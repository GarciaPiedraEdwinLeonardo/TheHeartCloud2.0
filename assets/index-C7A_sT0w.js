(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&a(h)}).observe(document,{childList:!0,subtree:!0});function n(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function a(l){if(l.ep)return;l.ep=!0;const u=n(l);fetch(l.href,u)}})();function cb(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var $m={exports:{}},uc={};var g2;function B_(){if(g2)return uc;g2=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(a,l,u){var h=null;if(u!==void 0&&(h=""+u),l.key!==void 0&&(h=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:s,type:a,key:h,ref:l!==void 0?l:null,props:u}}return uc.Fragment=e,uc.jsx=n,uc.jsxs=n,uc}var p2;function F_(){return p2||(p2=1,$m.exports=B_()),$m.exports}var i=F_(),Qm={exports:{}},Oe={};var x2;function q_(){if(x2)return Oe;x2=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),h=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),_=Symbol.iterator;function E(H){return H===null||typeof H!="object"?null:(H=_&&H[_]||H["@@iterator"],typeof H=="function"?H:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,D={};function L(H,ae,he){this.props=H,this.context=ae,this.refs=D,this.updater=he||S}L.prototype.isReactComponent={},L.prototype.setState=function(H,ae){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,ae,"setState")},L.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function B(){}B.prototype=L.prototype;function k(H,ae,he){this.props=H,this.context=ae,this.refs=D,this.updater=he||S}var $=k.prototype=new B;$.constructor=k,A($,L.prototype),$.isPureReactComponent=!0;var q=Array.isArray;function F(){}var R={H:null,A:null,T:null,S:null},j=Object.prototype.hasOwnProperty;function C(H,ae,he){var me=he.ref;return{$$typeof:s,type:H,key:ae,ref:me!==void 0?me:null,props:he}}function O(H,ae){return C(H.type,ae,H.props)}function P(H){return typeof H=="object"&&H!==null&&H.$$typeof===s}function U(H){var ae={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(he){return ae[he]})}var M=/\/+/g;function ue(H,ae){return typeof H=="object"&&H!==null&&H.key!=null?U(""+H.key):ae.toString(36)}function we(H){switch(H.status){case"fulfilled":return H.value;case"rejected":throw H.reason;default:switch(typeof H.status=="string"?H.then(F,F):(H.status="pending",H.then(function(ae){H.status==="pending"&&(H.status="fulfilled",H.value=ae)},function(ae){H.status==="pending"&&(H.status="rejected",H.reason=ae)})),H.status){case"fulfilled":return H.value;case"rejected":throw H.reason}}throw H}function K(H,ae,he,me,Ae){var Ie=typeof H;(Ie==="undefined"||Ie==="boolean")&&(H=null);var Fe=!1;if(H===null)Fe=!0;else switch(Ie){case"bigint":case"string":case"number":Fe=!0;break;case"object":switch(H.$$typeof){case s:case e:Fe=!0;break;case y:return Fe=H._init,K(Fe(H._payload),ae,he,me,Ae)}}if(Fe)return Ae=Ae(H),Fe=me===""?"."+ue(H,0):me,q(Ae)?(he="",Fe!=null&&(he=Fe.replace(M,"$&/")+"/"),K(Ae,ae,he,"",function(on){return on})):Ae!=null&&(P(Ae)&&(Ae=O(Ae,he+(Ae.key==null||H&&H.key===Ae.key?"":(""+Ae.key).replace(M,"$&/")+"/")+Fe)),ae.push(Ae)),1;Fe=0;var wt=me===""?".":me+":";if(q(H))for(var at=0;at<H.length;at++)me=H[at],Ie=wt+ue(me,at),Fe+=K(me,ae,he,Ie,Ae);else if(at=E(H),typeof at=="function")for(H=at.call(H),at=0;!(me=H.next()).done;)me=me.value,Ie=wt+ue(me,at++),Fe+=K(me,ae,he,Ie,Ae);else if(Ie==="object"){if(typeof H.then=="function")return K(we(H),ae,he,me,Ae);throw ae=String(H),Error("Objects are not valid as a React child (found: "+(ae==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":ae)+"). If you meant to render a collection of children, use an array instead.")}return Fe}function ce(H,ae,he){if(H==null)return H;var me=[],Ae=0;return K(H,me,"","",function(Ie){return ae.call(he,Ie,Ae++)}),me}function ge(H){if(H._status===-1){var ae=H._result;ae=ae(),ae.then(function(he){(H._status===0||H._status===-1)&&(H._status=1,H._result=he)},function(he){(H._status===0||H._status===-1)&&(H._status=2,H._result=he)}),H._status===-1&&(H._status=0,H._result=ae)}if(H._status===1)return H._result.default;throw H._result}var Ee=typeof reportError=="function"?reportError:function(H){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ae=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof H=="object"&&H!==null&&typeof H.message=="string"?String(H.message):String(H),error:H});if(!window.dispatchEvent(ae))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",H);return}console.error(H)},Le={map:ce,forEach:function(H,ae,he){ce(H,function(){ae.apply(this,arguments)},he)},count:function(H){var ae=0;return ce(H,function(){ae++}),ae},toArray:function(H){return ce(H,function(ae){return ae})||[]},only:function(H){if(!P(H))throw Error("React.Children.only expected to receive a single React element child.");return H}};return Oe.Activity=v,Oe.Children=Le,Oe.Component=L,Oe.Fragment=n,Oe.Profiler=l,Oe.PureComponent=k,Oe.StrictMode=a,Oe.Suspense=g,Oe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Oe.__COMPILER_RUNTIME={__proto__:null,c:function(H){return R.H.useMemoCache(H)}},Oe.cache=function(H){return function(){return H.apply(null,arguments)}},Oe.cacheSignal=function(){return null},Oe.cloneElement=function(H,ae,he){if(H==null)throw Error("The argument must be a React element, but you passed "+H+".");var me=A({},H.props),Ae=H.key;if(ae!=null)for(Ie in ae.key!==void 0&&(Ae=""+ae.key),ae)!j.call(ae,Ie)||Ie==="key"||Ie==="__self"||Ie==="__source"||Ie==="ref"&&ae.ref===void 0||(me[Ie]=ae[Ie]);var Ie=arguments.length-2;if(Ie===1)me.children=he;else if(1<Ie){for(var Fe=Array(Ie),wt=0;wt<Ie;wt++)Fe[wt]=arguments[wt+2];me.children=Fe}return C(H.type,Ae,me)},Oe.createContext=function(H){return H={$$typeof:h,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null},H.Provider=H,H.Consumer={$$typeof:u,_context:H},H},Oe.createElement=function(H,ae,he){var me,Ae={},Ie=null;if(ae!=null)for(me in ae.key!==void 0&&(Ie=""+ae.key),ae)j.call(ae,me)&&me!=="key"&&me!=="__self"&&me!=="__source"&&(Ae[me]=ae[me]);var Fe=arguments.length-2;if(Fe===1)Ae.children=he;else if(1<Fe){for(var wt=Array(Fe),at=0;at<Fe;at++)wt[at]=arguments[at+2];Ae.children=wt}if(H&&H.defaultProps)for(me in Fe=H.defaultProps,Fe)Ae[me]===void 0&&(Ae[me]=Fe[me]);return C(H,Ie,Ae)},Oe.createRef=function(){return{current:null}},Oe.forwardRef=function(H){return{$$typeof:p,render:H}},Oe.isValidElement=P,Oe.lazy=function(H){return{$$typeof:y,_payload:{_status:-1,_result:H},_init:ge}},Oe.memo=function(H,ae){return{$$typeof:x,type:H,compare:ae===void 0?null:ae}},Oe.startTransition=function(H){var ae=R.T,he={};R.T=he;try{var me=H(),Ae=R.S;Ae!==null&&Ae(he,me),typeof me=="object"&&me!==null&&typeof me.then=="function"&&me.then(F,Ee)}catch(Ie){Ee(Ie)}finally{ae!==null&&he.types!==null&&(ae.types=he.types),R.T=ae}},Oe.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Oe.use=function(H){return R.H.use(H)},Oe.useActionState=function(H,ae,he){return R.H.useActionState(H,ae,he)},Oe.useCallback=function(H,ae){return R.H.useCallback(H,ae)},Oe.useContext=function(H){return R.H.useContext(H)},Oe.useDebugValue=function(){},Oe.useDeferredValue=function(H,ae){return R.H.useDeferredValue(H,ae)},Oe.useEffect=function(H,ae){return R.H.useEffect(H,ae)},Oe.useEffectEvent=function(H){return R.H.useEffectEvent(H)},Oe.useId=function(){return R.H.useId()},Oe.useImperativeHandle=function(H,ae,he){return R.H.useImperativeHandle(H,ae,he)},Oe.useInsertionEffect=function(H,ae){return R.H.useInsertionEffect(H,ae)},Oe.useLayoutEffect=function(H,ae){return R.H.useLayoutEffect(H,ae)},Oe.useMemo=function(H,ae){return R.H.useMemo(H,ae)},Oe.useOptimistic=function(H,ae){return R.H.useOptimistic(H,ae)},Oe.useReducer=function(H,ae,he){return R.H.useReducer(H,ae,he)},Oe.useRef=function(H){return R.H.useRef(H)},Oe.useState=function(H){return R.H.useState(H)},Oe.useSyncExternalStore=function(H,ae,he){return R.H.useSyncExternalStore(H,ae,he)},Oe.useTransition=function(){return R.H.useTransition()},Oe.version="19.2.0",Oe}var y2;function z0(){return y2||(y2=1,Qm.exports=q_()),Qm.exports}var V=z0();const Ga=cb(V);var Ym={exports:{}},dc={},Km={exports:{}},Xm={};var b2;function H_(){return b2||(b2=1,(function(s){function e(K,ce){var ge=K.length;K.push(ce);e:for(;0<ge;){var Ee=ge-1>>>1,Le=K[Ee];if(0<l(Le,ce))K[Ee]=ce,K[ge]=Le,ge=Ee;else break e}}function n(K){return K.length===0?null:K[0]}function a(K){if(K.length===0)return null;var ce=K[0],ge=K.pop();if(ge!==ce){K[0]=ge;e:for(var Ee=0,Le=K.length,H=Le>>>1;Ee<H;){var ae=2*(Ee+1)-1,he=K[ae],me=ae+1,Ae=K[me];if(0>l(he,ge))me<Le&&0>l(Ae,he)?(K[Ee]=Ae,K[me]=ge,Ee=me):(K[Ee]=he,K[ae]=ge,Ee=ae);else if(me<Le&&0>l(Ae,ge))K[Ee]=Ae,K[me]=ge,Ee=me;else break e}}return ce}function l(K,ce){var ge=K.sortIndex-ce.sortIndex;return ge!==0?ge:K.id-ce.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var h=Date,p=h.now();s.unstable_now=function(){return h.now()-p}}var g=[],x=[],y=1,v=null,_=3,E=!1,S=!1,A=!1,D=!1,L=typeof setTimeout=="function"?setTimeout:null,B=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function $(K){for(var ce=n(x);ce!==null;){if(ce.callback===null)a(x);else if(ce.startTime<=K)a(x),ce.sortIndex=ce.expirationTime,e(g,ce);else break;ce=n(x)}}function q(K){if(A=!1,$(K),!S)if(n(g)!==null)S=!0,F||(F=!0,U());else{var ce=n(x);ce!==null&&we(q,ce.startTime-K)}}var F=!1,R=-1,j=5,C=-1;function O(){return D?!0:!(s.unstable_now()-C<j)}function P(){if(D=!1,F){var K=s.unstable_now();C=K;var ce=!0;try{e:{S=!1,A&&(A=!1,B(R),R=-1),E=!0;var ge=_;try{t:{for($(K),v=n(g);v!==null&&!(v.expirationTime>K&&O());){var Ee=v.callback;if(typeof Ee=="function"){v.callback=null,_=v.priorityLevel;var Le=Ee(v.expirationTime<=K);if(K=s.unstable_now(),typeof Le=="function"){v.callback=Le,$(K),ce=!0;break t}v===n(g)&&a(g),$(K)}else a(g);v=n(g)}if(v!==null)ce=!0;else{var H=n(x);H!==null&&we(q,H.startTime-K),ce=!1}}break e}finally{v=null,_=ge,E=!1}ce=void 0}}finally{ce?U():F=!1}}}var U;if(typeof k=="function")U=function(){k(P)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,ue=M.port2;M.port1.onmessage=P,U=function(){ue.postMessage(null)}}else U=function(){L(P,0)};function we(K,ce){R=L(function(){K(s.unstable_now())},ce)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(K){K.callback=null},s.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<K?Math.floor(1e3/K):5},s.unstable_getCurrentPriorityLevel=function(){return _},s.unstable_next=function(K){switch(_){case 1:case 2:case 3:var ce=3;break;default:ce=_}var ge=_;_=ce;try{return K()}finally{_=ge}},s.unstable_requestPaint=function(){D=!0},s.unstable_runWithPriority=function(K,ce){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var ge=_;_=K;try{return ce()}finally{_=ge}},s.unstable_scheduleCallback=function(K,ce,ge){var Ee=s.unstable_now();switch(typeof ge=="object"&&ge!==null?(ge=ge.delay,ge=typeof ge=="number"&&0<ge?Ee+ge:Ee):ge=Ee,K){case 1:var Le=-1;break;case 2:Le=250;break;case 5:Le=1073741823;break;case 4:Le=1e4;break;default:Le=5e3}return Le=ge+Le,K={id:y++,callback:ce,priorityLevel:K,startTime:ge,expirationTime:Le,sortIndex:-1},ge>Ee?(K.sortIndex=ge,e(x,K),n(g)===null&&K===n(x)&&(A?(B(R),R=-1):A=!0,we(q,ge-Ee))):(K.sortIndex=Le,e(g,K),S||E||(S=!0,F||(F=!0,U()))),K},s.unstable_shouldYield=O,s.unstable_wrapCallback=function(K){var ce=_;return function(){var ge=_;_=ce;try{return K.apply(this,arguments)}finally{_=ge}}}})(Xm)),Xm}var v2;function G_(){return v2||(v2=1,Km.exports=H_()),Km.exports}var Zm={exports:{}},vn={};var w2;function $_(){if(w2)return vn;w2=1;var s=z0();function e(g){var x="https://react.dev/errors/"+g;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)x+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+g+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var a={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,x,y){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:v==null?null:""+v,children:g,containerInfo:x,implementation:y}}var h=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,x){if(g==="font")return"";if(typeof x=="string")return x==="use-credentials"?x:""}return vn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,vn.createPortal=function(g,x){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)throw Error(e(299));return u(g,x,null,y)},vn.flushSync=function(g){var x=h.T,y=a.p;try{if(h.T=null,a.p=2,g)return g()}finally{h.T=x,a.p=y,a.d.f()}},vn.preconnect=function(g,x){typeof g=="string"&&(x?(x=x.crossOrigin,x=typeof x=="string"?x==="use-credentials"?x:"":void 0):x=null,a.d.C(g,x))},vn.prefetchDNS=function(g){typeof g=="string"&&a.d.D(g)},vn.preinit=function(g,x){if(typeof g=="string"&&x&&typeof x.as=="string"){var y=x.as,v=p(y,x.crossOrigin),_=typeof x.integrity=="string"?x.integrity:void 0,E=typeof x.fetchPriority=="string"?x.fetchPriority:void 0;y==="style"?a.d.S(g,typeof x.precedence=="string"?x.precedence:void 0,{crossOrigin:v,integrity:_,fetchPriority:E}):y==="script"&&a.d.X(g,{crossOrigin:v,integrity:_,fetchPriority:E,nonce:typeof x.nonce=="string"?x.nonce:void 0})}},vn.preinitModule=function(g,x){if(typeof g=="string")if(typeof x=="object"&&x!==null){if(x.as==null||x.as==="script"){var y=p(x.as,x.crossOrigin);a.d.M(g,{crossOrigin:y,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0})}}else x==null&&a.d.M(g)},vn.preload=function(g,x){if(typeof g=="string"&&typeof x=="object"&&x!==null&&typeof x.as=="string"){var y=x.as,v=p(y,x.crossOrigin);a.d.L(g,y,{crossOrigin:v,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0,type:typeof x.type=="string"?x.type:void 0,fetchPriority:typeof x.fetchPriority=="string"?x.fetchPriority:void 0,referrerPolicy:typeof x.referrerPolicy=="string"?x.referrerPolicy:void 0,imageSrcSet:typeof x.imageSrcSet=="string"?x.imageSrcSet:void 0,imageSizes:typeof x.imageSizes=="string"?x.imageSizes:void 0,media:typeof x.media=="string"?x.media:void 0})}},vn.preloadModule=function(g,x){if(typeof g=="string")if(x){var y=p(x.as,x.crossOrigin);a.d.m(g,{as:typeof x.as=="string"&&x.as!=="script"?x.as:void 0,crossOrigin:y,integrity:typeof x.integrity=="string"?x.integrity:void 0})}else a.d.m(g)},vn.requestFormReset=function(g){a.d.r(g)},vn.unstable_batchedUpdates=function(g,x){return g(x)},vn.useFormState=function(g,x,y){return h.H.useFormState(g,x,y)},vn.useFormStatus=function(){return h.H.useHostTransitionStatus()},vn.version="19.2.0",vn}var _2;function Q_(){if(_2)return Zm.exports;_2=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Zm.exports=$_(),Zm.exports}var N2;function Y_(){if(N2)return dc;N2=1;var s=G_(),e=z0(),n=Q_();function a(t){var r="https://react.dev/errors/"+t;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+t+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function u(t){var r=t,o=t;if(t.alternate)for(;r.return;)r=r.return;else{t=r;do r=t,(r.flags&4098)!==0&&(o=r.return),t=r.return;while(t)}return r.tag===3?o:null}function h(t){if(t.tag===13){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function p(t){if(t.tag===31){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function g(t){if(u(t)!==t)throw Error(a(188))}function x(t){var r=t.alternate;if(!r){if(r=u(t),r===null)throw Error(a(188));return r!==t?null:t}for(var o=t,c=r;;){var f=o.return;if(f===null)break;var m=f.alternate;if(m===null){if(c=f.return,c!==null){o=c;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===o)return g(f),t;if(m===c)return g(f),r;m=m.sibling}throw Error(a(188))}if(o.return!==c.return)o=f,c=m;else{for(var w=!1,T=f.child;T;){if(T===o){w=!0,o=f,c=m;break}if(T===c){w=!0,c=f,o=m;break}T=T.sibling}if(!w){for(T=m.child;T;){if(T===o){w=!0,o=m,c=f;break}if(T===c){w=!0,c=m,o=f;break}T=T.sibling}if(!w)throw Error(a(189))}}if(o.alternate!==c)throw Error(a(190))}if(o.tag!==3)throw Error(a(188));return o.stateNode.current===o?t:r}function y(t){var r=t.tag;if(r===5||r===26||r===27||r===6)return t;for(t=t.child;t!==null;){if(r=y(t),r!==null)return r;t=t.sibling}return null}var v=Object.assign,_=Symbol.for("react.element"),E=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),B=Symbol.for("react.consumer"),k=Symbol.for("react.context"),$=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),C=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function U(t){return t===null||typeof t!="object"?null:(t=P&&t[P]||t["@@iterator"],typeof t=="function"?t:null)}var M=Symbol.for("react.client.reference");function ue(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===M?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case A:return"Fragment";case L:return"Profiler";case D:return"StrictMode";case q:return"Suspense";case F:return"SuspenseList";case C:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case S:return"Portal";case k:return t.displayName||"Context";case B:return(t._context.displayName||"Context")+".Consumer";case $:var r=t.render;return t=t.displayName,t||(t=r.displayName||r.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case R:return r=t.displayName||null,r!==null?r:ue(t.type)||"Memo";case j:r=t._payload,t=t._init;try{return ue(t(r))}catch{}}return null}var we=Array.isArray,K=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ge={pending:!1,data:null,method:null,action:null},Ee=[],Le=-1;function H(t){return{current:t}}function ae(t){0>Le||(t.current=Ee[Le],Ee[Le]=null,Le--)}function he(t,r){Le++,Ee[Le]=t.current,t.current=r}var me=H(null),Ae=H(null),Ie=H(null),Fe=H(null);function wt(t,r){switch(he(Ie,r),he(Ae,t),he(me,null),r.nodeType){case 9:case 11:t=(t=r.documentElement)&&(t=t.namespaceURI)?Ly(t):0;break;default:if(t=r.tagName,r=r.namespaceURI)r=Ly(r),t=Uy(r,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}ae(me),he(me,t)}function at(){ae(me),ae(Ae),ae(Ie)}function on(t){t.memoizedState!==null&&he(Fe,t);var r=me.current,o=Uy(r,t.type);r!==o&&(he(Ae,t),he(me,o))}function Yn(t){Ae.current===t&&(ae(me),ae(Ae)),Fe.current===t&&(ae(Fe),ic._currentValue=ge)}var Kn,os;function ln(t){if(Kn===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);Kn=r&&r[1]||"",os=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Kn+t+os}var In=!1;function nt(t,r){if(!t||In)return"";In=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var oe=function(){throw Error()};if(Object.defineProperty(oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(oe,[])}catch(te){var W=te}Reflect.construct(t,[],oe)}else{try{oe.call()}catch(te){W=te}t.call(oe.prototype)}}else{try{throw Error()}catch(te){W=te}(oe=t())&&typeof oe.catch=="function"&&oe.catch(function(){})}}catch(te){if(te&&W&&typeof te.stack=="string")return[te.stack,W.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),w=m[0],T=m[1];if(w&&T){var z=w.split(`
`),J=T.split(`
`);for(f=c=0;c<z.length&&!z[c].includes("DetermineComponentFrameRoot");)c++;for(;f<J.length&&!J[f].includes("DetermineComponentFrameRoot");)f++;if(c===z.length||f===J.length)for(c=z.length-1,f=J.length-1;1<=c&&0<=f&&z[c]!==J[f];)f--;for(;1<=c&&0<=f;c--,f--)if(z[c]!==J[f]){if(c!==1||f!==1)do if(c--,f--,0>f||z[c]!==J[f]){var ne=`
`+z[c].replace(" at new "," at ");return t.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",t.displayName)),ne}while(1<=c&&0<=f);break}}}finally{In=!1,Error.prepareStackTrace=o}return(o=t?t.displayName||t.name:"")?ln(o):""}function Tn(t,r){switch(t.tag){case 26:case 27:case 5:return ln(t.type);case 16:return ln("Lazy");case 13:return t.child!==r&&r!==null?ln("Suspense Fallback"):ln("Suspense");case 19:return ln("SuspenseList");case 0:case 15:return nt(t.type,!1);case 11:return nt(t.type.render,!1);case 1:return nt(t.type,!0);case 31:return ln("Activity");default:return""}}function it(t){try{var r="",o=null;do r+=Tn(t,o),o=t,t=t.return;while(t);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Qe=Object.prototype.hasOwnProperty,qe=s.unstable_scheduleCallback,Ct=s.unstable_cancelCallback,Es=s.unstable_shouldYield,Te=s.unstable_requestPaint,Pt=s.unstable_now,bn=s.unstable_getCurrentPriorityLevel,ls=s.unstable_ImmediatePriority,yr=s.unstable_UserBlockingPriority,js=s.unstable_NormalPriority,ul=s.unstable_LowPriority,br=s.unstable_IdlePriority,oa=s.log,vr=s.unstable_setDisableYieldValue,Mn=null,Jt=null;function kn(t){if(typeof oa=="function"&&vr(t),Jt&&typeof Jt.setStrictMode=="function")try{Jt.setStrictMode(Mn,t)}catch{}}var Rt=Math.clz32?Math.clz32:Ki,Yi=Math.log,Bs=Math.LN2;function Ki(t){return t>>>=0,t===0?32:31-(Yi(t)/Bs|0)|0}var cs=256,wr=262144,pe=4194304;function Vn(t){var r=t&42;if(r!==0)return r;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function Fs(t,r,o){var c=t.pendingLanes;if(c===0)return 0;var f=0,m=t.suspendedLanes,w=t.pingedLanes;t=t.warmLanes;var T=c&134217727;return T!==0?(c=T&~m,c!==0?f=Vn(c):(w&=T,w!==0?f=Vn(w):o||(o=T&~t,o!==0&&(f=Vn(o))))):(T=c&~m,T!==0?f=Vn(T):w!==0?f=Vn(w):o||(o=c&~t,o!==0&&(f=Vn(o)))),f===0?0:r!==0&&r!==f&&(r&m)===0&&(m=f&-f,o=r&-r,m>=o||m===32&&(o&4194048)!==0)?r:f}function Ss(t,r){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&r)===0}function Kh(t,r){switch(t){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nu(){var t=pe;return pe<<=1,(pe&62914560)===0&&(pe=4194304),t}function qs(t){for(var r=[],o=0;31>o;o++)r.push(t);return r}function ii(t,r){t.pendingLanes|=r,r!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function Xh(t,r,o,c,f,m){var w=t.pendingLanes;t.pendingLanes=o,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=o,t.entangledLanes&=o,t.errorRecoveryDisabledLanes&=o,t.shellSuspendCounter=0;var T=t.entanglements,z=t.expirationTimes,J=t.hiddenUpdates;for(o=w&~o;0<o;){var ne=31-Rt(o),oe=1<<ne;T[ne]=0,z[ne]=-1;var W=J[ne];if(W!==null)for(J[ne]=null,ne=0;ne<W.length;ne++){var te=W[ne];te!==null&&(te.lane&=-536870913)}o&=~oe}c!==0&&oi(t,c,0),m!==0&&f===0&&t.tag!==0&&(t.suspendedLanes|=m&~(w&~r))}function oi(t,r,o){t.pendingLanes|=r,t.suspendedLanes&=~r;var c=31-Rt(r);t.entangledLanes|=r,t.entanglements[c]=t.entanglements[c]|1073741824|o&261930}function dl(t,r){var o=t.entangledLanes|=r;for(t=t.entanglements;o;){var c=31-Rt(o),f=1<<c;f&r|t[c]&r&&(t[c]|=r),o&=~f}}function hl(t,r){var o=r&-r;return o=(o&42)!==0?1:li(o),(o&(t.suspendedLanes|r))!==0?0:o}function li(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function _r(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function su(){var t=ce.p;return t!==0?t:(t=window.event,t===void 0?32:l2(t.type))}function Ts(t,r){var o=ce.p;try{return ce.p=t,r()}finally{ce.p=o}}var As=Math.random().toString(36).slice(2),Ft="__reactFiber$"+As,tn="__reactProps$"+As,Hs="__reactContainer$"+As,Xi="__reactEvents$"+As,Zh="__reactListeners$"+As,ru="__reactHandles$"+As,au="__reactResources$"+As,Gs="__reactMarker$"+As;function Zi(t){delete t[Ft],delete t[tn],delete t[Xi],delete t[Zh],delete t[ru]}function $s(t){var r=t[Ft];if(r)return r;for(var o=t.parentNode;o;){if(r=o[Hs]||o[Ft]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(t=$y(t);t!==null;){if(o=t[Ft])return o;t=$y(t)}return r}t=o,o=t.parentNode}return null}function us(t){if(t=t[Ft]||t[Hs]){var r=t.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return t}return null}function Xn(t){var r=t.tag;if(r===5||r===26||r===27||r===6)return t.stateNode;throw Error(a(33))}function Qs(t){var r=t[au];return r||(r=t[au]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function qt(t){t[Gs]=!0}var fl=new Set,ml={};function Ys(t,r){Ks(t,r),Ks(t+"Capture",r)}function Ks(t,r){for(ml[t]=r,t=0;t<r.length;t++)fl.add(r[t])}var gl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),pl={},xl={};function iu(t){return Qe.call(xl,t)?!0:Qe.call(pl,t)?!1:gl.test(t)?xl[t]=!0:(pl[t]=!0,!1)}function Ji(t,r,o){if(iu(r))if(o===null)t.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":t.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){t.removeAttribute(r);return}}t.setAttribute(r,""+o)}}function Zn(t,r,o){if(o===null)t.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(r);return}t.setAttribute(r,""+o)}}function Ht(t,r,o,c){if(c===null)t.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(o);return}t.setAttributeNS(r,o,""+c)}}function nn(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function la(t){var r=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function yl(t,r,o){var c=Object.getOwnPropertyDescriptor(t.constructor.prototype,r);if(!t.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,m=c.set;return Object.defineProperty(t,r,{configurable:!0,get:function(){return f.call(this)},set:function(w){o=""+w,m.call(this,w)}}),Object.defineProperty(t,r,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(w){o=""+w},stopTracking:function(){t._valueTracker=null,delete t[r]}}}}function dt(t){if(!t._valueTracker){var r=la(t)?"checked":"value";t._valueTracker=yl(t,r,""+t[r])}}function ci(t){if(!t)return!1;var r=t._valueTracker;if(!r)return!0;var o=r.getValue(),c="";return t&&(c=la(t)?t.checked?"true":"false":t.value),t=c,t!==o?(r.setValue(t),!0):!1}function Xs(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var ui=/[\n"\\]/g;function On(t){return t.replace(ui,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Wi(t,r,o,c,f,m,w,T){t.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?t.type=w:t.removeAttribute("type"),r!=null?w==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+nn(r)):t.value!==""+nn(r)&&(t.value=""+nn(r)):w!=="submit"&&w!=="reset"||t.removeAttribute("value"),r!=null?bl(t,w,nn(r)):o!=null?bl(t,w,nn(o)):c!=null&&t.removeAttribute("value"),f==null&&m!=null&&(t.defaultChecked=!!m),f!=null&&(t.checked=f&&typeof f!="function"&&typeof f!="symbol"),T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?t.name=""+nn(T):t.removeAttribute("name")}function ou(t,r,o,c,f,m,w,T){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(t.type=m),r!=null||o!=null){if(!(m!=="submit"&&m!=="reset"||r!=null)){dt(t);return}o=o!=null?""+nn(o):"",r=r!=null?""+nn(r):o,T||r===t.value||(t.value=r),t.defaultValue=r}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,t.checked=T?t.checked:!!c,t.defaultChecked=!!c,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(t.name=w),dt(t)}function bl(t,r,o){r==="number"&&Xs(t.ownerDocument)===t||t.defaultValue===""+o||(t.defaultValue=""+o)}function ca(t,r,o,c){if(t=t.options,r){r={};for(var f=0;f<o.length;f++)r["$"+o[f]]=!0;for(o=0;o<t.length;o++)f=r.hasOwnProperty("$"+t[o].value),t[o].selected!==f&&(t[o].selected=f),f&&c&&(t[o].defaultSelected=!0)}else{for(o=""+nn(o),r=null,f=0;f<t.length;f++){if(t[f].value===o){t[f].selected=!0,c&&(t[f].defaultSelected=!0);return}r!==null||t[f].disabled||(r=t[f])}r!==null&&(r.selected=!0)}}function lu(t,r,o){if(r!=null&&(r=""+nn(r),r!==t.value&&(t.value=r),o==null)){t.defaultValue!==r&&(t.defaultValue=r);return}t.defaultValue=o!=null?""+nn(o):""}function ua(t,r,o,c){if(r==null){if(c!=null){if(o!=null)throw Error(a(92));if(we(c)){if(1<c.length)throw Error(a(93));c=c[0]}o=c}o==null&&(o=""),r=o}o=nn(r),t.defaultValue=o,c=t.textContent,c===o&&c!==""&&c!==null&&(t.value=c),dt(t)}function Pn(t,r){if(r){var o=t.firstChild;if(o&&o===t.lastChild&&o.nodeType===3){o.nodeValue=r;return}}t.textContent=r}var cu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function vl(t,r,o){var c=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?t.setProperty(r,""):r==="float"?t.cssFloat="":t[r]="":c?t.setProperty(r,o):typeof o!="number"||o===0||cu.has(r)?r==="float"?t.cssFloat=o:t[r]=(""+o).trim():t[r]=o+"px"}function wl(t,r,o){if(r!=null&&typeof r!="object")throw Error(a(62));if(t=t.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?t.setProperty(c,""):c==="float"?t.cssFloat="":t[c]="");for(var f in r)c=r[f],r.hasOwnProperty(f)&&o[f]!==c&&vl(t,f,c)}else for(var m in r)r.hasOwnProperty(m)&&vl(t,m,r[m])}function eo(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var uu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),da=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function to(t){return da.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function Cs(){}var _l=null;function ds(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ha=null,Zs=null;function di(t){var r=us(t);if(r&&(t=r.stateNode)){var o=t[tn]||null;e:switch(t=r.stateNode,r.type){case"input":if(Wi(t,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=t;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+On(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var c=o[r];if(c!==t&&c.form===t.form){var f=c[tn]||null;if(!f)throw Error(a(90));Wi(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<o.length;r++)c=o[r],c.form===t.form&&ci(c)}break e;case"textarea":lu(t,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&ca(t,!!o.multiple,r,!1)}}}var no=!1;function fa(t,r,o){if(no)return t(r,o);no=!0;try{var c=t(r);return c}finally{if(no=!1,(ha!==null||Zs!==null)&&(sd(),ha&&(r=ha,t=Zs,Zs=ha=null,di(r),t)))for(r=0;r<t.length;r++)di(t[r])}}function Rs(t,r){var o=t.stateNode;if(o===null)return null;var c=o[tn]||null;if(c===null)return null;o=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(t=t.type,c=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!c;break e;default:t=!1}if(t)return null;if(o&&typeof o!="function")throw Error(a(231,r,typeof o));return o}var hs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hi=!1;if(hs)try{var mt={};Object.defineProperty(mt,"passive",{get:function(){hi=!0}}),window.addEventListener("test",mt,mt),window.removeEventListener("test",mt,mt)}catch{hi=!1}var Js=null,Nl=null,fi=null;function El(){if(fi)return fi;var t,r=Nl,o=r.length,c,f="value"in Js?Js.value:Js.textContent,m=f.length;for(t=0;t<o&&r[t]===f[t];t++);var w=o-t;for(c=1;c<=w&&r[o-c]===f[m-c];c++);return fi=f.slice(t,1<c?1-c:void 0)}function mi(t){var r=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&r===13&&(t=13)):t=r,t===10&&(t=13),32<=t||t===13?t:0}function Nr(){return!0}function Ds(){return!1}function cn(t){function r(o,c,f,m,w){this._reactName=o,this._targetInst=f,this.type=c,this.nativeEvent=m,this.target=w,this.currentTarget=null;for(var T in t)t.hasOwnProperty(T)&&(o=t[T],this[T]=o?o(m):m[T]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?Nr:Ds,this.isPropagationStopped=Ds,this}return v(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Nr)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Nr)},persist:function(){},isPersistent:Nr}),r}var Er={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ws=cn(Er),ma=v({},Er,{view:0,detail:0}),jl=cn(ma),ga,so,er,ro=v({},ma,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pa,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==er&&(er&&t.type==="mousemove"?(ga=t.screenX-er.screenX,so=t.screenY-er.screenY):so=ga=0,er=t),ga)},movementY:function(t){return"movementY"in t?t.movementY:so}}),Sl=cn(ro),gi=v({},ro,{dataTransfer:0}),du=cn(gi),hu=v({},ma,{relatedTarget:0}),pi=cn(hu),Tl=v({},Er,{animationName:0,elapsedTime:0,pseudoElement:0}),fu=cn(Tl),ao=v({},Er,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),mu=cn(ao),gu=v({},Er,{data:0}),tr=cn(gu),pu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bu(t){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(t):(t=yu[t])?!!r[t]:!1}function pa(){return bu}var An=v({},ma,{key:function(t){if(t.key){var r=pu[t.key]||t.key;if(r!=="Unidentified")return r}return t.type==="keypress"?(t=mi(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?xu[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pa,charCode:function(t){return t.type==="keypress"?mi(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?mi(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),vu=cn(An),wu=v({},ro,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jr=cn(wu),d=v({},ma,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pa}),b=cn(d),N=v({},Er,{propertyName:0,elapsedTime:0,pseudoElement:0}),I=cn(N),X=v({},ro,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),ee=cn(X),de=v({},Er,{newState:0,oldState:0}),Ue=cn(de),Lt=[9,13,27,32],ot=hs&&"CompositionEvent"in window,jt=null;hs&&"documentMode"in document&&(jt=document.documentMode);var fs=hs&&"TextEvent"in window&&!jt,nr=hs&&(!ot||jt&&8<jt&&11>=jt),Is=" ",Ms=!1;function xi(t,r){switch(t){case"keyup":return Lt.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function io(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var oo=!1;function dw(t,r){switch(t){case"compositionend":return io(r);case"keypress":return r.which!==32?null:(Ms=!0,Is);case"textInput":return t=r.data,t===Is&&Ms?null:t;default:return null}}function hw(t,r){if(oo)return t==="compositionend"||!ot&&xi(t,r)?(t=El(),fi=Nl=Js=null,oo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return nr&&r.locale!=="ko"?null:r.data;default:return null}}var fw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kg(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r==="input"?!!fw[t.type]:r==="textarea"}function Xg(t,r,o,c){ha?Zs?Zs.push(c):Zs=[c]:ha=c,r=ud(r,"onChange"),0<r.length&&(o=new Ws("onChange","change",null,o,c),t.push({event:o,listeners:r}))}var Al=null,Cl=null;function mw(t){Iy(t,0)}function _u(t){var r=Xn(t);if(ci(r))return t}function Zg(t,r){if(t==="change")return r}var Jg=!1;if(hs){var Jh;if(hs){var Wh="oninput"in document;if(!Wh){var Wg=document.createElement("div");Wg.setAttribute("oninput","return;"),Wh=typeof Wg.oninput=="function"}Jh=Wh}else Jh=!1;Jg=Jh&&(!document.documentMode||9<document.documentMode)}function ep(){Al&&(Al.detachEvent("onpropertychange",tp),Cl=Al=null)}function tp(t){if(t.propertyName==="value"&&_u(Cl)){var r=[];Xg(r,Cl,t,ds(t)),fa(mw,r)}}function gw(t,r,o){t==="focusin"?(ep(),Al=r,Cl=o,Al.attachEvent("onpropertychange",tp)):t==="focusout"&&ep()}function pw(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return _u(Cl)}function xw(t,r){if(t==="click")return _u(r)}function yw(t,r){if(t==="input"||t==="change")return _u(r)}function bw(t,r){return t===r&&(t!==0||1/t===1/r)||t!==t&&r!==r}var Jn=typeof Object.is=="function"?Object.is:bw;function Rl(t,r){if(Jn(t,r))return!0;if(typeof t!="object"||t===null||typeof r!="object"||r===null)return!1;var o=Object.keys(t),c=Object.keys(r);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var f=o[c];if(!Qe.call(r,f)||!Jn(t[f],r[f]))return!1}return!0}function np(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function sp(t,r){var o=np(t);t=0;for(var c;o;){if(o.nodeType===3){if(c=t+o.textContent.length,t<=r&&c>=r)return{node:o,offset:r-t};t=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=np(o)}}function rp(t,r){return t&&r?t===r?!0:t&&t.nodeType===3?!1:r&&r.nodeType===3?rp(t,r.parentNode):"contains"in t?t.contains(r):t.compareDocumentPosition?!!(t.compareDocumentPosition(r)&16):!1:!1}function ap(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var r=Xs(t.document);r instanceof t.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)t=r.contentWindow;else break;r=Xs(t.document)}return r}function ef(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r&&(r==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||r==="textarea"||t.contentEditable==="true")}var vw=hs&&"documentMode"in document&&11>=document.documentMode,lo=null,tf=null,Dl=null,nf=!1;function ip(t,r,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;nf||lo==null||lo!==Xs(c)||(c=lo,"selectionStart"in c&&ef(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Dl&&Rl(Dl,c)||(Dl=c,c=ud(tf,"onSelect"),0<c.length&&(r=new Ws("onSelect","select",null,r,o),t.push({event:r,listeners:c}),r.target=lo)))}function yi(t,r){var o={};return o[t.toLowerCase()]=r.toLowerCase(),o["Webkit"+t]="webkit"+r,o["Moz"+t]="moz"+r,o}var co={animationend:yi("Animation","AnimationEnd"),animationiteration:yi("Animation","AnimationIteration"),animationstart:yi("Animation","AnimationStart"),transitionrun:yi("Transition","TransitionRun"),transitionstart:yi("Transition","TransitionStart"),transitioncancel:yi("Transition","TransitionCancel"),transitionend:yi("Transition","TransitionEnd")},sf={},op={};hs&&(op=document.createElement("div").style,"AnimationEvent"in window||(delete co.animationend.animation,delete co.animationiteration.animation,delete co.animationstart.animation),"TransitionEvent"in window||delete co.transitionend.transition);function bi(t){if(sf[t])return sf[t];if(!co[t])return t;var r=co[t],o;for(o in r)if(r.hasOwnProperty(o)&&o in op)return sf[t]=r[o];return t}var lp=bi("animationend"),cp=bi("animationiteration"),up=bi("animationstart"),ww=bi("transitionrun"),_w=bi("transitionstart"),Nw=bi("transitioncancel"),dp=bi("transitionend"),hp=new Map,rf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");rf.push("scrollEnd");function ks(t,r){hp.set(t,r),Ys(r,[t])}var Nu=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},ms=[],uo=0,af=0;function Eu(){for(var t=uo,r=af=uo=0;r<t;){var o=ms[r];ms[r++]=null;var c=ms[r];ms[r++]=null;var f=ms[r];ms[r++]=null;var m=ms[r];if(ms[r++]=null,c!==null&&f!==null){var w=c.pending;w===null?f.next=f:(f.next=w.next,w.next=f),c.pending=f}m!==0&&fp(o,f,m)}}function ju(t,r,o,c){ms[uo++]=t,ms[uo++]=r,ms[uo++]=o,ms[uo++]=c,af|=c,t.lanes|=c,t=t.alternate,t!==null&&(t.lanes|=c)}function of(t,r,o,c){return ju(t,r,o,c),Su(t)}function vi(t,r){return ju(t,null,null,r),Su(t)}function fp(t,r,o){t.lanes|=o;var c=t.alternate;c!==null&&(c.lanes|=o);for(var f=!1,m=t.return;m!==null;)m.childLanes|=o,c=m.alternate,c!==null&&(c.childLanes|=o),m.tag===22&&(t=m.stateNode,t===null||t._visibility&1||(f=!0)),t=m,m=m.return;return t.tag===3?(m=t.stateNode,f&&r!==null&&(f=31-Rt(o),t=m.hiddenUpdates,c=t[f],c===null?t[f]=[r]:c.push(r),r.lane=o|536870912),m):null}function Su(t){if(50<Wl)throw Wl=0,pm=null,Error(a(185));for(var r=t.return;r!==null;)t=r,r=t.return;return t.tag===3?t.stateNode:null}var ho={};function Ew(t,r,o,c){this.tag=t,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wn(t,r,o,c){return new Ew(t,r,o,c)}function lf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Sr(t,r){var o=t.alternate;return o===null?(o=Wn(t.tag,r,t.key,t.mode),o.elementType=t.elementType,o.type=t.type,o.stateNode=t.stateNode,o.alternate=t,t.alternate=o):(o.pendingProps=r,o.type=t.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=t.flags&65011712,o.childLanes=t.childLanes,o.lanes=t.lanes,o.child=t.child,o.memoizedProps=t.memoizedProps,o.memoizedState=t.memoizedState,o.updateQueue=t.updateQueue,r=t.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=t.sibling,o.index=t.index,o.ref=t.ref,o.refCleanup=t.refCleanup,o}function mp(t,r){t.flags&=65011714;var o=t.alternate;return o===null?(t.childLanes=0,t.lanes=r,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=o.childLanes,t.lanes=o.lanes,t.child=o.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=o.memoizedProps,t.memoizedState=o.memoizedState,t.updateQueue=o.updateQueue,t.type=o.type,r=o.dependencies,t.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),t}function Tu(t,r,o,c,f,m){var w=0;if(c=t,typeof t=="function")lf(t)&&(w=1);else if(typeof t=="string")w=C_(t,o,me.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case C:return t=Wn(31,o,r,f),t.elementType=C,t.lanes=m,t;case A:return wi(o.children,f,m,r);case D:w=8,f|=24;break;case L:return t=Wn(12,o,r,f|2),t.elementType=L,t.lanes=m,t;case q:return t=Wn(13,o,r,f),t.elementType=q,t.lanes=m,t;case F:return t=Wn(19,o,r,f),t.elementType=F,t.lanes=m,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case k:w=10;break e;case B:w=9;break e;case $:w=11;break e;case R:w=14;break e;case j:w=16,c=null;break e}w=29,o=Error(a(130,t===null?"null":typeof t,"")),c=null}return r=Wn(w,o,r,f),r.elementType=t,r.type=c,r.lanes=m,r}function wi(t,r,o,c){return t=Wn(7,t,c,r),t.lanes=o,t}function cf(t,r,o){return t=Wn(6,t,null,r),t.lanes=o,t}function gp(t){var r=Wn(18,null,null,0);return r.stateNode=t,r}function uf(t,r,o){return r=Wn(4,t.children!==null?t.children:[],t.key,r),r.lanes=o,r.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},r}var pp=new WeakMap;function gs(t,r){if(typeof t=="object"&&t!==null){var o=pp.get(t);return o!==void 0?o:(r={value:t,source:r,stack:it(r)},pp.set(t,r),r)}return{value:t,source:r,stack:it(r)}}var fo=[],mo=0,Au=null,Il=0,ps=[],xs=0,xa=null,sr=1,rr="";function Tr(t,r){fo[mo++]=Il,fo[mo++]=Au,Au=t,Il=r}function xp(t,r,o){ps[xs++]=sr,ps[xs++]=rr,ps[xs++]=xa,xa=t;var c=sr;t=rr;var f=32-Rt(c)-1;c&=~(1<<f),o+=1;var m=32-Rt(r)+f;if(30<m){var w=f-f%5;m=(c&(1<<w)-1).toString(32),c>>=w,f-=w,sr=1<<32-Rt(r)+f|o<<f|c,rr=m+t}else sr=1<<m|o<<f|c,rr=t}function df(t){t.return!==null&&(Tr(t,1),xp(t,1,0))}function hf(t){for(;t===Au;)Au=fo[--mo],fo[mo]=null,Il=fo[--mo],fo[mo]=null;for(;t===xa;)xa=ps[--xs],ps[xs]=null,rr=ps[--xs],ps[xs]=null,sr=ps[--xs],ps[xs]=null}function yp(t,r){ps[xs++]=sr,ps[xs++]=rr,ps[xs++]=xa,sr=r.id,rr=r.overflow,xa=t}var un=null,_t=null,We=!1,ya=null,ys=!1,ff=Error(a(519));function ba(t){var r=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ml(gs(r,t)),ff}function bp(t){var r=t.stateNode,o=t.type,c=t.memoizedProps;switch(r[Ft]=t,r[tn]=c,o){case"dialog":$e("cancel",r),$e("close",r);break;case"iframe":case"object":case"embed":$e("load",r);break;case"video":case"audio":for(o=0;o<tc.length;o++)$e(tc[o],r);break;case"source":$e("error",r);break;case"img":case"image":case"link":$e("error",r),$e("load",r);break;case"details":$e("toggle",r);break;case"input":$e("invalid",r),ou(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":$e("invalid",r);break;case"textarea":$e("invalid",r),ua(r,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||c.suppressHydrationWarning===!0||Oy(r.textContent,o)?(c.popover!=null&&($e("beforetoggle",r),$e("toggle",r)),c.onScroll!=null&&$e("scroll",r),c.onScrollEnd!=null&&$e("scrollend",r),c.onClick!=null&&(r.onclick=Cs),r=!0):r=!1,r||ba(t,!0)}function vp(t){for(un=t.return;un;)switch(un.tag){case 5:case 31:case 13:ys=!1;return;case 27:case 3:ys=!0;return;default:un=un.return}}function go(t){if(t!==un)return!1;if(!We)return vp(t),We=!0,!1;var r=t.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=t.type,o=!(o!=="form"&&o!=="button")||Dm(t.type,t.memoizedProps)),o=!o),o&&_t&&ba(t),vp(t),r===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(a(317));_t=Gy(t)}else if(r===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(a(317));_t=Gy(t)}else r===27?(r=_t,Ma(t.type)?(t=Om,Om=null,_t=t):_t=r):_t=un?vs(t.stateNode.nextSibling):null;return!0}function _i(){_t=un=null,We=!1}function mf(){var t=ya;return t!==null&&(Bn===null?Bn=t:Bn.push.apply(Bn,t),ya=null),t}function Ml(t){ya===null?ya=[t]:ya.push(t)}var gf=H(null),Ni=null,Ar=null;function va(t,r,o){he(gf,r._currentValue),r._currentValue=o}function Cr(t){t._currentValue=gf.current,ae(gf)}function pf(t,r,o){for(;t!==null;){var c=t.alternate;if((t.childLanes&r)!==r?(t.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),t===o)break;t=t.return}}function xf(t,r,o,c){var f=t.child;for(f!==null&&(f.return=t);f!==null;){var m=f.dependencies;if(m!==null){var w=f.child;m=m.firstContext;e:for(;m!==null;){var T=m;m=f;for(var z=0;z<r.length;z++)if(T.context===r[z]){m.lanes|=o,T=m.alternate,T!==null&&(T.lanes|=o),pf(m.return,o,t),c||(w=null);break e}m=T.next}}else if(f.tag===18){if(w=f.return,w===null)throw Error(a(341));w.lanes|=o,m=w.alternate,m!==null&&(m.lanes|=o),pf(w,o,t),w=null}else w=f.child;if(w!==null)w.return=f;else for(w=f;w!==null;){if(w===t){w=null;break}if(f=w.sibling,f!==null){f.return=w.return,w=f;break}w=w.return}f=w}}function po(t,r,o,c){t=null;for(var f=r,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var w=f.alternate;if(w===null)throw Error(a(387));if(w=w.memoizedProps,w!==null){var T=f.type;Jn(f.pendingProps.value,w.value)||(t!==null?t.push(T):t=[T])}}else if(f===Fe.current){if(w=f.alternate,w===null)throw Error(a(387));w.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(t!==null?t.push(ic):t=[ic])}f=f.return}t!==null&&xf(r,t,o,c),r.flags|=262144}function Cu(t){for(t=t.firstContext;t!==null;){if(!Jn(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function Ei(t){Ni=t,Ar=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function dn(t){return wp(Ni,t)}function Ru(t,r){return Ni===null&&Ei(t),wp(t,r)}function wp(t,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},Ar===null){if(t===null)throw Error(a(308));Ar=r,t.dependencies={lanes:0,firstContext:r},t.flags|=524288}else Ar=Ar.next=r;return o}var jw=typeof AbortController<"u"?AbortController:function(){var t=[],r=this.signal={aborted:!1,addEventListener:function(o,c){t.push(c)}};this.abort=function(){r.aborted=!0,t.forEach(function(o){return o()})}},Sw=s.unstable_scheduleCallback,Tw=s.unstable_NormalPriority,Gt={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function yf(){return{controller:new jw,data:new Map,refCount:0}}function kl(t){t.refCount--,t.refCount===0&&Sw(Tw,function(){t.controller.abort()})}var Vl=null,bf=0,xo=0,yo=null;function Aw(t,r){if(Vl===null){var o=Vl=[];bf=0,xo=_m(),yo={status:"pending",value:void 0,then:function(c){o.push(c)}}}return bf++,r.then(_p,_p),r}function _p(){if(--bf===0&&Vl!==null){yo!==null&&(yo.status="fulfilled");var t=Vl;Vl=null,xo=0,yo=null;for(var r=0;r<t.length;r++)(0,t[r])()}}function Cw(t,r){var o=[],c={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return t.then(function(){c.status="fulfilled",c.value=r;for(var f=0;f<o.length;f++)(0,o[f])(r)},function(f){for(c.status="rejected",c.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),c}var Np=K.S;K.S=function(t,r){iy=Pt(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&Aw(t,r),Np!==null&&Np(t,r)};var ji=H(null);function vf(){var t=ji.current;return t!==null?t:yt.pooledCache}function Du(t,r){r===null?he(ji,ji.current):he(ji,r.pool)}function Ep(){var t=vf();return t===null?null:{parent:Gt._currentValue,pool:t}}var bo=Error(a(460)),wf=Error(a(474)),Iu=Error(a(542)),Mu={then:function(){}};function jp(t){return t=t.status,t==="fulfilled"||t==="rejected"}function Sp(t,r,o){switch(o=t[o],o===void 0?t.push(r):o!==r&&(r.then(Cs,Cs),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw t=r.reason,Ap(t),t;default:if(typeof r.status=="string")r.then(Cs,Cs);else{if(t=yt,t!==null&&100<t.shellSuspendCounter)throw Error(a(482));t=r,t.status="pending",t.then(function(c){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=c}},function(c){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw t=r.reason,Ap(t),t}throw Ti=r,bo}}function Si(t){try{var r=t._init;return r(t._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Ti=o,bo):o}}var Ti=null;function Tp(){if(Ti===null)throw Error(a(459));var t=Ti;return Ti=null,t}function Ap(t){if(t===bo||t===Iu)throw Error(a(483))}var vo=null,Ol=0;function ku(t){var r=Ol;return Ol+=1,vo===null&&(vo=[]),Sp(vo,t,r)}function Pl(t,r){r=r.props.ref,t.ref=r!==void 0?r:null}function Vu(t,r){throw r.$$typeof===_?Error(a(525)):(t=Object.prototype.toString.call(r),Error(a(31,t==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":t)))}function Cp(t){function r(Q,G){if(t){var Z=Q.deletions;Z===null?(Q.deletions=[G],Q.flags|=16):Z.push(G)}}function o(Q,G){if(!t)return null;for(;G!==null;)r(Q,G),G=G.sibling;return null}function c(Q){for(var G=new Map;Q!==null;)Q.key!==null?G.set(Q.key,Q):G.set(Q.index,Q),Q=Q.sibling;return G}function f(Q,G){return Q=Sr(Q,G),Q.index=0,Q.sibling=null,Q}function m(Q,G,Z){return Q.index=Z,t?(Z=Q.alternate,Z!==null?(Z=Z.index,Z<G?(Q.flags|=67108866,G):Z):(Q.flags|=67108866,G)):(Q.flags|=1048576,G)}function w(Q){return t&&Q.alternate===null&&(Q.flags|=67108866),Q}function T(Q,G,Z,ie){return G===null||G.tag!==6?(G=cf(Z,Q.mode,ie),G.return=Q,G):(G=f(G,Z),G.return=Q,G)}function z(Q,G,Z,ie){var je=Z.type;return je===A?ne(Q,G,Z.props.children,ie,Z.key):G!==null&&(G.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===j&&Si(je)===G.type)?(G=f(G,Z.props),Pl(G,Z),G.return=Q,G):(G=Tu(Z.type,Z.key,Z.props,null,Q.mode,ie),Pl(G,Z),G.return=Q,G)}function J(Q,G,Z,ie){return G===null||G.tag!==4||G.stateNode.containerInfo!==Z.containerInfo||G.stateNode.implementation!==Z.implementation?(G=uf(Z,Q.mode,ie),G.return=Q,G):(G=f(G,Z.children||[]),G.return=Q,G)}function ne(Q,G,Z,ie,je){return G===null||G.tag!==7?(G=wi(Z,Q.mode,ie,je),G.return=Q,G):(G=f(G,Z),G.return=Q,G)}function oe(Q,G,Z){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=cf(""+G,Q.mode,Z),G.return=Q,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case E:return Z=Tu(G.type,G.key,G.props,null,Q.mode,Z),Pl(Z,G),Z.return=Q,Z;case S:return G=uf(G,Q.mode,Z),G.return=Q,G;case j:return G=Si(G),oe(Q,G,Z)}if(we(G)||U(G))return G=wi(G,Q.mode,Z,null),G.return=Q,G;if(typeof G.then=="function")return oe(Q,ku(G),Z);if(G.$$typeof===k)return oe(Q,Ru(Q,G),Z);Vu(Q,G)}return null}function W(Q,G,Z,ie){var je=G!==null?G.key:null;if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return je!==null?null:T(Q,G,""+Z,ie);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case E:return Z.key===je?z(Q,G,Z,ie):null;case S:return Z.key===je?J(Q,G,Z,ie):null;case j:return Z=Si(Z),W(Q,G,Z,ie)}if(we(Z)||U(Z))return je!==null?null:ne(Q,G,Z,ie,null);if(typeof Z.then=="function")return W(Q,G,ku(Z),ie);if(Z.$$typeof===k)return W(Q,G,Ru(Q,Z),ie);Vu(Q,Z)}return null}function te(Q,G,Z,ie,je){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return Q=Q.get(Z)||null,T(G,Q,""+ie,je);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case E:return Q=Q.get(ie.key===null?Z:ie.key)||null,z(G,Q,ie,je);case S:return Q=Q.get(ie.key===null?Z:ie.key)||null,J(G,Q,ie,je);case j:return ie=Si(ie),te(Q,G,Z,ie,je)}if(we(ie)||U(ie))return Q=Q.get(Z)||null,ne(G,Q,ie,je,null);if(typeof ie.then=="function")return te(Q,G,Z,ku(ie),je);if(ie.$$typeof===k)return te(Q,G,Z,Ru(G,ie),je);Vu(G,ie)}return null}function be(Q,G,Z,ie){for(var je=null,st=null,_e=G,Be=G=0,Ke=null;_e!==null&&Be<Z.length;Be++){_e.index>Be?(Ke=_e,_e=null):Ke=_e.sibling;var rt=W(Q,_e,Z[Be],ie);if(rt===null){_e===null&&(_e=Ke);break}t&&_e&&rt.alternate===null&&r(Q,_e),G=m(rt,G,Be),st===null?je=rt:st.sibling=rt,st=rt,_e=Ke}if(Be===Z.length)return o(Q,_e),We&&Tr(Q,Be),je;if(_e===null){for(;Be<Z.length;Be++)_e=oe(Q,Z[Be],ie),_e!==null&&(G=m(_e,G,Be),st===null?je=_e:st.sibling=_e,st=_e);return We&&Tr(Q,Be),je}for(_e=c(_e);Be<Z.length;Be++)Ke=te(_e,Q,Be,Z[Be],ie),Ke!==null&&(t&&Ke.alternate!==null&&_e.delete(Ke.key===null?Be:Ke.key),G=m(Ke,G,Be),st===null?je=Ke:st.sibling=Ke,st=Ke);return t&&_e.forEach(function(La){return r(Q,La)}),We&&Tr(Q,Be),je}function Ce(Q,G,Z,ie){if(Z==null)throw Error(a(151));for(var je=null,st=null,_e=G,Be=G=0,Ke=null,rt=Z.next();_e!==null&&!rt.done;Be++,rt=Z.next()){_e.index>Be?(Ke=_e,_e=null):Ke=_e.sibling;var La=W(Q,_e,rt.value,ie);if(La===null){_e===null&&(_e=Ke);break}t&&_e&&La.alternate===null&&r(Q,_e),G=m(La,G,Be),st===null?je=La:st.sibling=La,st=La,_e=Ke}if(rt.done)return o(Q,_e),We&&Tr(Q,Be),je;if(_e===null){for(;!rt.done;Be++,rt=Z.next())rt=oe(Q,rt.value,ie),rt!==null&&(G=m(rt,G,Be),st===null?je=rt:st.sibling=rt,st=rt);return We&&Tr(Q,Be),je}for(_e=c(_e);!rt.done;Be++,rt=Z.next())rt=te(_e,Q,Be,rt.value,ie),rt!==null&&(t&&rt.alternate!==null&&_e.delete(rt.key===null?Be:rt.key),G=m(rt,G,Be),st===null?je=rt:st.sibling=rt,st=rt);return t&&_e.forEach(function(z_){return r(Q,z_)}),We&&Tr(Q,Be),je}function xt(Q,G,Z,ie){if(typeof Z=="object"&&Z!==null&&Z.type===A&&Z.key===null&&(Z=Z.props.children),typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case E:e:{for(var je=Z.key;G!==null;){if(G.key===je){if(je=Z.type,je===A){if(G.tag===7){o(Q,G.sibling),ie=f(G,Z.props.children),ie.return=Q,Q=ie;break e}}else if(G.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===j&&Si(je)===G.type){o(Q,G.sibling),ie=f(G,Z.props),Pl(ie,Z),ie.return=Q,Q=ie;break e}o(Q,G);break}else r(Q,G);G=G.sibling}Z.type===A?(ie=wi(Z.props.children,Q.mode,ie,Z.key),ie.return=Q,Q=ie):(ie=Tu(Z.type,Z.key,Z.props,null,Q.mode,ie),Pl(ie,Z),ie.return=Q,Q=ie)}return w(Q);case S:e:{for(je=Z.key;G!==null;){if(G.key===je)if(G.tag===4&&G.stateNode.containerInfo===Z.containerInfo&&G.stateNode.implementation===Z.implementation){o(Q,G.sibling),ie=f(G,Z.children||[]),ie.return=Q,Q=ie;break e}else{o(Q,G);break}else r(Q,G);G=G.sibling}ie=uf(Z,Q.mode,ie),ie.return=Q,Q=ie}return w(Q);case j:return Z=Si(Z),xt(Q,G,Z,ie)}if(we(Z))return be(Q,G,Z,ie);if(U(Z)){if(je=U(Z),typeof je!="function")throw Error(a(150));return Z=je.call(Z),Ce(Q,G,Z,ie)}if(typeof Z.then=="function")return xt(Q,G,ku(Z),ie);if(Z.$$typeof===k)return xt(Q,G,Ru(Q,Z),ie);Vu(Q,Z)}return typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint"?(Z=""+Z,G!==null&&G.tag===6?(o(Q,G.sibling),ie=f(G,Z),ie.return=Q,Q=ie):(o(Q,G),ie=cf(Z,Q.mode,ie),ie.return=Q,Q=ie),w(Q)):o(Q,G)}return function(Q,G,Z,ie){try{Ol=0;var je=xt(Q,G,Z,ie);return vo=null,je}catch(_e){if(_e===bo||_e===Iu)throw _e;var st=Wn(29,_e,null,Q.mode);return st.lanes=ie,st.return=Q,st}finally{}}}var Ai=Cp(!0),Rp=Cp(!1),wa=!1;function _f(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Nf(t,r){t=t.updateQueue,r.updateQueue===t&&(r.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function _a(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Na(t,r,o){var c=t.updateQueue;if(c===null)return null;if(c=c.shared,(lt&2)!==0){var f=c.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),c.pending=r,r=Su(t),fp(t,null,o),r}return ju(t,c,r,o),Su(t)}function Ll(t,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var c=r.lanes;c&=t.pendingLanes,o|=c,r.lanes=o,dl(t,o)}}function Ef(t,r){var o=t.updateQueue,c=t.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var f=null,m=null;if(o=o.firstBaseUpdate,o!==null){do{var w={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};m===null?f=m=w:m=m.next=w,o=o.next}while(o!==null);m===null?f=m=r:m=m.next=r}else f=m=r;o={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},t.updateQueue=o;return}t=o.lastBaseUpdate,t===null?o.firstBaseUpdate=r:t.next=r,o.lastBaseUpdate=r}var jf=!1;function Ul(){if(jf){var t=yo;if(t!==null)throw t}}function zl(t,r,o,c){jf=!1;var f=t.updateQueue;wa=!1;var m=f.firstBaseUpdate,w=f.lastBaseUpdate,T=f.shared.pending;if(T!==null){f.shared.pending=null;var z=T,J=z.next;z.next=null,w===null?m=J:w.next=J,w=z;var ne=t.alternate;ne!==null&&(ne=ne.updateQueue,T=ne.lastBaseUpdate,T!==w&&(T===null?ne.firstBaseUpdate=J:T.next=J,ne.lastBaseUpdate=z))}if(m!==null){var oe=f.baseState;w=0,ne=J=z=null,T=m;do{var W=T.lane&-536870913,te=W!==T.lane;if(te?(Ye&W)===W:(c&W)===W){W!==0&&W===xo&&(jf=!0),ne!==null&&(ne=ne.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});e:{var be=t,Ce=T;W=r;var xt=o;switch(Ce.tag){case 1:if(be=Ce.payload,typeof be=="function"){oe=be.call(xt,oe,W);break e}oe=be;break e;case 3:be.flags=be.flags&-65537|128;case 0:if(be=Ce.payload,W=typeof be=="function"?be.call(xt,oe,W):be,W==null)break e;oe=v({},oe,W);break e;case 2:wa=!0}}W=T.callback,W!==null&&(t.flags|=64,te&&(t.flags|=8192),te=f.callbacks,te===null?f.callbacks=[W]:te.push(W))}else te={lane:W,tag:T.tag,payload:T.payload,callback:T.callback,next:null},ne===null?(J=ne=te,z=oe):ne=ne.next=te,w|=W;if(T=T.next,T===null){if(T=f.shared.pending,T===null)break;te=T,T=te.next,te.next=null,f.lastBaseUpdate=te,f.shared.pending=null}}while(!0);ne===null&&(z=oe),f.baseState=z,f.firstBaseUpdate=J,f.lastBaseUpdate=ne,m===null&&(f.shared.lanes=0),Aa|=w,t.lanes=w,t.memoizedState=oe}}function Dp(t,r){if(typeof t!="function")throw Error(a(191,t));t.call(r)}function Ip(t,r){var o=t.callbacks;if(o!==null)for(t.callbacks=null,t=0;t<o.length;t++)Dp(o[t],r)}var wo=H(null),Ou=H(0);function Mp(t,r){t=Lr,he(Ou,t),he(wo,r),Lr=t|r.baseLanes}function Sf(){he(Ou,Lr),he(wo,wo.current)}function Tf(){Lr=Ou.current,ae(wo),ae(Ou)}var es=H(null),bs=null;function Ea(t){var r=t.alternate;he(Ut,Ut.current&1),he(es,t),bs===null&&(r===null||wo.current!==null||r.memoizedState!==null)&&(bs=t)}function Af(t){he(Ut,Ut.current),he(es,t),bs===null&&(bs=t)}function kp(t){t.tag===22?(he(Ut,Ut.current),he(es,t),bs===null&&(bs=t)):ja()}function ja(){he(Ut,Ut.current),he(es,es.current)}function ts(t){ae(es),bs===t&&(bs=null),ae(Ut)}var Ut=H(0);function Pu(t){for(var r=t;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||km(o)||Vm(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Rr=0,ze=null,gt=null,$t=null,Lu=!1,_o=!1,Ci=!1,Uu=0,Bl=0,No=null,Rw=0;function kt(){throw Error(a(321))}function Cf(t,r){if(r===null)return!1;for(var o=0;o<r.length&&o<t.length;o++)if(!Jn(t[o],r[o]))return!1;return!0}function Rf(t,r,o,c,f,m){return Rr=m,ze=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,K.H=t===null||t.memoizedState===null?xx:Gf,Ci=!1,m=o(c,f),Ci=!1,_o&&(m=Op(r,o,c,f)),Vp(t),m}function Vp(t){K.H=Hl;var r=gt!==null&&gt.next!==null;if(Rr=0,$t=gt=ze=null,Lu=!1,Bl=0,No=null,r)throw Error(a(300));t===null||Qt||(t=t.dependencies,t!==null&&Cu(t)&&(Qt=!0))}function Op(t,r,o,c){ze=t;var f=0;do{if(_o&&(No=null),Bl=0,_o=!1,25<=f)throw Error(a(301));if(f+=1,$t=gt=null,t.updateQueue!=null){var m=t.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}K.H=yx,m=r(o,c)}while(_o);return m}function Dw(){var t=K.H,r=t.useState()[0];return r=typeof r.then=="function"?Fl(r):r,t=t.useState()[0],(gt!==null?gt.memoizedState:null)!==t&&(ze.flags|=1024),r}function Df(){var t=Uu!==0;return Uu=0,t}function If(t,r,o){r.updateQueue=t.updateQueue,r.flags&=-2053,t.lanes&=~o}function Mf(t){if(Lu){for(t=t.memoizedState;t!==null;){var r=t.queue;r!==null&&(r.pending=null),t=t.next}Lu=!1}Rr=0,$t=gt=ze=null,_o=!1,Bl=Uu=0,No=null}function Cn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $t===null?ze.memoizedState=$t=t:$t=$t.next=t,$t}function zt(){if(gt===null){var t=ze.alternate;t=t!==null?t.memoizedState:null}else t=gt.next;var r=$t===null?ze.memoizedState:$t.next;if(r!==null)$t=r,gt=t;else{if(t===null)throw ze.alternate===null?Error(a(467)):Error(a(310));gt=t,t={memoizedState:gt.memoizedState,baseState:gt.baseState,baseQueue:gt.baseQueue,queue:gt.queue,next:null},$t===null?ze.memoizedState=$t=t:$t=$t.next=t}return $t}function zu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Fl(t){var r=Bl;return Bl+=1,No===null&&(No=[]),t=Sp(No,t,r),r=ze,($t===null?r.memoizedState:$t.next)===null&&(r=r.alternate,K.H=r===null||r.memoizedState===null?xx:Gf),t}function Bu(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return Fl(t);if(t.$$typeof===k)return dn(t)}throw Error(a(438,String(t)))}function kf(t){var r=null,o=ze.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var c=ze.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=zu(),ze.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(t),c=0;c<t;c++)o[c]=O;return r.index++,o}function Dr(t,r){return typeof r=="function"?r(t):r}function Fu(t){var r=zt();return Vf(r,gt,t)}function Vf(t,r,o){var c=t.queue;if(c===null)throw Error(a(311));c.lastRenderedReducer=o;var f=t.baseQueue,m=c.pending;if(m!==null){if(f!==null){var w=f.next;f.next=m.next,m.next=w}r.baseQueue=f=m,c.pending=null}if(m=t.baseState,f===null)t.memoizedState=m;else{r=f.next;var T=w=null,z=null,J=r,ne=!1;do{var oe=J.lane&-536870913;if(oe!==J.lane?(Ye&oe)===oe:(Rr&oe)===oe){var W=J.revertLane;if(W===0)z!==null&&(z=z.next={lane:0,revertLane:0,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),oe===xo&&(ne=!0);else if((Rr&W)===W){J=J.next,W===xo&&(ne=!0);continue}else oe={lane:0,revertLane:J.revertLane,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},z===null?(T=z=oe,w=m):z=z.next=oe,ze.lanes|=W,Aa|=W;oe=J.action,Ci&&o(m,oe),m=J.hasEagerState?J.eagerState:o(m,oe)}else W={lane:oe,revertLane:J.revertLane,gesture:J.gesture,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},z===null?(T=z=W,w=m):z=z.next=W,ze.lanes|=oe,Aa|=oe;J=J.next}while(J!==null&&J!==r);if(z===null?w=m:z.next=T,!Jn(m,t.memoizedState)&&(Qt=!0,ne&&(o=yo,o!==null)))throw o;t.memoizedState=m,t.baseState=w,t.baseQueue=z,c.lastRenderedState=m}return f===null&&(c.lanes=0),[t.memoizedState,c.dispatch]}function Of(t){var r=zt(),o=r.queue;if(o===null)throw Error(a(311));o.lastRenderedReducer=t;var c=o.dispatch,f=o.pending,m=r.memoizedState;if(f!==null){o.pending=null;var w=f=f.next;do m=t(m,w.action),w=w.next;while(w!==f);Jn(m,r.memoizedState)||(Qt=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),o.lastRenderedState=m}return[m,c]}function Pp(t,r,o){var c=ze,f=zt(),m=We;if(m){if(o===void 0)throw Error(a(407));o=o()}else o=r();var w=!Jn((gt||f).memoizedState,o);if(w&&(f.memoizedState=o,Qt=!0),f=f.queue,Uf(zp.bind(null,c,f,t),[t]),f.getSnapshot!==r||w||$t!==null&&$t.memoizedState.tag&1){if(c.flags|=2048,Eo(9,{destroy:void 0},Up.bind(null,c,f,o,r),null),yt===null)throw Error(a(349));m||(Rr&127)!==0||Lp(c,r,o)}return o}function Lp(t,r,o){t.flags|=16384,t={getSnapshot:r,value:o},r=ze.updateQueue,r===null?(r=zu(),ze.updateQueue=r,r.stores=[t]):(o=r.stores,o===null?r.stores=[t]:o.push(t))}function Up(t,r,o,c){r.value=o,r.getSnapshot=c,Bp(r)&&Fp(t)}function zp(t,r,o){return o(function(){Bp(r)&&Fp(t)})}function Bp(t){var r=t.getSnapshot;t=t.value;try{var o=r();return!Jn(t,o)}catch{return!0}}function Fp(t){var r=vi(t,2);r!==null&&Fn(r,t,2)}function Pf(t){var r=Cn();if(typeof t=="function"){var o=t;if(t=o(),Ci){kn(!0);try{o()}finally{kn(!1)}}}return r.memoizedState=r.baseState=t,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Dr,lastRenderedState:t},r}function qp(t,r,o,c){return t.baseState=o,Vf(t,gt,typeof c=="function"?c:Dr)}function Iw(t,r,o,c,f){if(Gu(t))throw Error(a(485));if(t=r.action,t!==null){var m={payload:f,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){m.listeners.push(w)}};K.T!==null?o(!0):m.isTransition=!1,c(m),o=r.pending,o===null?(m.next=r.pending=m,Hp(r,m)):(m.next=o.next,r.pending=o.next=m)}}function Hp(t,r){var o=r.action,c=r.payload,f=t.state;if(r.isTransition){var m=K.T,w={};K.T=w;try{var T=o(f,c),z=K.S;z!==null&&z(w,T),Gp(t,r,T)}catch(J){Lf(t,r,J)}finally{m!==null&&w.types!==null&&(m.types=w.types),K.T=m}}else try{m=o(f,c),Gp(t,r,m)}catch(J){Lf(t,r,J)}}function Gp(t,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){$p(t,r,c)},function(c){return Lf(t,r,c)}):$p(t,r,o)}function $p(t,r,o){r.status="fulfilled",r.value=o,Qp(r),t.state=o,r=t.pending,r!==null&&(o=r.next,o===r?t.pending=null:(o=o.next,r.next=o,Hp(t,o)))}function Lf(t,r,o){var c=t.pending;if(t.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=o,Qp(r),r=r.next;while(r!==c)}t.action=null}function Qp(t){t=t.listeners;for(var r=0;r<t.length;r++)(0,t[r])()}function Yp(t,r){return r}function Kp(t,r){if(We){var o=yt.formState;if(o!==null){e:{var c=ze;if(We){if(_t){t:{for(var f=_t,m=ys;f.nodeType!==8;){if(!m){f=null;break t}if(f=vs(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){_t=vs(f.nextSibling),c=f.data==="F!";break e}}ba(c)}c=!1}c&&(r=o[0])}}return o=Cn(),o.memoizedState=o.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yp,lastRenderedState:r},o.queue=c,o=mx.bind(null,ze,c),c.dispatch=o,c=Pf(!1),m=Hf.bind(null,ze,!1,c.queue),c=Cn(),f={state:r,dispatch:null,action:t,pending:null},c.queue=f,o=Iw.bind(null,ze,f,m,o),f.dispatch=o,c.memoizedState=t,[r,o,!1]}function Xp(t){var r=zt();return Zp(r,gt,t)}function Zp(t,r,o){if(r=Vf(t,r,Yp)[0],t=Fu(Dr)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=Fl(r)}catch(w){throw w===bo?Iu:w}else c=r;r=zt();var f=r.queue,m=f.dispatch;return o!==r.memoizedState&&(ze.flags|=2048,Eo(9,{destroy:void 0},Mw.bind(null,f,o),null)),[c,m,t]}function Mw(t,r){t.action=r}function Jp(t){var r=zt(),o=gt;if(o!==null)return Zp(r,o,t);zt(),r=r.memoizedState,o=zt();var c=o.queue.dispatch;return o.memoizedState=t,[r,c,!1]}function Eo(t,r,o,c){return t={tag:t,create:o,deps:c,inst:r,next:null},r=ze.updateQueue,r===null&&(r=zu(),ze.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=t.next=t:(c=o.next,o.next=t,t.next=c,r.lastEffect=t),t}function Wp(){return zt().memoizedState}function qu(t,r,o,c){var f=Cn();ze.flags|=t,f.memoizedState=Eo(1|r,{destroy:void 0},o,c===void 0?null:c)}function Hu(t,r,o,c){var f=zt();c=c===void 0?null:c;var m=f.memoizedState.inst;gt!==null&&c!==null&&Cf(c,gt.memoizedState.deps)?f.memoizedState=Eo(r,m,o,c):(ze.flags|=t,f.memoizedState=Eo(1|r,m,o,c))}function ex(t,r){qu(8390656,8,t,r)}function Uf(t,r){Hu(2048,8,t,r)}function kw(t){ze.flags|=4;var r=ze.updateQueue;if(r===null)r=zu(),ze.updateQueue=r,r.events=[t];else{var o=r.events;o===null?r.events=[t]:o.push(t)}}function tx(t){var r=zt().memoizedState;return kw({ref:r,nextImpl:t}),function(){if((lt&2)!==0)throw Error(a(440));return r.impl.apply(void 0,arguments)}}function nx(t,r){return Hu(4,2,t,r)}function sx(t,r){return Hu(4,4,t,r)}function rx(t,r){if(typeof r=="function"){t=t();var o=r(t);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return t=t(),r.current=t,function(){r.current=null}}function ax(t,r,o){o=o!=null?o.concat([t]):null,Hu(4,4,rx.bind(null,r,t),o)}function zf(){}function ix(t,r){var o=zt();r=r===void 0?null:r;var c=o.memoizedState;return r!==null&&Cf(r,c[1])?c[0]:(o.memoizedState=[t,r],t)}function ox(t,r){var o=zt();r=r===void 0?null:r;var c=o.memoizedState;if(r!==null&&Cf(r,c[1]))return c[0];if(c=t(),Ci){kn(!0);try{t()}finally{kn(!1)}}return o.memoizedState=[c,r],c}function Bf(t,r,o){return o===void 0||(Rr&1073741824)!==0&&(Ye&261930)===0?t.memoizedState=r:(t.memoizedState=o,t=ly(),ze.lanes|=t,Aa|=t,o)}function lx(t,r,o,c){return Jn(o,r)?o:wo.current!==null?(t=Bf(t,o,c),Jn(t,r)||(Qt=!0),t):(Rr&42)===0||(Rr&1073741824)!==0&&(Ye&261930)===0?(Qt=!0,t.memoizedState=o):(t=ly(),ze.lanes|=t,Aa|=t,r)}function cx(t,r,o,c,f){var m=ce.p;ce.p=m!==0&&8>m?m:8;var w=K.T,T={};K.T=T,Hf(t,!1,r,o);try{var z=f(),J=K.S;if(J!==null&&J(T,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var ne=Cw(z,c);ql(t,r,ne,rs(t))}else ql(t,r,c,rs(t))}catch(oe){ql(t,r,{then:function(){},status:"rejected",reason:oe},rs())}finally{ce.p=m,w!==null&&T.types!==null&&(w.types=T.types),K.T=w}}function Vw(){}function Ff(t,r,o,c){if(t.tag!==5)throw Error(a(476));var f=ux(t).queue;cx(t,f,r,ge,o===null?Vw:function(){return dx(t),o(c)})}function ux(t){var r=t.memoizedState;if(r!==null)return r;r={memoizedState:ge,baseState:ge,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Dr,lastRenderedState:ge},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Dr,lastRenderedState:o},next:null},t.memoizedState=r,t=t.alternate,t!==null&&(t.memoizedState=r),r}function dx(t){var r=ux(t);r.next===null&&(r=t.alternate.memoizedState),ql(t,r.next.queue,{},rs())}function qf(){return dn(ic)}function hx(){return zt().memoizedState}function fx(){return zt().memoizedState}function Ow(t){for(var r=t.return;r!==null;){switch(r.tag){case 24:case 3:var o=rs();t=_a(o);var c=Na(r,t,o);c!==null&&(Fn(c,r,o),Ll(c,r,o)),r={cache:yf()},t.payload=r;return}r=r.return}}function Pw(t,r,o){var c=rs();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Gu(t)?gx(r,o):(o=of(t,r,o,c),o!==null&&(Fn(o,t,c),px(o,r,c)))}function mx(t,r,o){var c=rs();ql(t,r,o,c)}function ql(t,r,o,c){var f={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Gu(t))gx(r,f);else{var m=t.alternate;if(t.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var w=r.lastRenderedState,T=m(w,o);if(f.hasEagerState=!0,f.eagerState=T,Jn(T,w))return ju(t,r,f,0),yt===null&&Eu(),!1}catch{}finally{}if(o=of(t,r,f,c),o!==null)return Fn(o,t,c),px(o,r,c),!0}return!1}function Hf(t,r,o,c){if(c={lane:2,revertLane:_m(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Gu(t)){if(r)throw Error(a(479))}else r=of(t,o,c,2),r!==null&&Fn(r,t,2)}function Gu(t){var r=t.alternate;return t===ze||r!==null&&r===ze}function gx(t,r){_o=Lu=!0;var o=t.pending;o===null?r.next=r:(r.next=o.next,o.next=r),t.pending=r}function px(t,r,o){if((o&4194048)!==0){var c=r.lanes;c&=t.pendingLanes,o|=c,r.lanes=o,dl(t,o)}}var Hl={readContext:dn,use:Bu,useCallback:kt,useContext:kt,useEffect:kt,useImperativeHandle:kt,useLayoutEffect:kt,useInsertionEffect:kt,useMemo:kt,useReducer:kt,useRef:kt,useState:kt,useDebugValue:kt,useDeferredValue:kt,useTransition:kt,useSyncExternalStore:kt,useId:kt,useHostTransitionStatus:kt,useFormState:kt,useActionState:kt,useOptimistic:kt,useMemoCache:kt,useCacheRefresh:kt};Hl.useEffectEvent=kt;var xx={readContext:dn,use:Bu,useCallback:function(t,r){return Cn().memoizedState=[t,r===void 0?null:r],t},useContext:dn,useEffect:ex,useImperativeHandle:function(t,r,o){o=o!=null?o.concat([t]):null,qu(4194308,4,rx.bind(null,r,t),o)},useLayoutEffect:function(t,r){return qu(4194308,4,t,r)},useInsertionEffect:function(t,r){qu(4,2,t,r)},useMemo:function(t,r){var o=Cn();r=r===void 0?null:r;var c=t();if(Ci){kn(!0);try{t()}finally{kn(!1)}}return o.memoizedState=[c,r],c},useReducer:function(t,r,o){var c=Cn();if(o!==void 0){var f=o(r);if(Ci){kn(!0);try{o(r)}finally{kn(!1)}}}else f=r;return c.memoizedState=c.baseState=f,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:f},c.queue=t,t=t.dispatch=Pw.bind(null,ze,t),[c.memoizedState,t]},useRef:function(t){var r=Cn();return t={current:t},r.memoizedState=t},useState:function(t){t=Pf(t);var r=t.queue,o=mx.bind(null,ze,r);return r.dispatch=o,[t.memoizedState,o]},useDebugValue:zf,useDeferredValue:function(t,r){var o=Cn();return Bf(o,t,r)},useTransition:function(){var t=Pf(!1);return t=cx.bind(null,ze,t.queue,!0,!1),Cn().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,r,o){var c=ze,f=Cn();if(We){if(o===void 0)throw Error(a(407));o=o()}else{if(o=r(),yt===null)throw Error(a(349));(Ye&127)!==0||Lp(c,r,o)}f.memoizedState=o;var m={value:o,getSnapshot:r};return f.queue=m,ex(zp.bind(null,c,m,t),[t]),c.flags|=2048,Eo(9,{destroy:void 0},Up.bind(null,c,m,o,r),null),o},useId:function(){var t=Cn(),r=yt.identifierPrefix;if(We){var o=rr,c=sr;o=(c&~(1<<32-Rt(c)-1)).toString(32)+o,r="_"+r+"R_"+o,o=Uu++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=Rw++,r="_"+r+"r_"+o.toString(32)+"_";return t.memoizedState=r},useHostTransitionStatus:qf,useFormState:Kp,useActionState:Kp,useOptimistic:function(t){var r=Cn();r.memoizedState=r.baseState=t;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=Hf.bind(null,ze,!0,o),o.dispatch=r,[t,r]},useMemoCache:kf,useCacheRefresh:function(){return Cn().memoizedState=Ow.bind(null,ze)},useEffectEvent:function(t){var r=Cn(),o={impl:t};return r.memoizedState=o,function(){if((lt&2)!==0)throw Error(a(440));return o.impl.apply(void 0,arguments)}}},Gf={readContext:dn,use:Bu,useCallback:ix,useContext:dn,useEffect:Uf,useImperativeHandle:ax,useInsertionEffect:nx,useLayoutEffect:sx,useMemo:ox,useReducer:Fu,useRef:Wp,useState:function(){return Fu(Dr)},useDebugValue:zf,useDeferredValue:function(t,r){var o=zt();return lx(o,gt.memoizedState,t,r)},useTransition:function(){var t=Fu(Dr)[0],r=zt().memoizedState;return[typeof t=="boolean"?t:Fl(t),r]},useSyncExternalStore:Pp,useId:hx,useHostTransitionStatus:qf,useFormState:Xp,useActionState:Xp,useOptimistic:function(t,r){var o=zt();return qp(o,gt,t,r)},useMemoCache:kf,useCacheRefresh:fx};Gf.useEffectEvent=tx;var yx={readContext:dn,use:Bu,useCallback:ix,useContext:dn,useEffect:Uf,useImperativeHandle:ax,useInsertionEffect:nx,useLayoutEffect:sx,useMemo:ox,useReducer:Of,useRef:Wp,useState:function(){return Of(Dr)},useDebugValue:zf,useDeferredValue:function(t,r){var o=zt();return gt===null?Bf(o,t,r):lx(o,gt.memoizedState,t,r)},useTransition:function(){var t=Of(Dr)[0],r=zt().memoizedState;return[typeof t=="boolean"?t:Fl(t),r]},useSyncExternalStore:Pp,useId:hx,useHostTransitionStatus:qf,useFormState:Jp,useActionState:Jp,useOptimistic:function(t,r){var o=zt();return gt!==null?qp(o,gt,t,r):(o.baseState=t,[t,o.queue.dispatch])},useMemoCache:kf,useCacheRefresh:fx};yx.useEffectEvent=tx;function $f(t,r,o,c){r=t.memoizedState,o=o(c,r),o=o==null?r:v({},r,o),t.memoizedState=o,t.lanes===0&&(t.updateQueue.baseState=o)}var Qf={enqueueSetState:function(t,r,o){t=t._reactInternals;var c=rs(),f=_a(c);f.payload=r,o!=null&&(f.callback=o),r=Na(t,f,c),r!==null&&(Fn(r,t,c),Ll(r,t,c))},enqueueReplaceState:function(t,r,o){t=t._reactInternals;var c=rs(),f=_a(c);f.tag=1,f.payload=r,o!=null&&(f.callback=o),r=Na(t,f,c),r!==null&&(Fn(r,t,c),Ll(r,t,c))},enqueueForceUpdate:function(t,r){t=t._reactInternals;var o=rs(),c=_a(o);c.tag=2,r!=null&&(c.callback=r),r=Na(t,c,o),r!==null&&(Fn(r,t,o),Ll(r,t,o))}};function bx(t,r,o,c,f,m,w){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(c,m,w):r.prototype&&r.prototype.isPureReactComponent?!Rl(o,c)||!Rl(f,m):!0}function vx(t,r,o,c){t=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,c),r.state!==t&&Qf.enqueueReplaceState(r,r.state,null)}function Ri(t,r){var o=r;if("ref"in r){o={};for(var c in r)c!=="ref"&&(o[c]=r[c])}if(t=t.defaultProps){o===r&&(o=v({},o));for(var f in t)o[f]===void 0&&(o[f]=t[f])}return o}function wx(t){Nu(t)}function _x(t){console.error(t)}function Nx(t){Nu(t)}function $u(t,r){try{var o=t.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function Ex(t,r,o){try{var c=t.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Yf(t,r,o){return o=_a(o),o.tag=3,o.payload={element:null},o.callback=function(){$u(t,r)},o}function jx(t){return t=_a(t),t.tag=3,t}function Sx(t,r,o,c){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var m=c.value;t.payload=function(){return f(m)},t.callback=function(){Ex(r,o,c)}}var w=o.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(t.callback=function(){Ex(r,o,c),typeof f!="function"&&(Ca===null?Ca=new Set([this]):Ca.add(this));var T=c.stack;this.componentDidCatch(c.value,{componentStack:T!==null?T:""})})}function Lw(t,r,o,c,f){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=o.alternate,r!==null&&po(r,o,f,!0),o=es.current,o!==null){switch(o.tag){case 31:case 13:return bs===null?rd():o.alternate===null&&Vt===0&&(Vt=3),o.flags&=-257,o.flags|=65536,o.lanes=f,c===Mu?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([c]):r.add(c),bm(t,c,f)),!1;case 22:return o.flags|=65536,c===Mu?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([c]):o.add(c)),bm(t,c,f)),!1}throw Error(a(435,o.tag))}return bm(t,c,f),rd(),!1}if(We)return r=es.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,c!==ff&&(t=Error(a(422),{cause:c}),Ml(gs(t,o)))):(c!==ff&&(r=Error(a(423),{cause:c}),Ml(gs(r,o))),t=t.current.alternate,t.flags|=65536,f&=-f,t.lanes|=f,c=gs(c,o),f=Yf(t.stateNode,c,f),Ef(t,f),Vt!==4&&(Vt=2)),!1;var m=Error(a(520),{cause:c});if(m=gs(m,o),Jl===null?Jl=[m]:Jl.push(m),Vt!==4&&(Vt=2),r===null)return!0;c=gs(c,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,t=f&-f,o.lanes|=t,t=Yf(o.stateNode,c,t),Ef(o,t),!1;case 1:if(r=o.type,m=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Ca===null||!Ca.has(m))))return o.flags|=65536,f&=-f,o.lanes|=f,f=jx(f),Sx(f,t,o,c),Ef(o,f),!1}o=o.return}while(o!==null);return!1}var Kf=Error(a(461)),Qt=!1;function hn(t,r,o,c){r.child=t===null?Rp(r,null,o,c):Ai(r,t.child,o,c)}function Tx(t,r,o,c,f){o=o.render;var m=r.ref;if("ref"in c){var w={};for(var T in c)T!=="ref"&&(w[T]=c[T])}else w=c;return Ei(r),c=Rf(t,r,o,w,m,f),T=Df(),t!==null&&!Qt?(If(t,r,f),Ir(t,r,f)):(We&&T&&df(r),r.flags|=1,hn(t,r,c,f),r.child)}function Ax(t,r,o,c,f){if(t===null){var m=o.type;return typeof m=="function"&&!lf(m)&&m.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=m,Cx(t,r,m,c,f)):(t=Tu(o.type,null,c,r,r.mode,f),t.ref=r.ref,t.return=r,r.child=t)}if(m=t.child,!sm(t,f)){var w=m.memoizedProps;if(o=o.compare,o=o!==null?o:Rl,o(w,c)&&t.ref===r.ref)return Ir(t,r,f)}return r.flags|=1,t=Sr(m,c),t.ref=r.ref,t.return=r,r.child=t}function Cx(t,r,o,c,f){if(t!==null){var m=t.memoizedProps;if(Rl(m,c)&&t.ref===r.ref)if(Qt=!1,r.pendingProps=c=m,sm(t,f))(t.flags&131072)!==0&&(Qt=!0);else return r.lanes=t.lanes,Ir(t,r,f)}return Xf(t,r,o,c,f)}function Rx(t,r,o,c){var f=c.children,m=t!==null?t.memoizedState:null;if(t===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(m=m!==null?m.baseLanes|o:o,t!==null){for(c=r.child=t.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~m}else c=0,r.child=null;return Dx(t,r,m,o,c)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},t!==null&&Du(r,m!==null?m.cachePool:null),m!==null?Mp(r,m):Sf(),kp(r);else return c=r.lanes=536870912,Dx(t,r,m!==null?m.baseLanes|o:o,o,c)}else m!==null?(Du(r,m.cachePool),Mp(r,m),ja(),r.memoizedState=null):(t!==null&&Du(r,null),Sf(),ja());return hn(t,r,f,o),r.child}function Gl(t,r){return t!==null&&t.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function Dx(t,r,o,c,f){var m=vf();return m=m===null?null:{parent:Gt._currentValue,pool:m},r.memoizedState={baseLanes:o,cachePool:m},t!==null&&Du(r,null),Sf(),kp(r),t!==null&&po(t,r,c,!0),r.childLanes=f,null}function Qu(t,r){return r=Ku({mode:r.mode,children:r.children},t.mode),r.ref=t.ref,t.child=r,r.return=t,r}function Ix(t,r,o){return Ai(r,t.child,null,o),t=Qu(r,r.pendingProps),t.flags|=2,ts(r),r.memoizedState=null,t}function Uw(t,r,o){var c=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,t===null){if(We){if(c.mode==="hidden")return t=Qu(r,c),r.lanes=536870912,Gl(null,t);if(Af(r),(t=_t)?(t=Hy(t,ys),t=t!==null&&t.data==="&"?t:null,t!==null&&(r.memoizedState={dehydrated:t,treeContext:xa!==null?{id:sr,overflow:rr}:null,retryLane:536870912,hydrationErrors:null},o=gp(t),o.return=r,r.child=o,un=r,_t=null)):t=null,t===null)throw ba(r);return r.lanes=536870912,null}return Qu(r,c)}var m=t.memoizedState;if(m!==null){var w=m.dehydrated;if(Af(r),f)if(r.flags&256)r.flags&=-257,r=Ix(t,r,o);else if(r.memoizedState!==null)r.child=t.child,r.flags|=128,r=null;else throw Error(a(558));else if(Qt||po(t,r,o,!1),f=(o&t.childLanes)!==0,Qt||f){if(c=yt,c!==null&&(w=hl(c,o),w!==0&&w!==m.retryLane))throw m.retryLane=w,vi(t,w),Fn(c,t,w),Kf;rd(),r=Ix(t,r,o)}else t=m.treeContext,_t=vs(w.nextSibling),un=r,We=!0,ya=null,ys=!1,t!==null&&yp(r,t),r=Qu(r,c),r.flags|=4096;return r}return t=Sr(t.child,{mode:c.mode,children:c.children}),t.ref=r.ref,r.child=t,t.return=r,t}function Yu(t,r){var o=r.ref;if(o===null)t!==null&&t.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(a(284));(t===null||t.ref!==o)&&(r.flags|=4194816)}}function Xf(t,r,o,c,f){return Ei(r),o=Rf(t,r,o,c,void 0,f),c=Df(),t!==null&&!Qt?(If(t,r,f),Ir(t,r,f)):(We&&c&&df(r),r.flags|=1,hn(t,r,o,f),r.child)}function Mx(t,r,o,c,f,m){return Ei(r),r.updateQueue=null,o=Op(r,c,o,f),Vp(t),c=Df(),t!==null&&!Qt?(If(t,r,m),Ir(t,r,m)):(We&&c&&df(r),r.flags|=1,hn(t,r,o,m),r.child)}function kx(t,r,o,c,f){if(Ei(r),r.stateNode===null){var m=ho,w=o.contextType;typeof w=="object"&&w!==null&&(m=dn(w)),m=new o(c,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Qf,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=c,m.state=r.memoizedState,m.refs={},_f(r),w=o.contextType,m.context=typeof w=="object"&&w!==null?dn(w):ho,m.state=r.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&($f(r,o,w,c),m.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(w=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),w!==m.state&&Qf.enqueueReplaceState(m,m.state,null),zl(r,c,m,f),Ul(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(t===null){m=r.stateNode;var T=r.memoizedProps,z=Ri(o,T);m.props=z;var J=m.context,ne=o.contextType;w=ho,typeof ne=="object"&&ne!==null&&(w=dn(ne));var oe=o.getDerivedStateFromProps;ne=typeof oe=="function"||typeof m.getSnapshotBeforeUpdate=="function",T=r.pendingProps!==T,ne||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(T||J!==w)&&vx(r,m,c,w),wa=!1;var W=r.memoizedState;m.state=W,zl(r,c,m,f),Ul(),J=r.memoizedState,T||W!==J||wa?(typeof oe=="function"&&($f(r,o,oe,c),J=r.memoizedState),(z=wa||bx(r,o,z,c,W,J,w))?(ne||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=J),m.props=c,m.state=J,m.context=w,c=z):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{m=r.stateNode,Nf(t,r),w=r.memoizedProps,ne=Ri(o,w),m.props=ne,oe=r.pendingProps,W=m.context,J=o.contextType,z=ho,typeof J=="object"&&J!==null&&(z=dn(J)),T=o.getDerivedStateFromProps,(J=typeof T=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(w!==oe||W!==z)&&vx(r,m,c,z),wa=!1,W=r.memoizedState,m.state=W,zl(r,c,m,f),Ul();var te=r.memoizedState;w!==oe||W!==te||wa||t!==null&&t.dependencies!==null&&Cu(t.dependencies)?(typeof T=="function"&&($f(r,o,T,c),te=r.memoizedState),(ne=wa||bx(r,o,ne,c,W,te,z)||t!==null&&t.dependencies!==null&&Cu(t.dependencies))?(J||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,te,z),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,te,z)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||w===t.memoizedProps&&W===t.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||w===t.memoizedProps&&W===t.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=te),m.props=c,m.state=te,m.context=z,c=ne):(typeof m.componentDidUpdate!="function"||w===t.memoizedProps&&W===t.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||w===t.memoizedProps&&W===t.memoizedState||(r.flags|=1024),c=!1)}return m=c,Yu(t,r),c=(r.flags&128)!==0,m||c?(m=r.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,t!==null&&c?(r.child=Ai(r,t.child,null,f),r.child=Ai(r,null,o,f)):hn(t,r,o,f),r.memoizedState=m.state,t=r.child):t=Ir(t,r,f),t}function Vx(t,r,o,c){return _i(),r.flags|=256,hn(t,r,o,c),r.child}var Zf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Jf(t){return{baseLanes:t,cachePool:Ep()}}function Wf(t,r,o){return t=t!==null?t.childLanes&~o:0,r&&(t|=ss),t}function Ox(t,r,o){var c=r.pendingProps,f=!1,m=(r.flags&128)!==0,w;if((w=m)||(w=t!==null&&t.memoizedState===null?!1:(Ut.current&2)!==0),w&&(f=!0,r.flags&=-129),w=(r.flags&32)!==0,r.flags&=-33,t===null){if(We){if(f?Ea(r):ja(),(t=_t)?(t=Hy(t,ys),t=t!==null&&t.data!=="&"?t:null,t!==null&&(r.memoizedState={dehydrated:t,treeContext:xa!==null?{id:sr,overflow:rr}:null,retryLane:536870912,hydrationErrors:null},o=gp(t),o.return=r,r.child=o,un=r,_t=null)):t=null,t===null)throw ba(r);return Vm(t)?r.lanes=32:r.lanes=536870912,null}var T=c.children;return c=c.fallback,f?(ja(),f=r.mode,T=Ku({mode:"hidden",children:T},f),c=wi(c,f,o,null),T.return=r,c.return=r,T.sibling=c,r.child=T,c=r.child,c.memoizedState=Jf(o),c.childLanes=Wf(t,w,o),r.memoizedState=Zf,Gl(null,c)):(Ea(r),em(r,T))}var z=t.memoizedState;if(z!==null&&(T=z.dehydrated,T!==null)){if(m)r.flags&256?(Ea(r),r.flags&=-257,r=tm(t,r,o)):r.memoizedState!==null?(ja(),r.child=t.child,r.flags|=128,r=null):(ja(),T=c.fallback,f=r.mode,c=Ku({mode:"visible",children:c.children},f),T=wi(T,f,o,null),T.flags|=2,c.return=r,T.return=r,c.sibling=T,r.child=c,Ai(r,t.child,null,o),c=r.child,c.memoizedState=Jf(o),c.childLanes=Wf(t,w,o),r.memoizedState=Zf,r=Gl(null,c));else if(Ea(r),Vm(T)){if(w=T.nextSibling&&T.nextSibling.dataset,w)var J=w.dgst;w=J,c=Error(a(419)),c.stack="",c.digest=w,Ml({value:c,source:null,stack:null}),r=tm(t,r,o)}else if(Qt||po(t,r,o,!1),w=(o&t.childLanes)!==0,Qt||w){if(w=yt,w!==null&&(c=hl(w,o),c!==0&&c!==z.retryLane))throw z.retryLane=c,vi(t,c),Fn(w,t,c),Kf;km(T)||rd(),r=tm(t,r,o)}else km(T)?(r.flags|=192,r.child=t.child,r=null):(t=z.treeContext,_t=vs(T.nextSibling),un=r,We=!0,ya=null,ys=!1,t!==null&&yp(r,t),r=em(r,c.children),r.flags|=4096);return r}return f?(ja(),T=c.fallback,f=r.mode,z=t.child,J=z.sibling,c=Sr(z,{mode:"hidden",children:c.children}),c.subtreeFlags=z.subtreeFlags&65011712,J!==null?T=Sr(J,T):(T=wi(T,f,o,null),T.flags|=2),T.return=r,c.return=r,c.sibling=T,r.child=c,Gl(null,c),c=r.child,T=t.child.memoizedState,T===null?T=Jf(o):(f=T.cachePool,f!==null?(z=Gt._currentValue,f=f.parent!==z?{parent:z,pool:z}:f):f=Ep(),T={baseLanes:T.baseLanes|o,cachePool:f}),c.memoizedState=T,c.childLanes=Wf(t,w,o),r.memoizedState=Zf,Gl(t.child,c)):(Ea(r),o=t.child,t=o.sibling,o=Sr(o,{mode:"visible",children:c.children}),o.return=r,o.sibling=null,t!==null&&(w=r.deletions,w===null?(r.deletions=[t],r.flags|=16):w.push(t)),r.child=o,r.memoizedState=null,o)}function em(t,r){return r=Ku({mode:"visible",children:r},t.mode),r.return=t,t.child=r}function Ku(t,r){return t=Wn(22,t,null,r),t.lanes=0,t}function tm(t,r,o){return Ai(r,t.child,null,o),t=em(r,r.pendingProps.children),t.flags|=2,r.memoizedState=null,t}function Px(t,r,o){t.lanes|=r;var c=t.alternate;c!==null&&(c.lanes|=r),pf(t.return,r,o)}function nm(t,r,o,c,f,m){var w=t.memoizedState;w===null?t.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:f,treeForkCount:m}:(w.isBackwards=r,w.rendering=null,w.renderingStartTime=0,w.last=c,w.tail=o,w.tailMode=f,w.treeForkCount=m)}function Lx(t,r,o){var c=r.pendingProps,f=c.revealOrder,m=c.tail;c=c.children;var w=Ut.current,T=(w&2)!==0;if(T?(w=w&1|2,r.flags|=128):w&=1,he(Ut,w),hn(t,r,c,o),c=We?Il:0,!T&&t!==null&&(t.flags&128)!==0)e:for(t=r.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Px(t,o,r);else if(t.tag===19)Px(t,o,r);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===r)break e;for(;t.sibling===null;){if(t.return===null||t.return===r)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(f){case"forwards":for(o=r.child,f=null;o!==null;)t=o.alternate,t!==null&&Pu(t)===null&&(f=o),o=o.sibling;o=f,o===null?(f=r.child,r.child=null):(f=o.sibling,o.sibling=null),nm(r,!1,f,o,m,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,f=r.child,r.child=null;f!==null;){if(t=f.alternate,t!==null&&Pu(t)===null){r.child=f;break}t=f.sibling,f.sibling=o,o=f,f=t}nm(r,!0,o,null,m,c);break;case"together":nm(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function Ir(t,r,o){if(t!==null&&(r.dependencies=t.dependencies),Aa|=r.lanes,(o&r.childLanes)===0)if(t!==null){if(po(t,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(t!==null&&r.child!==t.child)throw Error(a(153));if(r.child!==null){for(t=r.child,o=Sr(t,t.pendingProps),r.child=o,o.return=r;t.sibling!==null;)t=t.sibling,o=o.sibling=Sr(t,t.pendingProps),o.return=r;o.sibling=null}return r.child}function sm(t,r){return(t.lanes&r)!==0?!0:(t=t.dependencies,!!(t!==null&&Cu(t)))}function zw(t,r,o){switch(r.tag){case 3:wt(r,r.stateNode.containerInfo),va(r,Gt,t.memoizedState.cache),_i();break;case 27:case 5:on(r);break;case 4:wt(r,r.stateNode.containerInfo);break;case 10:va(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Af(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(Ea(r),r.flags|=128,null):(o&r.child.childLanes)!==0?Ox(t,r,o):(Ea(r),t=Ir(t,r,o),t!==null?t.sibling:null);Ea(r);break;case 19:var f=(t.flags&128)!==0;if(c=(o&r.childLanes)!==0,c||(po(t,r,o,!1),c=(o&r.childLanes)!==0),f){if(c)return Lx(t,r,o);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),he(Ut,Ut.current),c)break;return null;case 22:return r.lanes=0,Rx(t,r,o,r.pendingProps);case 24:va(r,Gt,t.memoizedState.cache)}return Ir(t,r,o)}function Ux(t,r,o){if(t!==null)if(t.memoizedProps!==r.pendingProps)Qt=!0;else{if(!sm(t,o)&&(r.flags&128)===0)return Qt=!1,zw(t,r,o);Qt=(t.flags&131072)!==0}else Qt=!1,We&&(r.flags&1048576)!==0&&xp(r,Il,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(t=Si(r.elementType),r.type=t,typeof t=="function")lf(t)?(c=Ri(t,c),r.tag=1,r=kx(null,r,t,c,o)):(r.tag=0,r=Xf(null,r,t,c,o));else{if(t!=null){var f=t.$$typeof;if(f===$){r.tag=11,r=Tx(null,r,t,c,o);break e}else if(f===R){r.tag=14,r=Ax(null,r,t,c,o);break e}}throw r=ue(t)||t,Error(a(306,r,""))}}return r;case 0:return Xf(t,r,r.type,r.pendingProps,o);case 1:return c=r.type,f=Ri(c,r.pendingProps),kx(t,r,c,f,o);case 3:e:{if(wt(r,r.stateNode.containerInfo),t===null)throw Error(a(387));c=r.pendingProps;var m=r.memoizedState;f=m.element,Nf(t,r),zl(r,c,null,o);var w=r.memoizedState;if(c=w.cache,va(r,Gt,c),c!==m.cache&&xf(r,[Gt],o,!0),Ul(),c=w.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:w.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=Vx(t,r,c,o);break e}else if(c!==f){f=gs(Error(a(424)),r),Ml(f),r=Vx(t,r,c,o);break e}else{switch(t=r.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(_t=vs(t.firstChild),un=r,We=!0,ya=null,ys=!0,o=Rp(r,null,c,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(_i(),c===f){r=Ir(t,r,o);break e}hn(t,r,c,o)}r=r.child}return r;case 26:return Yu(t,r),t===null?(o=Xy(r.type,null,r.pendingProps,null))?r.memoizedState=o:We||(o=r.type,t=r.pendingProps,c=dd(Ie.current).createElement(o),c[Ft]=r,c[tn]=t,fn(c,o,t),qt(c),r.stateNode=c):r.memoizedState=Xy(r.type,t.memoizedProps,r.pendingProps,t.memoizedState),null;case 27:return on(r),t===null&&We&&(c=r.stateNode=Qy(r.type,r.pendingProps,Ie.current),un=r,ys=!0,f=_t,Ma(r.type)?(Om=f,_t=vs(c.firstChild)):_t=f),hn(t,r,r.pendingProps.children,o),Yu(t,r),t===null&&(r.flags|=4194304),r.child;case 5:return t===null&&We&&((f=c=_t)&&(c=p_(c,r.type,r.pendingProps,ys),c!==null?(r.stateNode=c,un=r,_t=vs(c.firstChild),ys=!1,f=!0):f=!1),f||ba(r)),on(r),f=r.type,m=r.pendingProps,w=t!==null?t.memoizedProps:null,c=m.children,Dm(f,m)?c=null:w!==null&&Dm(f,w)&&(r.flags|=32),r.memoizedState!==null&&(f=Rf(t,r,Dw,null,null,o),ic._currentValue=f),Yu(t,r),hn(t,r,c,o),r.child;case 6:return t===null&&We&&((t=o=_t)&&(o=x_(o,r.pendingProps,ys),o!==null?(r.stateNode=o,un=r,_t=null,t=!0):t=!1),t||ba(r)),null;case 13:return Ox(t,r,o);case 4:return wt(r,r.stateNode.containerInfo),c=r.pendingProps,t===null?r.child=Ai(r,null,c,o):hn(t,r,c,o),r.child;case 11:return Tx(t,r,r.type,r.pendingProps,o);case 7:return hn(t,r,r.pendingProps,o),r.child;case 8:return hn(t,r,r.pendingProps.children,o),r.child;case 12:return hn(t,r,r.pendingProps.children,o),r.child;case 10:return c=r.pendingProps,va(r,r.type,c.value),hn(t,r,c.children,o),r.child;case 9:return f=r.type._context,c=r.pendingProps.children,Ei(r),f=dn(f),c=c(f),r.flags|=1,hn(t,r,c,o),r.child;case 14:return Ax(t,r,r.type,r.pendingProps,o);case 15:return Cx(t,r,r.type,r.pendingProps,o);case 19:return Lx(t,r,o);case 31:return Uw(t,r,o);case 22:return Rx(t,r,o,r.pendingProps);case 24:return Ei(r),c=dn(Gt),t===null?(f=vf(),f===null&&(f=yt,m=yf(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=o),f=m),r.memoizedState={parent:c,cache:f},_f(r),va(r,Gt,f)):((t.lanes&o)!==0&&(Nf(t,r),zl(r,null,null,o),Ul()),f=t.memoizedState,m=r.memoizedState,f.parent!==c?(f={parent:c,cache:c},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),va(r,Gt,c)):(c=m.cache,va(r,Gt,c),c!==f.cache&&xf(r,[Gt],o,!0))),hn(t,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(a(156,r.tag))}function Mr(t){t.flags|=4}function rm(t,r,o,c,f){if((r=(t.mode&32)!==0)&&(r=!1),r){if(t.flags|=16777216,(f&335544128)===f)if(t.stateNode.complete)t.flags|=8192;else if(hy())t.flags|=8192;else throw Ti=Mu,wf}else t.flags&=-16777217}function zx(t,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!t2(r))if(hy())t.flags|=8192;else throw Ti=Mu,wf}function Xu(t,r){r!==null&&(t.flags|=4),t.flags&16384&&(r=t.tag!==22?nu():536870912,t.lanes|=r,Ao|=r)}function $l(t,r){if(!We)switch(t.tailMode){case"hidden":r=t.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?t.tail=null:o.sibling=null;break;case"collapsed":o=t.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r||t.tail===null?t.tail=null:t.tail.sibling=null:c.sibling=null}}function Nt(t){var r=t.alternate!==null&&t.alternate.child===t.child,o=0,c=0;if(r)for(var f=t.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=t,f=f.sibling;else for(f=t.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=t,f=f.sibling;return t.subtreeFlags|=c,t.childLanes=o,r}function Bw(t,r,o){var c=r.pendingProps;switch(hf(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nt(r),null;case 1:return Nt(r),null;case 3:return o=r.stateNode,c=null,t!==null&&(c=t.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),Cr(Gt),at(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(t===null||t.child===null)&&(go(r)?Mr(r):t===null||t.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,mf())),Nt(r),null;case 26:var f=r.type,m=r.memoizedState;return t===null?(Mr(r),m!==null?(Nt(r),zx(r,m)):(Nt(r),rm(r,f,null,c,o))):m?m!==t.memoizedState?(Mr(r),Nt(r),zx(r,m)):(Nt(r),r.flags&=-16777217):(t=t.memoizedProps,t!==c&&Mr(r),Nt(r),rm(r,f,t,c,o)),null;case 27:if(Yn(r),o=Ie.current,f=r.type,t!==null&&r.stateNode!=null)t.memoizedProps!==c&&Mr(r);else{if(!c){if(r.stateNode===null)throw Error(a(166));return Nt(r),null}t=me.current,go(r)?bp(r):(t=Qy(f,c,o),r.stateNode=t,Mr(r))}return Nt(r),null;case 5:if(Yn(r),f=r.type,t!==null&&r.stateNode!=null)t.memoizedProps!==c&&Mr(r);else{if(!c){if(r.stateNode===null)throw Error(a(166));return Nt(r),null}if(m=me.current,go(r))bp(r);else{var w=dd(Ie.current);switch(m){case 1:m=w.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=w.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=w.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=w.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=w.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof c.is=="string"?w.createElement("select",{is:c.is}):w.createElement("select"),c.multiple?m.multiple=!0:c.size&&(m.size=c.size);break;default:m=typeof c.is=="string"?w.createElement(f,{is:c.is}):w.createElement(f)}}m[Ft]=r,m[tn]=c;e:for(w=r.child;w!==null;){if(w.tag===5||w.tag===6)m.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===r)break e;for(;w.sibling===null;){if(w.return===null||w.return===r)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}r.stateNode=m;e:switch(fn(m,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Mr(r)}}return Nt(r),rm(r,r.type,t===null?null:t.memoizedProps,r.pendingProps,o),null;case 6:if(t&&r.stateNode!=null)t.memoizedProps!==c&&Mr(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(a(166));if(t=Ie.current,go(r)){if(t=r.stateNode,o=r.memoizedProps,c=null,f=un,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}t[Ft]=r,t=!!(t.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||Oy(t.nodeValue,o)),t||ba(r,!0)}else t=dd(t).createTextNode(c),t[Ft]=r,r.stateNode=t}return Nt(r),null;case 31:if(o=r.memoizedState,t===null||t.memoizedState!==null){if(c=go(r),o!==null){if(t===null){if(!c)throw Error(a(318));if(t=r.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(a(557));t[Ft]=r}else _i(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Nt(r),t=!1}else o=mf(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=o),t=!0;if(!t)return r.flags&256?(ts(r),r):(ts(r),null);if((r.flags&128)!==0)throw Error(a(558))}return Nt(r),null;case 13:if(c=r.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(f=go(r),c!==null&&c.dehydrated!==null){if(t===null){if(!f)throw Error(a(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(a(317));f[Ft]=r}else _i(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Nt(r),f=!1}else f=mf(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(ts(r),r):(ts(r),null)}return ts(r),(r.flags&128)!==0?(r.lanes=o,r):(o=c!==null,t=t!==null&&t.memoizedState!==null,o&&(c=r.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048)),o!==t&&o&&(r.child.flags|=8192),Xu(r,r.updateQueue),Nt(r),null);case 4:return at(),t===null&&Sm(r.stateNode.containerInfo),Nt(r),null;case 10:return Cr(r.type),Nt(r),null;case 19:if(ae(Ut),c=r.memoizedState,c===null)return Nt(r),null;if(f=(r.flags&128)!==0,m=c.rendering,m===null)if(f)$l(c,!1);else{if(Vt!==0||t!==null&&(t.flags&128)!==0)for(t=r.child;t!==null;){if(m=Pu(t),m!==null){for(r.flags|=128,$l(c,!1),t=m.updateQueue,r.updateQueue=t,Xu(r,t),r.subtreeFlags=0,t=o,o=r.child;o!==null;)mp(o,t),o=o.sibling;return he(Ut,Ut.current&1|2),We&&Tr(r,c.treeForkCount),r.child}t=t.sibling}c.tail!==null&&Pt()>td&&(r.flags|=128,f=!0,$l(c,!1),r.lanes=4194304)}else{if(!f)if(t=Pu(m),t!==null){if(r.flags|=128,f=!0,t=t.updateQueue,r.updateQueue=t,Xu(r,t),$l(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!We)return Nt(r),null}else 2*Pt()-c.renderingStartTime>td&&o!==536870912&&(r.flags|=128,f=!0,$l(c,!1),r.lanes=4194304);c.isBackwards?(m.sibling=r.child,r.child=m):(t=c.last,t!==null?t.sibling=m:r.child=m,c.last=m)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=Pt(),t.sibling=null,o=Ut.current,he(Ut,f?o&1|2:o&1),We&&Tr(r,c.treeForkCount),t):(Nt(r),null);case 22:case 23:return ts(r),Tf(),c=r.memoizedState!==null,t!==null?t.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(o&536870912)!==0&&(r.flags&128)===0&&(Nt(r),r.subtreeFlags&6&&(r.flags|=8192)):Nt(r),o=r.updateQueue,o!==null&&Xu(r,o.retryQueue),o=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==o&&(r.flags|=2048),t!==null&&ae(ji),null;case 24:return o=null,t!==null&&(o=t.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),Cr(Gt),Nt(r),null;case 25:return null;case 30:return null}throw Error(a(156,r.tag))}function Fw(t,r){switch(hf(r),r.tag){case 1:return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 3:return Cr(Gt),at(),t=r.flags,(t&65536)!==0&&(t&128)===0?(r.flags=t&-65537|128,r):null;case 26:case 27:case 5:return Yn(r),null;case 31:if(r.memoizedState!==null){if(ts(r),r.alternate===null)throw Error(a(340));_i()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 13:if(ts(r),t=r.memoizedState,t!==null&&t.dehydrated!==null){if(r.alternate===null)throw Error(a(340));_i()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 19:return ae(Ut),null;case 4:return at(),null;case 10:return Cr(r.type),null;case 22:case 23:return ts(r),Tf(),t!==null&&ae(ji),t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 24:return Cr(Gt),null;case 25:return null;default:return null}}function Bx(t,r){switch(hf(r),r.tag){case 3:Cr(Gt),at();break;case 26:case 27:case 5:Yn(r);break;case 4:at();break;case 31:r.memoizedState!==null&&ts(r);break;case 13:ts(r);break;case 19:ae(Ut);break;case 10:Cr(r.type);break;case 22:case 23:ts(r),Tf(),t!==null&&ae(ji);break;case 24:Cr(Gt)}}function Ql(t,r){try{var o=r.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var f=c.next;o=f;do{if((o.tag&t)===t){c=void 0;var m=o.create,w=o.inst;c=m(),w.destroy=c}o=o.next}while(o!==f)}}catch(T){ft(r,r.return,T)}}function Sa(t,r,o){try{var c=r.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&t)===t){var w=c.inst,T=w.destroy;if(T!==void 0){w.destroy=void 0,f=r;var z=o,J=T;try{J()}catch(ne){ft(f,z,ne)}}}c=c.next}while(c!==m)}}catch(ne){ft(r,r.return,ne)}}function Fx(t){var r=t.updateQueue;if(r!==null){var o=t.stateNode;try{Ip(r,o)}catch(c){ft(t,t.return,c)}}}function qx(t,r,o){o.props=Ri(t.type,t.memoizedProps),o.state=t.memoizedState;try{o.componentWillUnmount()}catch(c){ft(t,r,c)}}function Yl(t,r){try{var o=t.ref;if(o!==null){switch(t.tag){case 26:case 27:case 5:var c=t.stateNode;break;case 30:c=t.stateNode;break;default:c=t.stateNode}typeof o=="function"?t.refCleanup=o(c):o.current=c}}catch(f){ft(t,r,f)}}function ar(t,r){var o=t.ref,c=t.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(f){ft(t,r,f)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){ft(t,r,f)}else o.current=null}function Hx(t){var r=t.type,o=t.memoizedProps,c=t.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(f){ft(t,t.return,f)}}function am(t,r,o){try{var c=t.stateNode;u_(c,t.type,o,r),c[tn]=r}catch(f){ft(t,t.return,f)}}function Gx(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Ma(t.type)||t.tag===4}function im(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Gx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Ma(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function om(t,r,o){var c=t.tag;if(c===5||c===6)t=t.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(t,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(t),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=Cs));else if(c!==4&&(c===27&&Ma(t.type)&&(o=t.stateNode,r=null),t=t.child,t!==null))for(om(t,r,o),t=t.sibling;t!==null;)om(t,r,o),t=t.sibling}function Zu(t,r,o){var c=t.tag;if(c===5||c===6)t=t.stateNode,r?o.insertBefore(t,r):o.appendChild(t);else if(c!==4&&(c===27&&Ma(t.type)&&(o=t.stateNode),t=t.child,t!==null))for(Zu(t,r,o),t=t.sibling;t!==null;)Zu(t,r,o),t=t.sibling}function $x(t){var r=t.stateNode,o=t.memoizedProps;try{for(var c=t.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);fn(r,c,o),r[Ft]=t,r[tn]=o}catch(m){ft(t,t.return,m)}}var kr=!1,Yt=!1,lm=!1,Qx=typeof WeakSet=="function"?WeakSet:Set,sn=null;function qw(t,r){if(t=t.containerInfo,Cm=yd,t=ap(t),ef(t)){if("selectionStart"in t)var o={start:t.selectionStart,end:t.selectionEnd};else e:{o=(o=t.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var f=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{o.nodeType,m.nodeType}catch{o=null;break e}var w=0,T=-1,z=-1,J=0,ne=0,oe=t,W=null;t:for(;;){for(var te;oe!==o||f!==0&&oe.nodeType!==3||(T=w+f),oe!==m||c!==0&&oe.nodeType!==3||(z=w+c),oe.nodeType===3&&(w+=oe.nodeValue.length),(te=oe.firstChild)!==null;)W=oe,oe=te;for(;;){if(oe===t)break t;if(W===o&&++J===f&&(T=w),W===m&&++ne===c&&(z=w),(te=oe.nextSibling)!==null)break;oe=W,W=oe.parentNode}oe=te}o=T===-1||z===-1?null:{start:T,end:z}}else o=null}o=o||{start:0,end:0}}else o=null;for(Rm={focusedElem:t,selectionRange:o},yd=!1,sn=r;sn!==null;)if(r=sn,t=r.child,(r.subtreeFlags&1028)!==0&&t!==null)t.return=r,sn=t;else for(;sn!==null;){switch(r=sn,m=r.alternate,t=r.flags,r.tag){case 0:if((t&4)!==0&&(t=r.updateQueue,t=t!==null?t.events:null,t!==null))for(o=0;o<t.length;o++)f=t[o],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&m!==null){t=void 0,o=r,f=m.memoizedProps,m=m.memoizedState,c=o.stateNode;try{var be=Ri(o.type,f);t=c.getSnapshotBeforeUpdate(be,m),c.__reactInternalSnapshotBeforeUpdate=t}catch(Ce){ft(o,o.return,Ce)}}break;case 3:if((t&1024)!==0){if(t=r.stateNode.containerInfo,o=t.nodeType,o===9)Mm(t);else if(o===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":Mm(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(a(163))}if(t=r.sibling,t!==null){t.return=r.return,sn=t;break}sn=r.return}}function Yx(t,r,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:Or(t,o),c&4&&Ql(5,o);break;case 1:if(Or(t,o),c&4)if(t=o.stateNode,r===null)try{t.componentDidMount()}catch(w){ft(o,o.return,w)}else{var f=Ri(o.type,r.memoizedProps);r=r.memoizedState;try{t.componentDidUpdate(f,r,t.__reactInternalSnapshotBeforeUpdate)}catch(w){ft(o,o.return,w)}}c&64&&Fx(o),c&512&&Yl(o,o.return);break;case 3:if(Or(t,o),c&64&&(t=o.updateQueue,t!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{Ip(t,r)}catch(w){ft(o,o.return,w)}}break;case 27:r===null&&c&4&&$x(o);case 26:case 5:Or(t,o),r===null&&c&4&&Hx(o),c&512&&Yl(o,o.return);break;case 12:Or(t,o);break;case 31:Or(t,o),c&4&&Zx(t,o);break;case 13:Or(t,o),c&4&&Jx(t,o),c&64&&(t=o.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(o=Jw.bind(null,o),y_(t,o))));break;case 22:if(c=o.memoizedState!==null||kr,!c){r=r!==null&&r.memoizedState!==null||Yt,f=kr;var m=Yt;kr=c,(Yt=r)&&!m?Pr(t,o,(o.subtreeFlags&8772)!==0):Or(t,o),kr=f,Yt=m}break;case 30:break;default:Or(t,o)}}function Kx(t){var r=t.alternate;r!==null&&(t.alternate=null,Kx(r)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(r=t.stateNode,r!==null&&Zi(r)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var St=null,Ln=!1;function Vr(t,r,o){for(o=o.child;o!==null;)Xx(t,r,o),o=o.sibling}function Xx(t,r,o){if(Jt&&typeof Jt.onCommitFiberUnmount=="function")try{Jt.onCommitFiberUnmount(Mn,o)}catch{}switch(o.tag){case 26:Yt||ar(o,r),Vr(t,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Yt||ar(o,r);var c=St,f=Ln;Ma(o.type)&&(St=o.stateNode,Ln=!1),Vr(t,r,o),sc(o.stateNode),St=c,Ln=f;break;case 5:Yt||ar(o,r);case 6:if(c=St,f=Ln,St=null,Vr(t,r,o),St=c,Ln=f,St!==null)if(Ln)try{(St.nodeType===9?St.body:St.nodeName==="HTML"?St.ownerDocument.body:St).removeChild(o.stateNode)}catch(m){ft(o,r,m)}else try{St.removeChild(o.stateNode)}catch(m){ft(o,r,m)}break;case 18:St!==null&&(Ln?(t=St,Fy(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,o.stateNode),Oo(t)):Fy(St,o.stateNode));break;case 4:c=St,f=Ln,St=o.stateNode.containerInfo,Ln=!0,Vr(t,r,o),St=c,Ln=f;break;case 0:case 11:case 14:case 15:Sa(2,o,r),Yt||Sa(4,o,r),Vr(t,r,o);break;case 1:Yt||(ar(o,r),c=o.stateNode,typeof c.componentWillUnmount=="function"&&qx(o,r,c)),Vr(t,r,o);break;case 21:Vr(t,r,o);break;case 22:Yt=(c=Yt)||o.memoizedState!==null,Vr(t,r,o),Yt=c;break;default:Vr(t,r,o)}}function Zx(t,r){if(r.memoizedState===null&&(t=r.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{Oo(t)}catch(o){ft(r,r.return,o)}}}function Jx(t,r){if(r.memoizedState===null&&(t=r.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{Oo(t)}catch(o){ft(r,r.return,o)}}function Hw(t){switch(t.tag){case 31:case 13:case 19:var r=t.stateNode;return r===null&&(r=t.stateNode=new Qx),r;case 22:return t=t.stateNode,r=t._retryCache,r===null&&(r=t._retryCache=new Qx),r;default:throw Error(a(435,t.tag))}}function Ju(t,r){var o=Hw(t);r.forEach(function(c){if(!o.has(c)){o.add(c);var f=Ww.bind(null,t,c);c.then(f,f)}})}function Un(t,r){var o=r.deletions;if(o!==null)for(var c=0;c<o.length;c++){var f=o[c],m=t,w=r,T=w;e:for(;T!==null;){switch(T.tag){case 27:if(Ma(T.type)){St=T.stateNode,Ln=!1;break e}break;case 5:St=T.stateNode,Ln=!1;break e;case 3:case 4:St=T.stateNode.containerInfo,Ln=!0;break e}T=T.return}if(St===null)throw Error(a(160));Xx(m,w,f),St=null,Ln=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)Wx(r,t),r=r.sibling}var Vs=null;function Wx(t,r){var o=t.alternate,c=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:Un(r,t),zn(t),c&4&&(Sa(3,t,t.return),Ql(3,t),Sa(5,t,t.return));break;case 1:Un(r,t),zn(t),c&512&&(Yt||o===null||ar(o,o.return)),c&64&&kr&&(t=t.updateQueue,t!==null&&(c=t.callbacks,c!==null&&(o=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var f=Vs;if(Un(r,t),zn(t),c&512&&(Yt||o===null||ar(o,o.return)),c&4){var m=o!==null?o.memoizedState:null;if(c=t.memoizedState,o===null)if(c===null)if(t.stateNode===null){e:{c=t.type,o=t.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":m=f.getElementsByTagName("title")[0],(!m||m[Gs]||m[Ft]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(c),f.head.insertBefore(m,f.querySelector("head > title"))),fn(m,c,o),m[Ft]=t,qt(m),c=m;break e;case"link":var w=Wy("link","href",f).get(c+(o.href||""));if(w){for(var T=0;T<w.length;T++)if(m=w[T],m.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&m.getAttribute("rel")===(o.rel==null?null:o.rel)&&m.getAttribute("title")===(o.title==null?null:o.title)&&m.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){w.splice(T,1);break t}}m=f.createElement(c),fn(m,c,o),f.head.appendChild(m);break;case"meta":if(w=Wy("meta","content",f).get(c+(o.content||""))){for(T=0;T<w.length;T++)if(m=w[T],m.getAttribute("content")===(o.content==null?null:""+o.content)&&m.getAttribute("name")===(o.name==null?null:o.name)&&m.getAttribute("property")===(o.property==null?null:o.property)&&m.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&m.getAttribute("charset")===(o.charSet==null?null:o.charSet)){w.splice(T,1);break t}}m=f.createElement(c),fn(m,c,o),f.head.appendChild(m);break;default:throw Error(a(468,c))}m[Ft]=t,qt(m),c=m}t.stateNode=c}else e2(f,t.type,t.stateNode);else t.stateNode=Jy(f,c,t.memoizedProps);else m!==c?(m===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):m.count--,c===null?e2(f,t.type,t.stateNode):Jy(f,c,t.memoizedProps)):c===null&&t.stateNode!==null&&am(t,t.memoizedProps,o.memoizedProps)}break;case 27:Un(r,t),zn(t),c&512&&(Yt||o===null||ar(o,o.return)),o!==null&&c&4&&am(t,t.memoizedProps,o.memoizedProps);break;case 5:if(Un(r,t),zn(t),c&512&&(Yt||o===null||ar(o,o.return)),t.flags&32){f=t.stateNode;try{Pn(f,"")}catch(be){ft(t,t.return,be)}}c&4&&t.stateNode!=null&&(f=t.memoizedProps,am(t,f,o!==null?o.memoizedProps:f)),c&1024&&(lm=!0);break;case 6:if(Un(r,t),zn(t),c&4){if(t.stateNode===null)throw Error(a(162));c=t.memoizedProps,o=t.stateNode;try{o.nodeValue=c}catch(be){ft(t,t.return,be)}}break;case 3:if(md=null,f=Vs,Vs=hd(r.containerInfo),Un(r,t),Vs=f,zn(t),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Oo(r.containerInfo)}catch(be){ft(t,t.return,be)}lm&&(lm=!1,ey(t));break;case 4:c=Vs,Vs=hd(t.stateNode.containerInfo),Un(r,t),zn(t),Vs=c;break;case 12:Un(r,t),zn(t);break;case 31:Un(r,t),zn(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,Ju(t,c)));break;case 13:Un(r,t),zn(t),t.child.flags&8192&&t.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(ed=Pt()),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,Ju(t,c)));break;case 22:f=t.memoizedState!==null;var z=o!==null&&o.memoizedState!==null,J=kr,ne=Yt;if(kr=J||f,Yt=ne||z,Un(r,t),Yt=ne,kr=J,zn(t),c&8192)e:for(r=t.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(o===null||z||kr||Yt||Di(t)),o=null,r=t;;){if(r.tag===5||r.tag===26){if(o===null){z=o=r;try{if(m=z.stateNode,f)w=m.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{T=z.stateNode;var oe=z.memoizedProps.style,W=oe!=null&&oe.hasOwnProperty("display")?oe.display:null;T.style.display=W==null||typeof W=="boolean"?"":(""+W).trim()}}catch(be){ft(z,z.return,be)}}}else if(r.tag===6){if(o===null){z=r;try{z.stateNode.nodeValue=f?"":z.memoizedProps}catch(be){ft(z,z.return,be)}}}else if(r.tag===18){if(o===null){z=r;try{var te=z.stateNode;f?qy(te,!0):qy(z.stateNode,!1)}catch(be){ft(z,z.return,be)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===t)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;r.sibling===null;){if(r.return===null||r.return===t)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=t.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Ju(t,o))));break;case 19:Un(r,t),zn(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,Ju(t,c)));break;case 30:break;case 21:break;default:Un(r,t),zn(t)}}function zn(t){var r=t.flags;if(r&2){try{for(var o,c=t.return;c!==null;){if(Gx(c)){o=c;break}c=c.return}if(o==null)throw Error(a(160));switch(o.tag){case 27:var f=o.stateNode,m=im(t);Zu(t,m,f);break;case 5:var w=o.stateNode;o.flags&32&&(Pn(w,""),o.flags&=-33);var T=im(t);Zu(t,T,w);break;case 3:case 4:var z=o.stateNode.containerInfo,J=im(t);om(t,J,z);break;default:throw Error(a(161))}}catch(ne){ft(t,t.return,ne)}t.flags&=-3}r&4096&&(t.flags&=-4097)}function ey(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var r=t;ey(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),t=t.sibling}}function Or(t,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)Yx(t,r.alternate,r),r=r.sibling}function Di(t){for(t=t.child;t!==null;){var r=t;switch(r.tag){case 0:case 11:case 14:case 15:Sa(4,r,r.return),Di(r);break;case 1:ar(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&qx(r,r.return,o),Di(r);break;case 27:sc(r.stateNode);case 26:case 5:ar(r,r.return),Di(r);break;case 22:r.memoizedState===null&&Di(r);break;case 30:Di(r);break;default:Di(r)}t=t.sibling}}function Pr(t,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,f=t,m=r,w=m.flags;switch(m.tag){case 0:case 11:case 15:Pr(f,m,o),Ql(4,m);break;case 1:if(Pr(f,m,o),c=m,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(J){ft(c,c.return,J)}if(c=m,f=c.updateQueue,f!==null){var T=c.stateNode;try{var z=f.shared.hiddenCallbacks;if(z!==null)for(f.shared.hiddenCallbacks=null,f=0;f<z.length;f++)Dp(z[f],T)}catch(J){ft(c,c.return,J)}}o&&w&64&&Fx(m),Yl(m,m.return);break;case 27:$x(m);case 26:case 5:Pr(f,m,o),o&&c===null&&w&4&&Hx(m),Yl(m,m.return);break;case 12:Pr(f,m,o);break;case 31:Pr(f,m,o),o&&w&4&&Zx(f,m);break;case 13:Pr(f,m,o),o&&w&4&&Jx(f,m);break;case 22:m.memoizedState===null&&Pr(f,m,o),Yl(m,m.return);break;case 30:break;default:Pr(f,m,o)}r=r.sibling}}function cm(t,r){var o=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),t=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(t=r.memoizedState.cachePool.pool),t!==o&&(t!=null&&t.refCount++,o!=null&&kl(o))}function um(t,r){t=null,r.alternate!==null&&(t=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==t&&(r.refCount++,t!=null&&kl(t))}function Os(t,r,o,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)ty(t,r,o,c),r=r.sibling}function ty(t,r,o,c){var f=r.flags;switch(r.tag){case 0:case 11:case 15:Os(t,r,o,c),f&2048&&Ql(9,r);break;case 1:Os(t,r,o,c);break;case 3:Os(t,r,o,c),f&2048&&(t=null,r.alternate!==null&&(t=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==t&&(r.refCount++,t!=null&&kl(t)));break;case 12:if(f&2048){Os(t,r,o,c),t=r.stateNode;try{var m=r.memoizedProps,w=m.id,T=m.onPostCommit;typeof T=="function"&&T(w,r.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(z){ft(r,r.return,z)}}else Os(t,r,o,c);break;case 31:Os(t,r,o,c);break;case 13:Os(t,r,o,c);break;case 23:break;case 22:m=r.stateNode,w=r.alternate,r.memoizedState!==null?m._visibility&2?Os(t,r,o,c):Kl(t,r):m._visibility&2?Os(t,r,o,c):(m._visibility|=2,jo(t,r,o,c,(r.subtreeFlags&10256)!==0||!1)),f&2048&&cm(w,r);break;case 24:Os(t,r,o,c),f&2048&&um(r.alternate,r);break;default:Os(t,r,o,c)}}function jo(t,r,o,c,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var m=t,w=r,T=o,z=c,J=w.flags;switch(w.tag){case 0:case 11:case 15:jo(m,w,T,z,f),Ql(8,w);break;case 23:break;case 22:var ne=w.stateNode;w.memoizedState!==null?ne._visibility&2?jo(m,w,T,z,f):Kl(m,w):(ne._visibility|=2,jo(m,w,T,z,f)),f&&J&2048&&cm(w.alternate,w);break;case 24:jo(m,w,T,z,f),f&&J&2048&&um(w.alternate,w);break;default:jo(m,w,T,z,f)}r=r.sibling}}function Kl(t,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=t,c=r,f=c.flags;switch(c.tag){case 22:Kl(o,c),f&2048&&cm(c.alternate,c);break;case 24:Kl(o,c),f&2048&&um(c.alternate,c);break;default:Kl(o,c)}r=r.sibling}}var Xl=8192;function So(t,r,o){if(t.subtreeFlags&Xl)for(t=t.child;t!==null;)ny(t,r,o),t=t.sibling}function ny(t,r,o){switch(t.tag){case 26:So(t,r,o),t.flags&Xl&&t.memoizedState!==null&&R_(o,Vs,t.memoizedState,t.memoizedProps);break;case 5:So(t,r,o);break;case 3:case 4:var c=Vs;Vs=hd(t.stateNode.containerInfo),So(t,r,o),Vs=c;break;case 22:t.memoizedState===null&&(c=t.alternate,c!==null&&c.memoizedState!==null?(c=Xl,Xl=16777216,So(t,r,o),Xl=c):So(t,r,o));break;default:So(t,r,o)}}function sy(t){var r=t.alternate;if(r!==null&&(t=r.child,t!==null)){r.child=null;do r=t.sibling,t.sibling=null,t=r;while(t!==null)}}function Zl(t){var r=t.deletions;if((t.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];sn=c,ay(c,t)}sy(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)ry(t),t=t.sibling}function ry(t){switch(t.tag){case 0:case 11:case 15:Zl(t),t.flags&2048&&Sa(9,t,t.return);break;case 3:Zl(t);break;case 12:Zl(t);break;case 22:var r=t.stateNode;t.memoizedState!==null&&r._visibility&2&&(t.return===null||t.return.tag!==13)?(r._visibility&=-3,Wu(t)):Zl(t);break;default:Zl(t)}}function Wu(t){var r=t.deletions;if((t.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];sn=c,ay(c,t)}sy(t)}for(t=t.child;t!==null;){switch(r=t,r.tag){case 0:case 11:case 15:Sa(8,r,r.return),Wu(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,Wu(r));break;default:Wu(r)}t=t.sibling}}function ay(t,r){for(;sn!==null;){var o=sn;switch(o.tag){case 0:case 11:case 15:Sa(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:kl(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,sn=c;else e:for(o=t;sn!==null;){c=sn;var f=c.sibling,m=c.return;if(Kx(c),c===o){sn=null;break e}if(f!==null){f.return=m,sn=f;break e}sn=m}}}var Gw={getCacheForType:function(t){var r=dn(Gt),o=r.data.get(t);return o===void 0&&(o=t(),r.data.set(t,o)),o},cacheSignal:function(){return dn(Gt).controller.signal}},$w=typeof WeakMap=="function"?WeakMap:Map,lt=0,yt=null,Ge=null,Ye=0,ht=0,ns=null,Ta=!1,To=!1,dm=!1,Lr=0,Vt=0,Aa=0,Ii=0,hm=0,ss=0,Ao=0,Jl=null,Bn=null,fm=!1,ed=0,iy=0,td=1/0,nd=null,Ca=null,Wt=0,Ra=null,Co=null,Ur=0,mm=0,gm=null,oy=null,Wl=0,pm=null;function rs(){return(lt&2)!==0&&Ye!==0?Ye&-Ye:K.T!==null?_m():su()}function ly(){if(ss===0)if((Ye&536870912)===0||We){var t=wr;wr<<=1,(wr&3932160)===0&&(wr=262144),ss=t}else ss=536870912;return t=es.current,t!==null&&(t.flags|=32),ss}function Fn(t,r,o){(t===yt&&(ht===2||ht===9)||t.cancelPendingCommit!==null)&&(Ro(t,0),Da(t,Ye,ss,!1)),ii(t,o),((lt&2)===0||t!==yt)&&(t===yt&&((lt&2)===0&&(Ii|=o),Vt===4&&Da(t,Ye,ss,!1)),ir(t))}function cy(t,r,o){if((lt&6)!==0)throw Error(a(327));var c=!o&&(r&127)===0&&(r&t.expiredLanes)===0||Ss(t,r),f=c?Kw(t,r):ym(t,r,!0),m=c;do{if(f===0){To&&!c&&Da(t,r,0,!1);break}else{if(o=t.current.alternate,m&&!Qw(o)){f=ym(t,r,!1),m=!1;continue}if(f===2){if(m=r,t.errorRecoveryDisabledLanes&m)var w=0;else w=t.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){r=w;e:{var T=t;f=Jl;var z=T.current.memoizedState.isDehydrated;if(z&&(Ro(T,w).flags|=256),w=ym(T,w,!1),w!==2){if(dm&&!z){T.errorRecoveryDisabledLanes|=m,Ii|=m,f=4;break e}m=Bn,Bn=f,m!==null&&(Bn===null?Bn=m:Bn.push.apply(Bn,m))}f=w}if(m=!1,f!==2)continue}}if(f===1){Ro(t,0),Da(t,r,0,!0);break}e:{switch(c=t,m=f,m){case 0:case 1:throw Error(a(345));case 4:if((r&4194048)!==r)break;case 6:Da(c,r,ss,!Ta);break e;case 2:Bn=null;break;case 3:case 5:break;default:throw Error(a(329))}if((r&62914560)===r&&(f=ed+300-Pt(),10<f)){if(Da(c,r,ss,!Ta),Fs(c,0,!0)!==0)break e;Ur=r,c.timeoutHandle=zy(uy.bind(null,c,o,Bn,nd,fm,r,ss,Ii,Ao,Ta,m,"Throttled",-0,0),f);break e}uy(c,o,Bn,nd,fm,r,ss,Ii,Ao,Ta,m,null,-0,0)}}break}while(!0);ir(t)}function uy(t,r,o,c,f,m,w,T,z,J,ne,oe,W,te){if(t.timeoutHandle=-1,oe=r.subtreeFlags,oe&8192||(oe&16785408)===16785408){oe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Cs},ny(r,m,oe);var be=(m&62914560)===m?ed-Pt():(m&4194048)===m?iy-Pt():0;if(be=D_(oe,be),be!==null){Ur=m,t.cancelPendingCommit=be(yy.bind(null,t,r,m,o,c,f,w,T,z,ne,oe,null,W,te)),Da(t,m,w,!J);return}}yy(t,r,m,o,c,f,w,T,z)}function Qw(t){for(var r=t;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var f=o[c],m=f.getSnapshot;f=f.value;try{if(!Jn(m(),f))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Da(t,r,o,c){r&=~hm,r&=~Ii,t.suspendedLanes|=r,t.pingedLanes&=~r,c&&(t.warmLanes|=r),c=t.expirationTimes;for(var f=r;0<f;){var m=31-Rt(f),w=1<<m;c[m]=-1,f&=~w}o!==0&&oi(t,o,r)}function sd(){return(lt&6)===0?(ec(0),!1):!0}function xm(){if(Ge!==null){if(ht===0)var t=Ge.return;else t=Ge,Ar=Ni=null,Mf(t),vo=null,Ol=0,t=Ge;for(;t!==null;)Bx(t.alternate,t),t=t.return;Ge=null}}function Ro(t,r){var o=t.timeoutHandle;o!==-1&&(t.timeoutHandle=-1,f_(o)),o=t.cancelPendingCommit,o!==null&&(t.cancelPendingCommit=null,o()),Ur=0,xm(),yt=t,Ge=o=Sr(t.current,null),Ye=r,ht=0,ns=null,Ta=!1,To=Ss(t,r),dm=!1,Ao=ss=hm=Ii=Aa=Vt=0,Bn=Jl=null,fm=!1,(r&8)!==0&&(r|=r&32);var c=t.entangledLanes;if(c!==0)for(t=t.entanglements,c&=r;0<c;){var f=31-Rt(c),m=1<<f;r|=t[f],c&=~m}return Lr=r,Eu(),o}function dy(t,r){ze=null,K.H=Hl,r===bo||r===Iu?(r=Tp(),ht=3):r===wf?(r=Tp(),ht=4):ht=r===Kf?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,ns=r,Ge===null&&(Vt=1,$u(t,gs(r,t.current)))}function hy(){var t=es.current;return t===null?!0:(Ye&4194048)===Ye?bs===null:(Ye&62914560)===Ye||(Ye&536870912)!==0?t===bs:!1}function fy(){var t=K.H;return K.H=Hl,t===null?Hl:t}function my(){var t=K.A;return K.A=Gw,t}function rd(){Vt=4,Ta||(Ye&4194048)!==Ye&&es.current!==null||(To=!0),(Aa&134217727)===0&&(Ii&134217727)===0||yt===null||Da(yt,Ye,ss,!1)}function ym(t,r,o){var c=lt;lt|=2;var f=fy(),m=my();(yt!==t||Ye!==r)&&(nd=null,Ro(t,r)),r=!1;var w=Vt;e:do try{if(ht!==0&&Ge!==null){var T=Ge,z=ns;switch(ht){case 8:xm(),w=6;break e;case 3:case 2:case 9:case 6:es.current===null&&(r=!0);var J=ht;if(ht=0,ns=null,Do(t,T,z,J),o&&To){w=0;break e}break;default:J=ht,ht=0,ns=null,Do(t,T,z,J)}}Yw(),w=Vt;break}catch(ne){dy(t,ne)}while(!0);return r&&t.shellSuspendCounter++,Ar=Ni=null,lt=c,K.H=f,K.A=m,Ge===null&&(yt=null,Ye=0,Eu()),w}function Yw(){for(;Ge!==null;)gy(Ge)}function Kw(t,r){var o=lt;lt|=2;var c=fy(),f=my();yt!==t||Ye!==r?(nd=null,td=Pt()+500,Ro(t,r)):To=Ss(t,r);e:do try{if(ht!==0&&Ge!==null){r=Ge;var m=ns;t:switch(ht){case 1:ht=0,ns=null,Do(t,r,m,1);break;case 2:case 9:if(jp(m)){ht=0,ns=null,py(r);break}r=function(){ht!==2&&ht!==9||yt!==t||(ht=7),ir(t)},m.then(r,r);break e;case 3:ht=7;break e;case 4:ht=5;break e;case 7:jp(m)?(ht=0,ns=null,py(r)):(ht=0,ns=null,Do(t,r,m,7));break;case 5:var w=null;switch(Ge.tag){case 26:w=Ge.memoizedState;case 5:case 27:var T=Ge;if(w?t2(w):T.stateNode.complete){ht=0,ns=null;var z=T.sibling;if(z!==null)Ge=z;else{var J=T.return;J!==null?(Ge=J,ad(J)):Ge=null}break t}}ht=0,ns=null,Do(t,r,m,5);break;case 6:ht=0,ns=null,Do(t,r,m,6);break;case 8:xm(),Vt=6;break e;default:throw Error(a(462))}}Xw();break}catch(ne){dy(t,ne)}while(!0);return Ar=Ni=null,K.H=c,K.A=f,lt=o,Ge!==null?0:(yt=null,Ye=0,Eu(),Vt)}function Xw(){for(;Ge!==null&&!Es();)gy(Ge)}function gy(t){var r=Ux(t.alternate,t,Lr);t.memoizedProps=t.pendingProps,r===null?ad(t):Ge=r}function py(t){var r=t,o=r.alternate;switch(r.tag){case 15:case 0:r=Mx(o,r,r.pendingProps,r.type,void 0,Ye);break;case 11:r=Mx(o,r,r.pendingProps,r.type.render,r.ref,Ye);break;case 5:Mf(r);default:Bx(o,r),r=Ge=mp(r,Lr),r=Ux(o,r,Lr)}t.memoizedProps=t.pendingProps,r===null?ad(t):Ge=r}function Do(t,r,o,c){Ar=Ni=null,Mf(r),vo=null,Ol=0;var f=r.return;try{if(Lw(t,f,r,o,Ye)){Vt=1,$u(t,gs(o,t.current)),Ge=null;return}}catch(m){if(f!==null)throw Ge=f,m;Vt=1,$u(t,gs(o,t.current)),Ge=null;return}r.flags&32768?(We||c===1?t=!0:To||(Ye&536870912)!==0?t=!1:(Ta=t=!0,(c===2||c===9||c===3||c===6)&&(c=es.current,c!==null&&c.tag===13&&(c.flags|=16384))),xy(r,t)):ad(r)}function ad(t){var r=t;do{if((r.flags&32768)!==0){xy(r,Ta);return}t=r.return;var o=Bw(r.alternate,r,Lr);if(o!==null){Ge=o;return}if(r=r.sibling,r!==null){Ge=r;return}Ge=r=t}while(r!==null);Vt===0&&(Vt=5)}function xy(t,r){do{var o=Fw(t.alternate,t);if(o!==null){o.flags&=32767,Ge=o;return}if(o=t.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(t=t.sibling,t!==null)){Ge=t;return}Ge=t=o}while(t!==null);Vt=6,Ge=null}function yy(t,r,o,c,f,m,w,T,z){t.cancelPendingCommit=null;do id();while(Wt!==0);if((lt&6)!==0)throw Error(a(327));if(r!==null){if(r===t.current)throw Error(a(177));if(m=r.lanes|r.childLanes,m|=af,Xh(t,o,m,w,T,z),t===yt&&(Ge=yt=null,Ye=0),Co=r,Ra=t,Ur=o,mm=m,gm=f,oy=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,e_(js,function(){return Ny(),null})):(t.callbackNode=null,t.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=K.T,K.T=null,f=ce.p,ce.p=2,w=lt,lt|=4;try{qw(t,r,o)}finally{lt=w,ce.p=f,K.T=c}}Wt=1,by(),vy(),wy()}}function by(){if(Wt===1){Wt=0;var t=Ra,r=Co,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=K.T,K.T=null;var c=ce.p;ce.p=2;var f=lt;lt|=4;try{Wx(r,t);var m=Rm,w=ap(t.containerInfo),T=m.focusedElem,z=m.selectionRange;if(w!==T&&T&&T.ownerDocument&&rp(T.ownerDocument.documentElement,T)){if(z!==null&&ef(T)){var J=z.start,ne=z.end;if(ne===void 0&&(ne=J),"selectionStart"in T)T.selectionStart=J,T.selectionEnd=Math.min(ne,T.value.length);else{var oe=T.ownerDocument||document,W=oe&&oe.defaultView||window;if(W.getSelection){var te=W.getSelection(),be=T.textContent.length,Ce=Math.min(z.start,be),xt=z.end===void 0?Ce:Math.min(z.end,be);!te.extend&&Ce>xt&&(w=xt,xt=Ce,Ce=w);var Q=sp(T,Ce),G=sp(T,xt);if(Q&&G&&(te.rangeCount!==1||te.anchorNode!==Q.node||te.anchorOffset!==Q.offset||te.focusNode!==G.node||te.focusOffset!==G.offset)){var Z=oe.createRange();Z.setStart(Q.node,Q.offset),te.removeAllRanges(),Ce>xt?(te.addRange(Z),te.extend(G.node,G.offset)):(Z.setEnd(G.node,G.offset),te.addRange(Z))}}}}for(oe=[],te=T;te=te.parentNode;)te.nodeType===1&&oe.push({element:te,left:te.scrollLeft,top:te.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<oe.length;T++){var ie=oe[T];ie.element.scrollLeft=ie.left,ie.element.scrollTop=ie.top}}yd=!!Cm,Rm=Cm=null}finally{lt=f,ce.p=c,K.T=o}}t.current=r,Wt=2}}function vy(){if(Wt===2){Wt=0;var t=Ra,r=Co,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=K.T,K.T=null;var c=ce.p;ce.p=2;var f=lt;lt|=4;try{Yx(t,r.alternate,r)}finally{lt=f,ce.p=c,K.T=o}}Wt=3}}function wy(){if(Wt===4||Wt===3){Wt=0,Te();var t=Ra,r=Co,o=Ur,c=oy;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Wt=5:(Wt=0,Co=Ra=null,_y(t,t.pendingLanes));var f=t.pendingLanes;if(f===0&&(Ca=null),_r(o),r=r.stateNode,Jt&&typeof Jt.onCommitFiberRoot=="function")try{Jt.onCommitFiberRoot(Mn,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=K.T,f=ce.p,ce.p=2,K.T=null;try{for(var m=t.onRecoverableError,w=0;w<c.length;w++){var T=c[w];m(T.value,{componentStack:T.stack})}}finally{K.T=r,ce.p=f}}(Ur&3)!==0&&id(),ir(t),f=t.pendingLanes,(o&261930)!==0&&(f&42)!==0?t===pm?Wl++:(Wl=0,pm=t):Wl=0,ec(0)}}function _y(t,r){(t.pooledCacheLanes&=r)===0&&(r=t.pooledCache,r!=null&&(t.pooledCache=null,kl(r)))}function id(){return by(),vy(),wy(),Ny()}function Ny(){if(Wt!==5)return!1;var t=Ra,r=mm;mm=0;var o=_r(Ur),c=K.T,f=ce.p;try{ce.p=32>o?32:o,K.T=null,o=gm,gm=null;var m=Ra,w=Ur;if(Wt=0,Co=Ra=null,Ur=0,(lt&6)!==0)throw Error(a(331));var T=lt;if(lt|=4,ry(m.current),ty(m,m.current,w,o),lt=T,ec(0,!1),Jt&&typeof Jt.onPostCommitFiberRoot=="function")try{Jt.onPostCommitFiberRoot(Mn,m)}catch{}return!0}finally{ce.p=f,K.T=c,_y(t,r)}}function Ey(t,r,o){r=gs(o,r),r=Yf(t.stateNode,r,2),t=Na(t,r,2),t!==null&&(ii(t,2),ir(t))}function ft(t,r,o){if(t.tag===3)Ey(t,t,o);else for(;r!==null;){if(r.tag===3){Ey(r,t,o);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Ca===null||!Ca.has(c))){t=gs(o,t),o=jx(2),c=Na(r,o,2),c!==null&&(Sx(o,c,r,t),ii(c,2),ir(c));break}}r=r.return}}function bm(t,r,o){var c=t.pingCache;if(c===null){c=t.pingCache=new $w;var f=new Set;c.set(r,f)}else f=c.get(r),f===void 0&&(f=new Set,c.set(r,f));f.has(o)||(dm=!0,f.add(o),t=Zw.bind(null,t,r,o),r.then(t,t))}function Zw(t,r,o){var c=t.pingCache;c!==null&&c.delete(r),t.pingedLanes|=t.suspendedLanes&o,t.warmLanes&=~o,yt===t&&(Ye&o)===o&&(Vt===4||Vt===3&&(Ye&62914560)===Ye&&300>Pt()-ed?(lt&2)===0&&Ro(t,0):hm|=o,Ao===Ye&&(Ao=0)),ir(t)}function jy(t,r){r===0&&(r=nu()),t=vi(t,r),t!==null&&(ii(t,r),ir(t))}function Jw(t){var r=t.memoizedState,o=0;r!==null&&(o=r.retryLane),jy(t,o)}function Ww(t,r){var o=0;switch(t.tag){case 31:case 13:var c=t.stateNode,f=t.memoizedState;f!==null&&(o=f.retryLane);break;case 19:c=t.stateNode;break;case 22:c=t.stateNode._retryCache;break;default:throw Error(a(314))}c!==null&&c.delete(r),jy(t,o)}function e_(t,r){return qe(t,r)}var od=null,Io=null,vm=!1,ld=!1,wm=!1,Ia=0;function ir(t){t!==Io&&t.next===null&&(Io===null?od=Io=t:Io=Io.next=t),ld=!0,vm||(vm=!0,n_())}function ec(t,r){if(!wm&&ld){wm=!0;do for(var o=!1,c=od;c!==null;){if(t!==0){var f=c.pendingLanes;if(f===0)var m=0;else{var w=c.suspendedLanes,T=c.pingedLanes;m=(1<<31-Rt(42|t)+1)-1,m&=f&~(w&~T),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(o=!0,Cy(c,m))}else m=Ye,m=Fs(c,c===yt?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||Ss(c,m)||(o=!0,Cy(c,m));c=c.next}while(o);wm=!1}}function t_(){Sy()}function Sy(){ld=vm=!1;var t=0;Ia!==0&&h_()&&(t=Ia);for(var r=Pt(),o=null,c=od;c!==null;){var f=c.next,m=Ty(c,r);m===0?(c.next=null,o===null?od=f:o.next=f,f===null&&(Io=o)):(o=c,(t!==0||(m&3)!==0)&&(ld=!0)),c=f}Wt!==0&&Wt!==5||ec(t),Ia!==0&&(Ia=0)}function Ty(t,r){for(var o=t.suspendedLanes,c=t.pingedLanes,f=t.expirationTimes,m=t.pendingLanes&-62914561;0<m;){var w=31-Rt(m),T=1<<w,z=f[w];z===-1?((T&o)===0||(T&c)!==0)&&(f[w]=Kh(T,r)):z<=r&&(t.expiredLanes|=T),m&=~T}if(r=yt,o=Ye,o=Fs(t,t===r?o:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c=t.callbackNode,o===0||t===r&&(ht===2||ht===9)||t.cancelPendingCommit!==null)return c!==null&&c!==null&&Ct(c),t.callbackNode=null,t.callbackPriority=0;if((o&3)===0||Ss(t,o)){if(r=o&-o,r===t.callbackPriority)return r;switch(c!==null&&Ct(c),_r(o)){case 2:case 8:o=yr;break;case 32:o=js;break;case 268435456:o=br;break;default:o=js}return c=Ay.bind(null,t),o=qe(o,c),t.callbackPriority=r,t.callbackNode=o,r}return c!==null&&c!==null&&Ct(c),t.callbackPriority=2,t.callbackNode=null,2}function Ay(t,r){if(Wt!==0&&Wt!==5)return t.callbackNode=null,t.callbackPriority=0,null;var o=t.callbackNode;if(id()&&t.callbackNode!==o)return null;var c=Ye;return c=Fs(t,t===yt?c:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c===0?null:(cy(t,c,r),Ty(t,Pt()),t.callbackNode!=null&&t.callbackNode===o?Ay.bind(null,t):null)}function Cy(t,r){if(id())return null;cy(t,r,!0)}function n_(){m_(function(){(lt&6)!==0?qe(ls,t_):Sy()})}function _m(){if(Ia===0){var t=xo;t===0&&(t=cs,cs<<=1,(cs&261888)===0&&(cs=256)),Ia=t}return Ia}function Ry(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:to(""+t)}function Dy(t,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,t.id&&o.setAttribute("form",t.id),r.parentNode.insertBefore(o,r),t=new FormData(t),o.parentNode.removeChild(o),t}function s_(t,r,o,c,f){if(r==="submit"&&o&&o.stateNode===f){var m=Ry((f[tn]||null).action),w=c.submitter;w&&(r=(r=w[tn]||null)?Ry(r.formAction):w.getAttribute("formAction"),r!==null&&(m=r,w=null));var T=new Ws("action","action",null,c,f);t.push({event:T,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Ia!==0){var z=w?Dy(f,w):new FormData(f);Ff(o,{pending:!0,data:z,method:f.method,action:m},null,z)}}else typeof m=="function"&&(T.preventDefault(),z=w?Dy(f,w):new FormData(f),Ff(o,{pending:!0,data:z,method:f.method,action:m},m,z))},currentTarget:f}]})}}for(var Nm=0;Nm<rf.length;Nm++){var Em=rf[Nm],r_=Em.toLowerCase(),a_=Em[0].toUpperCase()+Em.slice(1);ks(r_,"on"+a_)}ks(lp,"onAnimationEnd"),ks(cp,"onAnimationIteration"),ks(up,"onAnimationStart"),ks("dblclick","onDoubleClick"),ks("focusin","onFocus"),ks("focusout","onBlur"),ks(ww,"onTransitionRun"),ks(_w,"onTransitionStart"),ks(Nw,"onTransitionCancel"),ks(dp,"onTransitionEnd"),Ks("onMouseEnter",["mouseout","mouseover"]),Ks("onMouseLeave",["mouseout","mouseover"]),Ks("onPointerEnter",["pointerout","pointerover"]),Ks("onPointerLeave",["pointerout","pointerover"]),Ys("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ys("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ys("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ys("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ys("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ys("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var tc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),i_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(tc));function Iy(t,r){r=(r&4)!==0;for(var o=0;o<t.length;o++){var c=t[o],f=c.event;c=c.listeners;e:{var m=void 0;if(r)for(var w=c.length-1;0<=w;w--){var T=c[w],z=T.instance,J=T.currentTarget;if(T=T.listener,z!==m&&f.isPropagationStopped())break e;m=T,f.currentTarget=J;try{m(f)}catch(ne){Nu(ne)}f.currentTarget=null,m=z}else for(w=0;w<c.length;w++){if(T=c[w],z=T.instance,J=T.currentTarget,T=T.listener,z!==m&&f.isPropagationStopped())break e;m=T,f.currentTarget=J;try{m(f)}catch(ne){Nu(ne)}f.currentTarget=null,m=z}}}}function $e(t,r){var o=r[Xi];o===void 0&&(o=r[Xi]=new Set);var c=t+"__bubble";o.has(c)||(My(r,t,2,!1),o.add(c))}function jm(t,r,o){var c=0;r&&(c|=4),My(o,t,c,r)}var cd="_reactListening"+Math.random().toString(36).slice(2);function Sm(t){if(!t[cd]){t[cd]=!0,fl.forEach(function(o){o!=="selectionchange"&&(i_.has(o)||jm(o,!1,t),jm(o,!0,t))});var r=t.nodeType===9?t:t.ownerDocument;r===null||r[cd]||(r[cd]=!0,jm("selectionchange",!1,r))}}function My(t,r,o,c){switch(l2(r)){case 2:var f=k_;break;case 8:f=V_;break;default:f=Bm}o=f.bind(null,r,o,t),f=void 0,!hi||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),c?f!==void 0?t.addEventListener(r,o,{capture:!0,passive:f}):t.addEventListener(r,o,!0):f!==void 0?t.addEventListener(r,o,{passive:f}):t.addEventListener(r,o,!1)}function Tm(t,r,o,c,f){var m=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var w=c.tag;if(w===3||w===4){var T=c.stateNode.containerInfo;if(T===f)break;if(w===4)for(w=c.return;w!==null;){var z=w.tag;if((z===3||z===4)&&w.stateNode.containerInfo===f)return;w=w.return}for(;T!==null;){if(w=$s(T),w===null)return;if(z=w.tag,z===5||z===6||z===26||z===27){c=m=w;continue e}T=T.parentNode}}c=c.return}fa(function(){var J=m,ne=ds(o),oe=[];e:{var W=hp.get(t);if(W!==void 0){var te=Ws,be=t;switch(t){case"keypress":if(mi(o)===0)break e;case"keydown":case"keyup":te=vu;break;case"focusin":be="focus",te=pi;break;case"focusout":be="blur",te=pi;break;case"beforeblur":case"afterblur":te=pi;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":te=Sl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":te=du;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":te=b;break;case lp:case cp:case up:te=fu;break;case dp:te=I;break;case"scroll":case"scrollend":te=jl;break;case"wheel":te=ee;break;case"copy":case"cut":case"paste":te=mu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":te=jr;break;case"toggle":case"beforetoggle":te=Ue}var Ce=(r&4)!==0,xt=!Ce&&(t==="scroll"||t==="scrollend"),Q=Ce?W!==null?W+"Capture":null:W;Ce=[];for(var G=J,Z;G!==null;){var ie=G;if(Z=ie.stateNode,ie=ie.tag,ie!==5&&ie!==26&&ie!==27||Z===null||Q===null||(ie=Rs(G,Q),ie!=null&&Ce.push(nc(G,ie,Z))),xt)break;G=G.return}0<Ce.length&&(W=new te(W,be,null,o,ne),oe.push({event:W,listeners:Ce}))}}if((r&7)===0){e:{if(W=t==="mouseover"||t==="pointerover",te=t==="mouseout"||t==="pointerout",W&&o!==_l&&(be=o.relatedTarget||o.fromElement)&&($s(be)||be[Hs]))break e;if((te||W)&&(W=ne.window===ne?ne:(W=ne.ownerDocument)?W.defaultView||W.parentWindow:window,te?(be=o.relatedTarget||o.toElement,te=J,be=be?$s(be):null,be!==null&&(xt=u(be),Ce=be.tag,be!==xt||Ce!==5&&Ce!==27&&Ce!==6)&&(be=null)):(te=null,be=J),te!==be)){if(Ce=Sl,ie="onMouseLeave",Q="onMouseEnter",G="mouse",(t==="pointerout"||t==="pointerover")&&(Ce=jr,ie="onPointerLeave",Q="onPointerEnter",G="pointer"),xt=te==null?W:Xn(te),Z=be==null?W:Xn(be),W=new Ce(ie,G+"leave",te,o,ne),W.target=xt,W.relatedTarget=Z,ie=null,$s(ne)===J&&(Ce=new Ce(Q,G+"enter",be,o,ne),Ce.target=Z,Ce.relatedTarget=xt,ie=Ce),xt=ie,te&&be)t:{for(Ce=o_,Q=te,G=be,Z=0,ie=Q;ie;ie=Ce(ie))Z++;ie=0;for(var je=G;je;je=Ce(je))ie++;for(;0<Z-ie;)Q=Ce(Q),Z--;for(;0<ie-Z;)G=Ce(G),ie--;for(;Z--;){if(Q===G||G!==null&&Q===G.alternate){Ce=Q;break t}Q=Ce(Q),G=Ce(G)}Ce=null}else Ce=null;te!==null&&ky(oe,W,te,Ce,!1),be!==null&&xt!==null&&ky(oe,xt,be,Ce,!0)}}e:{if(W=J?Xn(J):window,te=W.nodeName&&W.nodeName.toLowerCase(),te==="select"||te==="input"&&W.type==="file")var st=Zg;else if(Kg(W))if(Jg)st=yw;else{st=pw;var _e=gw}else te=W.nodeName,!te||te.toLowerCase()!=="input"||W.type!=="checkbox"&&W.type!=="radio"?J&&eo(J.elementType)&&(st=Zg):st=xw;if(st&&(st=st(t,J))){Xg(oe,st,o,ne);break e}_e&&_e(t,W,J),t==="focusout"&&J&&W.type==="number"&&J.memoizedProps.value!=null&&bl(W,"number",W.value)}switch(_e=J?Xn(J):window,t){case"focusin":(Kg(_e)||_e.contentEditable==="true")&&(lo=_e,tf=J,Dl=null);break;case"focusout":Dl=tf=lo=null;break;case"mousedown":nf=!0;break;case"contextmenu":case"mouseup":case"dragend":nf=!1,ip(oe,o,ne);break;case"selectionchange":if(vw)break;case"keydown":case"keyup":ip(oe,o,ne)}var Be;if(ot)e:{switch(t){case"compositionstart":var Ke="onCompositionStart";break e;case"compositionend":Ke="onCompositionEnd";break e;case"compositionupdate":Ke="onCompositionUpdate";break e}Ke=void 0}else oo?xi(t,o)&&(Ke="onCompositionEnd"):t==="keydown"&&o.keyCode===229&&(Ke="onCompositionStart");Ke&&(nr&&o.locale!=="ko"&&(oo||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&oo&&(Be=El()):(Js=ne,Nl="value"in Js?Js.value:Js.textContent,oo=!0)),_e=ud(J,Ke),0<_e.length&&(Ke=new tr(Ke,t,null,o,ne),oe.push({event:Ke,listeners:_e}),Be?Ke.data=Be:(Be=io(o),Be!==null&&(Ke.data=Be)))),(Be=fs?dw(t,o):hw(t,o))&&(Ke=ud(J,"onBeforeInput"),0<Ke.length&&(_e=new tr("onBeforeInput","beforeinput",null,o,ne),oe.push({event:_e,listeners:Ke}),_e.data=Be)),s_(oe,t,J,o,ne)}Iy(oe,r)})}function nc(t,r,o){return{instance:t,listener:r,currentTarget:o}}function ud(t,r){for(var o=r+"Capture",c=[];t!==null;){var f=t,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=Rs(t,o),f!=null&&c.unshift(nc(t,f,m)),f=Rs(t,r),f!=null&&c.push(nc(t,f,m))),t.tag===3)return c;t=t.return}return[]}function o_(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function ky(t,r,o,c,f){for(var m=r._reactName,w=[];o!==null&&o!==c;){var T=o,z=T.alternate,J=T.stateNode;if(T=T.tag,z!==null&&z===c)break;T!==5&&T!==26&&T!==27||J===null||(z=J,f?(J=Rs(o,m),J!=null&&w.unshift(nc(o,J,z))):f||(J=Rs(o,m),J!=null&&w.push(nc(o,J,z)))),o=o.return}w.length!==0&&t.push({event:r,listeners:w})}var l_=/\r\n?/g,c_=/\u0000|\uFFFD/g;function Vy(t){return(typeof t=="string"?t:""+t).replace(l_,`
`).replace(c_,"")}function Oy(t,r){return r=Vy(r),Vy(t)===r}function pt(t,r,o,c,f,m){switch(o){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||Pn(t,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&Pn(t,""+c);break;case"className":Zn(t,"class",c);break;case"tabIndex":Zn(t,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Zn(t,o,c);break;case"style":wl(t,c,m);break;case"data":if(r!=="object"){Zn(t,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||o!=="href")){t.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(o);break}c=to(""+c),t.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){t.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(o==="formAction"?(r!=="input"&&pt(t,r,"name",f.name,f,null),pt(t,r,"formEncType",f.formEncType,f,null),pt(t,r,"formMethod",f.formMethod,f,null),pt(t,r,"formTarget",f.formTarget,f,null)):(pt(t,r,"encType",f.encType,f,null),pt(t,r,"method",f.method,f,null),pt(t,r,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(o);break}c=to(""+c),t.setAttribute(o,c);break;case"onClick":c!=null&&(t.onclick=Cs);break;case"onScroll":c!=null&&$e("scroll",t);break;case"onScrollEnd":c!=null&&$e("scrollend",t);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(a(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(a(60));t.innerHTML=o}}break;case"multiple":t.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":t.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){t.removeAttribute("xlink:href");break}o=to(""+c),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(o,""+c):t.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(o,""):t.removeAttribute(o);break;case"capture":case"download":c===!0?t.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(o,c):t.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?t.setAttribute(o,c):t.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?t.removeAttribute(o):t.setAttribute(o,c);break;case"popover":$e("beforetoggle",t),$e("toggle",t),Ji(t,"popover",c);break;case"xlinkActuate":Ht(t,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Ht(t,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Ht(t,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Ht(t,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Ht(t,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Ht(t,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Ht(t,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Ht(t,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Ht(t,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Ji(t,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=uu.get(o)||o,Ji(t,o,c))}}function Am(t,r,o,c,f,m){switch(o){case"style":wl(t,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(a(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(a(60));t.innerHTML=o}}break;case"children":typeof c=="string"?Pn(t,c):(typeof c=="number"||typeof c=="bigint")&&Pn(t,""+c);break;case"onScroll":c!=null&&$e("scroll",t);break;case"onScrollEnd":c!=null&&$e("scrollend",t);break;case"onClick":c!=null&&(t.onclick=Cs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ml.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),r=o.slice(2,f?o.length-7:void 0),m=t[tn]||null,m=m!=null?m[o]:null,typeof m=="function"&&t.removeEventListener(r,m,f),typeof c=="function")){typeof m!="function"&&m!==null&&(o in t?t[o]=null:t.hasAttribute(o)&&t.removeAttribute(o)),t.addEventListener(r,c,f);break e}o in t?t[o]=c:c===!0?t.setAttribute(o,""):Ji(t,o,c)}}}function fn(t,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$e("error",t),$e("load",t);var c=!1,f=!1,m;for(m in o)if(o.hasOwnProperty(m)){var w=o[m];if(w!=null)switch(m){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,r));default:pt(t,r,m,w,o,null)}}f&&pt(t,r,"srcSet",o.srcSet,o,null),c&&pt(t,r,"src",o.src,o,null);return;case"input":$e("invalid",t);var T=m=w=f=null,z=null,J=null;for(c in o)if(o.hasOwnProperty(c)){var ne=o[c];if(ne!=null)switch(c){case"name":f=ne;break;case"type":w=ne;break;case"checked":z=ne;break;case"defaultChecked":J=ne;break;case"value":m=ne;break;case"defaultValue":T=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(a(137,r));break;default:pt(t,r,c,ne,o,null)}}ou(t,m,T,z,J,w,f,!1);return;case"select":$e("invalid",t),c=w=m=null;for(f in o)if(o.hasOwnProperty(f)&&(T=o[f],T!=null))switch(f){case"value":m=T;break;case"defaultValue":w=T;break;case"multiple":c=T;default:pt(t,r,f,T,o,null)}r=m,o=w,t.multiple=!!c,r!=null?ca(t,!!c,r,!1):o!=null&&ca(t,!!c,o,!0);return;case"textarea":$e("invalid",t),m=f=c=null;for(w in o)if(o.hasOwnProperty(w)&&(T=o[w],T!=null))switch(w){case"value":c=T;break;case"defaultValue":f=T;break;case"children":m=T;break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(a(91));break;default:pt(t,r,w,T,o,null)}ua(t,c,f,m);return;case"option":for(z in o)if(o.hasOwnProperty(z)&&(c=o[z],c!=null))switch(z){case"selected":t.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:pt(t,r,z,c,o,null)}return;case"dialog":$e("beforetoggle",t),$e("toggle",t),$e("cancel",t),$e("close",t);break;case"iframe":case"object":$e("load",t);break;case"video":case"audio":for(c=0;c<tc.length;c++)$e(tc[c],t);break;case"image":$e("error",t),$e("load",t);break;case"details":$e("toggle",t);break;case"embed":case"source":case"link":$e("error",t),$e("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(J in o)if(o.hasOwnProperty(J)&&(c=o[J],c!=null))switch(J){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,r));default:pt(t,r,J,c,o,null)}return;default:if(eo(r)){for(ne in o)o.hasOwnProperty(ne)&&(c=o[ne],c!==void 0&&Am(t,r,ne,c,o,void 0));return}}for(T in o)o.hasOwnProperty(T)&&(c=o[T],c!=null&&pt(t,r,T,c,o,null))}function u_(t,r,o,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,w=null,T=null,z=null,J=null,ne=null;for(te in o){var oe=o[te];if(o.hasOwnProperty(te)&&oe!=null)switch(te){case"checked":break;case"value":break;case"defaultValue":z=oe;default:c.hasOwnProperty(te)||pt(t,r,te,null,c,oe)}}for(var W in c){var te=c[W];if(oe=o[W],c.hasOwnProperty(W)&&(te!=null||oe!=null))switch(W){case"type":m=te;break;case"name":f=te;break;case"checked":J=te;break;case"defaultChecked":ne=te;break;case"value":w=te;break;case"defaultValue":T=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(a(137,r));break;default:te!==oe&&pt(t,r,W,te,c,oe)}}Wi(t,w,T,z,J,ne,m,f);return;case"select":te=w=T=W=null;for(m in o)if(z=o[m],o.hasOwnProperty(m)&&z!=null)switch(m){case"value":break;case"multiple":te=z;default:c.hasOwnProperty(m)||pt(t,r,m,null,c,z)}for(f in c)if(m=c[f],z=o[f],c.hasOwnProperty(f)&&(m!=null||z!=null))switch(f){case"value":W=m;break;case"defaultValue":T=m;break;case"multiple":w=m;default:m!==z&&pt(t,r,f,m,c,z)}r=T,o=w,c=te,W!=null?ca(t,!!o,W,!1):!!c!=!!o&&(r!=null?ca(t,!!o,r,!0):ca(t,!!o,o?[]:"",!1));return;case"textarea":te=W=null;for(T in o)if(f=o[T],o.hasOwnProperty(T)&&f!=null&&!c.hasOwnProperty(T))switch(T){case"value":break;case"children":break;default:pt(t,r,T,null,c,f)}for(w in c)if(f=c[w],m=o[w],c.hasOwnProperty(w)&&(f!=null||m!=null))switch(w){case"value":W=f;break;case"defaultValue":te=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(a(91));break;default:f!==m&&pt(t,r,w,f,c,m)}lu(t,W,te);return;case"option":for(var be in o)if(W=o[be],o.hasOwnProperty(be)&&W!=null&&!c.hasOwnProperty(be))switch(be){case"selected":t.selected=!1;break;default:pt(t,r,be,null,c,W)}for(z in c)if(W=c[z],te=o[z],c.hasOwnProperty(z)&&W!==te&&(W!=null||te!=null))switch(z){case"selected":t.selected=W&&typeof W!="function"&&typeof W!="symbol";break;default:pt(t,r,z,W,c,te)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ce in o)W=o[Ce],o.hasOwnProperty(Ce)&&W!=null&&!c.hasOwnProperty(Ce)&&pt(t,r,Ce,null,c,W);for(J in c)if(W=c[J],te=o[J],c.hasOwnProperty(J)&&W!==te&&(W!=null||te!=null))switch(J){case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(a(137,r));break;default:pt(t,r,J,W,c,te)}return;default:if(eo(r)){for(var xt in o)W=o[xt],o.hasOwnProperty(xt)&&W!==void 0&&!c.hasOwnProperty(xt)&&Am(t,r,xt,void 0,c,W);for(ne in c)W=c[ne],te=o[ne],!c.hasOwnProperty(ne)||W===te||W===void 0&&te===void 0||Am(t,r,ne,W,c,te);return}}for(var Q in o)W=o[Q],o.hasOwnProperty(Q)&&W!=null&&!c.hasOwnProperty(Q)&&pt(t,r,Q,null,c,W);for(oe in c)W=c[oe],te=o[oe],!c.hasOwnProperty(oe)||W===te||W==null&&te==null||pt(t,r,oe,W,c,te)}function Py(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function d_(){if(typeof performance.getEntriesByType=="function"){for(var t=0,r=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var f=o[c],m=f.transferSize,w=f.initiatorType,T=f.duration;if(m&&T&&Py(w)){for(w=0,T=f.responseEnd,c+=1;c<o.length;c++){var z=o[c],J=z.startTime;if(J>T)break;var ne=z.transferSize,oe=z.initiatorType;ne&&Py(oe)&&(z=z.responseEnd,w+=ne*(z<T?1:(T-J)/(z-J)))}if(--c,r+=8*(m+w)/(f.duration/1e3),t++,10<t)break}}if(0<t)return r/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var Cm=null,Rm=null;function dd(t){return t.nodeType===9?t:t.ownerDocument}function Ly(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Uy(t,r){if(t===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&r==="foreignObject"?0:t}function Dm(t,r){return t==="textarea"||t==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Im=null;function h_(){var t=window.event;return t&&t.type==="popstate"?t===Im?!1:(Im=t,!0):(Im=null,!1)}var zy=typeof setTimeout=="function"?setTimeout:void 0,f_=typeof clearTimeout=="function"?clearTimeout:void 0,By=typeof Promise=="function"?Promise:void 0,m_=typeof queueMicrotask=="function"?queueMicrotask:typeof By<"u"?function(t){return By.resolve(null).then(t).catch(g_)}:zy;function g_(t){setTimeout(function(){throw t})}function Ma(t){return t==="head"}function Fy(t,r){var o=r,c=0;do{var f=o.nextSibling;if(t.removeChild(o),f&&f.nodeType===8)if(o=f.data,o==="/$"||o==="/&"){if(c===0){t.removeChild(f),Oo(r);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")sc(t.ownerDocument.documentElement);else if(o==="head"){o=t.ownerDocument.head,sc(o);for(var m=o.firstChild;m;){var w=m.nextSibling,T=m.nodeName;m[Gs]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&m.rel.toLowerCase()==="stylesheet"||o.removeChild(m),m=w}}else o==="body"&&sc(t.ownerDocument.body);o=f}while(o);Oo(r)}function qy(t,r){var o=t;t=0;do{var c=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(t===0)break;t--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||t++;o=c}while(o)}function Mm(t){var r=t.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Mm(o),Zi(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}t.removeChild(o)}}function p_(t,r,o,c){for(;t.nodeType===1;){var f=o;if(t.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(c){if(!t[Gs])switch(r){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(m=t.getAttribute("rel"),m==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(m!==f.rel||t.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||t.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||t.getAttribute("title")!==(f.title==null?null:f.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(m=t.getAttribute("src"),(m!==(f.src==null?null:f.src)||t.getAttribute("type")!==(f.type==null?null:f.type)||t.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(r==="input"&&t.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&t.getAttribute("name")===m)return t}else return t;if(t=vs(t.nextSibling),t===null)break}return null}function x_(t,r,o){if(r==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!o||(t=vs(t.nextSibling),t===null))return null;return t}function Hy(t,r){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!r||(t=vs(t.nextSibling),t===null))return null;return t}function km(t){return t.data==="$?"||t.data==="$~"}function Vm(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function y_(t,r){var o=t.ownerDocument;if(t.data==="$~")t._reactRetry=r;else if(t.data!=="$?"||o.readyState!=="loading")r();else{var c=function(){r(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),t._reactRetry=c}}function vs(t){for(;t!=null;t=t.nextSibling){var r=t.nodeType;if(r===1||r===3)break;if(r===8){if(r=t.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return t}var Om=null;function Gy(t){t=t.nextSibling;for(var r=0;t;){if(t.nodeType===8){var o=t.data;if(o==="/$"||o==="/&"){if(r===0)return vs(t.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}t=t.nextSibling}return null}function $y(t){t=t.previousSibling;for(var r=0;t;){if(t.nodeType===8){var o=t.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return t;r--}else o!=="/$"&&o!=="/&"||r++}t=t.previousSibling}return null}function Qy(t,r,o){switch(r=dd(o),t){case"html":if(t=r.documentElement,!t)throw Error(a(452));return t;case"head":if(t=r.head,!t)throw Error(a(453));return t;case"body":if(t=r.body,!t)throw Error(a(454));return t;default:throw Error(a(451))}}function sc(t){for(var r=t.attributes;r.length;)t.removeAttributeNode(r[0]);Zi(t)}var ws=new Map,Yy=new Set;function hd(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var zr=ce.d;ce.d={f:b_,r:v_,D:w_,C:__,L:N_,m:E_,X:S_,S:j_,M:T_};function b_(){var t=zr.f(),r=sd();return t||r}function v_(t){var r=us(t);r!==null&&r.tag===5&&r.type==="form"?dx(r):zr.r(t)}var Mo=typeof document>"u"?null:document;function Ky(t,r,o){var c=Mo;if(c&&typeof r=="string"&&r){var f=On(r);f='link[rel="'+t+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),Yy.has(f)||(Yy.add(f),t={rel:t,crossOrigin:o,href:r},c.querySelector(f)===null&&(r=c.createElement("link"),fn(r,"link",t),qt(r),c.head.appendChild(r)))}}function w_(t){zr.D(t),Ky("dns-prefetch",t,null)}function __(t,r){zr.C(t,r),Ky("preconnect",t,r)}function N_(t,r,o){zr.L(t,r,o);var c=Mo;if(c&&t&&r){var f='link[rel="preload"][as="'+On(r)+'"]';r==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+On(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+On(o.imageSizes)+'"]')):f+='[href="'+On(t)+'"]';var m=f;switch(r){case"style":m=ko(t);break;case"script":m=Vo(t)}ws.has(m)||(t=v({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:t,as:r},o),ws.set(m,t),c.querySelector(f)!==null||r==="style"&&c.querySelector(rc(m))||r==="script"&&c.querySelector(ac(m))||(r=c.createElement("link"),fn(r,"link",t),qt(r),c.head.appendChild(r)))}}function E_(t,r){zr.m(t,r);var o=Mo;if(o&&t){var c=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+On(c)+'"][href="'+On(t)+'"]',m=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Vo(t)}if(!ws.has(m)&&(t=v({rel:"modulepreload",href:t},r),ws.set(m,t),o.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(ac(m)))return}c=o.createElement("link"),fn(c,"link",t),qt(c),o.head.appendChild(c)}}}function j_(t,r,o){zr.S(t,r,o);var c=Mo;if(c&&t){var f=Qs(c).hoistableStyles,m=ko(t);r=r||"default";var w=f.get(m);if(!w){var T={loading:0,preload:null};if(w=c.querySelector(rc(m)))T.loading=5;else{t=v({rel:"stylesheet",href:t,"data-precedence":r},o),(o=ws.get(m))&&Pm(t,o);var z=w=c.createElement("link");qt(z),fn(z,"link",t),z._p=new Promise(function(J,ne){z.onload=J,z.onerror=ne}),z.addEventListener("load",function(){T.loading|=1}),z.addEventListener("error",function(){T.loading|=2}),T.loading|=4,fd(w,r,c)}w={type:"stylesheet",instance:w,count:1,state:T},f.set(m,w)}}}function S_(t,r){zr.X(t,r);var o=Mo;if(o&&t){var c=Qs(o).hoistableScripts,f=Vo(t),m=c.get(f);m||(m=o.querySelector(ac(f)),m||(t=v({src:t,async:!0},r),(r=ws.get(f))&&Lm(t,r),m=o.createElement("script"),qt(m),fn(m,"link",t),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function T_(t,r){zr.M(t,r);var o=Mo;if(o&&t){var c=Qs(o).hoistableScripts,f=Vo(t),m=c.get(f);m||(m=o.querySelector(ac(f)),m||(t=v({src:t,async:!0,type:"module"},r),(r=ws.get(f))&&Lm(t,r),m=o.createElement("script"),qt(m),fn(m,"link",t),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function Xy(t,r,o,c){var f=(f=Ie.current)?hd(f):null;if(!f)throw Error(a(446));switch(t){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=ko(o.href),o=Qs(f).hoistableStyles,c=o.get(r),c||(c={type:"style",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){t=ko(o.href);var m=Qs(f).hoistableStyles,w=m.get(t);if(w||(f=f.ownerDocument||f,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(t,w),(m=f.querySelector(rc(t)))&&!m._p&&(w.instance=m,w.state.loading=5),ws.has(t)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},ws.set(t,o),m||A_(f,t,o,w.state))),r&&c===null)throw Error(a(528,""));return w}if(r&&c!==null)throw Error(a(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Vo(o),o=Qs(f).hoistableScripts,c=o.get(r),c||(c={type:"script",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,t))}}function ko(t){return'href="'+On(t)+'"'}function rc(t){return'link[rel="stylesheet"]['+t+"]"}function Zy(t){return v({},t,{"data-precedence":t.precedence,precedence:null})}function A_(t,r,o,c){t.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=t.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),fn(r,"link",o),qt(r),t.head.appendChild(r))}function Vo(t){return'[src="'+On(t)+'"]'}function ac(t){return"script[async]"+t}function Jy(t,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var c=t.querySelector('style[data-href~="'+On(o.href)+'"]');if(c)return r.instance=c,qt(c),c;var f=v({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(t.ownerDocument||t).createElement("style"),qt(c),fn(c,"style",f),fd(c,o.precedence,t),r.instance=c;case"stylesheet":f=ko(o.href);var m=t.querySelector(rc(f));if(m)return r.state.loading|=4,r.instance=m,qt(m),m;c=Zy(o),(f=ws.get(f))&&Pm(c,f),m=(t.ownerDocument||t).createElement("link"),qt(m);var w=m;return w._p=new Promise(function(T,z){w.onload=T,w.onerror=z}),fn(m,"link",c),r.state.loading|=4,fd(m,o.precedence,t),r.instance=m;case"script":return m=Vo(o.src),(f=t.querySelector(ac(m)))?(r.instance=f,qt(f),f):(c=o,(f=ws.get(m))&&(c=v({},o),Lm(c,f)),t=t.ownerDocument||t,f=t.createElement("script"),qt(f),fn(f,"link",c),t.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(a(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,fd(c,o.precedence,t));return r.instance}function fd(t,r,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,m=f,w=0;w<c.length;w++){var T=c[w];if(T.dataset.precedence===r)m=T;else if(m!==f)break}m?m.parentNode.insertBefore(t,m.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(t,r.firstChild))}function Pm(t,r){t.crossOrigin==null&&(t.crossOrigin=r.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=r.referrerPolicy),t.title==null&&(t.title=r.title)}function Lm(t,r){t.crossOrigin==null&&(t.crossOrigin=r.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=r.referrerPolicy),t.integrity==null&&(t.integrity=r.integrity)}var md=null;function Wy(t,r,o){if(md===null){var c=new Map,f=md=new Map;f.set(o,c)}else f=md,c=f.get(o),c||(c=new Map,f.set(o,c));if(c.has(t))return c;for(c.set(t,null),o=o.getElementsByTagName(t),f=0;f<o.length;f++){var m=o[f];if(!(m[Gs]||m[Ft]||t==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var w=m.getAttribute(r)||"";w=t+w;var T=c.get(w);T?T.push(m):c.set(w,[m])}}return c}function e2(t,r,o){t=t.ownerDocument||t,t.head.insertBefore(o,r==="title"?t.querySelector("head > title"):null)}function C_(t,r,o){if(o===1||r.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return t=r.disabled,typeof r.precedence=="string"&&t==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function t2(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function R_(t,r,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var f=ko(c.href),m=r.querySelector(rc(f));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(t.count++,t=gd.bind(t),r.then(t,t)),o.state.loading|=4,o.instance=m,qt(m);return}m=r.ownerDocument||r,c=Zy(c),(f=ws.get(f))&&Pm(c,f),m=m.createElement("link"),qt(m);var w=m;w._p=new Promise(function(T,z){w.onload=T,w.onerror=z}),fn(m,"link",c),o.instance=m}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(t.count++,o=gd.bind(t),r.addEventListener("load",o),r.addEventListener("error",o))}}var Um=0;function D_(t,r){return t.stylesheets&&t.count===0&&xd(t,t.stylesheets),0<t.count||0<t.imgCount?function(o){var c=setTimeout(function(){if(t.stylesheets&&xd(t,t.stylesheets),t.unsuspend){var m=t.unsuspend;t.unsuspend=null,m()}},6e4+r);0<t.imgBytes&&Um===0&&(Um=62500*d_());var f=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&xd(t,t.stylesheets),t.unsuspend)){var m=t.unsuspend;t.unsuspend=null,m()}},(t.imgBytes>Um?50:800)+r);return t.unsuspend=o,function(){t.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function gd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)xd(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var pd=null;function xd(t,r){t.stylesheets=null,t.unsuspend!==null&&(t.count++,pd=new Map,r.forEach(I_,t),pd=null,gd.call(t))}function I_(t,r){if(!(r.state.loading&4)){var o=pd.get(t);if(o)var c=o.get(null);else{o=new Map,pd.set(t,o);for(var f=t.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var w=f[m];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(o.set(w.dataset.precedence,w),c=w)}c&&o.set(null,c)}f=r.instance,w=f.getAttribute("data-precedence"),m=o.get(w)||c,m===c&&o.set(null,f),o.set(w,f),this.count++,c=gd.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),m?m.parentNode.insertBefore(f,m.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(f,t.firstChild)),r.state.loading|=4}}var ic={$$typeof:k,Provider:null,Consumer:null,_currentValue:ge,_currentValue2:ge,_threadCount:0};function M_(t,r,o,c,f,m,w,T,z){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=qs(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qs(0),this.hiddenUpdates=qs(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=z,this.incompleteTransitions=new Map}function n2(t,r,o,c,f,m,w,T,z,J,ne,oe){return t=new M_(t,r,o,w,z,J,ne,oe,T),r=1,m===!0&&(r|=24),m=Wn(3,null,null,r),t.current=m,m.stateNode=t,r=yf(),r.refCount++,t.pooledCache=r,r.refCount++,m.memoizedState={element:c,isDehydrated:o,cache:r},_f(m),t}function s2(t){return t?(t=ho,t):ho}function r2(t,r,o,c,f,m){f=s2(f),c.context===null?c.context=f:c.pendingContext=f,c=_a(r),c.payload={element:o},m=m===void 0?null:m,m!==null&&(c.callback=m),o=Na(t,c,r),o!==null&&(Fn(o,t,r),Ll(o,t,r))}function a2(t,r){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var o=t.retryLane;t.retryLane=o!==0&&o<r?o:r}}function zm(t,r){a2(t,r),(t=t.alternate)&&a2(t,r)}function i2(t){if(t.tag===13||t.tag===31){var r=vi(t,67108864);r!==null&&Fn(r,t,67108864),zm(t,67108864)}}function o2(t){if(t.tag===13||t.tag===31){var r=rs();r=li(r);var o=vi(t,r);o!==null&&Fn(o,t,r),zm(t,r)}}var yd=!0;function k_(t,r,o,c){var f=K.T;K.T=null;var m=ce.p;try{ce.p=2,Bm(t,r,o,c)}finally{ce.p=m,K.T=f}}function V_(t,r,o,c){var f=K.T;K.T=null;var m=ce.p;try{ce.p=8,Bm(t,r,o,c)}finally{ce.p=m,K.T=f}}function Bm(t,r,o,c){if(yd){var f=Fm(c);if(f===null)Tm(t,r,c,bd,o),c2(t,c);else if(P_(f,t,r,o,c))c.stopPropagation();else if(c2(t,c),r&4&&-1<O_.indexOf(t)){for(;f!==null;){var m=us(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var w=Vn(m.pendingLanes);if(w!==0){var T=m;for(T.pendingLanes|=2,T.entangledLanes|=2;w;){var z=1<<31-Rt(w);T.entanglements[1]|=z,w&=~z}ir(m),(lt&6)===0&&(td=Pt()+500,ec(0))}}break;case 31:case 13:T=vi(m,2),T!==null&&Fn(T,m,2),sd(),zm(m,2)}if(m=Fm(c),m===null&&Tm(t,r,c,bd,o),m===f)break;f=m}f!==null&&c.stopPropagation()}else Tm(t,r,c,null,o)}}function Fm(t){return t=ds(t),qm(t)}var bd=null;function qm(t){if(bd=null,t=$s(t),t!==null){var r=u(t);if(r===null)t=null;else{var o=r.tag;if(o===13){if(t=h(r),t!==null)return t;t=null}else if(o===31){if(t=p(r),t!==null)return t;t=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;t=null}else r!==t&&(t=null)}}return bd=t,null}function l2(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(bn()){case ls:return 2;case yr:return 8;case js:case ul:return 32;case br:return 268435456;default:return 32}default:return 32}}var Hm=!1,ka=null,Va=null,Oa=null,oc=new Map,lc=new Map,Pa=[],O_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function c2(t,r){switch(t){case"focusin":case"focusout":ka=null;break;case"dragenter":case"dragleave":Va=null;break;case"mouseover":case"mouseout":Oa=null;break;case"pointerover":case"pointerout":oc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":lc.delete(r.pointerId)}}function cc(t,r,o,c,f,m){return t===null||t.nativeEvent!==m?(t={blockedOn:r,domEventName:o,eventSystemFlags:c,nativeEvent:m,targetContainers:[f]},r!==null&&(r=us(r),r!==null&&i2(r)),t):(t.eventSystemFlags|=c,r=t.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),t)}function P_(t,r,o,c,f){switch(r){case"focusin":return ka=cc(ka,t,r,o,c,f),!0;case"dragenter":return Va=cc(Va,t,r,o,c,f),!0;case"mouseover":return Oa=cc(Oa,t,r,o,c,f),!0;case"pointerover":var m=f.pointerId;return oc.set(m,cc(oc.get(m)||null,t,r,o,c,f)),!0;case"gotpointercapture":return m=f.pointerId,lc.set(m,cc(lc.get(m)||null,t,r,o,c,f)),!0}return!1}function u2(t){var r=$s(t.target);if(r!==null){var o=u(r);if(o!==null){if(r=o.tag,r===13){if(r=h(o),r!==null){t.blockedOn=r,Ts(t.priority,function(){o2(o)});return}}else if(r===31){if(r=p(o),r!==null){t.blockedOn=r,Ts(t.priority,function(){o2(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){t.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}t.blockedOn=null}function vd(t){if(t.blockedOn!==null)return!1;for(var r=t.targetContainers;0<r.length;){var o=Fm(t.nativeEvent);if(o===null){o=t.nativeEvent;var c=new o.constructor(o.type,o);_l=c,o.target.dispatchEvent(c),_l=null}else return r=us(o),r!==null&&i2(r),t.blockedOn=o,!1;r.shift()}return!0}function d2(t,r,o){vd(t)&&o.delete(r)}function L_(){Hm=!1,ka!==null&&vd(ka)&&(ka=null),Va!==null&&vd(Va)&&(Va=null),Oa!==null&&vd(Oa)&&(Oa=null),oc.forEach(d2),lc.forEach(d2)}function wd(t,r){t.blockedOn===r&&(t.blockedOn=null,Hm||(Hm=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,L_)))}var _d=null;function h2(t){_d!==t&&(_d=t,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){_d===t&&(_d=null);for(var r=0;r<t.length;r+=3){var o=t[r],c=t[r+1],f=t[r+2];if(typeof c!="function"){if(qm(c||o)===null)continue;break}var m=us(o);m!==null&&(t.splice(r,3),r-=3,Ff(m,{pending:!0,data:f,method:o.method,action:c},c,f))}}))}function Oo(t){function r(z){return wd(z,t)}ka!==null&&wd(ka,t),Va!==null&&wd(Va,t),Oa!==null&&wd(Oa,t),oc.forEach(r),lc.forEach(r);for(var o=0;o<Pa.length;o++){var c=Pa[o];c.blockedOn===t&&(c.blockedOn=null)}for(;0<Pa.length&&(o=Pa[0],o.blockedOn===null);)u2(o),o.blockedOn===null&&Pa.shift();if(o=(t.ownerDocument||t).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var f=o[c],m=o[c+1],w=f[tn]||null;if(typeof m=="function")w||h2(o);else if(w){var T=null;if(m&&m.hasAttribute("formAction")){if(f=m,w=m[tn]||null)T=w.formAction;else if(qm(f)!==null)continue}else T=w.action;typeof T=="function"?o[c+1]=T:(o.splice(c,3),c-=3),h2(o)}}}function f2(){function t(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(w){return f=w})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function Gm(t){this._internalRoot=t}Nd.prototype.render=Gm.prototype.render=function(t){var r=this._internalRoot;if(r===null)throw Error(a(409));var o=r.current,c=rs();r2(o,c,t,r,null,null)},Nd.prototype.unmount=Gm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var r=t.containerInfo;r2(t.current,2,null,t,null,null),sd(),r[Hs]=null}};function Nd(t){this._internalRoot=t}Nd.prototype.unstable_scheduleHydration=function(t){if(t){var r=su();t={blockedOn:null,target:t,priority:r};for(var o=0;o<Pa.length&&r!==0&&r<Pa[o].priority;o++);Pa.splice(o,0,t),o===0&&u2(t)}};var m2=e.version;if(m2!=="19.2.0")throw Error(a(527,m2,"19.2.0"));ce.findDOMNode=function(t){var r=t._reactInternals;if(r===void 0)throw typeof t.render=="function"?Error(a(188)):(t=Object.keys(t).join(","),Error(a(268,t)));return t=x(r),t=t!==null?y(t):null,t=t===null?null:t.stateNode,t};var U_={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:K,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ed=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ed.isDisabled&&Ed.supportsFiber)try{Mn=Ed.inject(U_),Jt=Ed}catch{}}return dc.createRoot=function(t,r){if(!l(t))throw Error(a(299));var o=!1,c="",f=wx,m=_x,w=Nx;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(w=r.onRecoverableError)),r=n2(t,1,!1,null,null,o,c,null,f,m,w,f2),t[Hs]=r.current,Sm(t),new Gm(r)},dc.hydrateRoot=function(t,r,o){if(!l(t))throw Error(a(299));var c=!1,f="",m=wx,w=_x,T=Nx,z=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(m=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(T=o.onRecoverableError),o.formState!==void 0&&(z=o.formState)),r=n2(t,1,!0,r,o??null,c,f,z,m,w,T,f2),r.context=s2(null),o=r.current,c=rs(),c=li(c),f=_a(c),f.callback=null,Na(o,f,c),o=c,r.current.lanes=o,ii(r,o),ir(r),t[Hs]=r.current,Sm(t),new Nd(r)},dc.version="19.2.0",dc}var E2;function K_(){if(E2)return Ym.exports;E2=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Ym.exports=Y_(),Ym.exports}var X_=K_();const Z_=cb(X_),J_=()=>{};var j2={};const ub=function(s){const e=[];let n=0;for(let a=0;a<s.length;a++){let l=s.charCodeAt(a);l<128?e[n++]=l:l<2048?(e[n++]=l>>6|192,e[n++]=l&63|128):(l&64512)===55296&&a+1<s.length&&(s.charCodeAt(a+1)&64512)===56320?(l=65536+((l&1023)<<10)+(s.charCodeAt(++a)&1023),e[n++]=l>>18|240,e[n++]=l>>12&63|128,e[n++]=l>>6&63|128,e[n++]=l&63|128):(e[n++]=l>>12|224,e[n++]=l>>6&63|128,e[n++]=l&63|128)}return e},W_=function(s){const e=[];let n=0,a=0;for(;n<s.length;){const l=s[n++];if(l<128)e[a++]=String.fromCharCode(l);else if(l>191&&l<224){const u=s[n++];e[a++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=s[n++],h=s[n++],p=s[n++],g=((l&7)<<18|(u&63)<<12|(h&63)<<6|p&63)-65536;e[a++]=String.fromCharCode(55296+(g>>10)),e[a++]=String.fromCharCode(56320+(g&1023))}else{const u=s[n++],h=s[n++];e[a++]=String.fromCharCode((l&15)<<12|(u&63)<<6|h&63)}}return e.join("")},db={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let l=0;l<s.length;l+=3){const u=s[l],h=l+1<s.length,p=h?s[l+1]:0,g=l+2<s.length,x=g?s[l+2]:0,y=u>>2,v=(u&3)<<4|p>>4;let _=(p&15)<<2|x>>6,E=x&63;g||(E=64,h||(_=64)),a.push(n[y],n[v],n[_],n[E])}return a.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(ub(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):W_(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,a=[];for(let l=0;l<s.length;){const u=n[s.charAt(l++)],p=l<s.length?n[s.charAt(l)]:0;++l;const x=l<s.length?n[s.charAt(l)]:64;++l;const v=l<s.length?n[s.charAt(l)]:64;if(++l,u==null||p==null||x==null||v==null)throw new e6;const _=u<<2|p>>4;if(a.push(_),x!==64){const E=p<<4&240|x>>2;if(a.push(E),v!==64){const S=x<<6&192|v;a.push(S)}}}return a},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class e6 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const t6=function(s){const e=ub(s);return db.encodeByteArray(e,!0)},Hd=function(s){return t6(s).replace(/\./g,"")},hb=function(s){try{return db.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function n6(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const s6=()=>n6().__FIREBASE_DEFAULTS__,r6=()=>{if(typeof process>"u"||typeof j2>"u")return;const s=j2.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},a6=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&hb(s[1]);return e&&JSON.parse(e)},xh=()=>{try{return J_()||s6()||r6()||a6()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},fb=s=>xh()?.emulatorHosts?.[s],i6=s=>{const e=fb(s);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const a=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),a]:[e.substring(0,n),a]},mb=()=>xh()?.config,gb=s=>xh()?.[`_${s}`];class o6{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,a)=>{n?this.reject(n):this.resolve(a),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,a))}}}function nl(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function pb(s){return(await fetch(s,{credentials:"include"})).ok}function l6(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},a=e||"demo-project",l=s.iat||0,u=s.sub||s.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const h={iss:`https://securetoken.google.com/${a}`,aud:a,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Hd(JSON.stringify(n)),Hd(JSON.stringify(h)),""].join(".")}const yc={};function c6(){const s={prod:[],emulator:[]};for(const e of Object.keys(yc))yc[e]?s.emulator.push(e):s.prod.push(e);return s}function u6(s){let e=document.getElementById(s),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),n=!0),{created:n,element:e}}let S2=!1;function xb(s,e){if(typeof window>"u"||typeof document>"u"||!nl(window.location.host)||yc[s]===e||yc[s]||S2)return;yc[s]=e;function n(_){return`__firebase__banner__${_}`}const a="__firebase__banner",u=c6().prod.length>0;function h(){const _=document.getElementById(a);_&&_.remove()}function p(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function g(_,E){_.setAttribute("width","24"),_.setAttribute("id",E),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function x(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{S2=!0,h()},_}function y(_,E){_.setAttribute("id",E),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function v(){const _=u6(a),E=n("text"),S=document.getElementById(E)||document.createElement("span"),A=n("learnmore"),D=document.getElementById(A)||document.createElement("a"),L=n("preprendIcon"),B=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const k=_.element;p(k),y(D,A);const $=x();g(B,L),k.append(B,S,D,$),document.body.appendChild(k)}u?(S.innerText="Preview backend disconnected.",B.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(B.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function Sn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function d6(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Sn())}function h6(){const s=xh()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function f6(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function m6(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function g6(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function p6(){const s=Sn();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function x6(){return!h6()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function y6(){try{return typeof indexedDB=="object"}catch{return!1}}function b6(){return new Promise((s,e)=>{try{let n=!0;const a="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(a);l.onsuccess=()=>{l.result.close(),n||self.indexedDB.deleteDatabase(a),s(!0)},l.onupgradeneeded=()=>{n=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(n){e(n)}})}const v6="FirebaseError";class na extends Error{constructor(e,n,a){super(n),this.code=e,this.customData=a,this.name=v6,Object.setPrototypeOf(this,na.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Oc.prototype.create)}}class Oc{constructor(e,n,a){this.service=e,this.serviceName=n,this.errors=a}create(e,...n){const a=n[0]||{},l=`${this.service}/${e}`,u=this.errors[e],h=u?w6(u,a):"Error",p=`${this.serviceName}: ${h} (${l}).`;return new na(l,p,a)}}function w6(s,e){return s.replace(_6,(n,a)=>{const l=e[a];return l!=null?String(l):`<${a}?>`})}const _6=/\{\$([^}]+)}/g;function N6(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function Yr(s,e){if(s===e)return!0;const n=Object.keys(s),a=Object.keys(e);for(const l of n){if(!a.includes(l))return!1;const u=s[l],h=e[l];if(T2(u)&&T2(h)){if(!Yr(u,h))return!1}else if(u!==h)return!1}for(const l of a)if(!n.includes(l))return!1;return!0}function T2(s){return s!==null&&typeof s=="object"}function Pc(s){const e=[];for(const[n,a]of Object.entries(s))Array.isArray(a)?a.forEach(l=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(a));return e.length?"&"+e.join("&"):""}function hc(s){const e={};return s.replace(/^\?/,"").split("&").forEach(a=>{if(a){const[l,u]=a.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function fc(s){const e=s.indexOf("?");if(!e)return"";const n=s.indexOf("#",e);return s.substring(e,n>0?n:void 0)}function E6(s,e){const n=new j6(s,e);return n.subscribe.bind(n)}class j6{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(a=>{this.error(a)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,a){let l;if(e===void 0&&n===void 0&&a===void 0)throw new Error("Missing Observer.");S6(e,["next","error","complete"])?l=e:l={next:e,error:n,complete:a},l.next===void 0&&(l.next=Jm),l.error===void 0&&(l.error=Jm),l.complete===void 0&&(l.complete=Jm);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(a){typeof console<"u"&&console.error&&console.error(a)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function S6(s,e){if(typeof s!="object"||s===null)return!1;for(const n of e)if(n in s&&typeof s[n]=="function")return!0;return!1}function Jm(){}function It(s){return s&&s._delegate?s._delegate:s}class Li{constructor(e,n,a){this.name=e,this.instanceFactory=n,this.type=a,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Mi="[DEFAULT]";class T6{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const a=new o6;if(this.instancesDeferred.set(n,a),this.isInitialized(n)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:n});l&&a.resolve(l)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),a=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(l){if(a)return null;throw l}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(C6(e))try{this.getOrInitializeService({instanceIdentifier:Mi})}catch{}for(const[n,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(n);try{const u=this.getOrInitializeService({instanceIdentifier:l});a.resolve(u)}catch{}}}}clearInstance(e=Mi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Mi){return this.instances.has(e)}getOptions(e=Mi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,a=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(a))throw Error(`${this.name}(${a}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:a,options:n});for(const[u,h]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);a===p&&h.resolve(l)}return l}onInit(e,n){const a=this.normalizeInstanceIdentifier(n),l=this.onInitCallbacks.get(a)??new Set;l.add(e),this.onInitCallbacks.set(a,l);const u=this.instances.get(a);return u&&e(u,a),()=>{l.delete(e)}}invokeOnInitCallbacks(e,n){const a=this.onInitCallbacks.get(n);if(a)for(const l of a)try{l(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let a=this.instances.get(e);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:A6(e),options:n}),this.instances.set(e,a),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(a,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,a)}catch{}return a||null}normalizeInstanceIdentifier(e=Mi){return this.component?this.component.multipleInstances?e:Mi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function A6(s){return s===Mi?void 0:s}function C6(s){return s.instantiationMode==="EAGER"}class R6{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new T6(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var Xe;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Xe||(Xe={}));const D6={debug:Xe.DEBUG,verbose:Xe.VERBOSE,info:Xe.INFO,warn:Xe.WARN,error:Xe.ERROR,silent:Xe.SILENT},I6=Xe.INFO,M6={[Xe.DEBUG]:"log",[Xe.VERBOSE]:"log",[Xe.INFO]:"info",[Xe.WARN]:"warn",[Xe.ERROR]:"error"},k6=(s,e,...n)=>{if(e<s.logLevel)return;const a=new Date().toISOString(),l=M6[e];if(l)console[l](`[${a}]  ${s.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class B0{constructor(e){this.name=e,this._logLevel=I6,this._logHandler=k6,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Xe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?D6[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Xe.DEBUG,...e),this._logHandler(this,Xe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Xe.VERBOSE,...e),this._logHandler(this,Xe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Xe.INFO,...e),this._logHandler(this,Xe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Xe.WARN,...e),this._logHandler(this,Xe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Xe.ERROR,...e),this._logHandler(this,Xe.ERROR,...e)}}const V6=(s,e)=>e.some(n=>s instanceof n);let A2,C2;function O6(){return A2||(A2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function P6(){return C2||(C2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const yb=new WeakMap,d0=new WeakMap,bb=new WeakMap,Wm=new WeakMap,F0=new WeakMap;function L6(s){const e=new Promise((n,a)=>{const l=()=>{s.removeEventListener("success",u),s.removeEventListener("error",h)},u=()=>{n($a(s.result)),l()},h=()=>{a(s.error),l()};s.addEventListener("success",u),s.addEventListener("error",h)});return e.then(n=>{n instanceof IDBCursor&&yb.set(n,s)}).catch(()=>{}),F0.set(e,s),e}function U6(s){if(d0.has(s))return;const e=new Promise((n,a)=>{const l=()=>{s.removeEventListener("complete",u),s.removeEventListener("error",h),s.removeEventListener("abort",h)},u=()=>{n(),l()},h=()=>{a(s.error||new DOMException("AbortError","AbortError")),l()};s.addEventListener("complete",u),s.addEventListener("error",h),s.addEventListener("abort",h)});d0.set(s,e)}let h0={get(s,e,n){if(s instanceof IDBTransaction){if(e==="done")return d0.get(s);if(e==="objectStoreNames")return s.objectStoreNames||bb.get(s);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return $a(s[e])},set(s,e,n){return s[e]=n,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function z6(s){h0=s(h0)}function B6(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const a=s.call(e0(this),e,...n);return bb.set(a,e.sort?e.sort():[e]),$a(a)}:P6().includes(s)?function(...e){return s.apply(e0(this),e),$a(yb.get(this))}:function(...e){return $a(s.apply(e0(this),e))}}function F6(s){return typeof s=="function"?B6(s):(s instanceof IDBTransaction&&U6(s),V6(s,O6())?new Proxy(s,h0):s)}function $a(s){if(s instanceof IDBRequest)return L6(s);if(Wm.has(s))return Wm.get(s);const e=F6(s);return e!==s&&(Wm.set(s,e),F0.set(e,s)),e}const e0=s=>F0.get(s);function q6(s,e,{blocked:n,upgrade:a,blocking:l,terminated:u}={}){const h=indexedDB.open(s,e),p=$a(h);return a&&h.addEventListener("upgradeneeded",g=>{a($a(h.result),g.oldVersion,g.newVersion,$a(h.transaction),g)}),n&&h.addEventListener("blocked",g=>n(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",x=>l(x.oldVersion,x.newVersion,x))}).catch(()=>{}),p}const H6=["get","getKey","getAll","getAllKeys","count"],G6=["put","add","delete","clear"],t0=new Map;function R2(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(t0.get(e))return t0.get(e);const n=e.replace(/FromIndex$/,""),a=e!==n,l=G6.includes(n);if(!(n in(a?IDBIndex:IDBObjectStore).prototype)||!(l||H6.includes(n)))return;const u=async function(h,...p){const g=this.transaction(h,l?"readwrite":"readonly");let x=g.store;return a&&(x=x.index(p.shift())),(await Promise.all([x[n](...p),l&&g.done]))[0]};return t0.set(e,u),u}z6(s=>({...s,get:(e,n,a)=>R2(e,n)||s.get(e,n,a),has:(e,n)=>!!R2(e,n)||s.has(e,n)}));class $6{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Q6(n)){const a=n.getImmediate();return`${a.library}/${a.version}`}else return null}).filter(n=>n).join(" ")}}function Q6(s){return s.getComponent()?.type==="VERSION"}const f0="@firebase/app",D2="0.14.6";const Kr=new B0("@firebase/app"),Y6="@firebase/app-compat",K6="@firebase/analytics-compat",X6="@firebase/analytics",Z6="@firebase/app-check-compat",J6="@firebase/app-check",W6="@firebase/auth",e5="@firebase/auth-compat",t5="@firebase/database",n5="@firebase/data-connect",s5="@firebase/database-compat",r5="@firebase/functions",a5="@firebase/functions-compat",i5="@firebase/installations",o5="@firebase/installations-compat",l5="@firebase/messaging",c5="@firebase/messaging-compat",u5="@firebase/performance",d5="@firebase/performance-compat",h5="@firebase/remote-config",f5="@firebase/remote-config-compat",m5="@firebase/storage",g5="@firebase/storage-compat",p5="@firebase/firestore",x5="@firebase/ai",y5="@firebase/firestore-compat",b5="firebase",v5="12.6.0";const m0="[DEFAULT]",w5={[f0]:"fire-core",[Y6]:"fire-core-compat",[X6]:"fire-analytics",[K6]:"fire-analytics-compat",[J6]:"fire-app-check",[Z6]:"fire-app-check-compat",[W6]:"fire-auth",[e5]:"fire-auth-compat",[t5]:"fire-rtdb",[n5]:"fire-data-connect",[s5]:"fire-rtdb-compat",[r5]:"fire-fn",[a5]:"fire-fn-compat",[i5]:"fire-iid",[o5]:"fire-iid-compat",[l5]:"fire-fcm",[c5]:"fire-fcm-compat",[u5]:"fire-perf",[d5]:"fire-perf-compat",[h5]:"fire-rc",[f5]:"fire-rc-compat",[m5]:"fire-gcs",[g5]:"fire-gcs-compat",[p5]:"fire-fst",[y5]:"fire-fst-compat",[x5]:"fire-vertex","fire-js":"fire-js",[b5]:"fire-js-all"};const Gd=new Map,_5=new Map,g0=new Map;function I2(s,e){try{s.container.addComponent(e)}catch(n){Kr.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,n)}}function Go(s){const e=s.name;if(g0.has(e))return Kr.debug(`There were multiple attempts to register component ${e}.`),!1;g0.set(e,s);for(const n of Gd.values())I2(n,s);for(const n of _5.values())I2(n,s);return!0}function q0(s,e){const n=s.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),s.container.getProvider(e)}function as(s){return s==null?!1:s.settings!==void 0}const N5={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qa=new Oc("app","Firebase",N5);class E5{constructor(e,n,a){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=a,this.container.addComponent(new Li("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qa.create("app-deleted",{appName:this._name})}}const sl=v5;function vb(s,e={}){let n=s;typeof e!="object"&&(e={name:e});const a={name:m0,automaticDataCollectionEnabled:!0,...e},l=a.name;if(typeof l!="string"||!l)throw Qa.create("bad-app-name",{appName:String(l)});if(n||(n=mb()),!n)throw Qa.create("no-options");const u=Gd.get(l);if(u){if(Yr(n,u.options)&&Yr(a,u.config))return u;throw Qa.create("duplicate-app",{appName:l})}const h=new R6(l);for(const g of g0.values())h.addComponent(g);const p=new E5(n,a,h);return Gd.set(l,p),p}function wb(s=m0){const e=Gd.get(s);if(!e&&s===m0&&mb())return vb();if(!e)throw Qa.create("no-app",{appName:s});return e}function Ya(s,e,n){let a=w5[s]??s;n&&(a+=`-${n}`);const l=a.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const h=[`Unable to register library "${a}" with version "${e}":`];l&&h.push(`library name "${a}" contains illegal characters (whitespace or "/")`),l&&u&&h.push("and"),u&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Kr.warn(h.join(" "));return}Go(new Li(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}const j5="firebase-heartbeat-database",S5=1,jc="firebase-heartbeat-store";let n0=null;function _b(){return n0||(n0=q6(j5,S5,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(jc)}catch(n){console.warn(n)}}}}).catch(s=>{throw Qa.create("idb-open",{originalErrorMessage:s.message})})),n0}async function T5(s){try{const n=(await _b()).transaction(jc),a=await n.objectStore(jc).get(Nb(s));return await n.done,a}catch(e){if(e instanceof na)Kr.warn(e.message);else{const n=Qa.create("idb-get",{originalErrorMessage:e?.message});Kr.warn(n.message)}}}async function M2(s,e){try{const a=(await _b()).transaction(jc,"readwrite");await a.objectStore(jc).put(e,Nb(s)),await a.done}catch(n){if(n instanceof na)Kr.warn(n.message);else{const a=Qa.create("idb-set",{originalErrorMessage:n?.message});Kr.warn(a.message)}}}function Nb(s){return`${s.name}!${s.options.appId}`}const A5=1024,C5=30;class R5{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new I5(n),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=k2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(l=>l.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:n}),this._heartbeatsCache.heartbeats.length>C5){const l=M5(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Kr.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=k2(),{heartbeatsToSend:n,unsentEntries:a}=D5(this._heartbeatsCache.heartbeats),l=Hd(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return Kr.warn(e),""}}}function k2(){return new Date().toISOString().substring(0,10)}function D5(s,e=A5){const n=[];let a=s.slice();for(const l of s){const u=n.find(h=>h.agent===l.agent);if(u){if(u.dates.push(l.date),V2(n)>e){u.dates.pop();break}}else if(n.push({agent:l.agent,dates:[l.date]}),V2(n)>e){n.pop();break}a=a.slice(1)}return{heartbeatsToSend:n,unsentEntries:a}}class I5{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return y6()?b6().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await T5(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const a=await this.read();return M2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const a=await this.read();return M2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function V2(s){return Hd(JSON.stringify({version:2,heartbeats:s})).length}function M5(s){if(s.length===0)return-1;let e=0,n=s[0].date;for(let a=1;a<s.length;a++)s[a].date<n&&(n=s[a].date,e=a);return e}function k5(s){Go(new Li("platform-logger",e=>new $6(e),"PRIVATE")),Go(new Li("heartbeat",e=>new R5(e),"PRIVATE")),Ya(f0,D2,s),Ya(f0,D2,"esm2020"),Ya("fire-js","")}k5("");function Eb(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const V5=Eb,jb=new Oc("auth","Firebase",Eb());const $d=new B0("@firebase/auth");function O5(s,...e){$d.logLevel<=Xe.WARN&&$d.warn(`Auth (${sl}): ${s}`,...e)}function Md(s,...e){$d.logLevel<=Xe.ERROR&&$d.error(`Auth (${sl}): ${s}`,...e)}function Ns(s,...e){throw G0(s,...e)}function Ls(s,...e){return G0(s,...e)}function H0(s,e,n){const a={...V5(),[e]:n};return new Oc("auth","Firebase",a).create(e,{appName:s.name})}function $r(s){return H0(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function P5(s,e,n){const a=n;if(!(e instanceof a))throw a.name!==e.constructor.name&&Ns(s,"argument-error"),H0(s,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function G0(s,...e){if(typeof s!="string"){const n=e[0],a=[...e.slice(1)];return a[0]&&(a[0].appName=s.name),s._errorFactory.create(n,...a)}return jb.create(s,...e)}function Re(s,e,...n){if(!s)throw G0(e,...n)}function qr(s){const e="INTERNAL ASSERTION FAILED: "+s;throw Md(e),new Error(e)}function Xr(s,e){s||qr(e)}function p0(){return typeof self<"u"&&self.location?.href||""}function L5(){return O2()==="http:"||O2()==="https:"}function O2(){return typeof self<"u"&&self.location?.protocol||null}function U5(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(L5()||m6()||"connection"in navigator)?navigator.onLine:!0}function z5(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class Lc{constructor(e,n){this.shortDelay=e,this.longDelay=n,Xr(n>e,"Short delay should be less than long delay!"),this.isMobile=d6()||g6()}get(){return U5()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function $0(s,e){Xr(s.emulator,"Emulator should always be set here");const{url:n}=s.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class Sb{static initialize(e,n,a){this.fetchImpl=e,n&&(this.headersImpl=n),a&&(this.responseImpl=a)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;qr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;qr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;qr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const B5={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const F5=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],q5=new Lc(3e4,6e4);function sa(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function ra(s,e,n,a,l={}){return Tb(s,l,async()=>{let u={},h={};a&&(e==="GET"?h=a:u={body:JSON.stringify(a)});const p=Pc({key:s.config.apiKey,...h}).slice(1),g=await s._getAdditionalHeaders();g["Content-Type"]="application/json",s.languageCode&&(g["X-Firebase-Locale"]=s.languageCode);const x={method:e,headers:g,...u};return f6()||(x.referrerPolicy="no-referrer"),s.emulatorConfig&&nl(s.emulatorConfig.host)&&(x.credentials="include"),Sb.fetch()(await Ab(s,s.config.apiHost,n,p),x)})}async function Tb(s,e,n){s._canInitEmulator=!1;const a={...B5,...e};try{const l=new G5(s),u=await Promise.race([n(),l.promise]);l.clearNetworkTimeout();const h=await u.json();if("needConfirmation"in h)throw jd(s,"account-exists-with-different-credential",h);if(u.ok&&!("errorMessage"in h))return h;{const p=u.ok?h.errorMessage:h.error.message,[g,x]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw jd(s,"credential-already-in-use",h);if(g==="EMAIL_EXISTS")throw jd(s,"email-already-in-use",h);if(g==="USER_DISABLED")throw jd(s,"user-disabled",h);const y=a[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(x)throw H0(s,y,x);Ns(s,y)}}catch(l){if(l instanceof na)throw l;Ns(s,"network-request-failed",{message:String(l)})}}async function Uc(s,e,n,a,l={}){const u=await ra(s,e,n,a,l);return"mfaPendingCredential"in u&&Ns(s,"multi-factor-auth-required",{_serverResponse:u}),u}async function Ab(s,e,n,a){const l=`${e}${n}?${a}`,u=s,h=u.config.emulator?$0(s.config,l):`${s.config.apiScheme}://${l}`;return F5.includes(n)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(h).toString():h}function H5(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class G5{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,a)=>{this.timer=setTimeout(()=>a(Ls(this.auth,"network-request-failed")),q5.get())})}}function jd(s,e,n){const a={appName:s.name};n.email&&(a.email=n.email),n.phoneNumber&&(a.phoneNumber=n.phoneNumber);const l=Ls(s,e,a);return l.customData._tokenResponse=n,l}function P2(s){return s!==void 0&&s.enterprise!==void 0}class $5{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return H5(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Q5(s,e){return ra(s,"GET","/v2/recaptchaConfig",sa(s,e))}async function Y5(s,e){return ra(s,"POST","/v1/accounts:delete",e)}async function Qd(s,e){return ra(s,"POST","/v1/accounts:lookup",e)}function bc(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function K5(s,e=!1){const n=It(s),a=await n.getIdToken(e),l=Q0(a);Re(l&&l.exp&&l.auth_time&&l.iat,n.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,h=u?.sign_in_provider;return{claims:l,token:a,authTime:bc(s0(l.auth_time)),issuedAtTime:bc(s0(l.iat)),expirationTime:bc(s0(l.exp)),signInProvider:h||null,signInSecondFactor:u?.sign_in_second_factor||null}}function s0(s){return Number(s)*1e3}function Q0(s){const[e,n,a]=s.split(".");if(e===void 0||n===void 0||a===void 0)return Md("JWT malformed, contained fewer than 3 sections"),null;try{const l=hb(n);return l?JSON.parse(l):(Md("Failed to decode base64 JWT payload"),null)}catch(l){return Md("Caught error parsing JWT payload as JSON",l?.toString()),null}}function L2(s){const e=Q0(s);return Re(e,"internal-error"),Re(typeof e.exp<"u","internal-error"),Re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Sc(s,e,n=!1){if(n)return e;try{return await e}catch(a){throw a instanceof na&&X5(a)&&s.auth.currentUser===s&&await s.auth.signOut(),a}}function X5({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class Z5{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const a=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class x0{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=bc(this.lastLoginAt),this.creationTime=bc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Yd(s){const e=s.auth,n=await s.getIdToken(),a=await Sc(s,Qd(e,{idToken:n}));Re(a?.users.length,e,"internal-error");const l=a.users[0];s._notifyReloadListener(l);const u=l.providerUserInfo?.length?Cb(l.providerUserInfo):[],h=W5(s.providerData,u),p=s.isAnonymous,g=!(s.email&&l.passwordHash)&&!h?.length,x=p?g:!1,y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:h,metadata:new x0(l.createdAt,l.lastLoginAt),isAnonymous:x};Object.assign(s,y)}async function J5(s){const e=It(s);await Yd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function W5(s,e){return[...s.filter(a=>!e.some(l=>l.providerId===a.providerId)),...e]}function Cb(s){return s.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function eN(s,e){const n=await Tb(s,{},async()=>{const a=Pc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=s.config,h=await Ab(s,l,"/v1/token",`key=${u}`),p=await s._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:a};return s.emulatorConfig&&nl(s.emulatorConfig.host)&&(g.credentials="include"),Sb.fetch()(h,g)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function tN(s,e){return ra(s,"POST","/v2/accounts:revokeToken",sa(s,e))}class Bo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Re(e.idToken,"internal-error"),Re(typeof e.idToken<"u","internal-error"),Re(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):L2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Re(e.length!==0,"internal-error");const n=L2(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:a,refreshToken:l,expiresIn:u}=await eN(e,n);this.updateTokensAndExpiration(a,l,Number(u))}updateTokensAndExpiration(e,n,a){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+a*1e3}static fromJSON(e,n){const{refreshToken:a,accessToken:l,expirationTime:u}=n,h=new Bo;return a&&(Re(typeof a=="string","internal-error",{appName:e}),h.refreshToken=a),l&&(Re(typeof l=="string","internal-error",{appName:e}),h.accessToken=l),u&&(Re(typeof u=="number","internal-error",{appName:e}),h.expirationTime=u),h}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Bo,this.toJSON())}_performRefresh(){return qr("not implemented")}}function Ua(s,e){Re(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class Ps{constructor({uid:e,auth:n,stsTokenManager:a,...l}){this.providerId="firebase",this.proactiveRefresh=new Z5(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new x0(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const n=await Sc(this,this.stsTokenManager.getToken(this.auth,e));return Re(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return K5(this,e)}reload(){return J5(this)}_assign(e){this!==e&&(Re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ps({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let a=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),a=!0),n&&await Yd(this),await this.auth._persistUserIfCurrent(this),a&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(as(this.auth.app))return Promise.reject($r(this.auth));const e=await this.getIdToken();return await Sc(this,Y5(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const a=n.displayName??void 0,l=n.email??void 0,u=n.phoneNumber??void 0,h=n.photoURL??void 0,p=n.tenantId??void 0,g=n._redirectEventId??void 0,x=n.createdAt??void 0,y=n.lastLoginAt??void 0,{uid:v,emailVerified:_,isAnonymous:E,providerData:S,stsTokenManager:A}=n;Re(v&&A,e,"internal-error");const D=Bo.fromJSON(this.name,A);Re(typeof v=="string",e,"internal-error"),Ua(a,e.name),Ua(l,e.name),Re(typeof _=="boolean",e,"internal-error"),Re(typeof E=="boolean",e,"internal-error"),Ua(u,e.name),Ua(h,e.name),Ua(p,e.name),Ua(g,e.name),Ua(x,e.name),Ua(y,e.name);const L=new Ps({uid:v,auth:e,email:l,emailVerified:_,displayName:a,isAnonymous:E,photoURL:h,phoneNumber:u,tenantId:p,stsTokenManager:D,createdAt:x,lastLoginAt:y});return S&&Array.isArray(S)&&(L.providerData=S.map(B=>({...B}))),g&&(L._redirectEventId=g),L}static async _fromIdTokenResponse(e,n,a=!1){const l=new Bo;l.updateFromServerResponse(n);const u=new Ps({uid:n.localId,auth:e,stsTokenManager:l,isAnonymous:a});return await Yd(u),u}static async _fromGetAccountInfoResponse(e,n,a){const l=n.users[0];Re(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?Cb(l.providerUserInfo):[],h=!(l.email&&l.passwordHash)&&!u?.length,p=new Bo;p.updateFromIdToken(a);const g=new Ps({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:h}),x={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new x0(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,x),g}}const U2=new Map;function Hr(s){Xr(s instanceof Function,"Expected a class definition");let e=U2.get(s);return e?(Xr(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,U2.set(s,e),e)}class Rb{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Rb.type="NONE";const z2=Rb;function kd(s,e,n){return`firebase:${s}:${e}:${n}`}class Fo{constructor(e,n,a){this.persistence=e,this.auth=n,this.userKey=a;const{config:l,name:u}=this.auth;this.fullUserKey=kd(this.userKey,l.apiKey,u),this.fullPersistenceKey=kd("persistence",l.apiKey,u),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Qd(this.auth,{idToken:e}).catch(()=>{});return n?Ps._fromGetAccountInfoResponse(this.auth,n,e):null}return Ps._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,a="authUser"){if(!n.length)return new Fo(Hr(z2),e,a);const l=(await Promise.all(n.map(async x=>{if(await x._isAvailable())return x}))).filter(x=>x);let u=l[0]||Hr(z2);const h=kd(a,e.config.apiKey,e.name);let p=null;for(const x of n)try{const y=await x._get(h);if(y){let v;if(typeof y=="string"){const _=await Qd(e,{idToken:y}).catch(()=>{});if(!_)break;v=await Ps._fromGetAccountInfoResponse(e,_,y)}else v=Ps._fromJSON(e,y);x!==u&&(p=v),u=x;break}}catch{}const g=l.filter(x=>x._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new Fo(u,e,a):(u=g[0],p&&await u._set(h,p.toJSON()),await Promise.all(n.map(async x=>{if(x!==u)try{await x._remove(h)}catch{}})),new Fo(u,e,a))}}function B2(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(kb(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Db(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Ob(e))return"Blackberry";if(Pb(e))return"Webos";if(Ib(e))return"Safari";if((e.includes("chrome/")||Mb(e))&&!e.includes("edge/"))return"Chrome";if(Vb(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,a=s.match(n);if(a?.length===2)return a[1]}return"Other"}function Db(s=Sn()){return/firefox\//i.test(s)}function Ib(s=Sn()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Mb(s=Sn()){return/crios\//i.test(s)}function kb(s=Sn()){return/iemobile/i.test(s)}function Vb(s=Sn()){return/android/i.test(s)}function Ob(s=Sn()){return/blackberry/i.test(s)}function Pb(s=Sn()){return/webos/i.test(s)}function Y0(s=Sn()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function nN(s=Sn()){return Y0(s)&&!!window.navigator?.standalone}function sN(){return p6()&&document.documentMode===10}function Lb(s=Sn()){return Y0(s)||Vb(s)||Pb(s)||Ob(s)||/windows phone/i.test(s)||kb(s)}function Ub(s,e=[]){let n;switch(s){case"Browser":n=B2(Sn());break;case"Worker":n=`${B2(Sn())}-${s}`;break;default:n=s}const a=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${sl}/${a}`}class rN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const a=u=>new Promise((h,p)=>{try{const g=e(u);h(g)}catch(g){p(g)}});a.onAbort=n,this.queue.push(a);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const a of this.queue)await a(e),a.onAbort&&n.push(a.onAbort)}catch(a){n.reverse();for(const l of n)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:a?.message})}}}async function aN(s,e={}){return ra(s,"GET","/v2/passwordPolicy",sa(s,e))}const iN=6;class oN{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??iN,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const a=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;a&&(n.meetsMinPasswordLength=e.length>=a),l&&(n.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let a;for(let l=0;l<e.length;l++)a=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(n,a>="a"&&a<="z",a>="A"&&a<="Z",a>="0"&&a<="9",this.allowedNonAlphanumericCharacters.includes(a))}updatePasswordCharacterOptionsStatuses(e,n,a,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=a)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class lN{constructor(e,n,a,l){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=a,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new F2(this),this.idTokenSubscription=new F2(this),this.beforeStateQueue=new rN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=jb,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Hr(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Fo.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Qd(this,{idToken:e}),a=await Ps._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(a)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(as(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(h,h))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let a=n,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,h=a?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===h)&&p?.user&&(a=p.user,l=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(a)}catch(u){a=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return Re(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Yd(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=z5()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(as(this.app))return Promise.reject($r(this));const n=e?It(e):null;return n&&Re(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return as(this.app)?Promise.reject($r(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return as(this.app)?Promise.reject($r(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Hr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await aN(this),n=new oN(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Oc("auth","Firebase",e())}onAuthStateChanged(e,n,a){return this.registerStateListener(this.authStateSubscription,e,n,a)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,a){return this.registerStateListener(this.idTokenSubscription,e,n,a)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const a=this.onAuthStateChanged(()=>{a(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),a={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(a.tenantId=this.tenantId),await tN(this,a)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const a=await this.getOrInitRedirectPersistenceManager(n);return e===null?a.removeCurrentUser():a.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Hr(e)||this._popupRedirectResolver;Re(n,this,"argument-error"),this.redirectPersistenceManager=await Fo.create(this,[Hr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,a,l){if(this._deleted)return()=>{};const u=typeof n=="function"?n:n.next.bind(n);let h=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(Re(p,this,"internal-error"),p.then(()=>{h||u(this.currentUser)}),typeof n=="function"){const g=e.addObserver(n,a,l);return()=>{h=!0,g()}}else{const g=e.addObserver(n);return()=>{h=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ub(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const a=await this._getAppCheckToken();return a&&(e["X-Firebase-AppCheck"]=a),e}async _getAppCheckToken(){if(as(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&O5(`Error while retrieving App Check token: ${e.error}`),e?.token}}function aa(s){return It(s)}class F2{constructor(e){this.auth=e,this.observer=null,this.addObserver=E6(n=>this.observer=n)}get next(){return Re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let yh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function cN(s){yh=s}function zb(s){return yh.loadJS(s)}function uN(){return yh.recaptchaEnterpriseScript}function dN(){return yh.gapiScript}function hN(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class fN{constructor(){this.enterprise=new mN}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class mN{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const gN="recaptcha-enterprise",Bb="NO_RECAPTCHA";class pN{constructor(e){this.type=gN,this.auth=aa(e)}async verify(e="verify",n=!1){async function a(u){if(!n){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(h,p)=>{Q5(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const x=new $5(g);return u.tenantId==null?u._agentRecaptchaConfig=x:u._tenantRecaptchaConfigs[u.tenantId]=x,h(x.siteKey)}}).catch(g=>{p(g)})})}function l(u,h,p){const g=window.grecaptcha;P2(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(x=>{h(x)}).catch(()=>{h(Bb)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new fN().execute("siteKey",{action:"verify"}):new Promise((u,h)=>{a(this.auth).then(p=>{if(!n&&P2(window.grecaptcha))l(p,u,h);else{if(typeof window>"u"){h(new Error("RecaptchaVerifier is only supported in browser"));return}let g=uN();g.length!==0&&(g+=p),zb(g).then(()=>{l(p,u,h)}).catch(x=>{h(x)})}}).catch(p=>{h(p)})})}}async function q2(s,e,n,a=!1,l=!1){const u=new pN(s);let h;if(l)h=Bb;else try{h=await u.verify(n)}catch{h=await u.verify(n,!0)}const p={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,x=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:x,captchaResponse:h,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:h,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return a?Object.assign(p,{captchaResp:h}):Object.assign(p,{captchaResponse:h}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Kd(s,e,n,a,l){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await q2(s,e,n,n==="getOobCode");return a(s,u)}else return a(s,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const h=await q2(s,e,n,n==="getOobCode");return a(s,h)}else return Promise.reject(u)})}function xN(s,e){const n=q0(s,"auth");if(n.isInitialized()){const l=n.getImmediate(),u=n.getOptions();if(Yr(u,e??{}))return l;Ns(l,"already-initialized")}return n.initialize({options:e})}function yN(s,e){const n=e?.persistence||[],a=(Array.isArray(n)?n:[n]).map(Hr);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(a,e?.popupRedirectResolver)}function bN(s,e,n){const a=aa(s);Re(/^https?:\/\//.test(e),a,"invalid-emulator-scheme");const l=!1,u=Fb(e),{host:h,port:p}=vN(e),g=p===null?"":`:${p}`,x={url:`${u}//${h}${g}/`},y=Object.freeze({host:h,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!a._canInitEmulator){Re(a.config.emulator&&a.emulatorConfig,a,"emulator-config-failed"),Re(Yr(x,a.config.emulator)&&Yr(y,a.emulatorConfig),a,"emulator-config-failed");return}a.config.emulator=x,a.emulatorConfig=y,a.settings.appVerificationDisabledForTesting=!0,nl(h)?(pb(`${u}//${h}${g}`),xb("Auth",!0)):wN()}function Fb(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function vN(s){const e=Fb(s),n=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!n)return{host:"",port:null};const a=n[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(a);if(l){const u=l[1];return{host:u,port:H2(a.substr(u.length+1))}}else{const[u,h]=a.split(":");return{host:u,port:H2(h)}}}function H2(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function wN(){function s(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class K0{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return qr("not implemented")}_getIdTokenResponse(e){return qr("not implemented")}_linkToIdToken(e,n){return qr("not implemented")}_getReauthenticationResolver(e){return qr("not implemented")}}async function _N(s,e){return ra(s,"POST","/v1/accounts:signUp",e)}async function NN(s,e){return Uc(s,"POST","/v1/accounts:signInWithPassword",sa(s,e))}async function qb(s,e){return ra(s,"POST","/v1/accounts:sendOobCode",sa(s,e))}async function EN(s,e){return qb(s,e)}async function jN(s,e){return qb(s,e)}async function SN(s,e){return Uc(s,"POST","/v1/accounts:signInWithEmailLink",sa(s,e))}async function TN(s,e){return Uc(s,"POST","/v1/accounts:signInWithEmailLink",sa(s,e))}class Tc extends K0{constructor(e,n,a,l=null){super("password",a),this._email=e,this._password=n,this._tenantId=l}static _fromEmailAndPassword(e,n){return new Tc(e,n,"password")}static _fromEmailAndCode(e,n,a=null){return new Tc(e,n,"emailLink",a)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Kd(e,n,"signInWithPassword",NN);case"emailLink":return SN(e,{email:this._email,oobCode:this._password});default:Ns(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const a={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Kd(e,a,"signUpPassword",_N);case"emailLink":return TN(e,{idToken:n,email:this._email,oobCode:this._password});default:Ns(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function qo(s,e){return Uc(s,"POST","/v1/accounts:signInWithIdp",sa(s,e))}const AN="http://localhost";class Ui extends K0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ui(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Ns("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:a,signInMethod:l,...u}=n;if(!a||!l)return null;const h=new Ui(a,l);return h.idToken=u.idToken||void 0,h.accessToken=u.accessToken||void 0,h.secret=u.secret,h.nonce=u.nonce,h.pendingToken=u.pendingToken||null,h}_getIdTokenResponse(e){const n=this.buildRequest();return qo(e,n)}_linkToIdToken(e,n){const a=this.buildRequest();return a.idToken=n,qo(e,a)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,qo(e,n)}buildRequest(){const e={requestUri:AN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Pc(n)}return e}}function CN(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function RN(s){const e=hc(fc(s)).link,n=e?hc(fc(e)).deep_link_id:null,a=hc(fc(s)).deep_link_id;return(a?hc(fc(a)).link:null)||a||n||e||s}class X0{constructor(e){const n=hc(fc(e)),a=n.apiKey??null,l=n.oobCode??null,u=CN(n.mode??null);Re(a&&l&&u,"argument-error"),this.apiKey=a,this.operation=u,this.code=l,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=RN(e);try{return new X0(n)}catch{return null}}}class rl{constructor(){this.providerId=rl.PROVIDER_ID}static credential(e,n){return Tc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const a=X0.parseLink(n);return Re(a,"argument-error"),Tc._fromEmailAndCode(e,a.code,a.tenantId)}}rl.PROVIDER_ID="password";rl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";rl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Z0{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class zc extends Z0{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class za extends zc{constructor(){super("facebook.com")}static credential(e){return Ui._fromParams({providerId:za.PROVIDER_ID,signInMethod:za.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return za.credentialFromTaggedObject(e)}static credentialFromError(e){return za.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return za.credential(e.oauthAccessToken)}catch{return null}}}za.FACEBOOK_SIGN_IN_METHOD="facebook.com";za.PROVIDER_ID="facebook.com";class Fr extends zc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ui._fromParams({providerId:Fr.PROVIDER_ID,signInMethod:Fr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Fr.credentialFromTaggedObject(e)}static credentialFromError(e){return Fr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:a}=e;if(!n&&!a)return null;try{return Fr.credential(n,a)}catch{return null}}}Fr.GOOGLE_SIGN_IN_METHOD="google.com";Fr.PROVIDER_ID="google.com";class Ba extends zc{constructor(){super("github.com")}static credential(e){return Ui._fromParams({providerId:Ba.PROVIDER_ID,signInMethod:Ba.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ba.credentialFromTaggedObject(e)}static credentialFromError(e){return Ba.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ba.credential(e.oauthAccessToken)}catch{return null}}}Ba.GITHUB_SIGN_IN_METHOD="github.com";Ba.PROVIDER_ID="github.com";class Fa extends zc{constructor(){super("twitter.com")}static credential(e,n){return Ui._fromParams({providerId:Fa.PROVIDER_ID,signInMethod:Fa.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Fa.credentialFromTaggedObject(e)}static credentialFromError(e){return Fa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:a}=e;if(!n||!a)return null;try{return Fa.credential(n,a)}catch{return null}}}Fa.TWITTER_SIGN_IN_METHOD="twitter.com";Fa.PROVIDER_ID="twitter.com";async function DN(s,e){return Uc(s,"POST","/v1/accounts:signUp",sa(s,e))}class zi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,a,l=!1){const u=await Ps._fromIdTokenResponse(e,a,l),h=G2(a);return new zi({user:u,providerId:h,_tokenResponse:a,operationType:n})}static async _forOperation(e,n,a){await e._updateTokensIfNecessary(a,!0);const l=G2(a);return new zi({user:e,providerId:l,_tokenResponse:a,operationType:n})}}function G2(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class Xd extends na{constructor(e,n,a,l){super(n.code,n.message),this.operationType=a,this.user=l,Object.setPrototypeOf(this,Xd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:a}}static _fromErrorAndOperation(e,n,a,l){return new Xd(e,n,a,l)}}function Hb(s,e,n,a){return(e==="reauthenticate"?n._getReauthenticationResolver(s):n._getIdTokenResponse(s)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Xd._fromErrorAndOperation(s,u,e,a):u})}async function IN(s,e,n=!1){const a=await Sc(s,e._linkToIdToken(s.auth,await s.getIdToken()),n);return zi._forOperation(s,"link",a)}async function MN(s,e,n=!1){const{auth:a}=s;if(as(a.app))return Promise.reject($r(a));const l="reauthenticate";try{const u=await Sc(s,Hb(a,l,e,s),n);Re(u.idToken,a,"internal-error");const h=Q0(u.idToken);Re(h,a,"internal-error");const{sub:p}=h;return Re(s.uid===p,a,"user-mismatch"),zi._forOperation(s,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&Ns(a,"user-mismatch"),u}}async function Gb(s,e,n=!1){if(as(s.app))return Promise.reject($r(s));const a="signIn",l=await Hb(s,a,e),u=await zi._fromIdTokenResponse(s,a,l);return n||await s._updateCurrentUser(u.user),u}async function kN(s,e){return Gb(aa(s),e)}async function $b(s){const e=aa(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function VN(s,e,n){const a=aa(s);await Kd(a,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",jN)}async function ON(s,e,n){if(as(s.app))return Promise.reject($r(s));const a=aa(s),h=await Kd(a,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",DN).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&$b(s),g}),p=await zi._fromIdTokenResponse(a,"signIn",h);return await a._updateCurrentUser(p.user),p}function PN(s,e,n){return as(s.app)?Promise.reject($r(s)):kN(It(s),rl.credential(e,n)).catch(async a=>{throw a.code==="auth/password-does-not-meet-requirements"&&$b(s),a})}async function $2(s,e){const n=It(s),l={requestType:"VERIFY_EMAIL",idToken:await s.getIdToken()},{email:u}=await EN(n.auth,l);u!==s.email&&await s.reload()}function LN(s,e,n,a){return It(s).onIdTokenChanged(e,n,a)}function UN(s,e,n){return It(s).beforeAuthStateChanged(e,n)}function Bc(s,e,n,a){return It(s).onAuthStateChanged(e,n,a)}function Qb(s){return It(s).signOut()}async function J0(s){return It(s).delete()}const Zd="__sak";class Yb{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Zd,"1"),this.storage.removeItem(Zd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const zN=1e3,BN=10;class Kb extends Yb{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Lb(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const a=this.storage.getItem(n),l=this.localCache[n];a!==l&&e(n,l,a)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((h,p,g)=>{this.notifyListeners(h,g)});return}const a=e.key;n?this.detachListener():this.stopPolling();const l=()=>{const h=this.storage.getItem(a);!n&&this.localCache[a]===h||this.notifyListeners(a,h)},u=this.storage.getItem(a);sN()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,BN):l()}notifyListeners(e,n){this.localCache[e]=n;const a=this.listeners[e];if(a)for(const l of Array.from(a))l(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,a)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:a}),!0)})},zN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Kb.type="LOCAL";const FN=Kb;class Xb extends Yb{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Xb.type="SESSION";const Zb=Xb;function qN(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class bh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(l=>l.isListeningto(e));if(n)return n;const a=new bh(e);return this.receivers.push(a),a}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:a,eventType:l,data:u}=n.data,h=this.handlersMap[l];if(!h?.size)return;n.ports[0].postMessage({status:"ack",eventId:a,eventType:l});const p=Array.from(h).map(async x=>x(n.origin,u)),g=await qN(p);n.ports[0].postMessage({status:"done",eventId:a,eventType:l,response:g})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}bh.receivers=[];function W0(s="",e=10){let n="";for(let a=0;a<e;a++)n+=Math.floor(Math.random()*10);return s+n}class HN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,a=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,h;return new Promise((p,g)=>{const x=W0("",20);l.port1.start();const y=setTimeout(()=>{g(new Error("unsupported_event"))},a);h={messageChannel:l,onMessage(v){const _=v;if(_.data.eventId===x)switch(_.data.status){case"ack":clearTimeout(y),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(_.data.response);break;default:clearTimeout(y),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(h),l.port1.addEventListener("message",h.onMessage),this.target.postMessage({eventType:e,eventId:x,data:n},[l.port2])}).finally(()=>{h&&this.removeMessageHandler(h)})}}function cr(){return window}function GN(s){cr().location.href=s}function Jb(){return typeof cr().WorkerGlobalScope<"u"&&typeof cr().importScripts=="function"}async function $N(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function QN(){return navigator?.serviceWorker?.controller||null}function YN(){return Jb()?self:null}const Wb="firebaseLocalStorageDb",KN=1,Jd="firebaseLocalStorage",ev="fbase_key";class Fc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function vh(s,e){return s.transaction([Jd],e?"readwrite":"readonly").objectStore(Jd)}function XN(){const s=indexedDB.deleteDatabase(Wb);return new Fc(s).toPromise()}function y0(){const s=indexedDB.open(Wb,KN);return new Promise((e,n)=>{s.addEventListener("error",()=>{n(s.error)}),s.addEventListener("upgradeneeded",()=>{const a=s.result;try{a.createObjectStore(Jd,{keyPath:ev})}catch(l){n(l)}}),s.addEventListener("success",async()=>{const a=s.result;a.objectStoreNames.contains(Jd)?e(a):(a.close(),await XN(),e(await y0()))})})}async function Q2(s,e,n){const a=vh(s,!0).put({[ev]:e,value:n});return new Fc(a).toPromise()}async function ZN(s,e){const n=vh(s,!1).get(e),a=await new Fc(n).toPromise();return a===void 0?null:a.value}function Y2(s,e){const n=vh(s,!0).delete(e);return new Fc(n).toPromise()}const JN=800,WN=3;class tv{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await y0(),this.db)}async _withRetries(e){let n=0;for(;;)try{const a=await this._openDb();return await e(a)}catch(a){if(n++>WN)throw a;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Jb()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=bh._getInstance(YN()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await $N(),!this.activeServiceWorker)return;this.sender=new HN(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||QN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await y0();return await Q2(e,Zd,"1"),await Y2(e,Zd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(a=>Q2(a,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(a=>ZN(a,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Y2(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=vh(l,!1).getAll();return new Fc(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],a=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)a.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),n.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!a.has(l)&&(this.notifyListeners(l,null),n.push(l));return n}notifyListeners(e,n){this.localCache[e]=n;const a=this.listeners[e];if(a)for(const l of Array.from(a))l(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),JN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}tv.type="LOCAL";const e3=tv;new Lc(3e4,6e4);function nv(s,e){return e?Hr(e):(Re(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class eg extends K0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return qo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return qo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return qo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function t3(s){return Gb(s.auth,new eg(s),s.bypassAuthState)}function n3(s){const{auth:e,user:n}=s;return Re(n,e,"internal-error"),MN(n,new eg(s),s.bypassAuthState)}async function s3(s){const{auth:e,user:n}=s;return Re(n,e,"internal-error"),IN(n,new eg(s),s.bypassAuthState)}class sv{constructor(e,n,a,l,u=!1){this.auth=e,this.resolver=a,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(a){this.reject(a)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:a,postBody:l,tenantId:u,error:h,type:p}=e;if(h){this.reject(h);return}const g={auth:this.auth,requestUri:n,sessionId:a,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(x){this.reject(x)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return t3;case"linkViaPopup":case"linkViaRedirect":return s3;case"reauthViaPopup":case"reauthViaRedirect":return n3;default:Ns(this.auth,"internal-error")}}resolve(e){Xr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Xr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const r3=new Lc(2e3,1e4);async function rv(s,e,n){if(as(s.app))return Promise.reject(Ls(s,"operation-not-supported-in-this-environment"));const a=aa(s);P5(s,e,Z0);const l=nv(a,n);return new ki(a,"signInViaPopup",e,l).executeNotNull()}class ki extends sv{constructor(e,n,a,l,u){super(e,n,l,u),this.provider=a,this.authWindow=null,this.pollId=null,ki.currentPopupAction&&ki.currentPopupAction.cancel(),ki.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Re(e,this.auth,"internal-error"),e}async onExecution(){Xr(this.filter.length===1,"Popup operations only handle one event");const e=W0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Ls(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ls(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ki.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ls(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,r3.get())};e()}}ki.currentPopupAction=null;const a3="pendingRedirect",Vd=new Map;class i3 extends sv{constructor(e,n,a=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,a),this.eventId=null}async execute(){let e=Vd.get(this.auth._key());if(!e){try{const a=await o3(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(a)}catch(n){e=()=>Promise.reject(n)}Vd.set(this.auth._key(),e)}return this.bypassAuthState||Vd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function o3(s,e){const n=u3(e),a=c3(s);if(!await a._isAvailable())return!1;const l=await a._get(n)==="true";return await a._remove(n),l}function l3(s,e){Vd.set(s._key(),e)}function c3(s){return Hr(s._redirectPersistence)}function u3(s){return kd(a3,s.config.apiKey,s.name)}async function d3(s,e,n=!1){if(as(s.app))return Promise.reject($r(s));const a=aa(s),l=nv(a,e),h=await new i3(a,l,n).execute();return h&&!n&&(delete h.user._redirectEventId,await a._persistUserIfCurrent(h.user),await a._setRedirectUser(null,e)),h}const h3=600*1e3;class f3{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(a=>{this.isEventForConsumer(e,a)&&(n=!0,this.sendToConsumer(e,a),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!m3(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!av(e)){const a=e.error.code?.split("auth/")[1]||"internal-error";n.onError(Ls(this.auth,a))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const a=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&a}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=h3&&this.cachedEventUids.clear(),this.cachedEventUids.has(K2(e))}saveEventToCache(e){this.cachedEventUids.add(K2(e)),this.lastProcessedEventTime=Date.now()}}function K2(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function av({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function m3(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return av(s);default:return!1}}async function g3(s,e={}){return ra(s,"GET","/v1/projects",e)}const p3=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,x3=/^https?/;async function y3(s){if(s.config.emulator)return;const{authorizedDomains:e}=await g3(s);for(const n of e)try{if(b3(n))return}catch{}Ns(s,"unauthorized-domain")}function b3(s){const e=p0(),{protocol:n,hostname:a}=new URL(e);if(s.startsWith("chrome-extension://")){const h=new URL(s);return h.hostname===""&&a===""?n==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&h.hostname===a}if(!x3.test(n))return!1;if(p3.test(s))return a===s;const l=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(a)}const v3=new Lc(3e4,6e4);function X2(){const s=cr().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let n=0;n<s.CP.length;n++)s.CP[n]=null}}function w3(s){return new Promise((e,n)=>{function a(){X2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{X2(),n(Ls(s,"network-request-failed"))},timeout:v3.get()})}if(cr().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(cr().gapi?.load)a();else{const l=hN("iframefcb");return cr()[l]=()=>{gapi.load?a():n(Ls(s,"network-request-failed"))},zb(`${dN()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw Od=null,e})}let Od=null;function _3(s){return Od=Od||w3(s),Od}const N3=new Lc(5e3,15e3),E3="__/auth/iframe",j3="emulator/auth/iframe",S3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},T3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function A3(s){const e=s.config;Re(e.authDomain,s,"auth-domain-config-required");const n=e.emulator?$0(e,j3):`https://${s.config.authDomain}/${E3}`,a={apiKey:e.apiKey,appName:s.name,v:sl},l=T3.get(s.config.apiHost);l&&(a.eid=l);const u=s._getFrameworks();return u.length&&(a.fw=u.join(",")),`${n}?${Pc(a).slice(1)}`}async function C3(s){const e=await _3(s),n=cr().gapi;return Re(n,s,"internal-error"),e.open({where:document.body,url:A3(s),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:S3,dontclear:!0},a=>new Promise(async(l,u)=>{await a.restyle({setHideOnLeave:!1});const h=Ls(s,"network-request-failed"),p=cr().setTimeout(()=>{u(h)},N3.get());function g(){cr().clearTimeout(p),l(a)}a.ping(g).then(g,()=>{u(h)})}))}const R3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},D3=500,I3=600,M3="_blank",k3="http://localhost";class Z2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function V3(s,e,n,a=D3,l=I3){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),h=Math.max((window.screen.availWidth-a)/2,0).toString();let p="";const g={...R3,width:a.toString(),height:l.toString(),top:u,left:h},x=Sn().toLowerCase();n&&(p=Mb(x)?M3:n),Db(x)&&(e=e||k3,g.scrollbars="yes");const y=Object.entries(g).reduce((_,[E,S])=>`${_}${E}=${S},`,"");if(nN(x)&&p!=="_self")return O3(e||"",p),new Z2(null);const v=window.open(e||"",p,y);Re(v,s,"popup-blocked");try{v.focus()}catch{}return new Z2(v)}function O3(s,e){const n=document.createElement("a");n.href=s,n.target=e;const a=document.createEvent("MouseEvent");a.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(a)}const P3="__/auth/handler",L3="emulator/auth/handler",U3=encodeURIComponent("fac");async function J2(s,e,n,a,l,u){Re(s.config.authDomain,s,"auth-domain-config-required"),Re(s.config.apiKey,s,"invalid-api-key");const h={apiKey:s.config.apiKey,appName:s.name,authType:n,redirectUrl:a,v:sl,eventId:l};if(e instanceof Z0){e.setDefaultLanguage(s.languageCode),h.providerId=e.providerId||"",N6(e.getCustomParameters())||(h.customParameters=JSON.stringify(e.getCustomParameters()));for(const[y,v]of Object.entries({}))h[y]=v}if(e instanceof zc){const y=e.getScopes().filter(v=>v!=="");y.length>0&&(h.scopes=y.join(","))}s.tenantId&&(h.tid=s.tenantId);const p=h;for(const y of Object.keys(p))p[y]===void 0&&delete p[y];const g=await s._getAppCheckToken(),x=g?`#${U3}=${encodeURIComponent(g)}`:"";return`${z3(s)}?${Pc(p).slice(1)}${x}`}function z3({config:s}){return s.emulator?$0(s,L3):`https://${s.authDomain}/${P3}`}const r0="webStorageSupport";class B3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Zb,this._completeRedirectFn=d3,this._overrideRedirectResult=l3}async _openPopup(e,n,a,l){Xr(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await J2(e,n,a,p0(),l);return V3(e,u,W0())}async _openRedirect(e,n,a,l){await this._originValidation(e);const u=await J2(e,n,a,p0(),l);return GN(u),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:l,promise:u}=this.eventManagers[n];return l?Promise.resolve(l):(Xr(u,"If manager is not set, promise should be"),u)}const a=this.initAndGetManager(e);return this.eventManagers[n]={promise:a},a.catch(()=>{delete this.eventManagers[n]}),a}async initAndGetManager(e){const n=await C3(e),a=new f3(e);return n.register("authEvent",l=>(Re(l?.authEvent,e,"invalid-auth-event"),{status:a.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:a},this.iframes[e._key()]=n,a}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(r0,{type:r0},l=>{const u=l?.[0]?.[r0];u!==void 0&&n(!!u),Ns(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=y3(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Lb()||Ib()||Y0()}}const F3=B3;var W2="@firebase/auth",e1="1.11.1";class q3{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(a=>{e(a?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function H3(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function G3(s){Go(new Li("auth",(e,{options:n})=>{const a=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:h,authDomain:p}=a.options;Re(h&&!h.includes(":"),"invalid-api-key",{appName:a.name});const g={apiKey:h,authDomain:p,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ub(s)},x=new lN(a,l,u,g);return yN(x,n),x},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,a)=>{e.getProvider("auth-internal").initialize()})),Go(new Li("auth-internal",e=>{const n=aa(e.getProvider("auth").getImmediate());return(a=>new q3(a))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ya(W2,e1,H3(s)),Ya(W2,e1,"esm2020")}const $3=300,Q3=gb("authIdTokenMaxAge")||$3;let t1=null;const Y3=s=>async e=>{const n=e&&await e.getIdTokenResult(),a=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(a&&a>Q3)return;const l=n?.token;t1!==l&&(t1=l,await fetch(s,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function K3(s=wb()){const e=q0(s,"auth");if(e.isInitialized())return e.getImmediate();const n=xN(s,{popupRedirectResolver:F3,persistence:[e3,FN,Zb]}),a=gb("authTokenSyncURL");if(a&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(a,location.origin);if(location.origin===u.origin){const h=Y3(u.toString());UN(n,h,()=>h(n.currentUser)),LN(n,p=>h(p))}}const l=fb("auth");return l&&bN(n,`http://${l}`),n}function X3(){return document.getElementsByTagName("head")?.[0]??document}cN({loadJS(s){return new Promise((e,n)=>{const a=document.createElement("script");a.setAttribute("src",s),a.onload=e,a.onerror=l=>{const u=Ls("internal-error");u.customData=l,n(u)},a.type="text/javascript",a.charset="UTF-8",X3().appendChild(a)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});G3("Browser");var Z3="firebase",J3="12.6.0";Ya(Z3,J3,"app");var n1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ka,iv;(function(){var s;function e(R,j){function C(){}C.prototype=j.prototype,R.F=j.prototype,R.prototype=new C,R.prototype.constructor=R,R.D=function(O,P,U){for(var M=Array(arguments.length-2),ue=2;ue<arguments.length;ue++)M[ue-2]=arguments[ue];return j.prototype[P].apply(O,M)}}function n(){this.blockSize=-1}function a(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(a,n),a.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(R,j,C){C||(C=0);const O=Array(16);if(typeof j=="string")for(var P=0;P<16;++P)O[P]=j.charCodeAt(C++)|j.charCodeAt(C++)<<8|j.charCodeAt(C++)<<16|j.charCodeAt(C++)<<24;else for(P=0;P<16;++P)O[P]=j[C++]|j[C++]<<8|j[C++]<<16|j[C++]<<24;j=R.g[0],C=R.g[1],P=R.g[2];let U=R.g[3],M;M=j+(U^C&(P^U))+O[0]+3614090360&4294967295,j=C+(M<<7&4294967295|M>>>25),M=U+(P^j&(C^P))+O[1]+3905402710&4294967295,U=j+(M<<12&4294967295|M>>>20),M=P+(C^U&(j^C))+O[2]+606105819&4294967295,P=U+(M<<17&4294967295|M>>>15),M=C+(j^P&(U^j))+O[3]+3250441966&4294967295,C=P+(M<<22&4294967295|M>>>10),M=j+(U^C&(P^U))+O[4]+4118548399&4294967295,j=C+(M<<7&4294967295|M>>>25),M=U+(P^j&(C^P))+O[5]+1200080426&4294967295,U=j+(M<<12&4294967295|M>>>20),M=P+(C^U&(j^C))+O[6]+2821735955&4294967295,P=U+(M<<17&4294967295|M>>>15),M=C+(j^P&(U^j))+O[7]+4249261313&4294967295,C=P+(M<<22&4294967295|M>>>10),M=j+(U^C&(P^U))+O[8]+1770035416&4294967295,j=C+(M<<7&4294967295|M>>>25),M=U+(P^j&(C^P))+O[9]+2336552879&4294967295,U=j+(M<<12&4294967295|M>>>20),M=P+(C^U&(j^C))+O[10]+4294925233&4294967295,P=U+(M<<17&4294967295|M>>>15),M=C+(j^P&(U^j))+O[11]+2304563134&4294967295,C=P+(M<<22&4294967295|M>>>10),M=j+(U^C&(P^U))+O[12]+1804603682&4294967295,j=C+(M<<7&4294967295|M>>>25),M=U+(P^j&(C^P))+O[13]+4254626195&4294967295,U=j+(M<<12&4294967295|M>>>20),M=P+(C^U&(j^C))+O[14]+2792965006&4294967295,P=U+(M<<17&4294967295|M>>>15),M=C+(j^P&(U^j))+O[15]+1236535329&4294967295,C=P+(M<<22&4294967295|M>>>10),M=j+(P^U&(C^P))+O[1]+4129170786&4294967295,j=C+(M<<5&4294967295|M>>>27),M=U+(C^P&(j^C))+O[6]+3225465664&4294967295,U=j+(M<<9&4294967295|M>>>23),M=P+(j^C&(U^j))+O[11]+643717713&4294967295,P=U+(M<<14&4294967295|M>>>18),M=C+(U^j&(P^U))+O[0]+3921069994&4294967295,C=P+(M<<20&4294967295|M>>>12),M=j+(P^U&(C^P))+O[5]+3593408605&4294967295,j=C+(M<<5&4294967295|M>>>27),M=U+(C^P&(j^C))+O[10]+38016083&4294967295,U=j+(M<<9&4294967295|M>>>23),M=P+(j^C&(U^j))+O[15]+3634488961&4294967295,P=U+(M<<14&4294967295|M>>>18),M=C+(U^j&(P^U))+O[4]+3889429448&4294967295,C=P+(M<<20&4294967295|M>>>12),M=j+(P^U&(C^P))+O[9]+568446438&4294967295,j=C+(M<<5&4294967295|M>>>27),M=U+(C^P&(j^C))+O[14]+3275163606&4294967295,U=j+(M<<9&4294967295|M>>>23),M=P+(j^C&(U^j))+O[3]+4107603335&4294967295,P=U+(M<<14&4294967295|M>>>18),M=C+(U^j&(P^U))+O[8]+1163531501&4294967295,C=P+(M<<20&4294967295|M>>>12),M=j+(P^U&(C^P))+O[13]+2850285829&4294967295,j=C+(M<<5&4294967295|M>>>27),M=U+(C^P&(j^C))+O[2]+4243563512&4294967295,U=j+(M<<9&4294967295|M>>>23),M=P+(j^C&(U^j))+O[7]+1735328473&4294967295,P=U+(M<<14&4294967295|M>>>18),M=C+(U^j&(P^U))+O[12]+2368359562&4294967295,C=P+(M<<20&4294967295|M>>>12),M=j+(C^P^U)+O[5]+4294588738&4294967295,j=C+(M<<4&4294967295|M>>>28),M=U+(j^C^P)+O[8]+2272392833&4294967295,U=j+(M<<11&4294967295|M>>>21),M=P+(U^j^C)+O[11]+1839030562&4294967295,P=U+(M<<16&4294967295|M>>>16),M=C+(P^U^j)+O[14]+4259657740&4294967295,C=P+(M<<23&4294967295|M>>>9),M=j+(C^P^U)+O[1]+2763975236&4294967295,j=C+(M<<4&4294967295|M>>>28),M=U+(j^C^P)+O[4]+1272893353&4294967295,U=j+(M<<11&4294967295|M>>>21),M=P+(U^j^C)+O[7]+4139469664&4294967295,P=U+(M<<16&4294967295|M>>>16),M=C+(P^U^j)+O[10]+3200236656&4294967295,C=P+(M<<23&4294967295|M>>>9),M=j+(C^P^U)+O[13]+681279174&4294967295,j=C+(M<<4&4294967295|M>>>28),M=U+(j^C^P)+O[0]+3936430074&4294967295,U=j+(M<<11&4294967295|M>>>21),M=P+(U^j^C)+O[3]+3572445317&4294967295,P=U+(M<<16&4294967295|M>>>16),M=C+(P^U^j)+O[6]+76029189&4294967295,C=P+(M<<23&4294967295|M>>>9),M=j+(C^P^U)+O[9]+3654602809&4294967295,j=C+(M<<4&4294967295|M>>>28),M=U+(j^C^P)+O[12]+3873151461&4294967295,U=j+(M<<11&4294967295|M>>>21),M=P+(U^j^C)+O[15]+530742520&4294967295,P=U+(M<<16&4294967295|M>>>16),M=C+(P^U^j)+O[2]+3299628645&4294967295,C=P+(M<<23&4294967295|M>>>9),M=j+(P^(C|~U))+O[0]+4096336452&4294967295,j=C+(M<<6&4294967295|M>>>26),M=U+(C^(j|~P))+O[7]+1126891415&4294967295,U=j+(M<<10&4294967295|M>>>22),M=P+(j^(U|~C))+O[14]+2878612391&4294967295,P=U+(M<<15&4294967295|M>>>17),M=C+(U^(P|~j))+O[5]+4237533241&4294967295,C=P+(M<<21&4294967295|M>>>11),M=j+(P^(C|~U))+O[12]+1700485571&4294967295,j=C+(M<<6&4294967295|M>>>26),M=U+(C^(j|~P))+O[3]+2399980690&4294967295,U=j+(M<<10&4294967295|M>>>22),M=P+(j^(U|~C))+O[10]+4293915773&4294967295,P=U+(M<<15&4294967295|M>>>17),M=C+(U^(P|~j))+O[1]+2240044497&4294967295,C=P+(M<<21&4294967295|M>>>11),M=j+(P^(C|~U))+O[8]+1873313359&4294967295,j=C+(M<<6&4294967295|M>>>26),M=U+(C^(j|~P))+O[15]+4264355552&4294967295,U=j+(M<<10&4294967295|M>>>22),M=P+(j^(U|~C))+O[6]+2734768916&4294967295,P=U+(M<<15&4294967295|M>>>17),M=C+(U^(P|~j))+O[13]+1309151649&4294967295,C=P+(M<<21&4294967295|M>>>11),M=j+(P^(C|~U))+O[4]+4149444226&4294967295,j=C+(M<<6&4294967295|M>>>26),M=U+(C^(j|~P))+O[11]+3174756917&4294967295,U=j+(M<<10&4294967295|M>>>22),M=P+(j^(U|~C))+O[2]+718787259&4294967295,P=U+(M<<15&4294967295|M>>>17),M=C+(U^(P|~j))+O[9]+3951481745&4294967295,R.g[0]=R.g[0]+j&4294967295,R.g[1]=R.g[1]+(P+(M<<21&4294967295|M>>>11))&4294967295,R.g[2]=R.g[2]+P&4294967295,R.g[3]=R.g[3]+U&4294967295}a.prototype.v=function(R,j){j===void 0&&(j=R.length);const C=j-this.blockSize,O=this.C;let P=this.h,U=0;for(;U<j;){if(P==0)for(;U<=C;)l(this,R,U),U+=this.blockSize;if(typeof R=="string"){for(;U<j;)if(O[P++]=R.charCodeAt(U++),P==this.blockSize){l(this,O),P=0;break}}else for(;U<j;)if(O[P++]=R[U++],P==this.blockSize){l(this,O),P=0;break}}this.h=P,this.o+=j},a.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var j=1;j<R.length-8;++j)R[j]=0;j=this.o*8;for(var C=R.length-8;C<R.length;++C)R[C]=j&255,j/=256;for(this.v(R),R=Array(16),j=0,C=0;C<4;++C)for(let O=0;O<32;O+=8)R[j++]=this.g[C]>>>O&255;return R};function u(R,j){var C=p;return Object.prototype.hasOwnProperty.call(C,R)?C[R]:C[R]=j(R)}function h(R,j){this.h=j;const C=[];let O=!0;for(let P=R.length-1;P>=0;P--){const U=R[P]|0;O&&U==j||(C[P]=U,O=!1)}this.g=C}var p={};function g(R){return-128<=R&&R<128?u(R,function(j){return new h([j|0],j<0?-1:0)}):new h([R|0],R<0?-1:0)}function x(R){if(isNaN(R)||!isFinite(R))return v;if(R<0)return D(x(-R));const j=[];let C=1;for(let O=0;R>=C;O++)j[O]=R/C|0,C*=4294967296;return new h(j,0)}function y(R,j){if(R.length==0)throw Error("number format error: empty string");if(j=j||10,j<2||36<j)throw Error("radix out of range: "+j);if(R.charAt(0)=="-")return D(y(R.substring(1),j));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const C=x(Math.pow(j,8));let O=v;for(let U=0;U<R.length;U+=8){var P=Math.min(8,R.length-U);const M=parseInt(R.substring(U,U+P),j);P<8?(P=x(Math.pow(j,P)),O=O.j(P).add(x(M))):(O=O.j(C),O=O.add(x(M)))}return O}var v=g(0),_=g(1),E=g(16777216);s=h.prototype,s.m=function(){if(A(this))return-D(this).m();let R=0,j=1;for(let C=0;C<this.g.length;C++){const O=this.i(C);R+=(O>=0?O:4294967296+O)*j,j*=4294967296}return R},s.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(S(this))return"0";if(A(this))return"-"+D(this).toString(R);const j=x(Math.pow(R,6));var C=this;let O="";for(;;){const P=$(C,j).g;C=L(C,P.j(j));let U=((C.g.length>0?C.g[0]:C.h)>>>0).toString(R);if(C=P,S(C))return U+O;for(;U.length<6;)U="0"+U;O=U+O}},s.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function S(R){if(R.h!=0)return!1;for(let j=0;j<R.g.length;j++)if(R.g[j]!=0)return!1;return!0}function A(R){return R.h==-1}s.l=function(R){return R=L(this,R),A(R)?-1:S(R)?0:1};function D(R){const j=R.g.length,C=[];for(let O=0;O<j;O++)C[O]=~R.g[O];return new h(C,~R.h).add(_)}s.abs=function(){return A(this)?D(this):this},s.add=function(R){const j=Math.max(this.g.length,R.g.length),C=[];let O=0;for(let P=0;P<=j;P++){let U=O+(this.i(P)&65535)+(R.i(P)&65535),M=(U>>>16)+(this.i(P)>>>16)+(R.i(P)>>>16);O=M>>>16,U&=65535,M&=65535,C[P]=M<<16|U}return new h(C,C[C.length-1]&-2147483648?-1:0)};function L(R,j){return R.add(D(j))}s.j=function(R){if(S(this)||S(R))return v;if(A(this))return A(R)?D(this).j(D(R)):D(D(this).j(R));if(A(R))return D(this.j(D(R)));if(this.l(E)<0&&R.l(E)<0)return x(this.m()*R.m());const j=this.g.length+R.g.length,C=[];for(var O=0;O<2*j;O++)C[O]=0;for(O=0;O<this.g.length;O++)for(let P=0;P<R.g.length;P++){const U=this.i(O)>>>16,M=this.i(O)&65535,ue=R.i(P)>>>16,we=R.i(P)&65535;C[2*O+2*P]+=M*we,B(C,2*O+2*P),C[2*O+2*P+1]+=U*we,B(C,2*O+2*P+1),C[2*O+2*P+1]+=M*ue,B(C,2*O+2*P+1),C[2*O+2*P+2]+=U*ue,B(C,2*O+2*P+2)}for(R=0;R<j;R++)C[R]=C[2*R+1]<<16|C[2*R];for(R=j;R<2*j;R++)C[R]=0;return new h(C,0)};function B(R,j){for(;(R[j]&65535)!=R[j];)R[j+1]+=R[j]>>>16,R[j]&=65535,j++}function k(R,j){this.g=R,this.h=j}function $(R,j){if(S(j))throw Error("division by zero");if(S(R))return new k(v,v);if(A(R))return j=$(D(R),j),new k(D(j.g),D(j.h));if(A(j))return j=$(R,D(j)),new k(D(j.g),j.h);if(R.g.length>30){if(A(R)||A(j))throw Error("slowDivide_ only works with positive integers.");for(var C=_,O=j;O.l(R)<=0;)C=q(C),O=q(O);var P=F(C,1),U=F(O,1);for(O=F(O,2),C=F(C,2);!S(O);){var M=U.add(O);M.l(R)<=0&&(P=P.add(C),U=M),O=F(O,1),C=F(C,1)}return j=L(R,P.j(j)),new k(P,j)}for(P=v;R.l(j)>=0;){for(C=Math.max(1,Math.floor(R.m()/j.m())),O=Math.ceil(Math.log(C)/Math.LN2),O=O<=48?1:Math.pow(2,O-48),U=x(C),M=U.j(j);A(M)||M.l(R)>0;)C-=O,U=x(C),M=U.j(j);S(U)&&(U=_),P=P.add(U),R=L(R,M)}return new k(P,R)}s.B=function(R){return $(this,R).h},s.and=function(R){const j=Math.max(this.g.length,R.g.length),C=[];for(let O=0;O<j;O++)C[O]=this.i(O)&R.i(O);return new h(C,this.h&R.h)},s.or=function(R){const j=Math.max(this.g.length,R.g.length),C=[];for(let O=0;O<j;O++)C[O]=this.i(O)|R.i(O);return new h(C,this.h|R.h)},s.xor=function(R){const j=Math.max(this.g.length,R.g.length),C=[];for(let O=0;O<j;O++)C[O]=this.i(O)^R.i(O);return new h(C,this.h^R.h)};function q(R){const j=R.g.length+1,C=[];for(let O=0;O<j;O++)C[O]=R.i(O)<<1|R.i(O-1)>>>31;return new h(C,R.h)}function F(R,j){const C=j>>5;j%=32;const O=R.g.length-C,P=[];for(let U=0;U<O;U++)P[U]=j>0?R.i(U+C)>>>j|R.i(U+C+1)<<32-j:R.i(U+C);return new h(P,R.h)}a.prototype.digest=a.prototype.A,a.prototype.reset=a.prototype.u,a.prototype.update=a.prototype.v,iv=a,h.prototype.add=h.prototype.add,h.prototype.multiply=h.prototype.j,h.prototype.modulo=h.prototype.B,h.prototype.compare=h.prototype.l,h.prototype.toNumber=h.prototype.m,h.prototype.toString=h.prototype.toString,h.prototype.getBits=h.prototype.i,h.fromNumber=x,h.fromString=y,Ka=h}).apply(typeof n1<"u"?n1:typeof self<"u"?self:typeof window<"u"?window:{});var Sd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ov,mc,lv,Pd,b0,cv,uv,dv;(function(){var s,e=Object.defineProperty;function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Sd=="object"&&Sd];for(var b=0;b<d.length;++b){var N=d[b];if(N&&N.Math==Math)return N}throw Error("Cannot find global object")}var a=n(this);function l(d,b){if(b)e:{var N=a;d=d.split(".");for(var I=0;I<d.length-1;I++){var X=d[I];if(!(X in N))break e;N=N[X]}d=d[d.length-1],I=N[d],b=b(I),b!=I&&b!=null&&e(N,d,{configurable:!0,writable:!0,value:b})}}l("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(d){return d||function(b){var N=[],I;for(I in b)Object.prototype.hasOwnProperty.call(b,I)&&N.push([I,b[I]]);return N}});var u=u||{},h=this||self;function p(d){var b=typeof d;return b=="object"&&d!=null||b=="function"}function g(d,b,N){return d.call.apply(d.bind,arguments)}function x(d,b,N){return x=g,x.apply(null,arguments)}function y(d,b){var N=Array.prototype.slice.call(arguments,1);return function(){var I=N.slice();return I.push.apply(I,arguments),d.apply(this,I)}}function v(d,b){function N(){}N.prototype=b.prototype,d.Z=b.prototype,d.prototype=new N,d.prototype.constructor=d,d.Ob=function(I,X,ee){for(var de=Array(arguments.length-2),Ue=2;Ue<arguments.length;Ue++)de[Ue-2]=arguments[Ue];return b.prototype[X].apply(I,de)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function E(d){const b=d.length;if(b>0){const N=Array(b);for(let I=0;I<b;I++)N[I]=d[I];return N}return[]}function S(d,b){for(let I=1;I<arguments.length;I++){const X=arguments[I];var N=typeof X;if(N=N!="object"?N:X?Array.isArray(X)?"array":N:"null",N=="array"||N=="object"&&typeof X.length=="number"){N=d.length||0;const ee=X.length||0;d.length=N+ee;for(let de=0;de<ee;de++)d[N+de]=X[de]}else d.push(X)}}class A{constructor(b,N){this.i=b,this.j=N,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function D(d){h.setTimeout(()=>{throw d},0)}function L(){var d=R;let b=null;return d.g&&(b=d.g,d.g=d.g.next,d.g||(d.h=null),b.next=null),b}class B{constructor(){this.h=this.g=null}add(b,N){const I=k.get();I.set(b,N),this.h?this.h.next=I:this.g=I,this.h=I}}var k=new A(()=>new $,d=>d.reset());class ${constructor(){this.next=this.g=this.h=null}set(b,N){this.h=b,this.g=N,this.next=null}reset(){this.next=this.g=this.h=null}}let q,F=!1,R=new B,j=()=>{const d=Promise.resolve(void 0);q=()=>{d.then(C)}};function C(){for(var d;d=L();){try{d.h.call(d.g)}catch(N){D(N)}var b=k;b.j(d),b.h<100&&(b.h++,d.next=b.g,b.g=d)}F=!1}function O(){this.u=this.u,this.C=this.C}O.prototype.u=!1,O.prototype.dispose=function(){this.u||(this.u=!0,this.N())},O.prototype[Symbol.dispose]=function(){this.dispose()},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function P(d,b){this.type=d,this.g=this.target=b,this.defaultPrevented=!1}P.prototype.h=function(){this.defaultPrevented=!0};var U=(function(){if(!h.addEventListener||!Object.defineProperty)return!1;var d=!1,b=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const N=()=>{};h.addEventListener("test",N,b),h.removeEventListener("test",N,b)}catch{}return d})();function M(d){return/^[\s\xa0]*$/.test(d)}function ue(d,b){P.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,b)}v(ue,P),ue.prototype.init=function(d,b){const N=this.type=d.type,I=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=b,b=d.relatedTarget,b||(N=="mouseover"?b=d.fromElement:N=="mouseout"&&(b=d.toElement)),this.relatedTarget=b,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&ue.Z.h.call(this)},ue.prototype.h=function(){ue.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var we="closure_listenable_"+(Math.random()*1e6|0),K=0;function ce(d,b,N,I,X){this.listener=d,this.proxy=null,this.src=b,this.type=N,this.capture=!!I,this.ha=X,this.key=++K,this.da=this.fa=!1}function ge(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function Ee(d,b,N){for(const I in d)b.call(N,d[I],I,d)}function Le(d,b){for(const N in d)b.call(void 0,d[N],N,d)}function H(d){const b={};for(const N in d)b[N]=d[N];return b}const ae="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function he(d,b){let N,I;for(let X=1;X<arguments.length;X++){I=arguments[X];for(N in I)d[N]=I[N];for(let ee=0;ee<ae.length;ee++)N=ae[ee],Object.prototype.hasOwnProperty.call(I,N)&&(d[N]=I[N])}}function me(d){this.src=d,this.g={},this.h=0}me.prototype.add=function(d,b,N,I,X){const ee=d.toString();d=this.g[ee],d||(d=this.g[ee]=[],this.h++);const de=Ie(d,b,I,X);return de>-1?(b=d[de],N||(b.fa=!1)):(b=new ce(b,this.src,ee,!!I,X),b.fa=N,d.push(b)),b};function Ae(d,b){const N=b.type;if(N in d.g){var I=d.g[N],X=Array.prototype.indexOf.call(I,b,void 0),ee;(ee=X>=0)&&Array.prototype.splice.call(I,X,1),ee&&(ge(b),d.g[N].length==0&&(delete d.g[N],d.h--))}}function Ie(d,b,N,I){for(let X=0;X<d.length;++X){const ee=d[X];if(!ee.da&&ee.listener==b&&ee.capture==!!N&&ee.ha==I)return X}return-1}var Fe="closure_lm_"+(Math.random()*1e6|0),wt={};function at(d,b,N,I,X){if(Array.isArray(b)){for(let ee=0;ee<b.length;ee++)at(d,b[ee],N,I,X);return null}return N=it(N),d&&d[we]?d.J(b,N,p(I)?!!I.capture:!1,X):on(d,b,N,!1,I,X)}function on(d,b,N,I,X,ee){if(!b)throw Error("Invalid event type");const de=p(X)?!!X.capture:!!X;let Ue=nt(d);if(Ue||(d[Fe]=Ue=new me(d)),N=Ue.add(b,N,I,de,ee),N.proxy)return N;if(I=Yn(),N.proxy=I,I.src=d,I.listener=N,d.addEventListener)U||(X=de),X===void 0&&(X=!1),d.addEventListener(b.toString(),I,X);else if(d.attachEvent)d.attachEvent(ln(b.toString()),I);else if(d.addListener&&d.removeListener)d.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return N}function Yn(){function d(N){return b.call(d.src,d.listener,N)}const b=In;return d}function Kn(d,b,N,I,X){if(Array.isArray(b))for(var ee=0;ee<b.length;ee++)Kn(d,b[ee],N,I,X);else I=p(I)?!!I.capture:!!I,N=it(N),d&&d[we]?(d=d.i,ee=String(b).toString(),ee in d.g&&(b=d.g[ee],N=Ie(b,N,I,X),N>-1&&(ge(b[N]),Array.prototype.splice.call(b,N,1),b.length==0&&(delete d.g[ee],d.h--)))):d&&(d=nt(d))&&(b=d.g[b.toString()],d=-1,b&&(d=Ie(b,N,I,X)),(N=d>-1?b[d]:null)&&os(N))}function os(d){if(typeof d!="number"&&d&&!d.da){var b=d.src;if(b&&b[we])Ae(b.i,d);else{var N=d.type,I=d.proxy;b.removeEventListener?b.removeEventListener(N,I,d.capture):b.detachEvent?b.detachEvent(ln(N),I):b.addListener&&b.removeListener&&b.removeListener(I),(N=nt(b))?(Ae(N,d),N.h==0&&(N.src=null,b[Fe]=null)):ge(d)}}}function ln(d){return d in wt?wt[d]:wt[d]="on"+d}function In(d,b){if(d.da)d=!0;else{b=new ue(b,this);const N=d.listener,I=d.ha||d.src;d.fa&&os(d),d=N.call(I,b)}return d}function nt(d){return d=d[Fe],d instanceof me?d:null}var Tn="__closure_events_fn_"+(Math.random()*1e9>>>0);function it(d){return typeof d=="function"?d:(d[Tn]||(d[Tn]=function(b){return d.handleEvent(b)}),d[Tn])}function Qe(){O.call(this),this.i=new me(this),this.M=this,this.G=null}v(Qe,O),Qe.prototype[we]=!0,Qe.prototype.removeEventListener=function(d,b,N,I){Kn(this,d,b,N,I)};function qe(d,b){var N,I=d.G;if(I)for(N=[];I;I=I.G)N.push(I);if(d=d.M,I=b.type||b,typeof b=="string")b=new P(b,d);else if(b instanceof P)b.target=b.target||d;else{var X=b;b=new P(I,d),he(b,X)}X=!0;let ee,de;if(N)for(de=N.length-1;de>=0;de--)ee=b.g=N[de],X=Ct(ee,I,!0,b)&&X;if(ee=b.g=d,X=Ct(ee,I,!0,b)&&X,X=Ct(ee,I,!1,b)&&X,N)for(de=0;de<N.length;de++)ee=b.g=N[de],X=Ct(ee,I,!1,b)&&X}Qe.prototype.N=function(){if(Qe.Z.N.call(this),this.i){var d=this.i;for(const b in d.g){const N=d.g[b];for(let I=0;I<N.length;I++)ge(N[I]);delete d.g[b],d.h--}}this.G=null},Qe.prototype.J=function(d,b,N,I){return this.i.add(String(d),b,!1,N,I)},Qe.prototype.K=function(d,b,N,I){return this.i.add(String(d),b,!0,N,I)};function Ct(d,b,N,I){if(b=d.i.g[String(b)],!b)return!0;b=b.concat();let X=!0;for(let ee=0;ee<b.length;++ee){const de=b[ee];if(de&&!de.da&&de.capture==N){const Ue=de.listener,Lt=de.ha||de.src;de.fa&&Ae(d.i,de),X=Ue.call(Lt,I)!==!1&&X}}return X&&!I.defaultPrevented}function Es(d,b){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=x(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:h.setTimeout(d,b||0)}function Te(d){d.g=Es(()=>{d.g=null,d.i&&(d.i=!1,Te(d))},d.l);const b=d.h;d.h=null,d.m.apply(null,b)}class Pt extends O{constructor(b,N){super(),this.m=b,this.l=N,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:Te(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function bn(d){O.call(this),this.h=d,this.g={}}v(bn,O);var ls=[];function yr(d){Ee(d.g,function(b,N){this.g.hasOwnProperty(N)&&os(b)},d),d.g={}}bn.prototype.N=function(){bn.Z.N.call(this),yr(this)},bn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var js=h.JSON.stringify,ul=h.JSON.parse,br=class{stringify(d){return h.JSON.stringify(d,void 0)}parse(d){return h.JSON.parse(d,void 0)}};function oa(){}function vr(){}var Mn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Jt(){P.call(this,"d")}v(Jt,P);function kn(){P.call(this,"c")}v(kn,P);var Rt={},Yi=null;function Bs(){return Yi=Yi||new Qe}Rt.Ia="serverreachability";function Ki(d){P.call(this,Rt.Ia,d)}v(Ki,P);function cs(d){const b=Bs();qe(b,new Ki(b))}Rt.STAT_EVENT="statevent";function wr(d,b){P.call(this,Rt.STAT_EVENT,d),this.stat=b}v(wr,P);function pe(d){const b=Bs();qe(b,new wr(b,d))}Rt.Ja="timingevent";function Vn(d,b){P.call(this,Rt.Ja,d),this.size=b}v(Vn,P);function Fs(d,b){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){d()},b)}function Ss(){this.g=!0}Ss.prototype.ua=function(){this.g=!1};function Kh(d,b,N,I,X,ee){d.info(function(){if(d.g)if(ee){var de="",Ue=ee.split("&");for(let ot=0;ot<Ue.length;ot++){var Lt=Ue[ot].split("=");if(Lt.length>1){const jt=Lt[0];Lt=Lt[1];const fs=jt.split("_");de=fs.length>=2&&fs[1]=="type"?de+(jt+"="+Lt+"&"):de+(jt+"=redacted&")}}}else de=null;else de=ee;return"XMLHTTP REQ ("+I+") [attempt "+X+"]: "+b+`
`+N+`
`+de})}function nu(d,b,N,I,X,ee,de){d.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+X+"]: "+b+`
`+N+`
`+ee+" "+de})}function qs(d,b,N,I){d.info(function(){return"XMLHTTP TEXT ("+b+"): "+Xh(d,N)+(I?" "+I:"")})}function ii(d,b){d.info(function(){return"TIMEOUT: "+b})}Ss.prototype.info=function(){};function Xh(d,b){if(!d.g)return b;if(!b)return null;try{const ee=JSON.parse(b);if(ee){for(d=0;d<ee.length;d++)if(Array.isArray(ee[d])){var N=ee[d];if(!(N.length<2)){var I=N[1];if(Array.isArray(I)&&!(I.length<1)){var X=I[0];if(X!="noop"&&X!="stop"&&X!="close")for(let de=1;de<I.length;de++)I[de]=""}}}}return js(ee)}catch{return b}}var oi={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},dl={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},hl;function li(){}v(li,oa),li.prototype.g=function(){return new XMLHttpRequest},hl=new li;function _r(d){return encodeURIComponent(String(d))}function su(d){var b=1;d=d.split(":");const N=[];for(;b>0&&d.length;)N.push(d.shift()),b--;return d.length&&N.push(d.join(":")),N}function Ts(d,b,N,I){this.j=d,this.i=b,this.l=N,this.S=I||1,this.V=new bn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new As}function As(){this.i=null,this.g="",this.h=!1}var Ft={},tn={};function Hs(d,b,N){d.M=1,d.A=ci(Ht(b)),d.u=N,d.R=!0,Xi(d,null)}function Xi(d,b){d.F=Date.now(),Gs(d),d.B=Ht(d.A);var N=d.B,I=d.S;Array.isArray(I)||(I=[String(I)]),eo(N.i,"t",I),d.C=0,N=d.j.L,d.h=new As,d.g=yu(d.j,N?b:null,!d.u),d.P>0&&(d.O=new Pt(x(d.Y,d,d.g),d.P)),b=d.V,N=d.g,I=d.ba;var X="readystatechange";Array.isArray(X)||(X&&(ls[0]=X.toString()),X=ls);for(let ee=0;ee<X.length;ee++){const de=at(N,X[ee],I||b.handleEvent,!1,b.h||b);if(!de)break;b.g[de.key]=de}b=d.J?H(d.J):{},d.u?(d.v||(d.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,b)):(d.v="GET",d.g.ea(d.B,d.v,null,b)),cs(),Kh(d.i,d.v,d.B,d.l,d.S,d.u)}Ts.prototype.ba=function(d){d=d.target;const b=this.O;b&&Ds(d)==3?b.j():this.Y(d)},Ts.prototype.Y=function(d){try{if(d==this.g)e:{const Ue=Ds(this.g),Lt=this.g.ya(),ot=this.g.ca();if(!(Ue<3)&&(Ue!=3||this.g&&(this.h.h||this.g.la()||cn(this.g)))){this.K||Ue!=4||Lt==7||(Lt==8||ot<=0?cs(3):cs(2)),$s(this);var b=this.g.ca();this.X=b;var N=Zh(this);if(this.o=b==200,nu(this.i,this.v,this.B,this.l,this.S,Ue,b),this.o){if(this.U&&!this.L){t:{if(this.g){var I,X=this.g;if((I=X.g?X.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(I)){var ee=I;break t}}ee=null}if(d=ee)qs(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Qs(this,d);else{this.o=!1,this.m=3,pe(12),Xn(this),us(this);break e}}if(this.R){d=!0;let jt;for(;!this.K&&this.C<N.length;)if(jt=au(this,N),jt==tn){Ue==4&&(this.m=4,pe(14),d=!1),qs(this.i,this.l,null,"[Incomplete Response]");break}else if(jt==Ft){this.m=4,pe(15),qs(this.i,this.l,N,"[Invalid Chunk]"),d=!1;break}else qs(this.i,this.l,jt,null),Qs(this,jt);if(ru(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ue!=4||N.length!=0||this.h.h||(this.m=1,pe(16),d=!1),this.o=this.o&&d,!d)qs(this.i,this.l,N,"[Invalid Chunked Response]"),Xn(this),us(this);else if(N.length>0&&!this.W){this.W=!0;var de=this.j;de.g==this&&de.aa&&!de.P&&(de.j.info("Great, no buffering proxy detected. Bytes received: "+N.length),Tl(de),de.P=!0,pe(11))}}else qs(this.i,this.l,N,null),Qs(this,N);Ue==4&&Xn(this),this.o&&!this.K&&(Ue==4?mu(this.j,this):(this.o=!1,Gs(this)))}else Er(this.g),b==400&&N.indexOf("Unknown SID")>0?(this.m=3,pe(12)):(this.m=0,pe(13)),Xn(this),us(this)}}}catch{}finally{}};function Zh(d){if(!ru(d))return d.g.la();const b=cn(d.g);if(b==="")return"";let N="";const I=b.length,X=Ds(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return Xn(d),us(d),"";d.h.i=new h.TextDecoder}for(let ee=0;ee<I;ee++)d.h.h=!0,N+=d.h.i.decode(b[ee],{stream:!(X&&ee==I-1)});return b.length=0,d.h.g+=N,d.C=0,d.h.g}function ru(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function au(d,b){var N=d.C,I=b.indexOf(`
`,N);return I==-1?tn:(N=Number(b.substring(N,I)),isNaN(N)?Ft:(I+=1,I+N>b.length?tn:(b=b.slice(I,I+N),d.C=I+N,b)))}Ts.prototype.cancel=function(){this.K=!0,Xn(this)};function Gs(d){d.T=Date.now()+d.H,Zi(d,d.H)}function Zi(d,b){if(d.D!=null)throw Error("WatchDog timer not null");d.D=Fs(x(d.aa,d),b)}function $s(d){d.D&&(h.clearTimeout(d.D),d.D=null)}Ts.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(ii(this.i,this.B),this.M!=2&&(cs(),pe(17)),Xn(this),this.m=2,us(this)):Zi(this,this.T-d)};function us(d){d.j.I==0||d.K||mu(d.j,d)}function Xn(d){$s(d);var b=d.O;b&&typeof b.dispose=="function"&&b.dispose(),d.O=null,yr(d.V),d.g&&(b=d.g,d.g=null,b.abort(),b.dispose())}function Qs(d,b){try{var N=d.j;if(N.I!=0&&(N.g==d||Ks(N.h,d))){if(!d.L&&Ks(N.h,d)&&N.I==3){try{var I=N.Ba.g.parse(b)}catch{I=null}if(Array.isArray(I)&&I.length==3){var X=I;if(X[0]==0){e:if(!N.v){if(N.g)if(N.g.F+3e3<d.F)ao(N),ga(N);else break e;pi(N),pe(18)}}else N.xa=X[1],0<N.xa-N.K&&X[2]<37500&&N.F&&N.A==0&&!N.C&&(N.C=Fs(x(N.Va,N),6e3));Ys(N.h)<=1&&N.ta&&(N.ta=void 0)}else tr(N,11)}else if((d.L||N.g==d)&&ao(N),!M(b))for(X=N.Ba.g.parse(b),b=0;b<X.length;b++){let ot=X[b];const jt=ot[0];if(!(jt<=N.K))if(N.K=jt,ot=ot[1],N.I==2)if(ot[0]=="c"){N.M=ot[1],N.ba=ot[2];const fs=ot[3];fs!=null&&(N.ka=fs,N.j.info("VER="+N.ka));const nr=ot[4];nr!=null&&(N.za=nr,N.j.info("SVER="+N.za));const Is=ot[5];Is!=null&&typeof Is=="number"&&Is>0&&(I=1.5*Is,N.O=I,N.j.info("backChannelRequestTimeoutMs_="+I)),I=N;const Ms=d.g;if(Ms){const xi=Ms.g?Ms.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(xi){var ee=I.h;ee.g||xi.indexOf("spdy")==-1&&xi.indexOf("quic")==-1&&xi.indexOf("h2")==-1||(ee.j=ee.l,ee.g=new Set,ee.h&&(gl(ee,ee.h),ee.h=null))}if(I.G){const io=Ms.g?Ms.g.getResponseHeader("X-HTTP-Session-Id"):null;io&&(I.wa=io,dt(I.J,I.G,io))}}N.I=3,N.l&&N.l.ra(),N.aa&&(N.T=Date.now()-d.F,N.j.info("Handshake RTT: "+N.T+"ms")),I=N;var de=d;if(I.na=xu(I,I.L?I.ba:null,I.W),de.L){pl(I.h,de);var Ue=de,Lt=I.O;Lt&&(Ue.H=Lt),Ue.D&&($s(Ue),Gs(Ue)),I.g=de}else hu(I);N.i.length>0&&er(N)}else ot[0]!="stop"&&ot[0]!="close"||tr(N,7);else N.I==3&&(ot[0]=="stop"||ot[0]=="close"?ot[0]=="stop"?tr(N,7):jl(N):ot[0]!="noop"&&N.l&&N.l.qa(ot),N.A=0)}}cs(4)}catch{}}var qt=class{constructor(d,b){this.g=d,this.map=b}};function fl(d){this.l=d||10,h.PerformanceNavigationTiming?(d=h.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ml(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function Ys(d){return d.h?1:d.g?d.g.size:0}function Ks(d,b){return d.h?d.h==b:d.g?d.g.has(b):!1}function gl(d,b){d.g?d.g.add(b):d.h=b}function pl(d,b){d.h&&d.h==b?d.h=null:d.g&&d.g.has(b)&&d.g.delete(b)}fl.prototype.cancel=function(){if(this.i=xl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function xl(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let b=d.i;for(const N of d.g.values())b=b.concat(N.G);return b}return E(d.i)}var iu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ji(d,b){if(d){d=d.split("&");for(let N=0;N<d.length;N++){const I=d[N].indexOf("=");let X,ee=null;I>=0?(X=d[N].substring(0,I),ee=d[N].substring(I+1)):X=d[N],b(X,ee?decodeURIComponent(ee.replace(/\+/g," ")):"")}}}function Zn(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;d instanceof Zn?(this.l=d.l,nn(this,d.j),this.o=d.o,this.g=d.g,la(this,d.u),this.h=d.h,yl(this,uu(d.i)),this.m=d.m):d&&(b=String(d).match(iu))?(this.l=!1,nn(this,b[1]||"",!0),this.o=Xs(b[2]||""),this.g=Xs(b[3]||"",!0),la(this,b[4]),this.h=Xs(b[5]||"",!0),yl(this,b[6]||"",!0),this.m=Xs(b[7]||"")):(this.l=!1,this.i=new ua(null,this.l))}Zn.prototype.toString=function(){const d=[];var b=this.j;b&&d.push(ui(b,Wi,!0),":");var N=this.g;return(N||b=="file")&&(d.push("//"),(b=this.o)&&d.push(ui(b,Wi,!0),"@"),d.push(_r(N).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),N=this.u,N!=null&&d.push(":",String(N))),(N=this.h)&&(this.g&&N.charAt(0)!="/"&&d.push("/"),d.push(ui(N,N.charAt(0)=="/"?bl:ou,!0))),(N=this.i.toString())&&d.push("?",N),(N=this.m)&&d.push("#",ui(N,lu)),d.join("")},Zn.prototype.resolve=function(d){const b=Ht(this);let N=!!d.j;N?nn(b,d.j):N=!!d.o,N?b.o=d.o:N=!!d.g,N?b.g=d.g:N=d.u!=null;var I=d.h;if(N)la(b,d.u);else if(N=!!d.h){if(I.charAt(0)!="/")if(this.g&&!this.h)I="/"+I;else{var X=b.h.lastIndexOf("/");X!=-1&&(I=b.h.slice(0,X+1)+I)}if(X=I,X==".."||X==".")I="";else if(X.indexOf("./")!=-1||X.indexOf("/.")!=-1){I=X.lastIndexOf("/",0)==0,X=X.split("/");const ee=[];for(let de=0;de<X.length;){const Ue=X[de++];Ue=="."?I&&de==X.length&&ee.push(""):Ue==".."?((ee.length>1||ee.length==1&&ee[0]!="")&&ee.pop(),I&&de==X.length&&ee.push("")):(ee.push(Ue),I=!0)}I=ee.join("/")}else I=X}return N?b.h=I:N=d.i.toString()!=="",N?yl(b,uu(d.i)):N=!!d.m,N&&(b.m=d.m),b};function Ht(d){return new Zn(d)}function nn(d,b,N){d.j=N?Xs(b,!0):b,d.j&&(d.j=d.j.replace(/:$/,""))}function la(d,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);d.u=b}else d.u=null}function yl(d,b,N){b instanceof ua?(d.i=b,to(d.i,d.l)):(N||(b=ui(b,ca)),d.i=new ua(b,d.l))}function dt(d,b,N){d.i.set(b,N)}function ci(d){return dt(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function Xs(d,b){return d?b?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function ui(d,b,N){return typeof d=="string"?(d=encodeURI(d).replace(b,On),N&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function On(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var Wi=/[#\/\?@]/g,ou=/[#\?:]/g,bl=/[#\?]/g,ca=/[#\?@]/g,lu=/#/g;function ua(d,b){this.h=this.g=null,this.i=d||null,this.j=!!b}function Pn(d){d.g||(d.g=new Map,d.h=0,d.i&&Ji(d.i,function(b,N){d.add(decodeURIComponent(b.replace(/\+/g," ")),N)}))}s=ua.prototype,s.add=function(d,b){Pn(this),this.i=null,d=da(this,d);let N=this.g.get(d);return N||this.g.set(d,N=[]),N.push(b),this.h+=1,this};function cu(d,b){Pn(d),b=da(d,b),d.g.has(b)&&(d.i=null,d.h-=d.g.get(b).length,d.g.delete(b))}function vl(d,b){return Pn(d),b=da(d,b),d.g.has(b)}s.forEach=function(d,b){Pn(this),this.g.forEach(function(N,I){N.forEach(function(X){d.call(b,X,I,this)},this)},this)};function wl(d,b){Pn(d);let N=[];if(typeof b=="string")vl(d,b)&&(N=N.concat(d.g.get(da(d,b))));else for(d=Array.from(d.g.values()),b=0;b<d.length;b++)N=N.concat(d[b]);return N}s.set=function(d,b){return Pn(this),this.i=null,d=da(this,d),vl(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[b]),this.h+=1,this},s.get=function(d,b){return d?(d=wl(this,d),d.length>0?String(d[0]):b):b};function eo(d,b,N){cu(d,b),N.length>0&&(d.i=null,d.g.set(da(d,b),E(N)),d.h+=N.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],b=Array.from(this.g.keys());for(let I=0;I<b.length;I++){var N=b[I];const X=_r(N);N=wl(this,N);for(let ee=0;ee<N.length;ee++){let de=X;N[ee]!==""&&(de+="="+_r(N[ee])),d.push(de)}}return this.i=d.join("&")};function uu(d){const b=new ua;return b.i=d.i,d.g&&(b.g=new Map(d.g),b.h=d.h),b}function da(d,b){return b=String(b),d.j&&(b=b.toLowerCase()),b}function to(d,b){b&&!d.j&&(Pn(d),d.i=null,d.g.forEach(function(N,I){const X=I.toLowerCase();I!=X&&(cu(this,I),eo(this,X,N))},d)),d.j=b}function Cs(d,b){const N=new Ss;if(h.Image){const I=new Image;I.onload=y(ds,N,"TestLoadImage: loaded",!0,b,I),I.onerror=y(ds,N,"TestLoadImage: error",!1,b,I),I.onabort=y(ds,N,"TestLoadImage: abort",!1,b,I),I.ontimeout=y(ds,N,"TestLoadImage: timeout",!1,b,I),h.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=d}else b(!1)}function _l(d,b){const N=new Ss,I=new AbortController,X=setTimeout(()=>{I.abort(),ds(N,"TestPingServer: timeout",!1,b)},1e4);fetch(d,{signal:I.signal}).then(ee=>{clearTimeout(X),ee.ok?ds(N,"TestPingServer: ok",!0,b):ds(N,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(X),ds(N,"TestPingServer: error",!1,b)})}function ds(d,b,N,I,X){try{X&&(X.onload=null,X.onerror=null,X.onabort=null,X.ontimeout=null),I(N)}catch{}}function ha(){this.g=new br}function Zs(d){this.i=d.Sb||null,this.h=d.ab||!1}v(Zs,oa),Zs.prototype.g=function(){return new di(this.i,this.h)};function di(d,b){Qe.call(this),this.H=d,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(di,Qe),s=di.prototype,s.open=function(d,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=b,this.readyState=1,Rs(this)},s.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(b.body=d),(this.H||h).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,fa(this)),this.readyState=0},s.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Rs(this)),this.g&&(this.readyState=3,Rs(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;no(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function no(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}s.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var b=d.value?d.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!d.done}))&&(this.response=this.responseText+=b)}d.done?fa(this):Rs(this),this.readyState==3&&no(this)}},s.Oa=function(d){this.g&&(this.response=this.responseText=d,fa(this))},s.Na=function(d){this.g&&(this.response=d,fa(this))},s.ga=function(){this.g&&fa(this)};function fa(d){d.readyState=4,d.l=null,d.j=null,d.B=null,Rs(d)}s.setRequestHeader=function(d,b){this.A.append(d,b)},s.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],b=this.h.entries();for(var N=b.next();!N.done;)N=N.value,d.push(N[0]+": "+N[1]),N=b.next();return d.join(`\r
`)};function Rs(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(di.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function hs(d){let b="";return Ee(d,function(N,I){b+=I,b+=":",b+=N,b+=`\r
`}),b}function hi(d,b,N){e:{for(I in N){var I=!1;break e}I=!0}I||(N=hs(N),typeof d=="string"?N!=null&&_r(N):dt(d,b,N))}function mt(d){Qe.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(mt,Qe);var Js=/^https?$/i,Nl=["POST","PUT"];s=mt.prototype,s.Fa=function(d){this.H=d},s.ea=function(d,b,N,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);b=b?b.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():hl.g(),this.g.onreadystatechange=_(x(this.Ca,this));try{this.B=!0,this.g.open(b,String(d),!0),this.B=!1}catch(ee){fi(this,ee);return}if(d=N||"",N=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var X in I)N.set(X,I[X]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const ee of I.keys())N.set(ee,I.get(ee));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(N.keys()).find(ee=>ee.toLowerCase()=="content-type"),X=h.FormData&&d instanceof h.FormData,!(Array.prototype.indexOf.call(Nl,b,void 0)>=0)||I||X||N.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ee,de]of N)this.g.setRequestHeader(ee,de);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(ee){fi(this,ee)}};function fi(d,b){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=b,d.o=5,El(d),Nr(d)}function El(d){d.A||(d.A=!0,qe(d,"complete"),qe(d,"error"))}s.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,qe(this,"complete"),qe(this,"abort"),Nr(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Nr(this,!0)),mt.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?mi(this):this.Xa())},s.Xa=function(){mi(this)};function mi(d){if(d.h&&typeof u<"u"){if(d.v&&Ds(d)==4)setTimeout(d.Ca.bind(d),0);else if(qe(d,"readystatechange"),Ds(d)==4){d.h=!1;try{const ee=d.ca();e:switch(ee){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var N;if(!(N=b)){var I;if(I=ee===0){let de=String(d.D).match(iu)[1]||null;!de&&h.self&&h.self.location&&(de=h.self.location.protocol.slice(0,-1)),I=!Js.test(de?de.toLowerCase():"")}N=I}if(N)qe(d,"complete"),qe(d,"success");else{d.o=6;try{var X=Ds(d)>2?d.g.statusText:""}catch{X=""}d.l=X+" ["+d.ca()+"]",El(d)}}finally{Nr(d)}}}}function Nr(d,b){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const N=d.g;d.g=null,b||qe(d,"ready");try{N.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function Ds(d){return d.g?d.g.readyState:0}s.ca=function(){try{return Ds(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(d){if(this.g){var b=this.g.responseText;return d&&b.indexOf(d)==0&&(b=b.substring(d.length)),ul(b)}};function cn(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Er(d){const b={};d=(d.g&&Ds(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<d.length;I++){if(M(d[I]))continue;var N=su(d[I]);const X=N[0];if(N=N[1],typeof N!="string")continue;N=N.trim();const ee=b[X]||[];b[X]=ee,ee.push(N)}Le(b,function(I){return I.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ws(d,b,N){return N&&N.internalChannelParams&&N.internalChannelParams[d]||b}function ma(d){this.za=0,this.i=[],this.j=new Ss,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ws("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ws("baseRetryDelayMs",5e3,d),this.Za=Ws("retryDelaySeedMs",1e4,d),this.Ta=Ws("forwardChannelMaxRetries",2,d),this.va=Ws("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new fl(d&&d.concurrentRequestLimit),this.Ba=new ha,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=ma.prototype,s.ka=8,s.I=1,s.connect=function(d,b,N,I){pe(0),this.W=d,this.H=b||{},N&&I!==void 0&&(this.H.OSID=N,this.H.OAID=I),this.F=this.X,this.J=xu(this,null,this.W),er(this)};function jl(d){if(so(d),d.I==3){var b=d.V++,N=Ht(d.J);if(dt(N,"SID",d.M),dt(N,"RID",b),dt(N,"TYPE","terminate"),gi(d,N),b=new Ts(d,d.j,b),b.M=2,b.A=ci(Ht(N)),N=!1,h.navigator&&h.navigator.sendBeacon)try{N=h.navigator.sendBeacon(b.A.toString(),"")}catch{}!N&&h.Image&&(new Image().src=b.A,N=!0),N||(b.g=yu(b.j,null),b.g.ea(b.A)),b.F=Date.now(),Gs(b)}pu(d)}function ga(d){d.g&&(Tl(d),d.g.cancel(),d.g=null)}function so(d){ga(d),d.v&&(h.clearTimeout(d.v),d.v=null),ao(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&h.clearTimeout(d.m),d.m=null)}function er(d){if(!ml(d.h)&&!d.m){d.m=!0;var b=d.Ea;q||j(),F||(q(),F=!0),R.add(b,d),d.D=0}}function ro(d,b){return Ys(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=b.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=Fs(x(d.Ea,d,b),gu(d,d.D)),d.D++,!0)}s.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const X=new Ts(this,this.j,d);let ee=this.o;if(this.U&&(ee?(ee=H(ee),he(ee,this.U)):ee=this.U),this.u!==null||this.R||(X.J=ee,ee=null),this.S)e:{for(var b=0,N=0;N<this.i.length;N++){t:{var I=this.i[N];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(b+=I,b>4096){b=N;break e}if(b===4096||N===this.i.length-1){b=N+1;break e}}b=1e3}else b=1e3;b=du(this,X,b),N=Ht(this.J),dt(N,"RID",d),dt(N,"CVER",22),this.G&&dt(N,"X-HTTP-Session-Id",this.G),gi(this,N),ee&&(this.R?b="headers="+_r(hs(ee))+"&"+b:this.u&&hi(N,this.u,ee)),gl(this.h,X),this.Ra&&dt(N,"TYPE","init"),this.S?(dt(N,"$req",b),dt(N,"SID","null"),X.U=!0,Hs(X,N,null)):Hs(X,N,b),this.I=2}}else this.I==3&&(d?Sl(this,d):this.i.length==0||ml(this.h)||Sl(this))};function Sl(d,b){var N;b?N=b.l:N=d.V++;const I=Ht(d.J);dt(I,"SID",d.M),dt(I,"RID",N),dt(I,"AID",d.K),gi(d,I),d.u&&d.o&&hi(I,d.u,d.o),N=new Ts(d,d.j,N,d.D+1),d.u===null&&(N.J=d.o),b&&(d.i=b.G.concat(d.i)),b=du(d,N,1e3),N.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),gl(d.h,N),Hs(N,I,b)}function gi(d,b){d.H&&Ee(d.H,function(N,I){dt(b,I,N)}),d.l&&Ee({},function(N,I){dt(b,I,N)})}function du(d,b,N){N=Math.min(d.i.length,N);const I=d.l?x(d.l.Ka,d.l,d):null;e:{var X=d.i;let Ue=-1;for(;;){const Lt=["count="+N];Ue==-1?N>0?(Ue=X[0].g,Lt.push("ofs="+Ue)):Ue=0:Lt.push("ofs="+Ue);let ot=!0;for(let jt=0;jt<N;jt++){var ee=X[jt].g;const fs=X[jt].map;if(ee-=Ue,ee<0)Ue=Math.max(0,X[jt].g-100),ot=!1;else try{ee="req"+ee+"_"||"";try{var de=fs instanceof Map?fs:Object.entries(fs);for(const[nr,Is]of de){let Ms=Is;p(Is)&&(Ms=js(Is)),Lt.push(ee+nr+"="+encodeURIComponent(Ms))}}catch(nr){throw Lt.push(ee+"type="+encodeURIComponent("_badmap")),nr}}catch{I&&I(fs)}}if(ot){de=Lt.join("&");break e}}de=void 0}return d=d.i.splice(0,N),b.G=d,de}function hu(d){if(!d.g&&!d.v){d.Y=1;var b=d.Da;q||j(),F||(q(),F=!0),R.add(b,d),d.A=0}}function pi(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=Fs(x(d.Da,d),gu(d,d.A)),d.A++,!0)}s.Da=function(){if(this.v=null,fu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=Fs(x(this.Wa,this),d)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,pe(10),ga(this),fu(this))};function Tl(d){d.B!=null&&(h.clearTimeout(d.B),d.B=null)}function fu(d){d.g=new Ts(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var b=Ht(d.na);dt(b,"RID","rpc"),dt(b,"SID",d.M),dt(b,"AID",d.K),dt(b,"CI",d.F?"0":"1"),!d.F&&d.ia&&dt(b,"TO",d.ia),dt(b,"TYPE","xmlhttp"),gi(d,b),d.u&&d.o&&hi(b,d.u,d.o),d.O&&(d.g.H=d.O);var N=d.g;d=d.ba,N.M=1,N.A=ci(Ht(b)),N.u=null,N.R=!0,Xi(N,d)}s.Va=function(){this.C!=null&&(this.C=null,ga(this),pi(this),pe(19))};function ao(d){d.C!=null&&(h.clearTimeout(d.C),d.C=null)}function mu(d,b){var N=null;if(d.g==b){ao(d),Tl(d),d.g=null;var I=2}else if(Ks(d.h,b))N=b.G,pl(d.h,b),I=1;else return;if(d.I!=0){if(b.o)if(I==1){N=b.u?b.u.length:0,b=Date.now()-b.F;var X=d.D;I=Bs(),qe(I,new Vn(I,N)),er(d)}else hu(d);else if(X=b.m,X==3||X==0&&b.X>0||!(I==1&&ro(d,b)||I==2&&pi(d)))switch(N&&N.length>0&&(b=d.h,b.i=b.i.concat(N)),X){case 1:tr(d,5);break;case 4:tr(d,10);break;case 3:tr(d,6);break;default:tr(d,2)}}}function gu(d,b){let N=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(N*=2),N*b}function tr(d,b){if(d.j.info("Error code "+b),b==2){var N=x(d.bb,d),I=d.Ua;const X=!I;I=new Zn(I||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||nn(I,"https"),ci(I),X?Cs(I.toString(),N):_l(I.toString(),N)}else pe(2);d.I=0,d.l&&d.l.pa(b),pu(d),so(d)}s.bb=function(d){d?(this.j.info("Successfully pinged google.com"),pe(2)):(this.j.info("Failed to ping google.com"),pe(1))};function pu(d){if(d.I=0,d.ja=[],d.l){const b=xl(d.h);(b.length!=0||d.i.length!=0)&&(S(d.ja,b),S(d.ja,d.i),d.h.i.length=0,E(d.i),d.i.length=0),d.l.oa()}}function xu(d,b,N){var I=N instanceof Zn?Ht(N):new Zn(N);if(I.g!="")b&&(I.g=b+"."+I.g),la(I,I.u);else{var X=h.location;I=X.protocol,b=b?b+"."+X.hostname:X.hostname,X=+X.port;const ee=new Zn(null);I&&nn(ee,I),b&&(ee.g=b),X&&la(ee,X),N&&(ee.h=N),I=ee}return N=d.G,b=d.wa,N&&b&&dt(I,N,b),dt(I,"VER",d.ka),gi(d,I),I}function yu(d,b,N){if(b&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=d.Aa&&!d.ma?new mt(new Zs({ab:N})):new mt(d.ma),b.Fa(d.L),b}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function bu(){}s=bu.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function pa(){}pa.prototype.g=function(d,b){return new An(d,b)};function An(d,b){Qe.call(this),this.g=new ma(b),this.l=d,this.h=b&&b.messageUrlParams||null,d=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(d?d["X-WebChannel-Content-Type"]=b.messageContentType:d={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(d?d["X-WebChannel-Client-Profile"]=b.sa:d={"X-WebChannel-Client-Profile":b.sa}),this.g.U=d,(d=b&&b.Qb)&&!M(d)&&(this.g.u=d),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!M(b)&&(this.g.G=b,d=this.h,d!==null&&b in d&&(d=this.h,b in d&&delete d[b])),this.j=new jr(this)}v(An,Qe),An.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},An.prototype.close=function(){jl(this.g)},An.prototype.o=function(d){var b=this.g;if(typeof d=="string"){var N={};N.__data__=d,d=N}else this.v&&(N={},N.__data__=js(d),d=N);b.i.push(new qt(b.Ya++,d)),b.I==3&&er(b)},An.prototype.N=function(){this.g.l=null,delete this.j,jl(this.g),delete this.g,An.Z.N.call(this)};function vu(d){Jt.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var b=d.__sm__;if(b){e:{for(const N in b){d=N;break e}d=void 0}(this.i=d)&&(d=this.i,b=b!==null&&d in b?b[d]:void 0),this.data=b}else this.data=d}v(vu,Jt);function wu(){kn.call(this),this.status=1}v(wu,kn);function jr(d){this.g=d}v(jr,bu),jr.prototype.ra=function(){qe(this.g,"a")},jr.prototype.qa=function(d){qe(this.g,new vu(d))},jr.prototype.pa=function(d){qe(this.g,new wu)},jr.prototype.oa=function(){qe(this.g,"b")},pa.prototype.createWebChannel=pa.prototype.g,An.prototype.send=An.prototype.o,An.prototype.open=An.prototype.m,An.prototype.close=An.prototype.close,dv=function(){return new pa},uv=function(){return Bs()},cv=Rt,b0={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},oi.NO_ERROR=0,oi.TIMEOUT=8,oi.HTTP_ERROR=6,Pd=oi,dl.COMPLETE="complete",lv=dl,vr.EventType=Mn,Mn.OPEN="a",Mn.CLOSE="b",Mn.ERROR="c",Mn.MESSAGE="d",Qe.prototype.listen=Qe.prototype.J,mc=vr,mt.prototype.listenOnce=mt.prototype.K,mt.prototype.getLastError=mt.prototype.Ha,mt.prototype.getLastErrorCode=mt.prototype.ya,mt.prototype.getStatus=mt.prototype.ca,mt.prototype.getResponseJson=mt.prototype.La,mt.prototype.getResponseText=mt.prototype.la,mt.prototype.send=mt.prototype.ea,mt.prototype.setWithCredentials=mt.prototype.Fa,ov=mt}).apply(typeof Sd<"u"?Sd:typeof self<"u"?self:typeof window<"u"?window:{});const s1="@firebase/firestore",r1="4.9.2";class Nn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Nn.UNAUTHENTICATED=new Nn(null),Nn.GOOGLE_CREDENTIALS=new Nn("google-credentials-uid"),Nn.FIRST_PARTY=new Nn("first-party-uid"),Nn.MOCK_USER=new Nn("mock-user");let al="12.3.0";const Bi=new B0("@firebase/firestore");function Po(){return Bi.logLevel}function ye(s,...e){if(Bi.logLevel<=Xe.DEBUG){const n=e.map(tg);Bi.debug(`Firestore (${al}): ${s}`,...n)}}function Zr(s,...e){if(Bi.logLevel<=Xe.ERROR){const n=e.map(tg);Bi.error(`Firestore (${al}): ${s}`,...n)}}function $o(s,...e){if(Bi.logLevel<=Xe.WARN){const n=e.map(tg);Bi.warn(`Firestore (${al}): ${s}`,...n)}}function tg(s){if(typeof s=="string")return s;try{return(function(n){return JSON.stringify(n)})(s)}catch{return s}}function De(s,e,n){let a="Unexpected state";typeof e=="string"?a=e:n=e,hv(s,a,n)}function hv(s,e,n){let a=`FIRESTORE (${al}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(n!==void 0)try{a+=" CONTEXT: "+JSON.stringify(n)}catch{a+=" CONTEXT: "+n}throw Zr(a),new Error(a)}function ct(s,e,n,a){let l="Unexpected state";typeof n=="string"?l=n:a=n,s||hv(e,l,a)}function Pe(s,e){return s}const re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class fe extends na{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Qr{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class fv{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class W3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(Nn.UNAUTHENTICATED)))}shutdown(){}}class eE{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class tE{constructor(e){this.t=e,this.currentUser=Nn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ct(this.o===void 0,42304);let a=this.i;const l=g=>this.i!==a?(a=this.i,n(g)):Promise.resolve();let u=new Qr;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new Qr,e.enqueueRetryable((()=>l(this.currentUser)))};const h=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),h())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new Qr)}}),0),h()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((a=>this.i!==e?(ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):a?(ct(typeof a.accessToken=="string",31837,{l:a}),new fv(a.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ct(e===null||typeof e=="string",2055,{h:e}),new Nn(e)}}class nE{constructor(e,n,a){this.P=e,this.T=n,this.I=a,this.type="FirstParty",this.user=Nn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class sE{constructor(e,n,a){this.P=e,this.T=n,this.I=a}getToken(){return Promise.resolve(new nE(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(Nn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class a1{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class rE{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,as(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ct(this.o===void 0,3512);const a=u=>{u.error!=null&&ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const h=u.token!==this.m;return this.m=u.token,ye("FirebaseAppCheckTokenProvider",`Received ${h?"new":"existing"} token.`),h?n(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>a(u)))};const l=u=>{ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new a1(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(ct(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new a1(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function aE(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let a=0;a<s;a++)n[a]=Math.floor(256*Math.random());return n}class ng{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let a="";for(;a.length<20;){const l=aE(40);for(let u=0;u<l.length;++u)a.length<20&&l[u]<n&&(a+=e.charAt(l[u]%62))}return a}}function Ze(s,e){return s<e?-1:s>e?1:0}function v0(s,e){const n=Math.min(s.length,e.length);for(let a=0;a<n;a++){const l=s.charAt(a),u=e.charAt(a);if(l!==u)return a0(l)===a0(u)?Ze(l,u):a0(l)?1:-1}return Ze(s.length,e.length)}const iE=55296,oE=57343;function a0(s){const e=s.charCodeAt(0);return e>=iE&&e<=oE}function Qo(s,e,n){return s.length===e.length&&s.every(((a,l)=>n(a,e[l])))}const i1="__name__";class or{constructor(e,n,a){n===void 0?n=0:n>e.length&&De(637,{offset:n,range:e.length}),a===void 0?a=e.length-n:a>e.length-n&&De(1746,{length:a,range:e.length-n}),this.segments=e,this.offset=n,this.len=a}get length(){return this.len}isEqual(e){return or.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof or?e.forEach((a=>{n.push(a)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,a=this.limit();n<a;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const a=Math.min(e.length,n.length);for(let l=0;l<a;l++){const u=or.compareSegments(e.get(l),n.get(l));if(u!==0)return u}return Ze(e.length,n.length)}static compareSegments(e,n){const a=or.isNumericId(e),l=or.isNumericId(n);return a&&!l?-1:!a&&l?1:a&&l?or.extractNumericId(e).compare(or.extractNumericId(n)):v0(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ka.fromString(e.substring(4,e.length-2))}}class vt extends or{construct(e,n,a){return new vt(e,n,a)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const a of e){if(a.indexOf("//")>=0)throw new fe(re.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);n.push(...a.split("/").filter((l=>l.length>0)))}return new vt(n)}static emptyPath(){return new vt([])}}const lE=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class pn extends or{construct(e,n,a){return new pn(e,n,a)}static isValidIdentifier(e){return lE.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),pn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===i1}static keyField(){return new pn([i1])}static fromServerFormat(e){const n=[];let a="",l=0;const u=()=>{if(a.length===0)throw new fe(re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(a),a=""};let h=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new fe(re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new fe(re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);a+=g,l+=2}else p==="`"?(h=!h,l++):p!=="."||h?(a+=p,l++):(u(),l++)}if(u(),h)throw new fe(re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new pn(n)}static emptyPath(){return new pn([])}}class Se{constructor(e){this.path=e}static fromPath(e){return new Se(vt.fromString(e))}static fromName(e){return new Se(vt.fromString(e).popFirst(5))}static empty(){return new Se(vt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&vt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return vt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Se(new vt(e.slice()))}}function mv(s,e,n){if(!n)throw new fe(re.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function cE(s,e,n,a){if(e===!0&&a===!0)throw new fe(re.INVALID_ARGUMENT,`${s} and ${n} cannot be used together.`)}function o1(s){if(!Se.isDocumentKey(s))throw new fe(re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function l1(s){if(Se.isDocumentKey(s))throw new fe(re.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function gv(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function wh(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(a){return a.constructor?a.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":De(12329,{type:typeof s})}function Rn(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new fe(re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=wh(s);throw new fe(re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return s}function uE(s,e){if(e<=0)throw new fe(re.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}function Zt(s,e){const n={typeString:s};return e&&(n.value=e),n}function qc(s,e){if(!gv(s))throw new fe(re.INVALID_ARGUMENT,"JSON must be an object");let n;for(const a in e)if(e[a]){const l=e[a].typeString,u="value"in e[a]?{value:e[a].value}:void 0;if(!(a in s)){n=`JSON missing required field: '${a}'`;break}const h=s[a];if(l&&typeof h!==l){n=`JSON field '${a}' must be a ${l}.`;break}if(u!==void 0&&h!==u.value){n=`Expected '${a}' field to equal '${u.value}'`;break}}if(n)throw new fe(re.INVALID_ARGUMENT,n);return!0}const c1=-62135596800,u1=1e6;class Et{static now(){return Et.fromMillis(Date.now())}static fromDate(e){return Et.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),a=Math.floor((e-1e3*n)*u1);return new Et(n,a)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new fe(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new fe(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<c1)throw new fe(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new fe(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/u1}_compareTo(e){return this.seconds===e.seconds?Ze(this.nanoseconds,e.nanoseconds):Ze(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Et._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(qc(e,Et._jsonSchema))return new Et(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-c1;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Et._jsonSchemaVersion="firestore/timestamp/1.0",Et._jsonSchema={type:Zt("string",Et._jsonSchemaVersion),seconds:Zt("number"),nanoseconds:Zt("number")};class Ve{static fromTimestamp(e){return new Ve(e)}static min(){return new Ve(new Et(0,0))}static max(){return new Ve(new Et(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Ac=-1;function dE(s,e){const n=s.toTimestamp().seconds,a=s.toTimestamp().nanoseconds+1,l=Ve.fromTimestamp(a===1e9?new Et(n+1,0):new Et(n,a));return new Za(l,Se.empty(),e)}function hE(s){return new Za(s.readTime,s.key,Ac)}class Za{constructor(e,n,a){this.readTime=e,this.documentKey=n,this.largestBatchId=a}static min(){return new Za(Ve.min(),Se.empty(),Ac)}static max(){return new Za(Ve.max(),Se.empty(),Ac)}}function fE(s,e){let n=s.readTime.compareTo(e.readTime);return n!==0?n:(n=Se.comparator(s.documentKey,e.documentKey),n!==0?n:Ze(s.largestBatchId,e.largestBatchId))}const mE="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class gE{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function il(s){if(s.code!==re.FAILED_PRECONDITION||s.message!==mE)throw s;ye("LocalStore","Unexpectedly lost primary lease")}class le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&De(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new le(((a,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(a,l)},this.catchCallback=u=>{this.wrapFailure(n,u).next(a,l)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof le?n:le.resolve(n)}catch(n){return le.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):le.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):le.reject(n)}static resolve(e){return new le(((n,a)=>{n(e)}))}static reject(e){return new le(((n,a)=>{a(e)}))}static waitFor(e){return new le(((n,a)=>{let l=0,u=0,h=!1;e.forEach((p=>{++l,p.next((()=>{++u,h&&u===l&&n()}),(g=>a(g)))})),h=!0,u===l&&n()}))}static or(e){let n=le.resolve(!1);for(const a of e)n=n.next((l=>l?le.resolve(l):a()));return n}static forEach(e,n){const a=[];return e.forEach(((l,u)=>{a.push(n.call(this,l,u))})),this.waitFor(a)}static mapArray(e,n){return new le(((a,l)=>{const u=e.length,h=new Array(u);let p=0;for(let g=0;g<u;g++){const x=g;n(e[x]).next((y=>{h[x]=y,++p,p===u&&a(h)}),(y=>l(y)))}}))}static doWhile(e,n){return new le(((a,l)=>{const u=()=>{e()===!0?n().next((()=>{u()}),l):a()};u()}))}}function pE(s){const e=s.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function ol(s){return s.name==="IndexedDbTransactionError"}class _h{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=a=>this.ae(a),this.ue=a=>n.writeSequenceNumber(a))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}_h.ce=-1;const sg=-1;function Nh(s){return s==null}function Wd(s){return s===0&&1/s==-1/0}function xE(s){return typeof s=="number"&&Number.isInteger(s)&&!Wd(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const pv="";function yE(s){let e="";for(let n=0;n<s.length;n++)e.length>0&&(e=d1(e)),e=bE(s.get(n),e);return d1(e)}function bE(s,e){let n=e;const a=s.length;for(let l=0;l<a;l++){const u=s.charAt(l);switch(u){case"\0":n+="";break;case pv:n+="";break;default:n+=u}}return n}function d1(s){return s+pv+""}function h1(s){let e=0;for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&e++;return e}function ri(s,e){for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&e(n,s[n])}function xv(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class Mt{constructor(e,n){this.comparator=e,this.root=n||mn.EMPTY}insert(e,n){return new Mt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,mn.BLACK,null,null))}remove(e){return new Mt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,mn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return n.value;a<0?n=n.left:a>0&&(n=n.right)}return null}indexOf(e){let n=0,a=this.root;for(;!a.isEmpty();){const l=this.comparator(e,a.key);if(l===0)return n+a.left.size;l<0?a=a.left:(n+=a.left.size+1,a=a.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,a)=>(e(n,a),!1)))}toString(){const e=[];return this.inorderTraversal(((n,a)=>(e.push(`${n}:${a}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Td(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Td(this.root,e,this.comparator,!1)}getReverseIterator(){return new Td(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Td(this.root,e,this.comparator,!0)}}class Td{constructor(e,n,a,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=n?a(e.key,n):1,n&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class mn{constructor(e,n,a,l,u){this.key=e,this.value=n,this.color=a??mn.RED,this.left=l??mn.EMPTY,this.right=u??mn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,a,l,u){return new mn(e??this.key,n??this.value,a??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,a){let l=this;const u=a(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,n,a),null):u===0?l.copy(null,n,null,null,null):l.copy(null,null,null,null,l.right.insert(e,n,a)),l.fixUp()}removeMin(){if(this.left.isEmpty())return mn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let a,l=this;if(n(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,n),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),n(e,l.key)===0){if(l.right.isEmpty())return mn.EMPTY;a=l.right.min(),l=l.copy(a.key,a.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,n))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,mn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,mn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw De(43730,{key:this.key,value:this.value});if(this.right.isRed())throw De(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw De(27949);return e+(this.isRed()?0:1)}}mn.EMPTY=null,mn.RED=!0,mn.BLACK=!1;mn.EMPTY=new class{constructor(){this.size=0}get key(){throw De(57766)}get value(){throw De(16141)}get color(){throw De(16727)}get left(){throw De(29726)}get right(){throw De(36894)}copy(e,n,a,l,u){return this}insert(e,n,a){return new mn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class en{constructor(e){this.comparator=e,this.data=new Mt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,a)=>(e(n),!1)))}forEachInRange(e,n){const a=this.data.getIteratorFrom(e[0]);for(;a.hasNext();){const l=a.getNext();if(this.comparator(l.key,e[1])>=0)return;n(l.key)}}forEachWhile(e,n){let a;for(a=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();a.hasNext();)if(!e(a.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new f1(this.data.getIterator())}getIteratorFrom(e){return new f1(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((a=>{n=n.add(a)})),n}isEqual(e){if(!(e instanceof en)||this.size!==e.size)return!1;const n=this.data.getIterator(),a=e.data.getIterator();for(;n.hasNext();){const l=n.getNext().key,u=a.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new en(this.comparator);return n.data=e,n}}class f1{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class is{constructor(e){this.fields=e,e.sort(pn.comparator)}static empty(){return new is([])}unionWith(e){let n=new en(pn.comparator);for(const a of this.fields)n=n.add(a);for(const a of e)n=n.add(a);return new is(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Qo(this.fields,e.fields,((n,a)=>n.isEqual(a)))}}class yv extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class xn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new yv("Invalid base64 string: "+u):u}})(e);return new xn(n)}static fromUint8Array(e){const n=(function(l){let u="";for(let h=0;h<l.length;++h)u+=String.fromCharCode(l[h]);return u})(e);return new xn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const a=new Uint8Array(n.length);for(let l=0;l<n.length;l++)a[l]=n.charCodeAt(l);return a})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ze(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}xn.EMPTY_BYTE_STRING=new xn("");const vE=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ja(s){if(ct(!!s,39018),typeof s=="string"){let e=0;const n=vE.exec(s);if(ct(!!n,46558,{timestamp:s}),n[1]){let l=n[1];l=(l+"000000000").substr(0,9),e=Number(l)}const a=new Date(s);return{seconds:Math.floor(a.getTime()/1e3),nanos:e}}return{seconds:Bt(s.seconds),nanos:Bt(s.nanos)}}function Bt(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function Wa(s){return typeof s=="string"?xn.fromBase64String(s):xn.fromUint8Array(s)}const bv="server_timestamp",vv="__type__",wv="__previous_value__",_v="__local_write_time__";function rg(s){return(s?.mapValue?.fields||{})[vv]?.stringValue===bv}function Eh(s){const e=s.mapValue.fields[wv];return rg(e)?Eh(e):e}function Cc(s){const e=Ja(s.mapValue.fields[_v].timestampValue);return new Et(e.seconds,e.nanos)}class wE{constructor(e,n,a,l,u,h,p,g,x,y){this.databaseId=e,this.appId=n,this.persistenceKey=a,this.host=l,this.ssl=u,this.forceLongPolling=h,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=x,this.isUsingEmulator=y}}const eh="(default)";class Rc{constructor(e,n){this.projectId=e,this.database=n||eh}static empty(){return new Rc("","")}get isDefaultDatabase(){return this.database===eh}isEqual(e){return e instanceof Rc&&e.projectId===this.projectId&&e.database===this.database}}const Nv="__type__",_E="__max__",Ad={mapValue:{}},Ev="__vector__",th="value";function ei(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?rg(s)?4:EE(s)?9007199254740991:NE(s)?10:11:De(28295,{value:s})}function gr(s,e){if(s===e)return!0;const n=ei(s);if(n!==ei(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return Cc(s).isEqual(Cc(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const h=Ja(l.timestampValue),p=Ja(u.timestampValue);return h.seconds===p.seconds&&h.nanos===p.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(l,u){return Wa(l.bytesValue).isEqual(Wa(u.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(l,u){return Bt(l.geoPointValue.latitude)===Bt(u.geoPointValue.latitude)&&Bt(l.geoPointValue.longitude)===Bt(u.geoPointValue.longitude)})(s,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return Bt(l.integerValue)===Bt(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const h=Bt(l.doubleValue),p=Bt(u.doubleValue);return h===p?Wd(h)===Wd(p):isNaN(h)&&isNaN(p)}return!1})(s,e);case 9:return Qo(s.arrayValue.values||[],e.arrayValue.values||[],gr);case 10:case 11:return(function(l,u){const h=l.mapValue.fields||{},p=u.mapValue.fields||{};if(h1(h)!==h1(p))return!1;for(const g in h)if(h.hasOwnProperty(g)&&(p[g]===void 0||!gr(h[g],p[g])))return!1;return!0})(s,e);default:return De(52216,{left:s})}}function Dc(s,e){return(s.values||[]).find((n=>gr(n,e)))!==void 0}function Yo(s,e){if(s===e)return 0;const n=ei(s),a=ei(e);if(n!==a)return Ze(n,a);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ze(s.booleanValue,e.booleanValue);case 2:return(function(u,h){const p=Bt(u.integerValue||u.doubleValue),g=Bt(h.integerValue||h.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(s,e);case 3:return m1(s.timestampValue,e.timestampValue);case 4:return m1(Cc(s),Cc(e));case 5:return v0(s.stringValue,e.stringValue);case 6:return(function(u,h){const p=Wa(u),g=Wa(h);return p.compareTo(g)})(s.bytesValue,e.bytesValue);case 7:return(function(u,h){const p=u.split("/"),g=h.split("/");for(let x=0;x<p.length&&x<g.length;x++){const y=Ze(p[x],g[x]);if(y!==0)return y}return Ze(p.length,g.length)})(s.referenceValue,e.referenceValue);case 8:return(function(u,h){const p=Ze(Bt(u.latitude),Bt(h.latitude));return p!==0?p:Ze(Bt(u.longitude),Bt(h.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return g1(s.arrayValue,e.arrayValue);case 10:return(function(u,h){const p=u.fields||{},g=h.fields||{},x=p[th]?.arrayValue,y=g[th]?.arrayValue,v=Ze(x?.values?.length||0,y?.values?.length||0);return v!==0?v:g1(x,y)})(s.mapValue,e.mapValue);case 11:return(function(u,h){if(u===Ad.mapValue&&h===Ad.mapValue)return 0;if(u===Ad.mapValue)return 1;if(h===Ad.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),x=h.fields||{},y=Object.keys(x);g.sort(),y.sort();for(let v=0;v<g.length&&v<y.length;++v){const _=v0(g[v],y[v]);if(_!==0)return _;const E=Yo(p[g[v]],x[y[v]]);if(E!==0)return E}return Ze(g.length,y.length)})(s.mapValue,e.mapValue);default:throw De(23264,{he:n})}}function m1(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return Ze(s,e);const n=Ja(s),a=Ja(e),l=Ze(n.seconds,a.seconds);return l!==0?l:Ze(n.nanos,a.nanos)}function g1(s,e){const n=s.values||[],a=e.values||[];for(let l=0;l<n.length&&l<a.length;++l){const u=Yo(n[l],a[l]);if(u)return u}return Ze(n.length,a.length)}function Ko(s){return w0(s)}function w0(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(n){const a=Ja(n);return`time(${a.seconds},${a.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(n){return Wa(n).toBase64()})(s.bytesValue):"referenceValue"in s?(function(n){return Se.fromName(n).toString()})(s.referenceValue):"geoPointValue"in s?(function(n){return`geo(${n.latitude},${n.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(n){let a="[",l=!0;for(const u of n.values||[])l?l=!1:a+=",",a+=w0(u);return a+"]"})(s.arrayValue):"mapValue"in s?(function(n){const a=Object.keys(n.fields||{}).sort();let l="{",u=!0;for(const h of a)u?u=!1:l+=",",l+=`${h}:${w0(n.fields[h])}`;return l+"}"})(s.mapValue):De(61005,{value:s})}function Ld(s){switch(ei(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Eh(s);return e?16+Ld(e):16;case 5:return 2*s.stringValue.length;case 6:return Wa(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(a){return(a.values||[]).reduce(((l,u)=>l+Ld(u)),0)})(s.arrayValue);case 10:case 11:return(function(a){let l=0;return ri(a.fields,((u,h)=>{l+=u.length+Ld(h)})),l})(s.mapValue);default:throw De(13486,{value:s})}}function p1(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function _0(s){return!!s&&"integerValue"in s}function ag(s){return!!s&&"arrayValue"in s}function x1(s){return!!s&&"nullValue"in s}function y1(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Ud(s){return!!s&&"mapValue"in s}function NE(s){return(s?.mapValue?.fields||{})[Nv]?.stringValue===Ev}function vc(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return ri(s.mapValue.fields,((n,a)=>e.mapValue.fields[n]=vc(a))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(s.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=vc(s.arrayValue.values[n]);return e}return{...s}}function EE(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===_E}class Gn{constructor(e){this.value=e}static empty(){return new Gn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let a=0;a<e.length-1;++a)if(n=(n.mapValue.fields||{})[e.get(a)],!Ud(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=vc(n)}setAll(e){let n=pn.emptyPath(),a={},l=[];e.forEach(((h,p)=>{if(!n.isImmediateParentOf(p)){const g=this.getFieldsMap(n);this.applyChanges(g,a,l),a={},l=[],n=p.popLast()}h?a[p.lastSegment()]=vc(h):l.push(p.lastSegment())}));const u=this.getFieldsMap(n);this.applyChanges(u,a,l)}delete(e){const n=this.field(e.popLast());Ud(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return gr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let a=0;a<e.length;++a){let l=n.mapValue.fields[e.get(a)];Ud(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},n.mapValue.fields[e.get(a)]=l),n=l}return n.mapValue.fields}applyChanges(e,n,a){ri(n,((l,u)=>e[l]=u));for(const l of a)delete e[l]}clone(){return new Gn(vc(this.value))}}function jv(s){const e=[];return ri(s.fields,((n,a)=>{const l=new pn([n]);if(Ud(a)){const u=jv(a.mapValue).fields;if(u.length===0)e.push(l);else for(const h of u)e.push(l.child(h))}else e.push(l)})),new is(e)}class En{constructor(e,n,a,l,u,h,p){this.key=e,this.documentType=n,this.version=a,this.readTime=l,this.createTime=u,this.data=h,this.documentState=p}static newInvalidDocument(e){return new En(e,0,Ve.min(),Ve.min(),Ve.min(),Gn.empty(),0)}static newFoundDocument(e,n,a,l){return new En(e,1,n,Ve.min(),a,l,0)}static newNoDocument(e,n){return new En(e,2,n,Ve.min(),Ve.min(),Gn.empty(),0)}static newUnknownDocument(e,n){return new En(e,3,n,Ve.min(),Ve.min(),Gn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Gn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Gn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof En&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new En(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class nh{constructor(e,n){this.position=e,this.inclusive=n}}function b1(s,e,n){let a=0;for(let l=0;l<s.position.length;l++){const u=e[l],h=s.position[l];if(u.field.isKeyField()?a=Se.comparator(Se.fromName(h.referenceValue),n.key):a=Yo(h,n.data.field(u.field)),u.dir==="desc"&&(a*=-1),a!==0)break}return a}function v1(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let n=0;n<s.position.length;n++)if(!gr(s.position[n],e.position[n]))return!1;return!0}class Ic{constructor(e,n="asc"){this.field=e,this.dir=n}}function jE(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class Sv{}class Xt extends Sv{constructor(e,n,a){super(),this.field=e,this.op=n,this.value=a}static create(e,n,a){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,a):new TE(e,n,a):n==="array-contains"?new RE(e,a):n==="in"?new DE(e,a):n==="not-in"?new IE(e,a):n==="array-contains-any"?new ME(e,a):new Xt(e,n,a)}static createKeyFieldInFilter(e,n,a){return n==="in"?new AE(e,a):new CE(e,a)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Yo(n,this.value)):n!==null&&ei(this.value)===ei(n)&&this.matchesComparison(Yo(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return De(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Us extends Sv{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Us(e,n)}matches(e){return Tv(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Tv(s){return s.op==="and"}function Av(s){return SE(s)&&Tv(s)}function SE(s){for(const e of s.filters)if(e instanceof Us)return!1;return!0}function N0(s){if(s instanceof Xt)return s.field.canonicalString()+s.op.toString()+Ko(s.value);if(Av(s))return s.filters.map((e=>N0(e))).join(",");{const e=s.filters.map((n=>N0(n))).join(",");return`${s.op}(${e})`}}function Cv(s,e){return s instanceof Xt?(function(a,l){return l instanceof Xt&&a.op===l.op&&a.field.isEqual(l.field)&&gr(a.value,l.value)})(s,e):s instanceof Us?(function(a,l){return l instanceof Us&&a.op===l.op&&a.filters.length===l.filters.length?a.filters.reduce(((u,h,p)=>u&&Cv(h,l.filters[p])),!0):!1})(s,e):void De(19439)}function Rv(s){return s instanceof Xt?(function(n){return`${n.field.canonicalString()} ${n.op} ${Ko(n.value)}`})(s):s instanceof Us?(function(n){return n.op.toString()+" {"+n.getFilters().map(Rv).join(" ,")+"}"})(s):"Filter"}class TE extends Xt{constructor(e,n,a){super(e,n,a),this.key=Se.fromName(a.referenceValue)}matches(e){const n=Se.comparator(e.key,this.key);return this.matchesComparison(n)}}class AE extends Xt{constructor(e,n){super(e,"in",n),this.keys=Dv("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class CE extends Xt{constructor(e,n){super(e,"not-in",n),this.keys=Dv("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function Dv(s,e){return(e.arrayValue?.values||[]).map((n=>Se.fromName(n.referenceValue)))}class RE extends Xt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return ag(n)&&Dc(n.arrayValue,this.value)}}class DE extends Xt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Dc(this.value.arrayValue,n)}}class IE extends Xt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Dc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Dc(this.value.arrayValue,n)}}class ME extends Xt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!ag(n)||!n.arrayValue.values)&&n.arrayValue.values.some((a=>Dc(this.value.arrayValue,a)))}}class kE{constructor(e,n=null,a=[],l=[],u=null,h=null,p=null){this.path=e,this.collectionGroup=n,this.orderBy=a,this.filters=l,this.limit=u,this.startAt=h,this.endAt=p,this.Te=null}}function w1(s,e=null,n=[],a=[],l=null,u=null,h=null){return new kE(s,e,n,a,l,u,h)}function ig(s){const e=Pe(s);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((a=>N0(a))).join(","),n+="|ob:",n+=e.orderBy.map((a=>(function(u){return u.field.canonicalString()+u.dir})(a))).join(","),Nh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((a=>Ko(a))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((a=>Ko(a))).join(",")),e.Te=n}return e.Te}function og(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<s.orderBy.length;n++)if(!jE(s.orderBy[n],e.orderBy[n]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let n=0;n<s.filters.length;n++)if(!Cv(s.filters[n],e.filters[n]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!v1(s.startAt,e.startAt)&&v1(s.endAt,e.endAt)}function E0(s){return Se.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}class ll{constructor(e,n=null,a=[],l=[],u=null,h="F",p=null,g=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=a,this.filters=l,this.limit=u,this.limitType=h,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function VE(s,e,n,a,l,u,h,p){return new ll(s,e,n,a,l,u,h,p)}function jh(s){return new ll(s)}function _1(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function Iv(s){return s.collectionGroup!==null}function wc(s){const e=Pe(s);if(e.Ie===null){e.Ie=[];const n=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),n.add(u.field.canonicalString());const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(h){let p=new en(pn.comparator);return h.filters.forEach((g=>{g.getFlattenedFilters().forEach((x=>{x.isInequality()&&(p=p.add(x.field))}))})),p})(e).forEach((u=>{n.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new Ic(u,a))})),n.has(pn.keyField().canonicalString())||e.Ie.push(new Ic(pn.keyField(),a))}return e.Ie}function ur(s){const e=Pe(s);return e.Ee||(e.Ee=OE(e,wc(s))),e.Ee}function OE(s,e){if(s.limitType==="F")return w1(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new Ic(l.field,u)}));const n=s.endAt?new nh(s.endAt.position,s.endAt.inclusive):null,a=s.startAt?new nh(s.startAt.position,s.startAt.inclusive):null;return w1(s.path,s.collectionGroup,e,s.filters,s.limit,n,a)}}function j0(s,e){const n=s.filters.concat([e]);return new ll(s.path,s.collectionGroup,s.explicitOrderBy.slice(),n,s.limit,s.limitType,s.startAt,s.endAt)}function sh(s,e,n){return new ll(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,n,s.startAt,s.endAt)}function Sh(s,e){return og(ur(s),ur(e))&&s.limitType===e.limitType}function Mv(s){return`${ig(ur(s))}|lt:${s.limitType}`}function Lo(s){return`Query(target=${(function(n){let a=n.path.canonicalString();return n.collectionGroup!==null&&(a+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(a+=`, filters: [${n.filters.map((l=>Rv(l))).join(", ")}]`),Nh(n.limit)||(a+=", limit: "+n.limit),n.orderBy.length>0&&(a+=`, orderBy: [${n.orderBy.map((l=>(function(h){return`${h.field.canonicalString()} (${h.dir})`})(l))).join(", ")}]`),n.startAt&&(a+=", startAt: ",a+=n.startAt.inclusive?"b:":"a:",a+=n.startAt.position.map((l=>Ko(l))).join(",")),n.endAt&&(a+=", endAt: ",a+=n.endAt.inclusive?"a:":"b:",a+=n.endAt.position.map((l=>Ko(l))).join(",")),`Target(${a})`})(ur(s))}; limitType=${s.limitType})`}function Th(s,e){return e.isFoundDocument()&&(function(a,l){const u=l.key.path;return a.collectionGroup!==null?l.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(u):Se.isDocumentKey(a.path)?a.path.isEqual(u):a.path.isImmediateParentOf(u)})(s,e)&&(function(a,l){for(const u of wc(a))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(s,e)&&(function(a,l){for(const u of a.filters)if(!u.matches(l))return!1;return!0})(s,e)&&(function(a,l){return!(a.startAt&&!(function(h,p,g){const x=b1(h,p,g);return h.inclusive?x<=0:x<0})(a.startAt,wc(a),l)||a.endAt&&!(function(h,p,g){const x=b1(h,p,g);return h.inclusive?x>=0:x>0})(a.endAt,wc(a),l))})(s,e)}function PE(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function kv(s){return(e,n)=>{let a=!1;for(const l of wc(s)){const u=LE(l,e,n);if(u!==0)return u;a=a||l.field.isKeyField()}return 0}}function LE(s,e,n){const a=s.field.isKeyField()?Se.comparator(e.key,n.key):(function(u,h,p){const g=h.data.field(u),x=p.data.field(u);return g!==null&&x!==null?Yo(g,x):De(42886)})(s.field,e,n);switch(s.dir){case"asc":return a;case"desc":return-1*a;default:return De(19790,{direction:s.dir})}}class qi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),a=this.inner[n];if(a!==void 0){for(const[l,u]of a)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,n){const a=this.mapKeyFn(e),l=this.inner[a];if(l===void 0)return this.inner[a]=[[e,n]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,n]);l.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return!1;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return a.length===1?delete this.inner[n]:a.splice(l,1),this.innerSize--,!0;return!1}forEach(e){ri(this.inner,((n,a)=>{for(const[l,u]of a)e(l,u)}))}isEmpty(){return xv(this.inner)}size(){return this.innerSize}}const UE=new Mt(Se.comparator);function Jr(){return UE}const Vv=new Mt(Se.comparator);function gc(...s){let e=Vv;for(const n of s)e=e.insert(n.key,n);return e}function Ov(s){let e=Vv;return s.forEach(((n,a)=>e=e.insert(n,a.overlayedDocument))),e}function Vi(){return _c()}function Pv(){return _c()}function _c(){return new qi((s=>s.toString()),((s,e)=>s.isEqual(e)))}const zE=new Mt(Se.comparator),BE=new en(Se.comparator);function Je(...s){let e=BE;for(const n of s)e=e.add(n);return e}const FE=new en(Ze);function qE(){return FE}function lg(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Wd(e)?"-0":e}}function Lv(s){return{integerValue:""+s}}function Uv(s,e){return xE(e)?Lv(e):lg(s,e)}class Ah{constructor(){this._=void 0}}function HE(s,e,n){return s instanceof Mc?(function(l,u){const h={fields:{[vv]:{stringValue:bv},[_v]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&rg(u)&&(u=Eh(u)),u&&(h.fields[wv]=u),{mapValue:h}})(n,e):s instanceof Xo?Bv(s,e):s instanceof Zo?Fv(s,e):(function(l,u){const h=zv(l,u),p=N1(h)+N1(l.Ae);return _0(h)&&_0(l.Ae)?Lv(p):lg(l.serializer,p)})(s,e)}function GE(s,e,n){return s instanceof Xo?Bv(s,e):s instanceof Zo?Fv(s,e):n}function zv(s,e){return s instanceof kc?(function(a){return _0(a)||(function(u){return!!u&&"doubleValue"in u})(a)})(e)?e:{integerValue:0}:null}class Mc extends Ah{}class Xo extends Ah{constructor(e){super(),this.elements=e}}function Bv(s,e){const n=qv(e);for(const a of s.elements)n.some((l=>gr(l,a)))||n.push(a);return{arrayValue:{values:n}}}class Zo extends Ah{constructor(e){super(),this.elements=e}}function Fv(s,e){let n=qv(e);for(const a of s.elements)n=n.filter((l=>!gr(l,a)));return{arrayValue:{values:n}}}class kc extends Ah{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function N1(s){return Bt(s.integerValue||s.doubleValue)}function qv(s){return ag(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class Ch{constructor(e,n){this.field=e,this.transform=n}}function $E(s,e){return s.field.isEqual(e.field)&&(function(a,l){return a instanceof Xo&&l instanceof Xo||a instanceof Zo&&l instanceof Zo?Qo(a.elements,l.elements,gr):a instanceof kc&&l instanceof kc?gr(a.Ae,l.Ae):a instanceof Mc&&l instanceof Mc})(s.transform,e.transform)}class QE{constructor(e,n){this.version=e,this.transformResults=n}}class Dn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Dn}static exists(e){return new Dn(void 0,e)}static updateTime(e){return new Dn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function zd(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class Rh{}function Hv(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new Dh(s.key,Dn.none()):new Hc(s.key,s.data,Dn.none());{const n=s.data,a=Gn.empty();let l=new en(pn.comparator);for(let u of e.fields)if(!l.has(u)){let h=n.field(u);h===null&&u.length>1&&(u=u.popLast(),h=n.field(u)),h===null?a.delete(u):a.set(u,h),l=l.add(u)}return new ai(s.key,a,new is(l.toArray()),Dn.none())}}function YE(s,e,n){s instanceof Hc?(function(l,u,h){const p=l.value.clone(),g=j1(l.fieldTransforms,u,h.transformResults);p.setAll(g),u.convertToFoundDocument(h.version,p).setHasCommittedMutations()})(s,e,n):s instanceof ai?(function(l,u,h){if(!zd(l.precondition,u))return void u.convertToUnknownDocument(h.version);const p=j1(l.fieldTransforms,u,h.transformResults),g=u.data;g.setAll(Gv(l)),g.setAll(p),u.convertToFoundDocument(h.version,g).setHasCommittedMutations()})(s,e,n):(function(l,u,h){u.convertToNoDocument(h.version).setHasCommittedMutations()})(0,e,n)}function Nc(s,e,n,a){return s instanceof Hc?(function(u,h,p,g){if(!zd(u.precondition,h))return p;const x=u.value.clone(),y=S1(u.fieldTransforms,g,h);return x.setAll(y),h.convertToFoundDocument(h.version,x).setHasLocalMutations(),null})(s,e,n,a):s instanceof ai?(function(u,h,p,g){if(!zd(u.precondition,h))return p;const x=S1(u.fieldTransforms,g,h),y=h.data;return y.setAll(Gv(u)),y.setAll(x),h.convertToFoundDocument(h.version,y).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((v=>v.field)))})(s,e,n,a):(function(u,h,p){return zd(u.precondition,h)?(h.convertToNoDocument(h.version).setHasLocalMutations(),null):p})(s,e,n)}function KE(s,e){let n=null;for(const a of s.fieldTransforms){const l=e.data.field(a.field),u=zv(a.transform,l||null);u!=null&&(n===null&&(n=Gn.empty()),n.set(a.field,u))}return n||null}function E1(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(a,l){return a===void 0&&l===void 0||!(!a||!l)&&Qo(a,l,((u,h)=>$E(u,h)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Hc extends Rh{constructor(e,n,a,l=[]){super(),this.key=e,this.value=n,this.precondition=a,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class ai extends Rh{constructor(e,n,a,l,u=[]){super(),this.key=e,this.data=n,this.fieldMask=a,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function Gv(s){const e=new Map;return s.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const a=s.data.field(n);e.set(n,a)}})),e}function j1(s,e,n){const a=new Map;ct(s.length===n.length,32656,{Re:n.length,Ve:s.length});for(let l=0;l<n.length;l++){const u=s[l],h=u.transform,p=e.data.field(u.field);a.set(u.field,GE(h,p,n[l]))}return a}function S1(s,e,n){const a=new Map;for(const l of s){const u=l.transform,h=n.data.field(l.field);a.set(l.field,HE(u,h,e))}return a}class Dh extends Rh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class XE extends Rh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class ZE{constructor(e,n,a,l){this.batchId=e,this.localWriteTime=n,this.baseMutations=a,this.mutations=l}applyToRemoteDocument(e,n){const a=n.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&YE(u,e,a[l])}}applyToLocalView(e,n){for(const a of this.baseMutations)a.key.isEqual(e.key)&&(n=Nc(a,e,n,this.localWriteTime));for(const a of this.mutations)a.key.isEqual(e.key)&&(n=Nc(a,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const a=Pv();return this.mutations.forEach((l=>{const u=e.get(l.key),h=u.overlayedDocument;let p=this.applyToLocalView(h,u.mutatedFields);p=n.has(l.key)?null:p;const g=Hv(h,p);g!==null&&a.set(l.key,g),h.isValidDocument()||h.convertToNoDocument(Ve.min())})),a}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),Je())}isEqual(e){return this.batchId===e.batchId&&Qo(this.mutations,e.mutations,((n,a)=>E1(n,a)))&&Qo(this.baseMutations,e.baseMutations,((n,a)=>E1(n,a)))}}class cg{constructor(e,n,a,l){this.batch=e,this.commitVersion=n,this.mutationResults=a,this.docVersions=l}static from(e,n,a){ct(e.mutations.length===a.length,58842,{me:e.mutations.length,fe:a.length});let l=(function(){return zE})();const u=e.mutations;for(let h=0;h<u.length;h++)l=l.insert(u[h].key,a[h].version);return new cg(e,n,a,l)}}class JE{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class WE{constructor(e,n){this.count=e,this.unchangedNames=n}}var Kt,et;function ej(s){switch(s){case re.OK:return De(64938);case re.CANCELLED:case re.UNKNOWN:case re.DEADLINE_EXCEEDED:case re.RESOURCE_EXHAUSTED:case re.INTERNAL:case re.UNAVAILABLE:case re.UNAUTHENTICATED:return!1;case re.INVALID_ARGUMENT:case re.NOT_FOUND:case re.ALREADY_EXISTS:case re.PERMISSION_DENIED:case re.FAILED_PRECONDITION:case re.ABORTED:case re.OUT_OF_RANGE:case re.UNIMPLEMENTED:case re.DATA_LOSS:return!0;default:return De(15467,{code:s})}}function $v(s){if(s===void 0)return Zr("GRPC error has no .code"),re.UNKNOWN;switch(s){case Kt.OK:return re.OK;case Kt.CANCELLED:return re.CANCELLED;case Kt.UNKNOWN:return re.UNKNOWN;case Kt.DEADLINE_EXCEEDED:return re.DEADLINE_EXCEEDED;case Kt.RESOURCE_EXHAUSTED:return re.RESOURCE_EXHAUSTED;case Kt.INTERNAL:return re.INTERNAL;case Kt.UNAVAILABLE:return re.UNAVAILABLE;case Kt.UNAUTHENTICATED:return re.UNAUTHENTICATED;case Kt.INVALID_ARGUMENT:return re.INVALID_ARGUMENT;case Kt.NOT_FOUND:return re.NOT_FOUND;case Kt.ALREADY_EXISTS:return re.ALREADY_EXISTS;case Kt.PERMISSION_DENIED:return re.PERMISSION_DENIED;case Kt.FAILED_PRECONDITION:return re.FAILED_PRECONDITION;case Kt.ABORTED:return re.ABORTED;case Kt.OUT_OF_RANGE:return re.OUT_OF_RANGE;case Kt.UNIMPLEMENTED:return re.UNIMPLEMENTED;case Kt.DATA_LOSS:return re.DATA_LOSS;default:return De(39323,{code:s})}}(et=Kt||(Kt={}))[et.OK=0]="OK",et[et.CANCELLED=1]="CANCELLED",et[et.UNKNOWN=2]="UNKNOWN",et[et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",et[et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",et[et.NOT_FOUND=5]="NOT_FOUND",et[et.ALREADY_EXISTS=6]="ALREADY_EXISTS",et[et.PERMISSION_DENIED=7]="PERMISSION_DENIED",et[et.UNAUTHENTICATED=16]="UNAUTHENTICATED",et[et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",et[et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",et[et.ABORTED=10]="ABORTED",et[et.OUT_OF_RANGE=11]="OUT_OF_RANGE",et[et.UNIMPLEMENTED=12]="UNIMPLEMENTED",et[et.INTERNAL=13]="INTERNAL",et[et.UNAVAILABLE=14]="UNAVAILABLE",et[et.DATA_LOSS=15]="DATA_LOSS";function tj(){return new TextEncoder}const nj=new Ka([4294967295,4294967295],0);function T1(s){const e=tj().encode(s),n=new iv;return n.update(e),new Uint8Array(n.digest())}function A1(s){const e=new DataView(s.buffer),n=e.getUint32(0,!0),a=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new Ka([n,a],0),new Ka([l,u],0)]}class ug{constructor(e,n,a){if(this.bitmap=e,this.padding=n,this.hashCount=a,n<0||n>=8)throw new pc(`Invalid padding: ${n}`);if(a<0)throw new pc(`Invalid hash count: ${a}`);if(e.length>0&&this.hashCount===0)throw new pc(`Invalid hash count: ${a}`);if(e.length===0&&n!==0)throw new pc(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Ka.fromNumber(this.ge)}ye(e,n,a){let l=e.add(n.multiply(Ka.fromNumber(a)));return l.compare(nj)===1&&(l=new Ka([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=T1(e),[a,l]=A1(n);for(let u=0;u<this.hashCount;u++){const h=this.ye(a,l,u);if(!this.we(h))return!1}return!0}static create(e,n,a){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),h=new ug(u,l,n);return a.forEach((p=>h.insert(p))),h}insert(e){if(this.ge===0)return;const n=T1(e),[a,l]=A1(n);for(let u=0;u<this.hashCount;u++){const h=this.ye(a,l,u);this.Se(h)}}Se(e){const n=Math.floor(e/8),a=e%8;this.bitmap[n]|=1<<a}}class pc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Ih{constructor(e,n,a,l,u){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=a,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,n,a){const l=new Map;return l.set(e,Gc.createSynthesizedTargetChangeForCurrentChange(e,n,a)),new Ih(Ve.min(),l,new Mt(Ze),Jr(),Je())}}class Gc{constructor(e,n,a,l,u){this.resumeToken=e,this.current=n,this.addedDocuments=a,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,n,a){return new Gc(a,n,Je(),Je(),Je())}}class Bd{constructor(e,n,a,l){this.be=e,this.removedTargetIds=n,this.key=a,this.De=l}}class Qv{constructor(e,n){this.targetId=e,this.Ce=n}}class Yv{constructor(e,n,a=xn.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=n,this.resumeToken=a,this.cause=l}}class C1{constructor(){this.ve=0,this.Fe=R1(),this.Me=xn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Je(),n=Je(),a=Je();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:n=n.add(l);break;case 1:a=a.add(l);break;default:De(38017,{changeType:u})}})),new Gc(this.Me,this.xe,e,n,a)}qe(){this.Oe=!1,this.Fe=R1()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ct(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class sj{constructor(e){this.Ge=e,this.ze=new Map,this.je=Jr(),this.Je=Cd(),this.He=Cd(),this.Ye=new Mt(Ze)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const a=this.nt(n);switch(e.state){case 0:this.rt(n)&&a.Le(e.resumeToken);break;case 1:a.Ke(),a.Ne||a.qe(),a.Le(e.resumeToken);break;case 2:a.Ke(),a.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(a.We(),a.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),a.Le(e.resumeToken));break;default:De(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((a,l)=>{this.rt(l)&&n(l)}))}st(e){const n=e.targetId,a=e.Ce.count,l=this.ot(n);if(l){const u=l.target;if(E0(u))if(a===0){const h=new Se(u.path);this.et(n,h,En.newNoDocument(h,Ve.min()))}else ct(a===1,20013,{expectedCount:a});else{const h=this._t(n);if(h!==a){const p=this.ut(e),g=p?this.ct(p,e,h):1;if(g!==0){this.it(n);const x=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,x)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:a="",padding:l=0},hashCount:u=0}=n;let h,p;try{h=Wa(a).toUint8Array()}catch(g){if(g instanceof yv)return $o("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new ug(h,l,u)}catch(g){return $o(g instanceof pc?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,n,a){return n.Ce.count===a-this.Pt(e,n.targetId)?0:2}Pt(e,n){const a=this.Ge.getRemoteKeysForTarget(n);let l=0;return a.forEach((u=>{const h=this.Ge.ht(),p=`projects/${h.projectId}/databases/${h.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(n,u,null),l++)})),l}Tt(e){const n=new Map;this.ze.forEach(((u,h)=>{const p=this.ot(h);if(p){if(u.current&&E0(p.target)){const g=new Se(p.target.path);this.It(g).has(h)||this.Et(h,g)||this.et(h,g,En.newNoDocument(g,e))}u.Be&&(n.set(h,u.ke()),u.qe())}}));let a=Je();this.He.forEach(((u,h)=>{let p=!0;h.forEachWhile((g=>{const x=this.ot(g);return!x||x.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(a=a.add(u))})),this.je.forEach(((u,h)=>h.setReadTime(e)));const l=new Ih(e,n,this.Ye,this.je,a);return this.je=Jr(),this.Je=Cd(),this.He=Cd(),this.Ye=new Mt(Ze),l}Xe(e,n){if(!this.rt(e))return;const a=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,a),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,a){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,n)?l.Qe(n,1):l.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),a&&(this.je=this.je.insert(n,a))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new C1,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new en(Ze),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new en(Ze),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ye("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new C1),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Cd(){return new Mt(Se.comparator)}function R1(){return new Mt(Se.comparator)}const rj={asc:"ASCENDING",desc:"DESCENDING"},aj={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ij={and:"AND",or:"OR"};class oj{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function S0(s,e){return s.useProto3Json||Nh(e)?e:{value:e}}function rh(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Kv(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function lj(s,e){return rh(s,e.toTimestamp())}function dr(s){return ct(!!s,49232),Ve.fromTimestamp((function(n){const a=Ja(n);return new Et(a.seconds,a.nanos)})(s))}function dg(s,e){return T0(s,e).canonicalString()}function T0(s,e){const n=(function(l){return new vt(["projects",l.projectId,"databases",l.database])})(s).child("documents");return e===void 0?n:n.child(e)}function Xv(s){const e=vt.fromString(s);return ct(t4(e),10190,{key:e.toString()}),e}function A0(s,e){return dg(s.databaseId,e.path)}function i0(s,e){const n=Xv(e);if(n.get(1)!==s.databaseId.projectId)throw new fe(re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+s.databaseId.projectId);if(n.get(3)!==s.databaseId.database)throw new fe(re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+s.databaseId.database);return new Se(Jv(n))}function Zv(s,e){return dg(s.databaseId,e)}function cj(s){const e=Xv(s);return e.length===4?vt.emptyPath():Jv(e)}function C0(s){return new vt(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function Jv(s){return ct(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function D1(s,e,n){return{name:A0(s,e),fields:n.value.mapValue.fields}}function uj(s,e){let n;if("targetChange"in e){e.targetChange;const a=(function(x){return x==="NO_CHANGE"?0:x==="ADD"?1:x==="REMOVE"?2:x==="CURRENT"?3:x==="RESET"?4:De(39313,{state:x})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(x,y){return x.useProto3Json?(ct(y===void 0||typeof y=="string",58123),xn.fromBase64String(y||"")):(ct(y===void 0||y instanceof Buffer||y instanceof Uint8Array,16193),xn.fromUint8Array(y||new Uint8Array))})(s,e.targetChange.resumeToken),h=e.targetChange.cause,p=h&&(function(x){const y=x.code===void 0?re.UNKNOWN:$v(x.code);return new fe(y,x.message||"")})(h);n=new Yv(a,l,u,p||null)}else if("documentChange"in e){e.documentChange;const a=e.documentChange;a.document,a.document.name,a.document.updateTime;const l=i0(s,a.document.name),u=dr(a.document.updateTime),h=a.document.createTime?dr(a.document.createTime):Ve.min(),p=new Gn({mapValue:{fields:a.document.fields}}),g=En.newFoundDocument(l,u,h,p),x=a.targetIds||[],y=a.removedTargetIds||[];n=new Bd(x,y,g.key,g)}else if("documentDelete"in e){e.documentDelete;const a=e.documentDelete;a.document;const l=i0(s,a.document),u=a.readTime?dr(a.readTime):Ve.min(),h=En.newNoDocument(l,u),p=a.removedTargetIds||[];n=new Bd([],p,h.key,h)}else if("documentRemove"in e){e.documentRemove;const a=e.documentRemove;a.document;const l=i0(s,a.document),u=a.removedTargetIds||[];n=new Bd([],u,l,null)}else{if(!("filter"in e))return De(11601,{Rt:e});{e.filter;const a=e.filter;a.targetId;const{count:l=0,unchangedNames:u}=a,h=new WE(l,u),p=a.targetId;n=new Qv(p,h)}}return n}function dj(s,e){let n;if(e instanceof Hc)n={update:D1(s,e.key,e.value)};else if(e instanceof Dh)n={delete:A0(s,e.key)};else if(e instanceof ai)n={update:D1(s,e.key,e.data),updateMask:vj(e.fieldMask)};else{if(!(e instanceof XE))return De(16599,{Vt:e.type});n={verify:A0(s,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((a=>(function(u,h){const p=h.transform;if(p instanceof Mc)return{fieldPath:h.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof Xo)return{fieldPath:h.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Zo)return{fieldPath:h.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof kc)return{fieldPath:h.field.canonicalString(),increment:p.Ae};throw De(20930,{transform:h.transform})})(0,a)))),e.precondition.isNone||(n.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:lj(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:De(27497)})(s,e.precondition)),n}function hj(s,e){return s&&s.length>0?(ct(e!==void 0,14353),s.map((n=>(function(l,u){let h=l.updateTime?dr(l.updateTime):dr(u);return h.isEqual(Ve.min())&&(h=dr(u)),new QE(h,l.transformResults||[])})(n,e)))):[]}function fj(s,e){return{documents:[Zv(s,e.path)]}}function mj(s,e){const n={structuredQuery:{}},a=e.path;let l;e.collectionGroup!==null?(l=a,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=a.popLast(),n.structuredQuery.from=[{collectionId:a.lastSegment()}]),n.parent=Zv(s,l);const u=(function(x){if(x.length!==0)return e4(Us.create(x,"and"))})(e.filters);u&&(n.structuredQuery.where=u);const h=(function(x){if(x.length!==0)return x.map((y=>(function(_){return{field:Uo(_.field),direction:xj(_.dir)}})(y)))})(e.orderBy);h&&(n.structuredQuery.orderBy=h);const p=S0(s,e.limit);return p!==null&&(n.structuredQuery.limit=p),e.startAt&&(n.structuredQuery.startAt=(function(x){return{before:x.inclusive,values:x.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(x){return{before:!x.inclusive,values:x.position}})(e.endAt)),{ft:n,parent:l}}function gj(s){let e=cj(s.parent);const n=s.structuredQuery,a=n.from?n.from.length:0;let l=null;if(a>0){ct(a===1,65062);const y=n.from[0];y.allDescendants?l=y.collectionId:e=e.child(y.collectionId)}let u=[];n.where&&(u=(function(v){const _=Wv(v);return _ instanceof Us&&Av(_)?_.getFilters():[_]})(n.where));let h=[];n.orderBy&&(h=(function(v){return v.map((_=>(function(S){return new Ic(zo(S.field),(function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(_)))})(n.orderBy));let p=null;n.limit&&(p=(function(v){let _;return _=typeof v=="object"?v.value:v,Nh(_)?null:_})(n.limit));let g=null;n.startAt&&(g=(function(v){const _=!!v.before,E=v.values||[];return new nh(E,_)})(n.startAt));let x=null;return n.endAt&&(x=(function(v){const _=!v.before,E=v.values||[];return new nh(E,_)})(n.endAt)),VE(e,l,h,u,p,"F",g,x)}function pj(s,e){const n=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return De(28987,{purpose:l})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Wv(s){return s.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const a=zo(n.unaryFilter.field);return Xt.create(a,"==",{doubleValue:NaN});case"IS_NULL":const l=zo(n.unaryFilter.field);return Xt.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=zo(n.unaryFilter.field);return Xt.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const h=zo(n.unaryFilter.field);return Xt.create(h,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return De(61313);default:return De(60726)}})(s):s.fieldFilter!==void 0?(function(n){return Xt.create(zo(n.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return De(58110);default:return De(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(n){return Us.create(n.compositeFilter.filters.map((a=>Wv(a))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return De(1026)}})(n.compositeFilter.op))})(s):De(30097,{filter:s})}function xj(s){return rj[s]}function yj(s){return aj[s]}function bj(s){return ij[s]}function Uo(s){return{fieldPath:s.canonicalString()}}function zo(s){return pn.fromServerFormat(s.fieldPath)}function e4(s){return s instanceof Xt?(function(n){if(n.op==="=="){if(y1(n.value))return{unaryFilter:{field:Uo(n.field),op:"IS_NAN"}};if(x1(n.value))return{unaryFilter:{field:Uo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(y1(n.value))return{unaryFilter:{field:Uo(n.field),op:"IS_NOT_NAN"}};if(x1(n.value))return{unaryFilter:{field:Uo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Uo(n.field),op:yj(n.op),value:n.value}}})(s):s instanceof Us?(function(n){const a=n.getFilters().map((l=>e4(l)));return a.length===1?a[0]:{compositeFilter:{op:bj(n.op),filters:a}}})(s):De(54877,{filter:s})}function vj(s){const e=[];return s.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function t4(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}class qa{constructor(e,n,a,l,u=Ve.min(),h=Ve.min(),p=xn.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=n,this.purpose=a,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=h,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new qa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new qa(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new qa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new qa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class wj{constructor(e){this.yt=e}}function _j(s){const e=gj({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?sh(e,e.limit,"L"):e}class Nj{constructor(){this.Cn=new Ej}addToCollectionParentIndex(e,n){return this.Cn.add(n),le.resolve()}getCollectionParents(e,n){return le.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return le.resolve()}deleteFieldIndex(e,n){return le.resolve()}deleteAllFieldIndexes(e){return le.resolve()}createTargetIndexes(e,n){return le.resolve()}getDocumentsMatchingTarget(e,n){return le.resolve(null)}getIndexType(e,n){return le.resolve(0)}getFieldIndexes(e,n){return le.resolve([])}getNextCollectionGroupToUpdate(e){return le.resolve(null)}getMinOffset(e,n){return le.resolve(Za.min())}getMinOffsetFromCollectionGroup(e,n){return le.resolve(Za.min())}updateCollectionGroup(e,n,a){return le.resolve()}updateIndexEntries(e,n){return le.resolve()}}class Ej{constructor(){this.index={}}add(e){const n=e.lastSegment(),a=e.popLast(),l=this.index[n]||new en(vt.comparator),u=!l.has(a);return this.index[n]=l.add(a),u}has(e){const n=e.lastSegment(),a=e.popLast(),l=this.index[n];return l&&l.has(a)}getEntries(e){return(this.index[e]||new en(vt.comparator)).toArray()}}const I1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},n4=41943040;class qn{static withCacheSize(e){return new qn(e,qn.DEFAULT_COLLECTION_PERCENTILE,qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,a){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=a}}qn.DEFAULT_COLLECTION_PERCENTILE=10,qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,qn.DEFAULT=new qn(n4,qn.DEFAULT_COLLECTION_PERCENTILE,qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),qn.DISABLED=new qn(-1,0,0);class Jo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Jo(0)}static cr(){return new Jo(-1)}}const M1="LruGarbageCollector",jj=1048576;function k1([s,e],[n,a]){const l=Ze(s,n);return l===0?Ze(e,a):l}class Sj{constructor(e){this.Ir=e,this.buffer=new en(k1),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const a=this.buffer.last();k1(n,a)<0&&(this.buffer=this.buffer.delete(a).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Tj{constructor(e,n,a){this.garbageCollector=e,this.asyncQueue=n,this.localStore=a,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ye(M1,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ol(n)?ye(M1,"Ignoring IndexedDB error during garbage collection: ",n):await il(n)}await this.Vr(3e5)}))}}class Aj{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((a=>Math.floor(n/100*a)))}nthSequenceNumber(e,n){if(n===0)return le.resolve(_h.ce);const a=new Sj(n);return this.mr.forEachTarget(e,(l=>a.Ar(l.sequenceNumber))).next((()=>this.mr.pr(e,(l=>a.Ar(l))))).next((()=>a.maxValue))}removeTargets(e,n,a){return this.mr.removeTargets(e,n,a)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ye("LruGarbageCollector","Garbage collection skipped; disabled"),le.resolve(I1)):this.getCacheSize(e).next((a=>a<this.params.cacheSizeCollectionThreshold?(ye("LruGarbageCollector",`Garbage collection skipped; Cache size ${a} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),I1):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let a,l,u,h,p,g,x;const y=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(ye("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),l=this.params.maximumSequenceNumbersToCollect):l=v,h=Date.now(),this.nthSequenceNumber(e,l)))).next((v=>(a=v,p=Date.now(),this.removeTargets(e,a,n)))).next((v=>(u=v,g=Date.now(),this.removeOrphanedDocuments(e,a)))).next((v=>(x=Date.now(),Po()<=Xe.DEBUG&&ye("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${h-y}ms
	Determined least recently used ${l} in `+(p-h)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${v} documents in `+(x-g)+`ms
Total Duration: ${x-y}ms`),le.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:v}))))}}function Cj(s,e){return new Aj(s,e)}class Rj{constructor(){this.changes=new qi((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,En.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const a=this.changes.get(n);return a!==void 0?le.resolve(a):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Dj{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class Ij{constructor(e,n,a,l){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=a,this.indexManager=l}getDocument(e,n){let a=null;return this.documentOverlayCache.getOverlay(e,n).next((l=>(a=l,this.remoteDocumentCache.getEntry(e,n)))).next((l=>(a!==null&&Nc(a.mutation,l,is.empty(),Et.now()),l)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((a=>this.getLocalViewOfDocuments(e,a,Je()).next((()=>a))))}getLocalViewOfDocuments(e,n,a=Je()){const l=Vi();return this.populateOverlays(e,l,n).next((()=>this.computeViews(e,n,l,a).next((u=>{let h=gc();return u.forEach(((p,g)=>{h=h.insert(p,g.overlayedDocument)})),h}))))}getOverlayedDocuments(e,n){const a=Vi();return this.populateOverlays(e,a,n).next((()=>this.computeViews(e,n,a,Je())))}populateOverlays(e,n,a){const l=[];return a.forEach((u=>{n.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((h,p)=>{n.set(h,p)}))}))}computeViews(e,n,a,l){let u=Jr();const h=_c(),p=(function(){return _c()})();return n.forEach(((g,x)=>{const y=a.get(x.key);l.has(x.key)&&(y===void 0||y.mutation instanceof ai)?u=u.insert(x.key,x):y!==void 0?(h.set(x.key,y.mutation.getFieldMask()),Nc(y.mutation,x,y.mutation.getFieldMask(),Et.now())):h.set(x.key,is.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((x,y)=>h.set(x,y))),n.forEach(((x,y)=>p.set(x,new Dj(y,h.get(x)??null)))),p)))}recalculateAndSaveOverlays(e,n){const a=_c();let l=new Mt(((h,p)=>h-p)),u=Je();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((h=>{for(const p of h)p.keys().forEach((g=>{const x=n.get(g);if(x===null)return;let y=a.get(g)||is.empty();y=p.applyToLocalView(x,y),a.set(g,y);const v=(l.get(p.batchId)||Je()).add(g);l=l.insert(p.batchId,v)}))})).next((()=>{const h=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),x=g.key,y=g.value,v=Pv();y.forEach((_=>{if(!u.has(_)){const E=Hv(n.get(_),a.get(_));E!==null&&v.set(_,E),u=u.add(_)}})),h.push(this.documentOverlayCache.saveOverlays(e,x,v))}return le.waitFor(h)})).next((()=>a))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((a=>this.recalculateAndSaveOverlays(e,a)))}getDocumentsMatchingQuery(e,n,a,l){return(function(h){return Se.isDocumentKey(h.path)&&h.collectionGroup===null&&h.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Iv(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,a,l):this.getDocumentsMatchingCollectionQuery(e,n,a,l)}getNextDocuments(e,n,a,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,a,l).next((u=>{const h=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,a.largestBatchId,l-u.size):le.resolve(Vi());let p=Ac,g=u;return h.next((x=>le.forEach(x,((y,v)=>(p<v.largestBatchId&&(p=v.largestBatchId),u.get(y)?le.resolve():this.remoteDocumentCache.getEntry(e,y).next((_=>{g=g.insert(y,_)}))))).next((()=>this.populateOverlays(e,x,u))).next((()=>this.computeViews(e,g,x,Je()))).next((y=>({batchId:p,changes:Ov(y)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Se(n)).next((a=>{let l=gc();return a.isFoundDocument()&&(l=l.insert(a.key,a)),l}))}getDocumentsMatchingCollectionGroupQuery(e,n,a,l){const u=n.collectionGroup;let h=gc();return this.indexManager.getCollectionParents(e,u).next((p=>le.forEach(p,(g=>{const x=(function(v,_){return new ll(_,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(n,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,x,a,l).next((y=>{y.forEach(((v,_)=>{h=h.insert(v,_)}))}))})).next((()=>h))))}getDocumentsMatchingCollectionQuery(e,n,a,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,a.largestBatchId).next((h=>(u=h,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,a,u,l)))).next((h=>{u.forEach(((g,x)=>{const y=x.getKey();h.get(y)===null&&(h=h.insert(y,En.newInvalidDocument(y)))}));let p=gc();return h.forEach(((g,x)=>{const y=u.get(g);y!==void 0&&Nc(y.mutation,x,is.empty(),Et.now()),Th(n,x)&&(p=p.insert(g,x))})),p}))}}class Mj{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return le.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(l){return{id:l.id,version:l.version,createTime:dr(l.createTime)}})(n)),le.resolve()}getNamedQuery(e,n){return le.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(l){return{name:l.name,query:_j(l.bundledQuery),readTime:dr(l.readTime)}})(n)),le.resolve()}}class kj{constructor(){this.overlays=new Mt(Se.comparator),this.qr=new Map}getOverlay(e,n){return le.resolve(this.overlays.get(n))}getOverlays(e,n){const a=Vi();return le.forEach(n,(l=>this.getOverlay(e,l).next((u=>{u!==null&&a.set(l,u)})))).next((()=>a))}saveOverlays(e,n,a){return a.forEach(((l,u)=>{this.St(e,n,u)})),le.resolve()}removeOverlaysForBatchId(e,n,a){const l=this.qr.get(a);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.qr.delete(a)),le.resolve()}getOverlaysForCollection(e,n,a){const l=Vi(),u=n.length+1,h=new Se(n.child("")),p=this.overlays.getIteratorFrom(h);for(;p.hasNext();){const g=p.getNext().value,x=g.getKey();if(!n.isPrefixOf(x.path))break;x.path.length===u&&g.largestBatchId>a&&l.set(g.getKey(),g)}return le.resolve(l)}getOverlaysForCollectionGroup(e,n,a,l){let u=new Mt(((x,y)=>x-y));const h=this.overlays.getIterator();for(;h.hasNext();){const x=h.getNext().value;if(x.getKey().getCollectionGroup()===n&&x.largestBatchId>a){let y=u.get(x.largestBatchId);y===null&&(y=Vi(),u=u.insert(x.largestBatchId,y)),y.set(x.getKey(),x)}}const p=Vi(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((x,y)=>p.set(x,y))),!(p.size()>=l)););return le.resolve(p)}St(e,n,a){const l=this.overlays.get(a.key);if(l!==null){const h=this.qr.get(l.largestBatchId).delete(a.key);this.qr.set(l.largestBatchId,h)}this.overlays=this.overlays.insert(a.key,new JE(n,a));let u=this.qr.get(n);u===void 0&&(u=Je(),this.qr.set(n,u)),this.qr.set(n,u.add(a.key))}}class Vj{constructor(){this.sessionToken=xn.EMPTY_BYTE_STRING}getSessionToken(e){return le.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,le.resolve()}}class hg{constructor(){this.Qr=new en(rn.$r),this.Ur=new en(rn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const a=new rn(e,n);this.Qr=this.Qr.add(a),this.Ur=this.Ur.add(a)}Wr(e,n){e.forEach((a=>this.addReference(a,n)))}removeReference(e,n){this.Gr(new rn(e,n))}zr(e,n){e.forEach((a=>this.removeReference(a,n)))}jr(e){const n=new Se(new vt([])),a=new rn(n,e),l=new rn(n,e+1),u=[];return this.Ur.forEachInRange([a,l],(h=>{this.Gr(h),u.push(h.key)})),u}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Se(new vt([])),a=new rn(n,e),l=new rn(n,e+1);let u=Je();return this.Ur.forEachInRange([a,l],(h=>{u=u.add(h.key)})),u}containsKey(e){const n=new rn(e,0),a=this.Qr.firstAfterOrEqual(n);return a!==null&&e.isEqual(a.key)}}class rn{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Se.comparator(e.key,n.key)||Ze(e.Yr,n.Yr)}static Kr(e,n){return Ze(e.Yr,n.Yr)||Se.comparator(e.key,n.key)}}class Oj{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new en(rn.$r)}checkEmpty(e){return le.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,a,l){const u=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const h=new ZE(u,n,a,l);this.mutationQueue.push(h);for(const p of l)this.Zr=this.Zr.add(new rn(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return le.resolve(h)}lookupMutationBatch(e,n){return le.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const a=n+1,l=this.ei(a),u=l<0?0:l;return le.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return le.resolve(this.mutationQueue.length===0?sg:this.tr-1)}getAllMutationBatches(e){return le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const a=new rn(n,0),l=new rn(n,Number.POSITIVE_INFINITY),u=[];return this.Zr.forEachInRange([a,l],(h=>{const p=this.Xr(h.Yr);u.push(p)})),le.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,n){let a=new en(Ze);return n.forEach((l=>{const u=new rn(l,0),h=new rn(l,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([u,h],(p=>{a=a.add(p.Yr)}))})),le.resolve(this.ti(a))}getAllMutationBatchesAffectingQuery(e,n){const a=n.path,l=a.length+1;let u=a;Se.isDocumentKey(u)||(u=u.child(""));const h=new rn(new Se(u),0);let p=new en(Ze);return this.Zr.forEachWhile((g=>{const x=g.key.path;return!!a.isPrefixOf(x)&&(x.length===l&&(p=p.add(g.Yr)),!0)}),h),le.resolve(this.ti(p))}ti(e){const n=[];return e.forEach((a=>{const l=this.Xr(a);l!==null&&n.push(l)})),n}removeMutationBatch(e,n){ct(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let a=this.Zr;return le.forEach(n.mutations,(l=>{const u=new rn(l.key,n.batchId);return a=a.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Zr=a}))}ir(e){}containsKey(e,n){const a=new rn(n,0),l=this.Zr.firstAfterOrEqual(a);return le.resolve(n.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,le.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class Pj{constructor(e){this.ri=e,this.docs=(function(){return new Mt(Se.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const a=n.key,l=this.docs.get(a),u=l?l.size:0,h=this.ri(n);return this.docs=this.docs.insert(a,{document:n.mutableCopy(),size:h}),this.size+=h-u,this.indexManager.addToCollectionParentIndex(e,a.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const a=this.docs.get(n);return le.resolve(a?a.document.mutableCopy():En.newInvalidDocument(n))}getEntries(e,n){let a=Jr();return n.forEach((l=>{const u=this.docs.get(l);a=a.insert(l,u?u.document.mutableCopy():En.newInvalidDocument(l))})),le.resolve(a)}getDocumentsMatchingQuery(e,n,a,l){let u=Jr();const h=n.path,p=new Se(h.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:x,value:{document:y}}=g.getNext();if(!h.isPrefixOf(x.path))break;x.path.length>h.length+1||fE(hE(y),a)<=0||(l.has(y.key)||Th(n,y))&&(u=u.insert(y.key,y.mutableCopy()))}return le.resolve(u)}getAllFromCollectionGroup(e,n,a,l){De(9500)}ii(e,n){return le.forEach(this.docs,(a=>n(a)))}newChangeBuffer(e){return new Lj(this)}getSize(e){return le.resolve(this.size)}}class Lj extends Rj{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((a,l)=>{l.isValidDocument()?n.push(this.Nr.addEntry(e,l)):this.Nr.removeEntry(a)})),le.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class Uj{constructor(e){this.persistence=e,this.si=new qi((n=>ig(n)),og),this.lastRemoteSnapshotVersion=Ve.min(),this.highestTargetId=0,this.oi=0,this._i=new hg,this.targetCount=0,this.ai=Jo.ur()}forEachTarget(e,n){return this.si.forEach(((a,l)=>n(l))),le.resolve()}getLastRemoteSnapshotVersion(e){return le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return le.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),le.resolve(this.highestTargetId)}setTargetsMetadata(e,n,a){return a&&(this.lastRemoteSnapshotVersion=a),n>this.oi&&(this.oi=n),le.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Jo(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,le.resolve()}updateTargetData(e,n){return this.Pr(n),le.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,le.resolve()}removeTargets(e,n,a){let l=0;const u=[];return this.si.forEach(((h,p)=>{p.sequenceNumber<=n&&a.get(p.targetId)===null&&(this.si.delete(h),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),le.waitFor(u).next((()=>l))}getTargetCount(e){return le.resolve(this.targetCount)}getTargetData(e,n){const a=this.si.get(n)||null;return le.resolve(a)}addMatchingKeys(e,n,a){return this._i.Wr(n,a),le.resolve()}removeMatchingKeys(e,n,a){this._i.zr(n,a);const l=this.persistence.referenceDelegate,u=[];return l&&n.forEach((h=>{u.push(l.markPotentiallyOrphaned(e,h))})),le.waitFor(u)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),le.resolve()}getMatchingKeysForTargetId(e,n){const a=this._i.Hr(n);return le.resolve(a)}containsKey(e,n){return le.resolve(this._i.containsKey(n))}}class s4{constructor(e,n){this.ui={},this.overlays={},this.ci=new _h(0),this.li=!1,this.li=!0,this.hi=new Vj,this.referenceDelegate=e(this),this.Pi=new Uj(this),this.indexManager=new Nj,this.remoteDocumentCache=(function(l){return new Pj(l)})((a=>this.referenceDelegate.Ti(a))),this.serializer=new wj(n),this.Ii=new Mj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new kj,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let a=this.ui[e.toKey()];return a||(a=new Oj(n,this.referenceDelegate),this.ui[e.toKey()]=a),a}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,a){ye("MemoryPersistence","Starting transaction:",e);const l=new zj(this.ci.next());return this.referenceDelegate.Ei(),a(l).next((u=>this.referenceDelegate.di(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ai(e,n){return le.or(Object.values(this.ui).map((a=>()=>a.containsKey(e,n))))}}class zj extends gE{constructor(e){super(),this.currentSequenceNumber=e}}class fg{constructor(e){this.persistence=e,this.Ri=new hg,this.Vi=null}static mi(e){return new fg(e)}get fi(){if(this.Vi)return this.Vi;throw De(60996)}addReference(e,n,a){return this.Ri.addReference(a,n),this.fi.delete(a.toString()),le.resolve()}removeReference(e,n,a){return this.Ri.removeReference(a,n),this.fi.add(a.toString()),le.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),le.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((l=>this.fi.add(l.toString())));const a=this.persistence.getTargetCache();return a.getMatchingKeysForTargetId(e,n.targetId).next((l=>{l.forEach((u=>this.fi.add(u.toString())))})).next((()=>a.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return le.forEach(this.fi,(a=>{const l=Se.fromPath(a);return this.gi(e,l).next((u=>{u||n.removeEntry(l,Ve.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((a=>{a?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return le.or([()=>le.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class ah{constructor(e,n){this.persistence=e,this.pi=new qi((a=>yE(a.path)),((a,l)=>a.isEqual(l))),this.garbageCollector=Cj(this,n)}static mi(e,n){return new ah(e,n)}Ei(){}di(e){return le.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((a=>n.next((l=>a+l))))}wr(e){let n=0;return this.pr(e,(a=>{n++})).next((()=>n))}pr(e,n){return le.forEach(this.pi,((a,l)=>this.br(e,a,l).next((u=>u?le.resolve():n(l)))))}removeTargets(e,n,a){return this.persistence.getTargetCache().removeTargets(e,n,a)}removeOrphanedDocuments(e,n){let a=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ii(e,(h=>this.br(e,h,n).next((p=>{p||(a++,u.removeEntry(h,Ve.min()))})))).next((()=>u.apply(e))).next((()=>a))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),le.resolve()}removeTarget(e,n){const a=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,a)}addReference(e,n,a){return this.pi.set(a,e.currentSequenceNumber),le.resolve()}removeReference(e,n,a){return this.pi.set(a,e.currentSequenceNumber),le.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),le.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Ld(e.data.value)),n}br(e,n,a){return le.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const l=this.pi.get(n);return le.resolve(l!==void 0&&l>a)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class mg{constructor(e,n,a,l){this.targetId=e,this.fromCache=n,this.Es=a,this.ds=l}static As(e,n){let a=Je(),l=Je();for(const u of n.docChanges)switch(u.type){case 0:a=a.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new mg(e,n.fromCache,a,l)}}class Bj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Fj{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return x6()?8:pE(Sn())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,a,l){const u={result:null};return this.ys(e,n).next((h=>{u.result=h})).next((()=>{if(!u.result)return this.ws(e,n,l,a).next((h=>{u.result=h}))})).next((()=>{if(u.result)return;const h=new Bj;return this.Ss(e,n,h).next((p=>{if(u.result=p,this.Vs)return this.bs(e,n,h,p.size)}))})).next((()=>u.result))}bs(e,n,a,l){return a.documentReadCount<this.fs?(Po()<=Xe.DEBUG&&ye("QueryEngine","SDK will not create cache indexes for query:",Lo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),le.resolve()):(Po()<=Xe.DEBUG&&ye("QueryEngine","Query:",Lo(n),"scans",a.documentReadCount,"local documents and returns",l,"documents as results."),a.documentReadCount>this.gs*l?(Po()<=Xe.DEBUG&&ye("QueryEngine","The SDK decides to create cache indexes for query:",Lo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ur(n))):le.resolve())}ys(e,n){if(_1(n))return le.resolve(null);let a=ur(n);return this.indexManager.getIndexType(e,a).next((l=>l===0?null:(n.limit!==null&&l===1&&(n=sh(n,null,"F"),a=ur(n)),this.indexManager.getDocumentsMatchingTarget(e,a).next((u=>{const h=Je(...u);return this.ps.getDocuments(e,h).next((p=>this.indexManager.getMinOffset(e,a).next((g=>{const x=this.Ds(n,p);return this.Cs(n,x,h,g.readTime)?this.ys(e,sh(n,null,"F")):this.vs(e,x,n,g)}))))})))))}ws(e,n,a,l){return _1(n)||l.isEqual(Ve.min())?le.resolve(null):this.ps.getDocuments(e,a).next((u=>{const h=this.Ds(n,u);return this.Cs(n,h,a,l)?le.resolve(null):(Po()<=Xe.DEBUG&&ye("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Lo(n)),this.vs(e,h,n,dE(l,Ac)).next((p=>p)))}))}Ds(e,n){let a=new en(kv(e));return n.forEach(((l,u)=>{Th(e,u)&&(a=a.add(u))})),a}Cs(e,n,a,l){if(e.limit===null)return!1;if(a.size!==n.size)return!0;const u=e.limitType==="F"?n.last():n.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}Ss(e,n,a){return Po()<=Xe.DEBUG&&ye("QueryEngine","Using full collection scan to execute query:",Lo(n)),this.ps.getDocumentsMatchingQuery(e,n,Za.min(),a)}vs(e,n,a,l){return this.ps.getDocumentsMatchingQuery(e,a,l).next((u=>(n.forEach((h=>{u=u.insert(h.key,h)})),u)))}}const gg="LocalStore",qj=3e8;class Hj{constructor(e,n,a,l){this.persistence=e,this.Fs=n,this.serializer=l,this.Ms=new Mt(Ze),this.xs=new qi((u=>ig(u)),og),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(a)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ij(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function Gj(s,e,n,a){return new Hj(s,e,n,a)}async function r4(s,e){const n=Pe(s);return await n.persistence.runTransaction("Handle user change","readonly",(a=>{let l;return n.mutationQueue.getAllMutationBatches(a).next((u=>(l=u,n.Bs(e),n.mutationQueue.getAllMutationBatches(a)))).next((u=>{const h=[],p=[];let g=Je();for(const x of l){h.push(x.batchId);for(const y of x.mutations)g=g.add(y.key)}for(const x of u){p.push(x.batchId);for(const y of x.mutations)g=g.add(y.key)}return n.localDocuments.getDocuments(a,g).next((x=>({Ls:x,removedBatchIds:h,addedBatchIds:p})))}))}))}function $j(s,e){const n=Pe(s);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(a=>{const l=e.batch.keys(),u=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(p,g,x,y){const v=x.batch,_=v.keys();let E=le.resolve();return _.forEach((S=>{E=E.next((()=>y.getEntry(g,S))).next((A=>{const D=x.docVersions.get(S);ct(D!==null,48541),A.version.compareTo(D)<0&&(v.applyToRemoteDocument(A,x),A.isValidDocument()&&(A.setReadTime(x.commitVersion),y.addEntry(A)))}))})),E.next((()=>p.mutationQueue.removeMutationBatch(g,v)))})(n,a,e,u).next((()=>u.apply(a))).next((()=>n.mutationQueue.performConsistencyCheck(a))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(a,l,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,(function(p){let g=Je();for(let x=0;x<p.mutationResults.length;++x)p.mutationResults[x].transformResults.length>0&&(g=g.add(p.batch.mutations[x].key));return g})(e)))).next((()=>n.localDocuments.getDocuments(a,l)))}))}function a4(s){const e=Pe(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function Qj(s,e){const n=Pe(s),a=e.snapshotVersion;let l=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const h=n.Ns.newChangeBuffer({trackRemovals:!0});l=n.Ms;const p=[];e.targetChanges.forEach(((y,v)=>{const _=l.get(v);if(!_)return;p.push(n.Pi.removeMatchingKeys(u,y.removedDocuments,v).next((()=>n.Pi.addMatchingKeys(u,y.addedDocuments,v))));let E=_.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(v)!==null?E=E.withResumeToken(xn.EMPTY_BYTE_STRING,Ve.min()).withLastLimboFreeSnapshotVersion(Ve.min()):y.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(y.resumeToken,a)),l=l.insert(v,E),(function(A,D,L){return A.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=qj?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0})(_,E,y)&&p.push(n.Pi.updateTargetData(u,E))}));let g=Jr(),x=Je();if(e.documentUpdates.forEach((y=>{e.resolvedLimboDocuments.has(y)&&p.push(n.persistence.referenceDelegate.updateLimboDocument(u,y))})),p.push(Yj(u,h,e.documentUpdates).next((y=>{g=y.ks,x=y.qs}))),!a.isEqual(Ve.min())){const y=n.Pi.getLastRemoteSnapshotVersion(u).next((v=>n.Pi.setTargetsMetadata(u,u.currentSequenceNumber,a)));p.push(y)}return le.waitFor(p).next((()=>h.apply(u))).next((()=>n.localDocuments.getLocalViewOfDocuments(u,g,x))).next((()=>g))})).then((u=>(n.Ms=l,u)))}function Yj(s,e,n){let a=Je(),l=Je();return n.forEach((u=>a=a.add(u))),e.getEntries(s,a).next((u=>{let h=Jr();return n.forEach(((p,g)=>{const x=u.get(p);g.isFoundDocument()!==x.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual(Ve.min())?(e.removeEntry(p,g.readTime),h=h.insert(p,g)):!x.isValidDocument()||g.version.compareTo(x.version)>0||g.version.compareTo(x.version)===0&&x.hasPendingWrites?(e.addEntry(g),h=h.insert(p,g)):ye(gg,"Ignoring outdated watch update for ",p,". Current version:",x.version," Watch version:",g.version)})),{ks:h,qs:l}}))}function Kj(s,e){const n=Pe(s);return n.persistence.runTransaction("Get next mutation batch","readonly",(a=>(e===void 0&&(e=sg),n.mutationQueue.getNextMutationBatchAfterBatchId(a,e))))}function Xj(s,e){const n=Pe(s);return n.persistence.runTransaction("Allocate target","readwrite",(a=>{let l;return n.Pi.getTargetData(a,e).next((u=>u?(l=u,le.resolve(l)):n.Pi.allocateTargetId(a).next((h=>(l=new qa(e,h,"TargetPurposeListen",a.currentSequenceNumber),n.Pi.addTargetData(a,l).next((()=>l)))))))})).then((a=>{const l=n.Ms.get(a.targetId);return(l===null||a.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(a.targetId,a),n.xs.set(e,a.targetId)),a}))}async function R0(s,e,n){const a=Pe(s),l=a.Ms.get(e),u=n?"readwrite":"readwrite-primary";try{n||await a.persistence.runTransaction("Release target",u,(h=>a.persistence.referenceDelegate.removeTarget(h,l)))}catch(h){if(!ol(h))throw h;ye(gg,`Failed to update sequence numbers for target ${e}: ${h}`)}a.Ms=a.Ms.remove(e),a.xs.delete(l.target)}function V1(s,e,n){const a=Pe(s);let l=Ve.min(),u=Je();return a.persistence.runTransaction("Execute query","readwrite",(h=>(function(g,x,y){const v=Pe(g),_=v.xs.get(y);return _!==void 0?le.resolve(v.Ms.get(_)):v.Pi.getTargetData(x,y)})(a,h,ur(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,a.Pi.getMatchingKeysForTargetId(h,p.targetId).next((g=>{u=g}))})).next((()=>a.Fs.getDocumentsMatchingQuery(h,e,n?l:Ve.min(),n?u:Je()))).next((p=>(Zj(a,PE(e),p),{documents:p,Qs:u})))))}function Zj(s,e,n){let a=s.Os.get(e)||Ve.min();n.forEach(((l,u)=>{u.readTime.compareTo(a)>0&&(a=u.readTime)})),s.Os.set(e,a)}class O1{constructor(){this.activeTargetIds=qE()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Jj{constructor(){this.Mo=new O1,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,a){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,a){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new O1,Promise.resolve()}handleUserChange(e,n,a){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Wj{Oo(e){}shutdown(){}}const P1="ConnectivityMonitor";class L1{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ye(P1,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ye(P1,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Rd=null;function D0(){return Rd===null?Rd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Rd++,"0x"+Rd.toString(16)}const o0="RestConnection",eS={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class tS{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${a}/databases/${l}`,this.Wo=this.databaseId.database===eh?`project_id=${a}`:`project_id=${a}&database_id=${l}`}Go(e,n,a,l,u){const h=D0(),p=this.zo(e,n.toUriEncodedString());ye(o0,`Sending RPC '${e}' ${h}:`,p,a);const g={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(g,l,u);const{host:x}=new URL(p),y=nl(x);return this.Jo(e,p,g,a,y).then((v=>(ye(o0,`Received RPC '${e}' ${h}: `,v),v)),(v=>{throw $o(o0,`RPC '${e}' ${h} failed with error: `,v,"url: ",p,"request:",a),v}))}Ho(e,n,a,l,u,h){return this.Go(e,n,a,l,u)}jo(e,n,a){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+al})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((l,u)=>e[u]=l)),a&&a.headers.forEach(((l,u)=>e[u]=l))}zo(e,n){const a=eS[e];return`${this.Uo}/v1/${n}:${a}`}terminate(){}}class nS{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const wn="WebChannelConnection";class sS extends tS{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,a,l,u){const h=D0();return new Promise(((p,g)=>{const x=new ov;x.setWithCredentials(!0),x.listenOnce(lv.COMPLETE,(()=>{try{switch(x.getLastErrorCode()){case Pd.NO_ERROR:const v=x.getResponseJson();ye(wn,`XHR for RPC '${e}' ${h} received:`,JSON.stringify(v)),p(v);break;case Pd.TIMEOUT:ye(wn,`RPC '${e}' ${h} timed out`),g(new fe(re.DEADLINE_EXCEEDED,"Request time out"));break;case Pd.HTTP_ERROR:const _=x.getStatus();if(ye(wn,`RPC '${e}' ${h} failed with status:`,_,"response text:",x.getResponseText()),_>0){let E=x.getResponseJson();Array.isArray(E)&&(E=E[0]);const S=E?.error;if(S&&S.status&&S.message){const A=(function(L){const B=L.toLowerCase().replace(/_/g,"-");return Object.values(re).indexOf(B)>=0?B:re.UNKNOWN})(S.status);g(new fe(A,S.message))}else g(new fe(re.UNKNOWN,"Server responded with status "+x.getStatus()))}else g(new fe(re.UNAVAILABLE,"Connection failed."));break;default:De(9055,{l_:e,streamId:h,h_:x.getLastErrorCode(),P_:x.getLastError()})}}finally{ye(wn,`RPC '${e}' ${h} completed.`)}}));const y=JSON.stringify(l);ye(wn,`RPC '${e}' ${h} sending request:`,l),x.send(n,"POST",y,a,15)}))}T_(e,n,a){const l=D0(),u=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],h=dv(),p=uv(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},x=this.longPollingOptions.timeoutSeconds;x!==void 0&&(g.longPollingTimeout=Math.round(1e3*x)),this.useFetchStreams&&(g.useFetchStreams=!0),this.jo(g.initMessageHeaders,n,a),g.encodeInitMessageHeaders=!0;const y=u.join("");ye(wn,`Creating RPC '${e}' stream ${l}: ${y}`,g);const v=h.createWebChannel(y,g);this.I_(v);let _=!1,E=!1;const S=new nS({Yo:D=>{E?ye(wn,`Not sending because RPC '${e}' stream ${l} is closed:`,D):(_||(ye(wn,`Opening RPC '${e}' stream ${l} transport.`),v.open(),_=!0),ye(wn,`RPC '${e}' stream ${l} sending:`,D),v.send(D))},Zo:()=>v.close()}),A=(D,L,B)=>{D.listen(L,(k=>{try{B(k)}catch($){setTimeout((()=>{throw $}),0)}}))};return A(v,mc.EventType.OPEN,(()=>{E||(ye(wn,`RPC '${e}' stream ${l} transport opened.`),S.o_())})),A(v,mc.EventType.CLOSE,(()=>{E||(E=!0,ye(wn,`RPC '${e}' stream ${l} transport closed`),S.a_(),this.E_(v))})),A(v,mc.EventType.ERROR,(D=>{E||(E=!0,$o(wn,`RPC '${e}' stream ${l} transport errored. Name:`,D.name,"Message:",D.message),S.a_(new fe(re.UNAVAILABLE,"The operation could not be completed")))})),A(v,mc.EventType.MESSAGE,(D=>{if(!E){const L=D.data[0];ct(!!L,16349);const B=L,k=B?.error||B[0]?.error;if(k){ye(wn,`RPC '${e}' stream ${l} received error:`,k);const $=k.status;let q=(function(j){const C=Kt[j];if(C!==void 0)return $v(C)})($),F=k.message;q===void 0&&(q=re.INTERNAL,F="Unknown error status: "+$+" with message "+k.message),E=!0,S.a_(new fe(q,F)),v.close()}else ye(wn,`RPC '${e}' stream ${l} received:`,L),S.u_(L)}})),A(p,cv.STAT_EVENT,(D=>{D.stat===b0.PROXY?ye(wn,`RPC '${e}' stream ${l} detected buffering proxy`):D.stat===b0.NOPROXY&&ye(wn,`RPC '${e}' stream ${l} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function l0(){return typeof document<"u"?document:null}function Mh(s){return new oj(s,!0)}class i4{constructor(e,n,a=1e3,l=1.5,u=6e4){this.Mi=e,this.timerId=n,this.d_=a,this.A_=l,this.R_=u,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),a=Math.max(0,Date.now()-this.f_),l=Math.max(0,n-a);l>0&&ye("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${a} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const U1="PersistentStream";class o4{constructor(e,n,a,l,u,h,p,g){this.Mi=e,this.S_=a,this.b_=l,this.connection=u,this.authCredentialsProvider=h,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new i4(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===re.RESOURCE_EXHAUSTED?(Zr(n.toString()),Zr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([a,l])=>{this.D_===n&&this.G_(a,l)}),(a=>{e((()=>{const l=new fe(re.UNKNOWN,"Fetching auth token failed: "+a.message);return this.z_(l)}))}))}G_(e,n){const a=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{a((()=>this.listener.Xo()))})),this.stream.t_((()=>{a((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((l=>{a((()=>this.z_(l)))})),this.stream.onMessage((l=>{a((()=>++this.F_==1?this.J_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ye(U1,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(ye(U1,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class rS extends o4{constructor(e,n,a,l,u,h){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,a,l,h),this.serializer=u}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=uj(this.serializer,e),a=(function(u){if(!("targetChange"in u))return Ve.min();const h=u.targetChange;return h.targetIds&&h.targetIds.length?Ve.min():h.readTime?dr(h.readTime):Ve.min()})(e);return this.listener.H_(n,a)}Y_(e){const n={};n.database=C0(this.serializer),n.addTarget=(function(u,h){let p;const g=h.target;if(p=E0(g)?{documents:fj(u,g)}:{query:mj(u,g).ft},p.targetId=h.targetId,h.resumeToken.approximateByteSize()>0){p.resumeToken=Kv(u,h.resumeToken);const x=S0(u,h.expectedCount);x!==null&&(p.expectedCount=x)}else if(h.snapshotVersion.compareTo(Ve.min())>0){p.readTime=rh(u,h.snapshotVersion.toTimestamp());const x=S0(u,h.expectedCount);x!==null&&(p.expectedCount=x)}return p})(this.serializer,e);const a=pj(this.serializer,e);a&&(n.labels=a),this.q_(n)}Z_(e){const n={};n.database=C0(this.serializer),n.removeTarget=e,this.q_(n)}}class aS extends o4{constructor(e,n,a,l,u,h){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,a,l,h),this.serializer=u}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return ct(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ct(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ct(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=hj(e.writeResults,e.commitTime),a=dr(e.commitTime);return this.listener.na(a,n)}ra(){const e={};e.database=C0(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((a=>dj(this.serializer,a)))};this.q_(n)}}class iS{}class oS extends iS{constructor(e,n,a,l){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=a,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new fe(re.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,h])=>this.connection.Go(e,T0(n,a),l,u,h))).catch((u=>{throw u.name==="FirebaseError"?(u.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new fe(re.UNKNOWN,u.toString())}))}Ho(e,n,a,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([h,p])=>this.connection.Ho(e,T0(n,a),l,h,p,u))).catch((h=>{throw h.name==="FirebaseError"?(h.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),h):new fe(re.UNKNOWN,h.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class lS{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Zr(n),this.aa=!1):ye("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Fi="RemoteStore";class cS{constructor(e,n,a,l,u){this.localStore=e,this.datastore=n,this.asyncQueue=a,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=u,this.Aa.Oo((h=>{a.enqueueAndForget((async()=>{Hi(this)&&(ye(Fi,"Restarting streams for network reachability change."),await(async function(g){const x=Pe(g);x.Ea.add(4),await $c(x),x.Ra.set("Unknown"),x.Ea.delete(4),await kh(x)})(this))}))})),this.Ra=new lS(a,l)}}async function kh(s){if(Hi(s))for(const e of s.da)await e(!0)}async function $c(s){for(const e of s.da)await e(!1)}function l4(s,e){const n=Pe(s);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),bg(n)?yg(n):cl(n).O_()&&xg(n,e))}function pg(s,e){const n=Pe(s),a=cl(n);n.Ia.delete(e),a.O_()&&c4(n,e),n.Ia.size===0&&(a.O_()?a.L_():Hi(n)&&n.Ra.set("Unknown"))}function xg(s,e){if(s.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ve.min())>0){const n=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}cl(s).Y_(e)}function c4(s,e){s.Va.Ue(e),cl(s).Z_(e)}function yg(s){s.Va=new sj({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),cl(s).start(),s.Ra.ua()}function bg(s){return Hi(s)&&!cl(s).x_()&&s.Ia.size>0}function Hi(s){return Pe(s).Ea.size===0}function u4(s){s.Va=void 0}async function uS(s){s.Ra.set("Online")}async function dS(s){s.Ia.forEach(((e,n)=>{xg(s,e)}))}async function hS(s,e){u4(s),bg(s)?(s.Ra.ha(e),yg(s)):s.Ra.set("Unknown")}async function fS(s,e,n){if(s.Ra.set("Online"),e instanceof Yv&&e.state===2&&e.cause)try{await(async function(l,u){const h=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,h),l.Ia.delete(p),l.Va.removeTarget(p))})(s,e)}catch(a){ye(Fi,"Failed to remove targets %s: %s ",e.targetIds.join(","),a),await ih(s,a)}else if(e instanceof Bd?s.Va.Ze(e):e instanceof Qv?s.Va.st(e):s.Va.tt(e),!n.isEqual(Ve.min()))try{const a=await a4(s.localStore);n.compareTo(a)>=0&&await(function(u,h){const p=u.Va.Tt(h);return p.targetChanges.forEach(((g,x)=>{if(g.resumeToken.approximateByteSize()>0){const y=u.Ia.get(x);y&&u.Ia.set(x,y.withResumeToken(g.resumeToken,h))}})),p.targetMismatches.forEach(((g,x)=>{const y=u.Ia.get(g);if(!y)return;u.Ia.set(g,y.withResumeToken(xn.EMPTY_BYTE_STRING,y.snapshotVersion)),c4(u,g);const v=new qa(y.target,g,x,y.sequenceNumber);xg(u,v)})),u.remoteSyncer.applyRemoteEvent(p)})(s,n)}catch(a){ye(Fi,"Failed to raise snapshot:",a),await ih(s,a)}}async function ih(s,e,n){if(!ol(e))throw e;s.Ea.add(1),await $c(s),s.Ra.set("Offline"),n||(n=()=>a4(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{ye(Fi,"Retrying IndexedDB access"),await n(),s.Ea.delete(1),await kh(s)}))}function d4(s,e){return e().catch((n=>ih(s,n,e)))}async function Vh(s){const e=Pe(s),n=ti(e);let a=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:sg;for(;mS(e);)try{const l=await Kj(e.localStore,a);if(l===null){e.Ta.length===0&&n.L_();break}a=l.batchId,gS(e,l)}catch(l){await ih(e,l)}h4(e)&&f4(e)}function mS(s){return Hi(s)&&s.Ta.length<10}function gS(s,e){s.Ta.push(e);const n=ti(s);n.O_()&&n.X_&&n.ea(e.mutations)}function h4(s){return Hi(s)&&!ti(s).x_()&&s.Ta.length>0}function f4(s){ti(s).start()}async function pS(s){ti(s).ra()}async function xS(s){const e=ti(s);for(const n of s.Ta)e.ea(n.mutations)}async function yS(s,e,n){const a=s.Ta.shift(),l=cg.from(a,e,n);await d4(s,(()=>s.remoteSyncer.applySuccessfulWrite(l))),await Vh(s)}async function bS(s,e){e&&ti(s).X_&&await(async function(a,l){if((function(h){return ej(h)&&h!==re.ABORTED})(l.code)){const u=a.Ta.shift();ti(a).B_(),await d4(a,(()=>a.remoteSyncer.rejectFailedWrite(u.batchId,l))),await Vh(a)}})(s,e),h4(s)&&f4(s)}async function z1(s,e){const n=Pe(s);n.asyncQueue.verifyOperationInProgress(),ye(Fi,"RemoteStore received new credentials");const a=Hi(n);n.Ea.add(3),await $c(n),a&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await kh(n)}async function vS(s,e){const n=Pe(s);e?(n.Ea.delete(2),await kh(n)):e||(n.Ea.add(2),await $c(n),n.Ra.set("Unknown"))}function cl(s){return s.ma||(s.ma=(function(n,a,l){const u=Pe(n);return u.sa(),new rS(a,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Xo:uS.bind(null,s),t_:dS.bind(null,s),r_:hS.bind(null,s),H_:fS.bind(null,s)}),s.da.push((async e=>{e?(s.ma.B_(),bg(s)?yg(s):s.Ra.set("Unknown")):(await s.ma.stop(),u4(s))}))),s.ma}function ti(s){return s.fa||(s.fa=(function(n,a,l){const u=Pe(n);return u.sa(),new aS(a,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Xo:()=>Promise.resolve(),t_:pS.bind(null,s),r_:bS.bind(null,s),ta:xS.bind(null,s),na:yS.bind(null,s)}),s.da.push((async e=>{e?(s.fa.B_(),await Vh(s)):(await s.fa.stop(),s.Ta.length>0&&(ye(Fi,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class vg{constructor(e,n,a,l,u){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=a,this.op=l,this.removalCallback=u,this.deferred=new Qr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((h=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,a,l,u){const h=Date.now()+a,p=new vg(e,n,h,l,u);return p.start(a),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new fe(re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function wg(s,e){if(Zr("AsyncQueue",`${e}: ${s}`),ol(s))return new fe(re.UNAVAILABLE,`${e}: ${s}`);throw s}class Ho{static emptySet(e){return new Ho(e.comparator)}constructor(e){this.comparator=e?(n,a)=>e(n,a)||Se.comparator(n.key,a.key):(n,a)=>Se.comparator(n.key,a.key),this.keyedMap=gc(),this.sortedSet=new Mt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,a)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ho)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),a=e.sortedSet.getIterator();for(;n.hasNext();){const l=n.getNext().key,u=a.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const a=new Ho;return a.comparator=this.comparator,a.keyedMap=e,a.sortedSet=n,a}}class B1{constructor(){this.ga=new Mt(Se.comparator)}track(e){const n=e.doc.key,a=this.ga.get(n);a?e.type!==0&&a.type===3?this.ga=this.ga.insert(n,e):e.type===3&&a.type!==1?this.ga=this.ga.insert(n,{type:a.type,doc:e.doc}):e.type===2&&a.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&a.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&a.type===0?this.ga=this.ga.remove(n):e.type===1&&a.type===2?this.ga=this.ga.insert(n,{type:1,doc:a.doc}):e.type===0&&a.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):De(63341,{Rt:e,pa:a}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,a)=>{e.push(a)})),e}}class Wo{constructor(e,n,a,l,u,h,p,g,x){this.query=e,this.docs=n,this.oldDocs=a,this.docChanges=l,this.mutatedKeys=u,this.fromCache=h,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=x}static fromInitialDocuments(e,n,a,l,u){const h=[];return n.forEach((p=>{h.push({type:0,doc:p})})),new Wo(e,n,Ho.emptySet(n),h,a,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Sh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,a=e.docChanges;if(n.length!==a.length)return!1;for(let l=0;l<n.length;l++)if(n[l].type!==a[l].type||!n[l].doc.isEqual(a[l].doc))return!1;return!0}}class wS{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class _S{constructor(){this.queries=F1(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,a){const l=Pe(n),u=l.queries;l.queries=F1(),u.forEach(((h,p)=>{for(const g of p.Sa)g.onError(a)}))})(this,new fe(re.ABORTED,"Firestore shutting down"))}}function F1(){return new qi((s=>Mv(s)),Sh)}async function _g(s,e){const n=Pe(s);let a=3;const l=e.query;let u=n.queries.get(l);u?!u.ba()&&e.Da()&&(a=2):(u=new wS,a=e.Da()?0:1);try{switch(a){case 0:u.wa=await n.onListen(l,!0);break;case 1:u.wa=await n.onListen(l,!1);break;case 2:await n.onFirstRemoteStoreListen(l)}}catch(h){const p=wg(h,`Initialization of query '${Lo(e.query)}' failed`);return void e.onError(p)}n.queries.set(l,u),u.Sa.push(e),e.va(n.onlineState),u.wa&&e.Fa(u.wa)&&Eg(n)}async function Ng(s,e){const n=Pe(s),a=e.query;let l=3;const u=n.queries.get(a);if(u){const h=u.Sa.indexOf(e);h>=0&&(u.Sa.splice(h,1),u.Sa.length===0?l=e.Da()?0:1:!u.ba()&&e.Da()&&(l=2))}switch(l){case 0:return n.queries.delete(a),n.onUnlisten(a,!0);case 1:return n.queries.delete(a),n.onUnlisten(a,!1);case 2:return n.onLastRemoteStoreUnlisten(a);default:return}}function NS(s,e){const n=Pe(s);let a=!1;for(const l of e){const u=l.query,h=n.queries.get(u);if(h){for(const p of h.Sa)p.Fa(l)&&(a=!0);h.wa=l}}a&&Eg(n)}function ES(s,e,n){const a=Pe(s),l=a.queries.get(e);if(l)for(const u of l.Sa)u.onError(n);a.queries.delete(e)}function Eg(s){s.Ca.forEach((e=>{e.next()}))}var I0,q1;(q1=I0||(I0={})).Ma="default",q1.Cache="cache";class jg{constructor(e,n,a){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=a||{}}Fa(e){if(!this.options.includeMetadataChanges){const a=[];for(const l of e.docChanges)l.type!==3&&a.push(l);e=new Wo(e.query,e.docs,e.oldDocs,a,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const a=n!=="Offline";return(!this.options.qa||!a)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Wo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==I0.Cache}}class m4{constructor(e){this.key=e}}class g4{constructor(e){this.key=e}}class jS{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Je(),this.mutatedKeys=Je(),this.eu=kv(e),this.tu=new Ho(this.eu)}get nu(){return this.Ya}ru(e,n){const a=n?n.iu:new B1,l=n?n.tu:this.tu;let u=n?n.mutatedKeys:this.mutatedKeys,h=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,x=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((y,v)=>{const _=l.get(y),E=Th(this.query,v)?v:null,S=!!_&&this.mutatedKeys.has(_.key),A=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let D=!1;_&&E?_.data.isEqual(E.data)?S!==A&&(a.track({type:3,doc:E}),D=!0):this.su(_,E)||(a.track({type:2,doc:E}),D=!0,(g&&this.eu(E,g)>0||x&&this.eu(E,x)<0)&&(p=!0)):!_&&E?(a.track({type:0,doc:E}),D=!0):_&&!E&&(a.track({type:1,doc:_}),D=!0,(g||x)&&(p=!0)),D&&(E?(h=h.add(E),u=A?u.add(y):u.delete(y)):(h=h.delete(y),u=u.delete(y)))})),this.query.limit!==null)for(;h.size>this.query.limit;){const y=this.query.limitType==="F"?h.last():h.first();h=h.delete(y.key),u=u.delete(y.key),a.track({type:1,doc:y})}return{tu:h,iu:a,Cs:p,mutatedKeys:u}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,a,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const h=e.iu.ya();h.sort(((y,v)=>(function(E,S){const A=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return De(20277,{Rt:D})}};return A(E)-A(S)})(y.type,v.type)||this.eu(y.doc,v.doc))),this.ou(a),l=l??!1;const p=n&&!l?this._u():[],g=this.Xa.size===0&&this.current&&!l?1:0,x=g!==this.Za;return this.Za=g,h.length!==0||x?{snapshot:new Wo(this.query,e.tu,u,h,e.mutatedKeys,g===0,x,!1,!!a&&a.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new B1,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Je(),this.tu.forEach((a=>{this.uu(a.key)&&(this.Xa=this.Xa.add(a.key))}));const n=[];return e.forEach((a=>{this.Xa.has(a)||n.push(new g4(a))})),this.Xa.forEach((a=>{e.has(a)||n.push(new m4(a))})),n}cu(e){this.Ya=e.Qs,this.Xa=Je();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Wo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Sg="SyncEngine";class SS{constructor(e,n,a){this.query=e,this.targetId=n,this.view=a}}class TS{constructor(e){this.key=e,this.hu=!1}}class AS{constructor(e,n,a,l,u,h){this.localStore=e,this.remoteStore=n,this.eventManager=a,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=h,this.Pu={},this.Tu=new qi((p=>Mv(p)),Sh),this.Iu=new Map,this.Eu=new Set,this.du=new Mt(Se.comparator),this.Au=new Map,this.Ru=new hg,this.Vu={},this.mu=new Map,this.fu=Jo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function CS(s,e,n=!0){const a=w4(s);let l;const u=a.Tu.get(e);return u?(a.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await p4(a,e,n,!0),l}async function RS(s,e){const n=w4(s);await p4(n,e,!0,!1)}async function p4(s,e,n,a){const l=await Xj(s.localStore,ur(e)),u=l.targetId,h=s.sharedClientState.addLocalQueryTarget(u,n);let p;return a&&(p=await DS(s,e,u,h==="current",l.resumeToken)),s.isPrimaryClient&&n&&l4(s.remoteStore,l),p}async function DS(s,e,n,a,l){s.pu=(v,_,E)=>(async function(A,D,L,B){let k=D.view.ru(L);k.Cs&&(k=await V1(A.localStore,D.query,!1).then((({documents:R})=>D.view.ru(R,k))));const $=B&&B.targetChanges.get(D.targetId),q=B&&B.targetMismatches.get(D.targetId)!=null,F=D.view.applyChanges(k,A.isPrimaryClient,$,q);return G1(A,D.targetId,F.au),F.snapshot})(s,v,_,E);const u=await V1(s.localStore,e,!0),h=new jS(e,u.Qs),p=h.ru(u.documents),g=Gc.createSynthesizedTargetChangeForCurrentChange(n,a&&s.onlineState!=="Offline",l),x=h.applyChanges(p,s.isPrimaryClient,g);G1(s,n,x.au);const y=new SS(e,n,h);return s.Tu.set(e,y),s.Iu.has(n)?s.Iu.get(n).push(e):s.Iu.set(n,[e]),x.snapshot}async function IS(s,e,n){const a=Pe(s),l=a.Tu.get(e),u=a.Iu.get(l.targetId);if(u.length>1)return a.Iu.set(l.targetId,u.filter((h=>!Sh(h,e)))),void a.Tu.delete(e);a.isPrimaryClient?(a.sharedClientState.removeLocalQueryTarget(l.targetId),a.sharedClientState.isActiveQueryTarget(l.targetId)||await R0(a.localStore,l.targetId,!1).then((()=>{a.sharedClientState.clearQueryState(l.targetId),n&&pg(a.remoteStore,l.targetId),M0(a,l.targetId)})).catch(il)):(M0(a,l.targetId),await R0(a.localStore,l.targetId,!0))}async function MS(s,e){const n=Pe(s),a=n.Tu.get(e),l=n.Iu.get(a.targetId);n.isPrimaryClient&&l.length===1&&(n.sharedClientState.removeLocalQueryTarget(a.targetId),pg(n.remoteStore,a.targetId))}async function kS(s,e,n){const a=BS(s);try{const l=await(function(h,p){const g=Pe(h),x=Et.now(),y=p.reduce(((E,S)=>E.add(S.key)),Je());let v,_;return g.persistence.runTransaction("Locally write mutations","readwrite",(E=>{let S=Jr(),A=Je();return g.Ns.getEntries(E,y).next((D=>{S=D,S.forEach(((L,B)=>{B.isValidDocument()||(A=A.add(L))}))})).next((()=>g.localDocuments.getOverlayedDocuments(E,S))).next((D=>{v=D;const L=[];for(const B of p){const k=KE(B,v.get(B.key).overlayedDocument);k!=null&&L.push(new ai(B.key,k,jv(k.value.mapValue),Dn.exists(!0)))}return g.mutationQueue.addMutationBatch(E,x,L,p)})).next((D=>{_=D;const L=D.applyToLocalDocumentSet(v,A);return g.documentOverlayCache.saveOverlays(E,D.batchId,L)}))})).then((()=>({batchId:_.batchId,changes:Ov(v)})))})(a.localStore,e);a.sharedClientState.addPendingMutation(l.batchId),(function(h,p,g){let x=h.Vu[h.currentUser.toKey()];x||(x=new Mt(Ze)),x=x.insert(p,g),h.Vu[h.currentUser.toKey()]=x})(a,l.batchId,n),await Qc(a,l.changes),await Vh(a.remoteStore)}catch(l){const u=wg(l,"Failed to persist write");n.reject(u)}}async function x4(s,e){const n=Pe(s);try{const a=await Qj(n.localStore,e);e.targetChanges.forEach(((l,u)=>{const h=n.Au.get(u);h&&(ct(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?h.hu=!0:l.modifiedDocuments.size>0?ct(h.hu,14607):l.removedDocuments.size>0&&(ct(h.hu,42227),h.hu=!1))})),await Qc(n,a,e)}catch(a){await il(a)}}function H1(s,e,n){const a=Pe(s);if(a.isPrimaryClient&&n===0||!a.isPrimaryClient&&n===1){const l=[];a.Tu.forEach(((u,h)=>{const p=h.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(h,p){const g=Pe(h);g.onlineState=p;let x=!1;g.queries.forEach(((y,v)=>{for(const _ of v.Sa)_.va(p)&&(x=!0)})),x&&Eg(g)})(a.eventManager,e),l.length&&a.Pu.H_(l),a.onlineState=e,a.isPrimaryClient&&a.sharedClientState.setOnlineState(e)}}async function VS(s,e,n){const a=Pe(s);a.sharedClientState.updateQueryState(e,"rejected",n);const l=a.Au.get(e),u=l&&l.key;if(u){let h=new Mt(Se.comparator);h=h.insert(u,En.newNoDocument(u,Ve.min()));const p=Je().add(u),g=new Ih(Ve.min(),new Map,new Mt(Ze),h,p);await x4(a,g),a.du=a.du.remove(u),a.Au.delete(e),Tg(a)}else await R0(a.localStore,e,!1).then((()=>M0(a,e,n))).catch(il)}async function OS(s,e){const n=Pe(s),a=e.batch.batchId;try{const l=await $j(n.localStore,e);b4(n,a,null),y4(n,a),n.sharedClientState.updateMutationState(a,"acknowledged"),await Qc(n,l)}catch(l){await il(l)}}async function PS(s,e,n){const a=Pe(s);try{const l=await(function(h,p){const g=Pe(h);return g.persistence.runTransaction("Reject batch","readwrite-primary",(x=>{let y;return g.mutationQueue.lookupMutationBatch(x,p).next((v=>(ct(v!==null,37113),y=v.keys(),g.mutationQueue.removeMutationBatch(x,v)))).next((()=>g.mutationQueue.performConsistencyCheck(x))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(x,y,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(x,y))).next((()=>g.localDocuments.getDocuments(x,y)))}))})(a.localStore,e);b4(a,e,n),y4(a,e),a.sharedClientState.updateMutationState(e,"rejected",n),await Qc(a,l)}catch(l){await il(l)}}function y4(s,e){(s.mu.get(e)||[]).forEach((n=>{n.resolve()})),s.mu.delete(e)}function b4(s,e,n){const a=Pe(s);let l=a.Vu[a.currentUser.toKey()];if(l){const u=l.get(e);u&&(n?u.reject(n):u.resolve(),l=l.remove(e)),a.Vu[a.currentUser.toKey()]=l}}function M0(s,e,n=null){s.sharedClientState.removeLocalQueryTarget(e);for(const a of s.Iu.get(e))s.Tu.delete(a),n&&s.Pu.yu(a,n);s.Iu.delete(e),s.isPrimaryClient&&s.Ru.jr(e).forEach((a=>{s.Ru.containsKey(a)||v4(s,a)}))}function v4(s,e){s.Eu.delete(e.path.canonicalString());const n=s.du.get(e);n!==null&&(pg(s.remoteStore,n),s.du=s.du.remove(e),s.Au.delete(n),Tg(s))}function G1(s,e,n){for(const a of n)a instanceof m4?(s.Ru.addReference(a.key,e),LS(s,a)):a instanceof g4?(ye(Sg,"Document no longer in limbo: "+a.key),s.Ru.removeReference(a.key,e),s.Ru.containsKey(a.key)||v4(s,a.key)):De(19791,{wu:a})}function LS(s,e){const n=e.key,a=n.path.canonicalString();s.du.get(n)||s.Eu.has(a)||(ye(Sg,"New document in limbo: "+n),s.Eu.add(a),Tg(s))}function Tg(s){for(;s.Eu.size>0&&s.du.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const n=new Se(vt.fromString(e)),a=s.fu.next();s.Au.set(a,new TS(n)),s.du=s.du.insert(n,a),l4(s.remoteStore,new qa(ur(jh(n.path)),a,"TargetPurposeLimboResolution",_h.ce))}}async function Qc(s,e,n){const a=Pe(s),l=[],u=[],h=[];a.Tu.isEmpty()||(a.Tu.forEach(((p,g)=>{h.push(a.pu(g,e,n).then((x=>{if((x||n)&&a.isPrimaryClient){const y=x?!x.fromCache:n?.targetChanges.get(g.targetId)?.current;a.sharedClientState.updateQueryState(g.targetId,y?"current":"not-current")}if(x){l.push(x);const y=mg.As(g.targetId,x);u.push(y)}})))})),await Promise.all(h),a.Pu.H_(l),await(async function(g,x){const y=Pe(g);try{await y.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>le.forEach(x,(_=>le.forEach(_.Es,(E=>y.persistence.referenceDelegate.addReference(v,_.targetId,E))).next((()=>le.forEach(_.ds,(E=>y.persistence.referenceDelegate.removeReference(v,_.targetId,E)))))))))}catch(v){if(!ol(v))throw v;ye(gg,"Failed to update sequence numbers: "+v)}for(const v of x){const _=v.targetId;if(!v.fromCache){const E=y.Ms.get(_),S=E.snapshotVersion,A=E.withLastLimboFreeSnapshotVersion(S);y.Ms=y.Ms.insert(_,A)}}})(a.localStore,u))}async function US(s,e){const n=Pe(s);if(!n.currentUser.isEqual(e)){ye(Sg,"User change. New user:",e.toKey());const a=await r4(n.localStore,e);n.currentUser=e,(function(u,h){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new fe(re.CANCELLED,h))}))})),u.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,a.removedBatchIds,a.addedBatchIds),await Qc(n,a.Ls)}}function zS(s,e){const n=Pe(s),a=n.Au.get(e);if(a&&a.hu)return Je().add(a.key);{let l=Je();const u=n.Iu.get(e);if(!u)return l;for(const h of u){const p=n.Tu.get(h);l=l.unionWith(p.view.nu)}return l}}function w4(s){const e=Pe(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=x4.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=zS.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=VS.bind(null,e),e.Pu.H_=NS.bind(null,e.eventManager),e.Pu.yu=ES.bind(null,e.eventManager),e}function BS(s){const e=Pe(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=OS.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=PS.bind(null,e),e}class oh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Mh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return Gj(this.persistence,new Fj,e.initialUser,this.serializer)}Cu(e){return new s4(fg.mi,this.serializer)}Du(e){return new Jj}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}oh.provider={build:()=>new oh};class FS extends oh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ct(this.persistence.referenceDelegate instanceof ah,46915);const a=this.persistence.referenceDelegate.garbageCollector;return new Tj(a,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?qn.withCacheSize(this.cacheSizeBytes):qn.DEFAULT;return new s4((a=>ah.mi(a,n)),this.serializer)}}class k0{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>H1(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=US.bind(null,this.syncEngine),await vS(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new _S})()}createDatastore(e){const n=Mh(e.databaseInfo.databaseId),a=(function(u){return new sS(u)})(e.databaseInfo);return(function(u,h,p,g){return new oS(u,h,p,g)})(e.authCredentials,e.appCheckCredentials,a,n)}createRemoteStore(e){return(function(a,l,u,h,p){return new cS(a,l,u,h,p)})(this.localStore,this.datastore,e.asyncQueue,(n=>H1(this.syncEngine,n,0)),(function(){return L1.v()?new L1:new Wj})())}createSyncEngine(e,n){return(function(l,u,h,p,g,x,y){const v=new AS(l,u,h,p,g,x);return y&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const a=Pe(n);ye(Fi,"RemoteStore shutting down."),a.Ea.add(5),await $c(a),a.Aa.shutdown(),a.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}k0.provider={build:()=>new k0};class Ag{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Zr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const ni="FirestoreClient";class qS{constructor(e,n,a,l,u){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=a,this.databaseInfo=l,this.user=Nn.UNAUTHENTICATED,this.clientId=ng.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(a,(async h=>{ye(ni,"Received user=",h.uid),await this.authCredentialListener(h),this.user=h})),this.appCheckCredentials.start(a,(h=>(ye(ni,"Received new app check token=",h),this.appCheckCredentialListener(h,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Qr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const a=wg(n,"Failed to shutdown persistence");e.reject(a)}})),e.promise}}async function c0(s,e){s.asyncQueue.verifyOperationInProgress(),ye(ni,"Initializing OfflineComponentProvider");const n=s.configuration;await e.initialize(n);let a=n.initialUser;s.setCredentialChangeListener((async l=>{a.isEqual(l)||(await r4(e.localStore,l),a=l)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function $1(s,e){s.asyncQueue.verifyOperationInProgress();const n=await HS(s);ye(ni,"Initializing OnlineComponentProvider"),await e.initialize(n,s.configuration),s.setCredentialChangeListener((a=>z1(e.remoteStore,a))),s.setAppCheckTokenChangeListener(((a,l)=>z1(e.remoteStore,l))),s._onlineComponents=e}async function HS(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){ye(ni,"Using user provided OfflineComponentProvider");try{await c0(s,s._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(l){return l.name==="FirebaseError"?l.code===re.FAILED_PRECONDITION||l.code===re.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(n))throw n;$o("Error using user provided cache. Falling back to memory cache: "+n),await c0(s,new oh)}}else ye(ni,"Using default OfflineComponentProvider"),await c0(s,new FS(void 0));return s._offlineComponents}async function _4(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(ye(ni,"Using user provided OnlineComponentProvider"),await $1(s,s._uninitializedComponentsProvider._online)):(ye(ni,"Using default OnlineComponentProvider"),await $1(s,new k0))),s._onlineComponents}function GS(s){return _4(s).then((e=>e.syncEngine))}async function lh(s){const e=await _4(s),n=e.eventManager;return n.onListen=CS.bind(null,e.syncEngine),n.onUnlisten=IS.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=RS.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=MS.bind(null,e.syncEngine),n}function $S(s,e,n={}){const a=new Qr;return s.asyncQueue.enqueueAndForget((async()=>(function(u,h,p,g,x){const y=new Ag({next:_=>{y.Nu(),h.enqueueAndForget((()=>Ng(u,v)));const E=_.docs.has(p);!E&&_.fromCache?x.reject(new fe(re.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&_.fromCache&&g&&g.source==="server"?x.reject(new fe(re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):x.resolve(_)},error:_=>x.reject(_)}),v=new jg(jh(p.path),y,{includeMetadataChanges:!0,qa:!0});return _g(u,v)})(await lh(s),s.asyncQueue,e,n,a))),a.promise}function QS(s,e,n={}){const a=new Qr;return s.asyncQueue.enqueueAndForget((async()=>(function(u,h,p,g,x){const y=new Ag({next:_=>{y.Nu(),h.enqueueAndForget((()=>Ng(u,v))),_.fromCache&&g.source==="server"?x.reject(new fe(re.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):x.resolve(_)},error:_=>x.reject(_)}),v=new jg(p,y,{includeMetadataChanges:!0,qa:!0});return _g(u,v)})(await lh(s),s.asyncQueue,e,n,a))),a.promise}function N4(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const Q1=new Map;const E4="firestore.googleapis.com",Y1=!0;class K1{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new fe(re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=E4,this.ssl=Y1}else this.host=e.host,this.ssl=e.ssl??Y1;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=n4;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<jj)throw new fe(re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}cE("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=N4(e.experimentalLongPollingOptions??{}),(function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new fe(re.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new fe(re.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new fe(re.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(a,l){return a.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Oh{constructor(e,n,a,l){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=a,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new K1({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new fe(re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new fe(re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new K1(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(a){if(!a)return new W3;switch(a.type){case"firstParty":return new sE(a.sessionIndex||"0",a.iamToken||null,a.authTokenFactory||null);case"provider":return a.client;default:throw new fe(re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const a=Q1.get(n);a&&(ye("ComponentProvider","Removing Datastore"),Q1.delete(n),a.terminate())})(this),Promise.resolve()}}function YS(s,e,n,a={}){s=Rn(s,Oh);const l=nl(e),u=s._getSettings(),h={...u,emulatorOptions:s._getEmulatorOptions()},p=`${e}:${n}`;l&&(pb(`https://${p}`),xb("Firestore",!0)),u.host!==E4&&u.host!==p&&$o("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:a};if(!Yr(g,h)&&(s._setSettings(g),a.mockUserToken)){let x,y;if(typeof a.mockUserToken=="string")x=a.mockUserToken,y=Nn.MOCK_USER;else{x=l6(a.mockUserToken,s._app?.options.projectId);const v=a.mockUserToken.sub||a.mockUserToken.user_id;if(!v)throw new fe(re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new Nn(v)}s._authCredentials=new eE(new fv(x,y))}}class ia{constructor(e,n,a){this.converter=n,this._query=a,this.type="query",this.firestore=e}withConverter(e){return new ia(this.firestore,e,this._query)}}class Ot{constructor(e,n,a){this.converter=n,this._key=a,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Xa(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ot(this.firestore,e,this._key)}toJSON(){return{type:Ot._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,a){if(qc(n,Ot._jsonSchema))return new Ot(e,a||null,new Se(vt.fromString(n.referencePath)))}}Ot._jsonSchemaVersion="firestore/documentReference/1.0",Ot._jsonSchema={type:Zt("string",Ot._jsonSchemaVersion),referencePath:Zt("string")};class Xa extends ia{constructor(e,n,a){super(e,n,jh(a)),this._path=a,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ot(this.firestore,null,new Se(e))}withConverter(e){return new Xa(this.firestore,e,this._path)}}function Me(s,e,...n){if(s=It(s),mv("collection","path",e),s instanceof Oh){const a=vt.fromString(e,...n);return l1(a),new Xa(s,null,a)}{if(!(s instanceof Ot||s instanceof Xa))throw new fe(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=s._path.child(vt.fromString(e,...n));return l1(a),new Xa(s.firestore,null,a)}}function se(s,e,...n){if(s=It(s),arguments.length===1&&(e=ng.newId()),mv("doc","path",e),s instanceof Oh){const a=vt.fromString(e,...n);return o1(a),new Ot(s,null,new Se(a))}{if(!(s instanceof Ot||s instanceof Xa))throw new fe(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=s._path.child(vt.fromString(e,...n));return o1(a),new Ot(s.firestore,s instanceof Xa?s.converter:null,new Se(a))}}const X1="AsyncQueue";class Z1{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new i4(this,"async_queue_retry"),this._c=()=>{const a=l0();a&&ye(X1,"Visibility state changed to "+a.visibilityState),this.M_.w_()},this.ac=e;const n=l0();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=l0();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new Qr;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ol(e))throw e;ye(X1,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((a=>{throw this.nc=a,this.rc=!1,Zr("INTERNAL UNHANDLED ERROR: ",J1(a)),a})).then((a=>(this.rc=!1,a))))));return this.ac=n,n}enqueueAfterDelay(e,n,a){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const l=vg.createAndSchedule(this,e,n,a,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&De(47125,{Pc:J1(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,a)=>n.targetTimeMs-a.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function J1(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}function W1(s){return(function(n,a){if(typeof n!="object"||n===null)return!1;const l=n;for(const u of a)if(u in l&&typeof l[u]=="function")return!0;return!1})(s,["next","error","complete"])}class pr extends Oh{constructor(e,n,a,l){super(e,n,a,l),this.type="firestore",this._queue=new Z1,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Z1(e),this._firestoreClient=void 0,await e}}}function KS(s,e){const n=typeof s=="object"?s:wb(),a=typeof s=="string"?s:eh,l=q0(n,"firestore").getImmediate({identifier:a});if(!l._initialized){const u=i6("firestore");u&&YS(l,...u)}return l}function Yc(s){if(s._terminated)throw new fe(re.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||XS(s),s._firestoreClient}function XS(s){const e=s._freezeSettings(),n=(function(l,u,h,p){return new wE(l,u,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,N4(p.experimentalLongPollingOptions),p.useFetchStreams,p.isUsingEmulator)})(s._databaseId,s._app?.options.appId||"",s._persistenceKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new qS(s._authCredentials,s._appCheckCredentials,s._queue,n,s._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(s._componentsProvider))}class _s{constructor(e){this._byteString=e}static fromBase64String(e){try{return new _s(xn.fromBase64String(e))}catch(n){throw new fe(re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new _s(xn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:_s._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(qc(e,_s._jsonSchema))return _s.fromBase64String(e.bytes)}}_s._jsonSchemaVersion="firestore/bytes/1.0",_s._jsonSchema={type:Zt("string",_s._jsonSchemaVersion),bytes:Zt("string")};class Kc{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new fe(re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new pn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Gi{constructor(e){this._methodName=e}}class hr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new fe(re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new fe(re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ze(this._lat,e._lat)||Ze(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:hr._jsonSchemaVersion}}static fromJSON(e){if(qc(e,hr._jsonSchema))return new hr(e.latitude,e.longitude)}}hr._jsonSchemaVersion="firestore/geoPoint/1.0",hr._jsonSchema={type:Zt("string",hr._jsonSchemaVersion),latitude:Zt("number"),longitude:Zt("number")};class fr{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(a,l){if(a.length!==l.length)return!1;for(let u=0;u<a.length;++u)if(a[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:fr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(qc(e,fr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new fr(e.vectorValues);throw new fe(re.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}fr._jsonSchemaVersion="firestore/vectorValue/1.0",fr._jsonSchema={type:Zt("string",fr._jsonSchemaVersion),vectorValues:Zt("object")};const ZS=/^__.*__$/;class JS{constructor(e,n,a){this.data=e,this.fieldMask=n,this.fieldTransforms=a}toMutation(e,n){return this.fieldMask!==null?new ai(e,this.data,this.fieldMask,n,this.fieldTransforms):new Hc(e,this.data,n,this.fieldTransforms)}}class j4{constructor(e,n,a){this.data=e,this.fieldMask=n,this.fieldTransforms=a}toMutation(e,n){return new ai(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function S4(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw De(40011,{Ac:s})}}class Ph{constructor(e,n,a,l,u,h){this.settings=e,this.databaseId=n,this.serializer=a,this.ignoreUndefinedProperties=l,u===void 0&&this.Rc(),this.fieldTransforms=u||[],this.fieldMask=h||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Ph({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),a=this.Vc({path:n,fc:!1});return a.gc(e),a}yc(e){const n=this.path?.child(e),a=this.Vc({path:n,fc:!1});return a.Rc(),a}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return ch(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(S4(this.Ac)&&ZS.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class WS{constructor(e,n,a){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=a||Mh(e)}Cc(e,n,a,l=!1){return new Ph({Ac:e,methodName:n,Dc:a,path:pn.emptyPath(),fc:!1,bc:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Xc(s){const e=s._freezeSettings(),n=Mh(s._databaseId);return new WS(s._databaseId,!!e.ignoreUndefinedProperties,n)}function Cg(s,e,n,a,l,u={}){const h=s.Cc(u.merge||u.mergeFields?2:0,e,n,l);kg("Data must be an object, but it was:",h,a);const p=R4(a,h);let g,x;if(u.merge)g=new is(h.fieldMask),x=h.fieldTransforms;else if(u.mergeFields){const y=[];for(const v of u.mergeFields){const _=V0(e,v,n);if(!h.contains(_))throw new fe(re.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);I4(y,_)||y.push(_)}g=new is(y),x=h.fieldTransforms.filter((v=>g.covers(v.field)))}else g=null,x=h.fieldTransforms;return new JS(new Gn(p),g,x)}class Zc extends Gi{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Zc}}function T4(s,e,n){return new Ph({Ac:3,Dc:e.settings.Dc,methodName:s._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Rg extends Gi{_toFieldTransform(e){return new Ch(e.path,new Mc)}isEqual(e){return e instanceof Rg}}class Dg extends Gi{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=T4(this,e,!0),a=this.vc.map((u=>$i(u,n))),l=new Xo(a);return new Ch(e.path,l)}isEqual(e){return e instanceof Dg&&Yr(this.vc,e.vc)}}class Ig extends Gi{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=T4(this,e,!0),a=this.vc.map((u=>$i(u,n))),l=new Zo(a);return new Ch(e.path,l)}isEqual(e){return e instanceof Ig&&Yr(this.vc,e.vc)}}class Mg extends Gi{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new kc(e.serializer,Uv(e.serializer,this.Fc));return new Ch(e.path,n)}isEqual(e){return e instanceof Mg&&this.Fc===e.Fc}}function A4(s,e,n,a){const l=s.Cc(1,e,n);kg("Data must be an object, but it was:",l,a);const u=[],h=Gn.empty();ri(a,((g,x)=>{const y=Vg(e,g,n);x=It(x);const v=l.yc(y);if(x instanceof Zc)u.push(y);else{const _=$i(x,v);_!=null&&(u.push(y),h.set(y,_))}}));const p=new is(u);return new j4(h,p,l.fieldTransforms)}function C4(s,e,n,a,l,u){const h=s.Cc(1,e,n),p=[V0(e,a,n)],g=[l];if(u.length%2!=0)throw new fe(re.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<u.length;_+=2)p.push(V0(e,u[_])),g.push(u[_+1]);const x=[],y=Gn.empty();for(let _=p.length-1;_>=0;--_)if(!I4(x,p[_])){const E=p[_];let S=g[_];S=It(S);const A=h.yc(E);if(S instanceof Zc)x.push(E);else{const D=$i(S,A);D!=null&&(x.push(E),y.set(E,D))}}const v=new is(x);return new j4(y,v,h.fieldTransforms)}function eT(s,e,n,a=!1){return $i(n,s.Cc(a?4:3,e))}function $i(s,e){if(D4(s=It(s)))return kg("Unsupported field value:",e,s),R4(s,e);if(s instanceof Gi)return(function(a,l){if(!S4(l.Ac))throw l.Sc(`${a._methodName}() can only be used with update() and set()`);if(!l.path)throw l.Sc(`${a._methodName}() is not currently supported inside arrays`);const u=a._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(a,l){const u=[];let h=0;for(const p of a){let g=$i(p,l.wc(h));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),h++}return{arrayValue:{values:u}}})(s,e)}return(function(a,l){if((a=It(a))===null)return{nullValue:"NULL_VALUE"};if(typeof a=="number")return Uv(l.serializer,a);if(typeof a=="boolean")return{booleanValue:a};if(typeof a=="string")return{stringValue:a};if(a instanceof Date){const u=Et.fromDate(a);return{timestampValue:rh(l.serializer,u)}}if(a instanceof Et){const u=new Et(a.seconds,1e3*Math.floor(a.nanoseconds/1e3));return{timestampValue:rh(l.serializer,u)}}if(a instanceof hr)return{geoPointValue:{latitude:a.latitude,longitude:a.longitude}};if(a instanceof _s)return{bytesValue:Kv(l.serializer,a._byteString)};if(a instanceof Ot){const u=l.databaseId,h=a.firestore._databaseId;if(!h.isEqual(u))throw l.Sc(`Document reference is for database ${h.projectId}/${h.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:dg(a.firestore._databaseId||l.databaseId,a._key.path)}}if(a instanceof fr)return(function(h,p){return{mapValue:{fields:{[Nv]:{stringValue:Ev},[th]:{arrayValue:{values:h.toArray().map((x=>{if(typeof x!="number")throw p.Sc("VectorValues must only contain numeric values.");return lg(p.serializer,x)}))}}}}}})(a,l);throw l.Sc(`Unsupported field value: ${wh(a)}`)})(s,e)}function R4(s,e){const n={};return xv(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ri(s,((a,l)=>{const u=$i(l,e.mc(a));u!=null&&(n[a]=u)})),{mapValue:{fields:n}}}function D4(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof Et||s instanceof hr||s instanceof _s||s instanceof Ot||s instanceof Gi||s instanceof fr)}function kg(s,e,n){if(!D4(n)||!gv(n)){const a=wh(n);throw a==="an object"?e.Sc(s+" a custom object"):e.Sc(s+" "+a)}}function V0(s,e,n){if((e=It(e))instanceof Kc)return e._internalPath;if(typeof e=="string")return Vg(s,e);throw ch("Field path arguments must be of type string or ",s,!1,void 0,n)}const tT=new RegExp("[~\\*/\\[\\]]");function Vg(s,e,n){if(e.search(tT)>=0)throw ch(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,n);try{return new Kc(...e.split("."))._internalPath}catch{throw ch(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,n)}}function ch(s,e,n,a,l){const u=a&&!a.isEmpty(),h=l!==void 0;let p=`Function ${e}() called with invalid data`;n&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||h)&&(g+=" (found",u&&(g+=` in field ${a}`),h&&(g+=` in document ${l}`),g+=")"),new fe(re.INVALID_ARGUMENT,p+s+g)}function I4(s,e){return s.some((n=>n.isEqual(e)))}class M4{constructor(e,n,a,l,u){this._firestore=e,this._userDataWriter=n,this._key=a,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new Ot(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new nT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Lh("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class nT extends M4{data(){return super.data()}}function Lh(s,e){return typeof e=="string"?Vg(s,e):e instanceof Kc?e._internalPath:e._delegate._internalPath}function k4(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new fe(re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Og{}class Pg extends Og{}function Dt(s,e,...n){let a=[];e instanceof Og&&a.push(e),a=a.concat(n),(function(u){const h=u.filter((g=>g instanceof Lg)).length,p=u.filter((g=>g instanceof Uh)).length;if(h>1||h>0&&p>0)throw new fe(re.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(a);for(const l of a)s=l._apply(s);return s}class Uh extends Pg{constructor(e,n,a){super(),this._field=e,this._op=n,this._value=a,this.type="where"}static _create(e,n,a){return new Uh(e,n,a)}_apply(e){const n=this._parse(e);return V4(e._query,n),new ia(e.firestore,e.converter,j0(e._query,n))}_parse(e){const n=Xc(e.firestore);return(function(u,h,p,g,x,y,v){let _;if(x.isKeyField()){if(y==="array-contains"||y==="array-contains-any")throw new fe(re.INVALID_ARGUMENT,`Invalid Query. You can't perform '${y}' queries on documentId().`);if(y==="in"||y==="not-in"){tb(v,y);const S=[];for(const A of v)S.push(eb(g,u,A));_={arrayValue:{values:S}}}else _=eb(g,u,v)}else y!=="in"&&y!=="not-in"&&y!=="array-contains-any"||tb(v,y),_=eT(p,h,v,y==="in"||y==="not-in");return Xt.create(x,y,_)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function He(s,e,n){const a=e,l=Lh("where",s);return Uh._create(l,a,n)}class Lg extends Og{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Lg(e,n)}_parse(e){const n=this._queryConstraints.map((a=>a._parse(e))).filter((a=>a.getFilters().length>0));return n.length===1?n[0]:Us.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(l,u){let h=l;const p=u.getFlattenedFilters();for(const g of p)V4(h,g),h=j0(h,g)})(e._query,n),new ia(e.firestore,e.converter,j0(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Ug extends Pg{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Ug(e,n)}_apply(e){const n=(function(l,u,h){if(l.startAt!==null)throw new fe(re.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new fe(re.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ic(u,h)})(e._query,this._field,this._direction);return new ia(e.firestore,e.converter,(function(l,u){const h=l.explicitOrderBy.concat([u]);return new ll(l.path,l.collectionGroup,h,l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt)})(e._query,n))}}function el(s,e="asc"){const n=e,a=Lh("orderBy",s);return Ug._create(a,n)}class zg extends Pg{constructor(e,n,a){super(),this.type=e,this._limit=n,this._limitType=a}static _create(e,n,a){return new zg(e,n,a)}_apply(e){return new ia(e.firestore,e.converter,sh(e._query,this._limit,this._limitType))}}function tl(s){return uE("limit",s),zg._create("limit",s,"F")}function eb(s,e,n){if(typeof(n=It(n))=="string"){if(n==="")throw new fe(re.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Iv(e)&&n.indexOf("/")!==-1)throw new fe(re.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const a=e.path.child(vt.fromString(n));if(!Se.isDocumentKey(a))throw new fe(re.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${a}' is not because it has an odd number of segments (${a.length}).`);return p1(s,new Se(a))}if(n instanceof Ot)return p1(s,n._key);throw new fe(re.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${wh(n)}.`)}function tb(s,e){if(!Array.isArray(s)||s.length===0)throw new fe(re.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function V4(s,e){const n=(function(l,u){for(const h of l)for(const p of h.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(s.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new fe(re.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new fe(re.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class sT{convertValue(e,n="none"){switch(ei(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Bt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Wa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw De(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const a={};return ri(e,((l,u)=>{a[l]=this.convertValue(u,n)})),a}convertVectorValue(e){const n=e.fields?.[th].arrayValue?.values?.map((a=>Bt(a.doubleValue)));return new fr(n)}convertGeoPoint(e){return new hr(Bt(e.latitude),Bt(e.longitude))}convertArray(e,n){return(e.values||[]).map((a=>this.convertValue(a,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const a=Eh(e);return a==null?null:this.convertValue(a,n);case"estimate":return this.convertTimestamp(Cc(e));default:return null}}convertTimestamp(e){const n=Ja(e);return new Et(n.seconds,n.nanos)}convertDocumentKey(e,n){const a=vt.fromString(e);ct(t4(a),9688,{name:e});const l=new Rc(a.get(1),a.get(3)),u=new Se(a.popFirst(5));return l.isEqual(n)||Zr(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),u}}function Bg(s,e,n){let a;return a=s?n&&(n.merge||n.mergeFields)?s.toFirestore(e,n):s.toFirestore(e):e,a}class xc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Oi extends M4{constructor(e,n,a,l,u,h){super(e,n,a,l,h),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Fd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const a=this._document.data.field(Lh("DocumentSnapshot.get",e));if(a!==null)return this._userDataWriter.convertValue(a,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new fe(re.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Oi._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Oi._jsonSchemaVersion="firestore/documentSnapshot/1.0",Oi._jsonSchema={type:Zt("string",Oi._jsonSchemaVersion),bundleSource:Zt("string","DocumentSnapshot"),bundleName:Zt("string"),bundle:Zt("string")};class Fd extends Oi{data(e={}){return super.data(e)}}class Pi{constructor(e,n,a,l){this._firestore=e,this._userDataWriter=n,this._snapshot=l,this.metadata=new xc(l.hasPendingWrites,l.fromCache),this.query=a}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((a=>{e.call(n,new Fd(this._firestore,this._userDataWriter,a.key,a,new xc(this._snapshot.mutatedKeys.has(a.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new fe(re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let h=0;return l._snapshot.docChanges.map((p=>{const g=new Fd(l._firestore,l._userDataWriter,p.doc.key,p.doc,new xc(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:h++}}))}{let h=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new Fd(l._firestore,l._userDataWriter,p.doc.key,p.doc,new xc(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let x=-1,y=-1;return p.type!==0&&(x=h.indexOf(p.doc.key),h=h.delete(p.doc.key)),p.type!==1&&(h=h.add(p.doc),y=h.indexOf(p.doc.key)),{type:rT(p.type),doc:g,oldIndex:x,newIndex:y}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new fe(re.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Pi._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ng.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],a=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(n.push(u._document),a.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function rT(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return De(61501,{type:s})}}function ve(s){s=Rn(s,Ot);const e=Rn(s.firestore,pr);return $S(Yc(e),s._key).then((n=>O4(e,s,n)))}Pi._jsonSchemaVersion="firestore/querySnapshot/1.0",Pi._jsonSchema={type:Zt("string",Pi._jsonSchemaVersion),bundleSource:Zt("string","QuerySnapshot"),bundleName:Zt("string"),bundle:Zt("string")};class Fg extends sT{constructor(e){super(),this.firestore=e}convertBytes(e){return new _s(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ot(this.firestore,null,n)}}function gn(s){s=Rn(s,ia);const e=Rn(s.firestore,pr),n=Yc(e),a=new Fg(e);return k4(s._query),QS(n,s._query).then((l=>new Pi(e,a,s,l)))}function Ec(s,e,n){s=Rn(s,Ot);const a=Rn(s.firestore,pr),l=Bg(s.converter,e,n);return Jc(a,[Cg(Xc(a),"setDoc",s._key,l,s.converter!==null,n).toMutation(s._key,Dn.none())])}function tt(s,e,n,...a){s=Rn(s,Ot);const l=Rn(s.firestore,pr),u=Xc(l);let h;return h=typeof(e=It(e))=="string"||e instanceof Kc?C4(u,"updateDoc",s._key,e,n,a):A4(u,"updateDoc",s._key,e),Jc(l,[h.toMutation(s._key,Dn.exists(!0))])}function zh(s){return Jc(Rn(s.firestore,pr),[new Dh(s._key,Dn.none())])}function _n(s,e){const n=Rn(s.firestore,pr),a=se(s),l=Bg(s.converter,e);return Jc(n,[Cg(Xc(s.firestore),"addDoc",a._key,l,s.converter!==null,{}).toMutation(a._key,Dn.exists(!1))]).then((()=>a))}function zs(s,...e){s=It(s);let n={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||W1(e[a])||(n=e[a++]);const l={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(W1(e[a])){const g=e[a];e[a]=g.next?.bind(g),e[a+1]=g.error?.bind(g),e[a+2]=g.complete?.bind(g)}let u,h,p;if(s instanceof Ot)h=Rn(s.firestore,pr),p=jh(s._key.path),u={next:g=>{e[a]&&e[a](O4(h,s,g))},error:e[a+1],complete:e[a+2]};else{const g=Rn(s,ia);h=Rn(g.firestore,pr),p=g._query;const x=new Fg(h);u={next:y=>{e[a]&&e[a](new Pi(h,x,g,y))},error:e[a+1],complete:e[a+2]},k4(s._query)}return(function(x,y,v,_){const E=new Ag(_),S=new jg(y,E,v);return x.asyncQueue.enqueueAndForget((async()=>_g(await lh(x),S))),()=>{E.Nu(),x.asyncQueue.enqueueAndForget((async()=>Ng(await lh(x),S)))}})(Yc(h),p,l,u)}function Jc(s,e){return(function(a,l){const u=new Qr;return a.asyncQueue.enqueueAndForget((async()=>kS(await GS(a),l,u))),u.promise})(Yc(s),e)}function O4(s,e,n){const a=n.docs.get(e._key),l=new Fg(s);return new Oi(s,l,e._key,a,new xc(n.hasPendingWrites,n.fromCache),e.converter)}class aT{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Xc(e)}set(e,n,a){this._verifyNotCommitted();const l=u0(e,this._firestore),u=Bg(l.converter,n,a),h=Cg(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,a);return this._mutations.push(h.toMutation(l._key,Dn.none())),this}update(e,n,a,...l){this._verifyNotCommitted();const u=u0(e,this._firestore);let h;return h=typeof(n=It(n))=="string"||n instanceof Kc?C4(this._dataReader,"WriteBatch.update",u._key,n,a,l):A4(this._dataReader,"WriteBatch.update",u._key,n),this._mutations.push(h.toMutation(u._key,Dn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=u0(e,this._firestore);return this._mutations=this._mutations.concat(new Dh(n._key,Dn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new fe(re.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function u0(s,e){if((s=It(s)).firestore!==e)throw new fe(re.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function Hn(){return new Zc("deleteField")}function bt(){return new Rg("serverTimestamp")}function Gr(...s){return new Dg("arrayUnion",s)}function lr(...s){return new Ig("arrayRemove",s)}function ke(s){return new Mg("increment",s)}function $n(s){return Yc(s=Rn(s,pr)),new aT(s,(e=>Jc(s,e)))}(function(e,n=!0){(function(l){al=l})(sl),Go(new Li("firestore",((a,{instanceIdentifier:l,options:u})=>{const h=a.getProvider("app").getImmediate(),p=new pr(new tE(a.getProvider("auth-internal")),new rE(h,a.getProvider("app-check-internal")),(function(x,y){if(!Object.prototype.hasOwnProperty.apply(x.options,["projectId"]))throw new fe(re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Rc(x.options.projectId,y)})(h,l),h);return u={useFetchStreams:n,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),Ya(s1,r1,e),Ya(s1,r1,"esm2020")})();const iT={apiKey:void 0,authDomain:void 0,projectId:void 0,storageBucket:void 0,messagingSenderId:void 0,appId:void 0},P4=vb(iT),Ne=K3(P4),Y=KS(P4),L4=new Fr;var U4={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},nb=Ga.createContext&&Ga.createContext(U4),oT=["attr","size","title"];function lT(s,e){if(s==null)return{};var n=cT(s,e),a,l;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(s);for(l=0;l<u.length;l++)a=u[l],!(e.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(s,a)&&(n[a]=s[a])}return n}function cT(s,e){if(s==null)return{};var n={};for(var a in s)if(Object.prototype.hasOwnProperty.call(s,a)){if(e.indexOf(a)>=0)continue;n[a]=s[a]}return n}function uh(){return uh=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(s[a]=n[a])}return s},uh.apply(this,arguments)}function sb(s,e){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);e&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(s,l).enumerable})),n.push.apply(n,a)}return n}function dh(s){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?sb(Object(n),!0).forEach(function(a){uT(s,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):sb(Object(n)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(n,a))})}return s}function uT(s,e,n){return e=dT(e),e in s?Object.defineProperty(s,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):s[e]=n,s}function dT(s){var e=hT(s,"string");return typeof e=="symbol"?e:e+""}function hT(s,e){if(typeof s!="object"||!s)return s;var n=s[Symbol.toPrimitive];if(n!==void 0){var a=n.call(s,e);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function z4(s){return s&&s.map((e,n)=>Ga.createElement(e.tag,dh({key:n},e.attr),z4(e.child)))}function xe(s){return e=>Ga.createElement(fT,uh({attr:dh({},s.attr)},e),z4(s.child))}function fT(s){var e=n=>{var{attr:a,size:l,title:u}=s,h=lT(s,oT),p=l||n.size||"1em",g;return n.className&&(g=n.className),s.className&&(g=(g?g+" ":"")+s.className),Ga.createElement("svg",uh({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,a,h,{className:g,style:dh(dh({color:s.color||n.color},n.style),s.style),height:p,width:p,xmlns:"http://www.w3.org/2000/svg"}),u&&Ga.createElement("title",null,u),s.children)};return nb!==void 0?Ga.createElement(nb.Consumer,null,n=>e(n)):e(U4)}function hh(s){return xe({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M143 352.3L7 216.3c-9.4-9.4-9.4-24.6 0-33.9l22.6-22.6c9.4-9.4 24.6-9.4 33.9 0l96.4 96.4 96.4-96.4c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9l-136 136c-9.2 9.4-24.4 9.4-33.8 0z"},child:[]}]})(s)}function fh(s){return xe({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M177 159.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 329.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"},child:[]}]})(s)}function qg(s){return xe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"},child:[]}]})(s)}function B4(s){return xe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"},child:[]}]})(s)}function Hg(s){return xe({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M97.12 362.63c-8.69-8.69-4.16-6.24-25.12-11.85-9.51-2.55-17.87-7.45-25.43-13.32L1.2 448.7c-4.39 10.77 3.81 22.47 15.43 22.03l52.69-2.01L105.56 507c8 8.44 22.04 5.81 26.43-4.96l52.05-127.62c-10.84 6.04-22.87 9.58-35.31 9.58-19.5 0-37.82-7.59-51.61-21.37zM382.8 448.7l-45.37-111.24c-7.56 5.88-15.92 10.77-25.43 13.32-21.07 5.64-16.45 3.18-25.12 11.85-13.79 13.78-32.12 21.37-51.62 21.37-12.44 0-24.47-3.55-35.31-9.58L252 502.04c4.39 10.77 18.44 13.4 26.43 4.96l36.25-38.28 52.69 2.01c11.62.44 19.82-11.27 15.43-22.03zM263 340c15.28-15.55 17.03-14.21 38.79-20.14 13.89-3.79 24.75-14.84 28.47-28.98 7.48-28.4 5.54-24.97 25.95-45.75 10.17-10.35 14.14-25.44 10.42-39.58-7.47-28.38-7.48-24.42 0-52.83 3.72-14.14-.25-29.23-10.42-39.58-20.41-20.78-18.47-17.36-25.95-45.75-3.72-14.14-14.58-25.19-28.47-28.98-27.88-7.61-24.52-5.62-44.95-26.41-10.17-10.35-25-14.4-38.89-10.61-27.87 7.6-23.98 7.61-51.9 0-13.89-3.79-28.72.25-38.89 10.61-20.41 20.78-17.05 18.8-44.94 26.41-13.89 3.79-24.75 14.84-28.47 28.98-7.47 28.39-5.54 24.97-25.95 45.75-10.17 10.35-14.15 25.44-10.42 39.58 7.47 28.36 7.48 24.4 0 52.82-3.72 14.14.25 29.23 10.42 39.59 20.41 20.78 18.47 17.35 25.95 45.75 3.72 14.14 14.58 25.19 28.47 28.98C104.6 325.96 106.27 325 121 340c13.23 13.47 33.84 15.88 49.74 5.82a39.676 39.676 0 0 1 42.53 0c15.89 10.06 36.5 7.65 49.73-5.82zM97.66 175.96c0-53.03 42.24-96.02 94.34-96.02s94.34 42.99 94.34 96.02-42.24 96.02-94.34 96.02-94.34-42.99-94.34-96.02z"},child:[]}]})(s)}function mr(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.034 8 8 119.033 8 256s111.034 248 248 248 248-111.034 248-248S392.967 8 256 8zm130.108 117.892c65.448 65.448 70 165.481 20.677 235.637L150.47 105.216c70.204-49.356 170.226-44.735 235.638 20.676zM125.892 386.108c-65.448-65.448-70-165.481-20.677-235.637L361.53 406.784c-70.203 49.356-170.226 44.736-235.638-20.676z"},child:[]}]})(s)}function mT(s){return xe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M633.82 458.1l-90.62-70.05c.19-1.38.8-2.66.8-4.06.05-7.55-2.61-15.27-8.61-21.71-19.32-20.76-55.47-51.99-55.47-154.29 0-77.7-54.48-139.9-127.94-155.16V32c0-17.67-14.32-32-31.98-32s-31.98 14.33-31.98 32v20.84c-40.33 8.38-74.66 31.07-97.59 62.57L45.47 3.37C38.49-2.05 28.43-.8 23.01 6.18L3.37 31.45C-2.05 38.42-.8 48.47 6.18 53.9l588.35 454.73c6.98 5.43 17.03 4.17 22.46-2.81l19.64-25.27c5.42-6.97 4.17-17.02-2.81-22.45zM157.23 251.54c-8.61 67.96-36.41 93.33-52.62 110.75-6 6.45-8.66 14.16-8.61 21.71.11 16.4 12.98 32 32.1 32h241.92L157.23 251.54zM320 512c35.32 0 63.97-28.65 63.97-64H256.03c0 35.35 28.65 64 63.97 64z"},child:[]}]})(s)}function gT(s){return xe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 512c35.32 0 63.97-28.65 63.97-64H160.03c0 35.35 28.65 64 63.97 64zm215.39-149.71c-19.32-20.76-55.47-51.99-55.47-154.29 0-77.7-54.48-139.9-127.94-155.16V32c0-17.67-14.32-32-31.98-32s-31.98 14.33-31.98 32v20.84C118.56 68.1 64.08 130.3 64.08 208c0 102.3-36.15 133.53-55.47 154.29-6 6.45-8.66 14.16-8.61 21.71.11 16.4 12.98 32 32.1 32h383.8c19.12 0 32-15.6 32.1-32 .05-7.55-2.61-15.27-8.61-21.71z"},child:[]}]})(s)}function Bh(s){return xe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm320-196c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM192 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM64 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"},child:[]}]})(s)}function Qi(s){return xe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M12 192h424c6.6 0 12 5.4 12 12v260c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V204c0-6.6 5.4-12 12-12zm436-44v-36c0-26.5-21.5-48-48-48h-48V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H160V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H48C21.5 64 0 85.5 0 112v36c0 6.6 5.4 12 12 12h424c6.6 0 12-5.4 12-12z"},child:[]}]})(s)}function rb(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 144v288c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V144c0-26.5 21.5-48 48-48h88l12.3-32.9c7-18.7 24.9-31.1 44.9-31.1h125.5c20 0 37.9 12.4 44.9 31.1L376 96h88c26.5 0 48 21.5 48 48zM376 288c0-66.2-53.8-120-120-120s-120 53.8-120 120 53.8 120 120 120 120-53.8 120-120zm-32 0c0 48.5-39.5 88-88 88s-88-39.5-88-88 39.5-88 88-88 88 39.5 88 88z"},child:[]}]})(s)}function pT(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M458.622 255.92l45.985-45.005c13.708-12.977 7.316-36.039-10.664-40.339l-62.65-15.99 17.661-62.015c4.991-17.838-11.829-34.663-29.661-29.671l-61.994 17.667-15.984-62.671C337.085.197 313.765-6.276 300.99 7.228L256 53.57 211.011 7.229c-12.63-13.351-36.047-7.234-40.325 10.668l-15.984 62.671-61.995-17.667C74.87 57.907 58.056 74.738 63.046 92.572l17.661 62.015-62.65 15.99C.069 174.878-6.31 197.944 7.392 210.915l45.985 45.005-45.985 45.004c-13.708 12.977-7.316 36.039 10.664 40.339l62.65 15.99-17.661 62.015c-4.991 17.838 11.829 34.663 29.661 29.671l61.994-17.667 15.984 62.671c4.439 18.575 27.696 24.018 40.325 10.668L256 458.61l44.989 46.001c12.5 13.488 35.987 7.486 40.325-10.668l15.984-62.671 61.994 17.667c17.836 4.994 34.651-11.837 29.661-29.671l-17.661-62.015 62.65-15.99c17.987-4.302 24.366-27.367 10.664-40.339l-45.984-45.004z"},child:[]}]})(s)}function Fh(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16zM464 96H345.94c-21.38 0-32.09 25.85-16.97 40.97l32.4 32.4L288 242.75l-73.37-73.37c-12.5-12.5-32.76-12.5-45.25 0l-68.69 68.69c-6.25 6.25-6.25 16.38 0 22.63l22.62 22.62c6.25 6.25 16.38 6.25 22.63 0L192 237.25l73.37 73.37c12.5 12.5 32.76 12.5 45.25 0l96-96 32.4 32.4c15.12 15.12 40.97 4.41 40.97-16.97V112c.01-8.84-7.15-16-15.99-16z"},child:[]}]})(s)}function Wr(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},child:[]}]})(s)}function xT(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 174.8l-39.6-39.6c-9.4-9.4-24.6-9.4-33.9 0L192 374.7 80.6 263.2c-9.4-9.4-24.6-9.4-33.9 0L7 302.9c-9.4 9.4-9.4 24.6 0 34L175 505c9.4 9.4 24.6 9.4 33.9 0l296-296.2c9.4-9.5 9.4-24.7.1-34zm-324.3 106c6.2 6.3 16.4 6.3 22.6 0l208-208.2c6.2-6.3 6.2-16.4 0-22.6L366.1 4.7c-6.2-6.3-16.4-6.3-22.6 0L192 156.2l-55.4-55.5c-6.2-6.3-16.4-6.3-22.6 0L68.7 146c-6.2 6.3-6.2 16.4 0 22.6l112 112.2z"},child:[]}]})(s)}function F4(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"},child:[]}]})(s)}function O0(s){return xe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"},child:[]}]})(s)}function ab(s){return xe({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"},child:[]}]})(s)}function si(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"},child:[]}]})(s)}function q4(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(s)}function yT(s){return xe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M64 240c0 49.6 21.4 95 57 130.7-12.6 50.3-54.3 95.2-54.8 95.8-2.2 2.3-2.8 5.7-1.5 8.7 1.3 2.9 4.1 4.8 7.3 4.8 66.3 0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 27.4 0 53.7-3.6 78.4-10L72.9 186.4c-5.6 17.1-8.9 35-8.9 53.6zm569.8 218.1l-114.4-88.4C554.6 334.1 576 289.2 576 240c0-114.9-114.6-208-256-208-65.1 0-124.2 20.1-169.4 52.7L45.5 3.4C38.5-2 28.5-.8 23 6.2L3.4 31.4c-5.4 7-4.2 17 2.8 22.4l588.4 454.7c7 5.4 17 4.2 22.5-2.8l19.6-25.3c5.4-6.8 4.1-16.9-2.9-22.3z"},child:[]}]})(s)}function xr(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 32C114.6 32 0 125.1 0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3 0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4 0 256-93.1 256-208S397.4 32 256 32z"},child:[]}]})(s)}function bT(s){return xe({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M416 192c0-88.4-93.1-160-208-160S0 103.6 0 192c0 34.3 14.1 65.9 38 92-13.4 30.2-35.5 54.2-35.8 54.5-2.2 2.3-2.8 5.7-1.5 8.7S4.8 352 8 352c36.6 0 66.9-12.3 88.7-25 32.2 15.7 70.3 25 111.3 25 114.9 0 208-71.6 208-160zm122 220c23.9-26 38-57.7 38-92 0-66.9-53.5-124.2-129.3-148.1.9 6.6 1.3 13.3 1.3 20.1 0 105.9-107.7 192-240 192-10.8 0-21.3-.8-31.7-1.9C207.8 439.6 281.8 480 368 480c41 0 79.1-9.2 111.3-25 21.8 12.7 52.1 25 88.7 25 3.2 0 6.1-1.9 7.3-4.8 1.3-2.9.7-6.3-1.5-8.7-.3-.3-22.4-24.2-35.8-54.5z"},child:[]}]})(s)}function Wc(s){return xe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M528 448H112c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h416c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm64-320c-26.5 0-48 21.5-48 48 0 7.1 1.6 13.7 4.4 19.8L476 239.2c-15.4 9.2-35.3 4-44.2-11.6L350.3 85C361 76.2 368 63 368 48c0-26.5-21.5-48-48-48s-48 21.5-48 48c0 15 7 28.2 17.7 37l-81.5 142.6c-8.9 15.6-28.9 20.8-44.2 11.6l-72.3-43.4c2.7-6 4.4-12.7 4.4-19.8 0-26.5-21.5-48-48-48S0 149.5 0 176s21.5 48 48 48c2.6 0 5.2-.4 7.7-.8L128 416h384l72.3-192.8c2.5.4 5.1.8 7.7.8 26.5 0 48-21.5 48-48s-21.5-48-48-48z"},child:[]}]})(s)}function ea(s){return xe({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(s)}function H4(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M328 256c0 39.8-32.2 72-72 72s-72-32.2-72-72 32.2-72 72-72 72 32.2 72 72zm104-72c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm-352 0c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72z"},child:[]}]})(s)}function an(s){return xe({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(s)}function vT(s){return xe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 180V56c0-13.3 10.7-24 24-24h124c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H64v84c0 6.6-5.4 12-12 12H12c-6.6 0-12-5.4-12-12zM288 44v40c0 6.6 5.4 12 12 12h84v84c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12V56c0-13.3-10.7-24-24-24H300c-6.6 0-12 5.4-12 12zm148 276h-40c-6.6 0-12 5.4-12 12v84h-84c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h124c13.3 0 24-10.7 24-24V332c0-6.6-5.4-12-12-12zM160 468v-40c0-6.6-5.4-12-12-12H64v-84c0-6.6-5.4-12-12-12H12c-6.6 0-12 5.4-12 12v124c0 13.3 10.7 24 24 24h124c6.6 0 12-5.4 12-12z"},child:[]}]})(s)}function wT(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M432,320H400a16,16,0,0,0-16,16V448H64V128H208a16,16,0,0,0,16-16V80a16,16,0,0,0-16-16H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V336A16,16,0,0,0,432,320ZM488,0h-128c-21.37,0-32.05,25.91-17,41l35.73,35.73L135,320.37a24,24,0,0,0,0,34L157.67,377a24,24,0,0,0,34,0L435.28,133.32,471,169c15,15,41,4.5,41-17V24A24,24,0,0,0,488,0Z"},child:[]}]})(s)}function P0(s){return xe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M320 400c-75.85 0-137.25-58.71-142.9-133.11L72.2 185.82c-13.79 17.3-26.48 35.59-36.72 55.59a32.35 32.35 0 0 0 0 29.19C89.71 376.41 197.07 448 320 448c26.91 0 52.87-4 77.89-10.46L346 397.39a144.13 144.13 0 0 1-26 2.61zm313.82 58.1l-110.55-85.44a331.25 331.25 0 0 0 81.25-102.07 32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64a308.15 308.15 0 0 0-147.32 37.7L45.46 3.37A16 16 0 0 0 23 6.18L3.37 31.45A16 16 0 0 0 6.18 53.9l588.36 454.73a16 16 0 0 0 22.46-2.81l19.64-25.27a16 16 0 0 0-2.82-22.45zm-183.72-142l-39.3-30.38A94.75 94.75 0 0 0 416 256a94.76 94.76 0 0 0-121.31-92.21A47.65 47.65 0 0 1 304 192a46.64 46.64 0 0 1-1.54 10l-73.61-56.89A142.31 142.31 0 0 1 320 112a143.92 143.92 0 0 1 144 144c0 21.63-5.29 41.79-13.9 60.11z"},child:[]}]})(s)}function mh(s){return xe({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"},child:[]}]})(s)}function _T(s){return xe({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm64 236c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-64c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-72v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm96-114.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(s)}function NT(s){return xe({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-153 31V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm64 160v48c0 4.4-3.6 8-8 8h-56v56c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8v-56h-56c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h56v-56c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v56h56c4.4 0 8 3.6 8 8z"},child:[]}]})(s)}function ET(s){return xe({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm160-14.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(s)}function eu(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M349.565 98.783C295.978 98.783 251.721 64 184.348 64c-24.955 0-47.309 4.384-68.045 12.013a55.947 55.947 0 0 0 3.586-23.562C118.117 24.015 94.806 1.206 66.338.048 34.345-1.254 8 24.296 8 56c0 19.026 9.497 35.825 24 45.945V488c0 13.255 10.745 24 24 24h16c13.255 0 24-10.745 24-24v-94.4c28.311-12.064 63.582-22.122 114.435-22.122 53.588 0 97.844 34.783 165.217 34.783 48.169 0 86.667-16.294 122.505-40.858C506.84 359.452 512 349.571 512 339.045v-243.1c0-23.393-24.269-38.87-45.485-29.016-34.338 15.948-76.454 31.854-116.95 31.854z"},child:[]}]})(s)}function jT(s){return xe({attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z"},child:[]}]})(s)}function tu(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"},child:[]}]})(s)}function ST(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z"},child:[]}]})(s)}function TT(s){return xe({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(s)}function L0(s){return xe({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M528 32H48C21.5 32 0 53.5 0 80v16h576V80c0-26.5-21.5-48-48-48zM0 432c0 26.5 21.5 48 48 48h480c26.5 0 48-21.5 48-48V128H0v304zm352-232c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H360c-4.4 0-8-3.6-8-8v-16zm0 64c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H360c-4.4 0-8-3.6-8-8v-16zm0 64c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H360c-4.4 0-8-3.6-8-8v-16zM176 192c35.3 0 64 28.7 64 64s-28.7 64-64 64-64-28.7-64-64 28.7-64 64-64zM67.1 396.2C75.5 370.5 99.6 352 128 352h8.2c12.3 5.1 25.7 8 39.8 8s27.6-2.9 39.8-8h8.2c28.4 0 52.5 18.5 60.9 44.2 3.2 9.9-5.2 19.8-15.6 19.8H82.7c-10.4 0-18.8-10-15.6-19.8z"},child:[]}]})(s)}function G4(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48zM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56zM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48z"},child:[]}]})(s)}function Gg(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},child:[]}]})(s)}function gh(s){return xe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z"},child:[]}]})(s)}function AT(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M500.33 0h-47.41a12 12 0 0 0-12 12.57l4 82.76A247.42 247.42 0 0 0 256 8C119.34 8 7.9 119.53 8 256.19 8.1 393.07 119.1 504 256 504a247.1 247.1 0 0 0 166.18-63.91 12 12 0 0 0 .48-17.43l-34-34a12 12 0 0 0-16.38-.55A176 176 0 1 1 402.1 157.8l-101.53-4.87a12 12 0 0 0-12.57 12v47.41a12 12 0 0 0 12 12h200.33a12 12 0 0 0 12-12V12a12 12 0 0 0-12-12z"},child:[]}]})(s)}function $4(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M8.309 189.836L184.313 37.851C199.719 24.546 224 35.347 224 56.015v80.053c160.629 1.839 288 34.032 288 186.258 0 61.441-39.581 122.309-83.333 154.132-13.653 9.931-33.111-2.533-28.077-18.631 45.344-145.012-21.507-183.51-176.59-185.742V360c0 20.7-24.3 31.453-39.687 18.164l-176.004-152c-11.071-9.562-11.086-26.753 0-36.328z"},child:[]}]})(s)}function Vc(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(s)}function qh(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(s)}function ut(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"},child:[]}]})(s)}function CT(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M0 56v240c0 13.255 10.745 24 24 24h80c13.255 0 24-10.745 24-24V56c0-13.255-10.745-24-24-24H24C10.745 32 0 42.745 0 56zm40 200c0-13.255 10.745-24 24-24s24 10.745 24 24-10.745 24-24 24-24-10.745-24-24zm272 256c-20.183 0-29.485-39.293-33.931-57.795-5.206-21.666-10.589-44.07-25.393-58.902-32.469-32.524-49.503-73.967-89.117-113.111a11.98 11.98 0 0 1-3.558-8.521V59.901c0-6.541 5.243-11.878 11.783-11.998 15.831-.29 36.694-9.079 52.651-16.178C256.189 17.598 295.709.017 343.995 0h2.844c42.777 0 93.363.413 113.774 29.737 8.392 12.057 10.446 27.034 6.148 44.632 16.312 17.053 25.063 48.863 16.382 74.757 17.544 23.432 19.143 56.132 9.308 79.469l.11.11c11.893 11.949 19.523 31.259 19.439 49.197-.156 30.352-26.157 58.098-59.553 58.098H350.723C358.03 364.34 384 388.132 384 430.548 384 504 336 512 312 512z"},child:[]}]})(s)}function $g(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"},child:[]}]})(s)}function At(s){return xe({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(s)}function ta(s){return xe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(s)}function U0(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M496 128v16a8 8 0 0 1-8 8h-24v12c0 6.627-5.373 12-12 12H60c-6.627 0-12-5.373-12-12v-12H24a8 8 0 0 1-8-8v-16a8 8 0 0 1 4.941-7.392l232-88a7.996 7.996 0 0 1 6.118 0l232 88A8 8 0 0 1 496 128zm-24 304H40c-13.255 0-24 10.745-24 24v16a8 8 0 0 0 8 8h464a8 8 0 0 0 8-8v-16c0-13.255-10.745-24-24-24zM96 192v192H60c-6.627 0-12 5.373-12 12v20h416v-20c0-6.627-5.373-12-12-12h-36V192h-64v192h-64V192h-64v192h-64V192H96z"},child:[]}]})(s)}function RT(s){return xe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 256H152V152.9c0-39.6 31.7-72.5 71.3-72.9 40-.4 72.7 32.1 72.7 72v16c0 13.3 10.7 24 24 24h32c13.3 0 24-10.7 24-24v-16C376 68 307.5-.3 223.5 0 139.5.3 72 69.5 72 153.5V256H48c-26.5 0-48 21.5-48 48v160c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V304c0-26.5-21.5-48-48-48z"},child:[]}]})(s)}function ib(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M296 384h-80c-13.3 0-24-10.7-24-24V192h-87.7c-17.8 0-26.7-21.5-14.1-34.1L242.3 5.7c7.5-7.5 19.8-7.5 27.3 0l152.2 152.2c12.6 12.6 3.7 34.1-14.1 34.1H320v168c0 13.3-10.7 24-24 24zm216-8v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h136v8c0 30.9 25.1 56 56 56h80c30.9 0 56-25.1 56-56v-8h136c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(s)}function Hh(s){return xe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4zm323-128.4l-27.8-28.1c-4.6-4.7-12.1-4.7-16.8-.1l-104.8 104-45.5-45.8c-4.6-4.7-12.1-4.7-16.8-.1l-28.1 27.9c-4.7 4.6-4.7 12.1-.1 16.8l81.7 82.3c4.6 4.7 12.1 4.7 16.8.1l141.3-140.2c4.6-4.7 4.7-12.2.1-16.8z"},child:[]}]})(s)}function qd(s){return xe({attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6 0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7 0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4 0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9 14.3 0 28-2.7 40.9-6.9 2.3-.7 4.7-1.1 7.1-1.1 42.9 0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"},child:[]}]})(s)}function DT(s){return xe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h274.9c-2.4-6.8-3.4-14-2.6-21.3l6.8-60.9 1.2-11.1 7.9-7.9 77.3-77.3c-24.5-27.7-60-45.5-99.9-45.5zm45.3 145.3l-6.8 61c-1.1 10.2 7.5 18.8 17.6 17.6l60.9-6.8 137.9-137.9-71.7-71.7-137.9 137.8zM633 268.9L595.1 231c-9.3-9.3-24.5-9.3-33.8 0l-37.8 37.8-4.1 4.1 71.8 71.7 41.8-41.8c9.3-9.4 9.3-24.5 0-33.9z"},child:[]}]})(s)}function IT(s){return xe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M624 208H432c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h192c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm-400 48c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(s)}function Gh(s){return xe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M624 208h-64v-64c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v64h-64c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h64v64c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-64h64c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm-400 48c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(s)}function Qn(s){return xe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M622.3 271.1l-115.2-45c-4.1-1.6-12.6-3.7-22.2 0l-115.2 45c-10.7 4.2-17.7 14-17.7 24.9 0 111.6 68.7 188.8 132.9 213.9 9.6 3.7 18 1.6 22.2 0C558.4 489.9 640 420.5 640 296c0-10.9-7-20.7-17.7-24.9zM496 462.4V273.3l95.5 37.3c-5.6 87.1-60.9 135.4-95.5 151.8zM224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm96 40c0-2.5.8-4.8 1.1-7.2-2.5-.1-4.9-.8-7.5-.8h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c6.8 0 13.3-1.5 19.2-4-54-42.9-99.2-116.7-99.2-212z"},child:[]}]})(s)}function MT(s){return xe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M589.6 240l45.6-45.6c6.3-6.3 6.3-16.5 0-22.8l-22.8-22.8c-6.3-6.3-16.5-6.3-22.8 0L544 194.4l-45.6-45.6c-6.3-6.3-16.5-6.3-22.8 0l-22.8 22.8c-6.3 6.3-6.3 16.5 0 22.8l45.6 45.6-45.6 45.6c-6.3 6.3-6.3 16.5 0 22.8l22.8 22.8c6.3 6.3 16.5 6.3 22.8 0l45.6-45.6 45.6 45.6c6.3 6.3 16.5 6.3 22.8 0l22.8-22.8c6.3-6.3 6.3-16.5 0-22.8L589.6 240zM224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(s)}function yn(s){return xe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(s)}function Tt(s){return xe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(s)}function Q4(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M458.4 64.3C400.6 15.7 311.3 23 256 79.3 200.7 23 111.4 15.6 53.6 64.3-21.6 127.6-10.6 230.8 43 285.5l175.4 178.7c10 10.2 23.4 15.9 37.6 15.9 14.3 0 27.6-5.6 37.6-15.8L469 285.6c53.5-54.7 64.7-157.9-10.6-221.3zm-23.6 187.5L259.4 430.5c-2.4 2.4-4.4 2.4-6.8 0L77.2 251.8c-36.5-37.2-43.9-107.6 7.3-150.7 38.9-32.7 98.9-27.8 136.5 10.5l35 35.7 35-35.7c37.8-38.5 97.8-43.2 136.5-10.6 51.1 43.1 43.5 113.9 7.3 150.8z"},child:[]}]})(s)}function kT(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M466.27 225.31c4.674-22.647.864-44.538-8.99-62.99 2.958-23.868-4.021-48.565-17.34-66.99C438.986 39.423 404.117 0 327 0c-7 0-15 .01-22.22.01C201.195.01 168.997 40 128 40h-10.845c-5.64-4.975-13.042-8-21.155-8H32C14.327 32 0 46.327 0 64v240c0 17.673 14.327 32 32 32h64c11.842 0 22.175-6.438 27.708-16h7.052c19.146 16.953 46.013 60.653 68.76 83.4 13.667 13.667 10.153 108.6 71.76 108.6 57.58 0 95.27-31.936 95.27-104.73 0-18.41-3.93-33.73-8.85-46.54h36.48c48.602 0 85.82-41.565 85.82-85.58 0-19.15-4.96-34.99-13.73-49.84zM64 296c-13.255 0-24-10.745-24-24s10.745-24 24-24 24 10.745 24 24-10.745 24-24 24zm330.18 16.73H290.19c0 37.82 28.36 55.37 28.36 94.54 0 23.75 0 56.73-47.27 56.73-18.91-18.91-9.46-66.18-37.82-94.54C206.9 342.89 167.28 272 138.92 272H128V85.83c53.611 0 100.001-37.82 171.64-37.82h37.82c35.512 0 60.82 17.12 53.12 65.9 15.2 8.16 26.5 36.44 13.94 57.57 21.581 20.384 18.699 51.065 5.21 65.62 9.45 0 22.36 18.91 22.27 37.81-.09 18.91-16.71 37.82-37.82 37.82z"},child:[]}]})(s)}function VT(){return i.jsxs("div",{className:"max-w-2xl",children:[i.jsxs("div",{className:"text-center lg:text-left",children:[i.jsxs("h1",{className:"text-5xl lg:text-6xl font-bold text-gray-900 leading-tight",children:["Conecta,",i.jsx("span",{className:"block bg-gradient-to-r from-blue-600 to-purple-700 bg-clip-text text-transparent",children:"Colabora,"}),"Crece."]}),i.jsx("p",{className:"text-xl text-gray-600 mt-6 leading-relaxed",children:"nete a la comunidad mdica ms innovadora. Comparte conocimiento, resuelve casos clnicos y construye tu reputacin profesional."})]}),i.jsxs("div",{className:"mt-12 space-y-8",children:[i.jsxs("div",{className:"flex items-start space-x-4",children:[i.jsx("div",{className:"flex-shrink-0 w-14 h-14 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg",children:i.jsx(bT,{className:"w-7 h-7 text-white"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Foros Especializados"}),i.jsx("p",{className:"text-gray-600 mt-2",children:"Participa en comunidades mdicas especficas y comparte casos clnicos con colegas de tu especialidad."})]})]}),i.jsxs("div",{className:"flex items-start space-x-4",children:[i.jsx("div",{className:"flex-shrink-0 w-14 h-14 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:i.jsx(Qn,{className:"w-7 h-7 text-white"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Verificacin Profesional"}),i.jsx("p",{className:"text-gray-600 mt-2",children:"Ambiente seguro y confiable exclusivo para mdicos verificados con cdula profesional."})]})]}),i.jsxs("div",{className:"flex items-start space-x-4",children:[i.jsx("div",{className:"flex-shrink-0 w-14 h-14 bg-gradient-to-br from-cyan-500 to-blue-500 rounded-xl flex items-center justify-center shadow-lg",children:i.jsx(Fh,{className:"w-7 h-7 text-white"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Sistema de Reputacin"}),i.jsx("p",{className:"text-gray-600 mt-2",children:"Construye tu Aura profesional basado en contribuciones valiosas y experiencia compartida."})]})]}),i.jsxs("div",{className:"flex items-start space-x-4",children:[i.jsx("div",{className:"flex-shrink-0 w-14 h-14 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center shadow-lg",children:i.jsx(NT,{className:"w-7 h-7 text-white"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Casos Clnicos"}),i.jsx("p",{className:"text-gray-600 mt-2",children:"Discute diagnsticos complejos y comparte experiencias con profesionales de todo el mundo."})]})]})]})]})}function OT({email:s,onBackToLogin:e,onResendEmail:n,loading:a}){return i.jsx("div",{className:"bg-white p-8 rounded-2xl shadow-lg border border-gray-100",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Verifica tu email"}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 text-blue-700 px-4 py-3 rounded-lg mb-6",children:[i.jsx("p",{className:"font-medium",children:"Email de verificacin enviado"}),i.jsxs("p",{className:"mt-2 text-sm",children:["Hemos enviado un enlace de verificacin a ",i.jsx("strong",{children:s}),". Por favor revisa tu bandeja de entrada y haz clic en el enlace para activar tu cuenta. Despus de activar tu cuenta inicia sesin"]})]}),i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-700 px-4 py-3 rounded-lg mb-6 text-sm",children:[i.jsx("p",{children:i.jsx("strong",{children:" Importante:"})}),i.jsxs("ul",{className:"mt-2 space-y-1",children:[i.jsxs("li",{children:[" ",i.jsx("strong",{children:"Tienes 24 horas"})," para verificar tu cuenta"]}),i.jsx("li",{children:" Revisa tu carpeta de spam o correo no deseado"}),i.jsx("li",{children:" Si no verificas en 24 horas, tu cuenta se eliminar automticamente"}),i.jsx("li",{children:" Solo puedes solicitar un nuevo email cada 1 hora"})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("button",{onClick:n,disabled:a,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-all disabled:opacity-50",children:a?"Enviando...":"Reenviar email de verificacin"}),i.jsx("button",{onClick:e,className:"w-full border border-gray-300 text-gray-700 py-3 px-4 rounded-lg font-medium hover:bg-gray-50 transition-all",children:"Volver al inicio de sesin"})]})]})})}function PT({onSwitchToLogin:s}){const[e,n]=V.useState({email:"",password:"",confirmPassword:""}),[a,l]=V.useState(!1),[u,h]=V.useState(""),[p,g]=V.useState([]),[x,y]=V.useState(!1),[v,_]=V.useState(!1),[E,S]=V.useState(!1),[A,D]=V.useState(null),L=()=>{y(!x)},B=()=>{_(!v)},k=U=>{n({...e,[U.target.name]:U.target.value})},$=U=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(U),q=U=>U.length<8?"La contrasea debe tener al menos 8 caracteres":U.length>18?"La contrasea debe tener como mximo 18 caracteres":/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]+/.test(U)?"La contrasea no puede contener caracteres especiales":null,F=U=>{const M=[];return U.length<8&&M.push("Mnimo 8 caracteres"),U.length>18&&M.push("Mximo 18 caracteres"),/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]+/.test(U)&&M.push("Solo letras y nmeros"),g(M),M.length===0},R=async U=>{try{const M=Me(Y,"users"),ue=Dt(M,He("email","==",U),He("emailVerified","==",!1)),we=await gn(ue);if(!we.empty){const K=we.docs[0],ce=K.data(),ge=new Date,Ee=ce.emailVerificationSentAt?.toDate();if(Ee&&ge-Ee<3600*1e3)throw new Error("Ya se envi un email de verificacin recientemente. Revisa tu bandeja de entrada y espera al menos 1 hora.");await zh(se(Y,"users",K.id)),console.log("Usuario no verificado existente eliminado de Firestore")}}catch(M){throw M}},j=async U=>{if(U.preventDefault(),l(!0),h(""),!$(e.email)){h("Por favor ingresa un correo electrnico vlido."),l(!1);return}if(e.password!==e.confirmPassword){h("Las contraseas no coinciden."),l(!1);return}const M=q(e.password);if(M){h(M),l(!1);return}try{await R(e.email);const we=(await ON(Ne,e.email,e.password)).user;D(we),await $2(we);const K=new Date,ce=new Date(K.getTime()+1440*60*1e3);await Ec(se(Y,"users",we.uid),{id:we.uid,email:we.email,name:null,role:"unverified",profileMedia:null,professionalInfo:null,stats:{aura:0,contributionCount:0,postCount:0,commentCount:0,forumCount:0,joinedForumsCount:0,totalImagesUploaded:0,totalStorageUsed:0},suspension:{isSuspended:!1,reason:null,startDate:null,endDate:null,suspendedBy:null},joinedForums:[],joinDate:new Date,lastLogin:new Date,isActive:!0,isDeleted:!1,deletedAt:null,emailVerified:!1,emailVerificationSentAt:new Date,verificationExpiresAt:ce,verificationAttempts:1}),await Ne.signOut(),l(!1),S(!0)}catch(ue){console.error("Registration error:",ue),h(P(ue.code)),l(!1)}},C=async()=>{if(A){l(!0);try{await $2(A),h(""),await Ec(se(Y,"users",A.uid),{emailVerificationSentAt:new Date},{merge:!0})}catch{h("Error al reenviar el email. Intenta nuevamente.")}finally{l(!1)}}},O=async()=>{h("");try{const M=(await rv(Ne,L4)).user;await Ec(se(Y,"users",M.uid),{id:M.uid,email:M.email,name:null,role:"unverified",profileMedia:null,professionalInfo:null,stats:{aura:0,contributionCount:0,postCount:0,commentCount:0,forumCount:0,joinedForumsCount:0,totalImagesUploaded:0,totalStorageUsed:0},suspension:{isSuspended:!1,reason:null,startDate:null,endDate:null,suspendedBy:null},joinedForums:[],joinDate:new Date,lastLogin:new Date,isActive:!0,isDeleted:!1,deletedAt:null,emailVerified:!0,emailVerificationSentAt:new Date})}catch(U){console.error("Google registration error:",U),h(P(U.code)),l(!1)}},P=U=>{if(!U)return"Error al crear la cuenta. Intenta nuevamente.";switch(U){case"auth/email-already-in-use":return"Este correo electrnico ya est registrado. Si no verificaste tu cuenta anteriormente, espera unos minutos y intenta nuevamente.";case"auth/invalid-email":return"El correo electrnico no es vlido.";case"auth/operation-not-allowed":return"El registro con email/contrasea no est habilitado.";case"auth/weak-password":return"La contrasea es demasiado dbil.";case"auth/popup-closed-by-user":return"El registro con Google fue cancelado.";default:return typeof U=="string"&&U.includes("already-in-use")?"Este email ya est en uso. Si no verificaste tu cuenta, espera 1 hora e intenta nuevamente.":`Error al crear la cuenta: ${U}. Intenta nuevamente.`}};return E?i.jsx(OT,{email:e.email,onBackToLogin:s,onResendEmail:C,loading:a}):i.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-lg border border-gray-100",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900 text-center mb-6",children:"Crear Cuenta"}),u&&i.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4 text-sm",children:u}),i.jsxs("form",{onSubmit:j,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Correo Electrnico"}),i.jsx("input",{type:"email",id:"email",name:"email",value:e.email,onChange:k,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"tu@correo.com"})]}),i.jsxs("div",{className:"relative",children:[i.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Contrasea"}),i.jsx("input",{type:x?"text":"password",id:"password",name:"password",value:e.password,onChange:k,onBlur:()=>F(e.password),required:!0,minLength:8,maxLength:18,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Entre 8 y 18 caracteres"}),i.jsx("button",{type:"button",onClick:L,className:"absolute right-3 top-9 p-1 text-gray-500 hover:text-gray-700 transition duration-200",children:x?i.jsx(P0,{className:"w-5 h-5"}):i.jsx(mh,{className:"w-5 h-5"})})]}),p.length>0&&i.jsx("div",{className:"text-red-500 text-xs space-y-1 mt-1",children:p.map((U,M)=>i.jsxs("p",{children:[" ",U]},M))}),i.jsxs("div",{className:"relative",children:[i.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmar Contrasea"}),i.jsx("input",{type:v?"text":"password",id:"confirmPassword",name:"confirmPassword",value:e.confirmPassword,onChange:k,required:!0,minLength:8,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Repite tu contrasea"}),i.jsx("button",{type:"button",onClick:B,className:"absolute right-3 top-9 p-1 text-gray-500 hover:text-gray-700 transition duration-200",children:v?i.jsx(P0,{className:"w-5 h-5"}):i.jsx(mh,{className:"w-5 h-5"})})]}),i.jsx("button",{type:"submit",disabled:a,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Creando cuenta...":"Crear Cuenta"})]}),i.jsxs("div",{className:"mt-6",children:[i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-0 flex items-center",children:i.jsx("div",{className:"w-full border-t border-gray-300"})}),i.jsx("div",{className:"relative flex justify-center text-sm",children:i.jsx("span",{className:"px-2 bg-white text-gray-500",children:"O regstrate con"})})]}),i.jsx("button",{onClick:O,disabled:a,className:"w-full mt-4 bg-white border border-gray-300 text-gray-700 py-3 px-4 rounded-lg font-medium hover:bg-gray-50 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all disabled:opacity-50 flex items-center justify-center",children:"Google"})]}),i.jsx("div",{className:"mt-6 text-center",children:i.jsxs("div",{className:"text-sm text-gray-600",children:["Ya tienes cuenta?"," ",i.jsx("button",{onClick:s,className:"text-blue-600 hover:text-blue-700 font-medium",children:"Inicia sesin aqu"})]})}),i.jsx("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:i.jsxs("p",{className:"text-sm text-blue-700 text-center",children:[i.jsx("strong",{children:"Nota:"})," Las cuentas no verificadas se eliminan automticamente despus de 24 horas."]})})]})}function LT({onSwitchToRegister:s,onSwitchToForgotPassword:e}){const[n,a]=V.useState({email:"",password:""}),[l,u]=V.useState(!1),[h,p]=V.useState(""),[g,x]=V.useState(!1),y=D=>{a({...n,[D.target.name]:D.target.value})},v=()=>{x(!g)},_=async D=>{try{const L=await ve(se(Y,"users",D.uid));if(L.exists()){const B=L.data(),k=new Date,$=B.verificationExpiresAt?.toDate();if($&&k>$&&!B.emailVerified)return await zh(se(Y,"users",D.uid)),await J0(D),!0}}catch(L){console.error("Error cleaning up expired user:",L)}return!1},E=async D=>{D.preventDefault(),u(!0),p("");try{const B=(await PN(Ne,n.email,n.password)).user;if(!B.emailVerified){if(await _(B)){await Ne.signOut(),p(" El enlace de verificacin ha expirado. Por favor regstrate nuevamente."),u(!1);return}await Ne.signOut(),p(" Por favor verifica tu email antes de iniciar sesin. Revisa tu bandeja de entrada y carpeta de spam. Si no recibiste el email, puedes registrarte nuevamente despus de 1 hora."),u(!1);return}await tt(se(Y,"users",B.uid),{lastLogin:new Date,emailVerified:!0})}catch(L){p(A(L.code)),u(!1)}},S=async()=>{u(!0),p("");try{const L=(await rv(Ne,L4)).user;(await ve(se(Y,"users",L.uid))).exists()?(await tt(se(Y,"users",L.uid),{lastLogin:new Date,emailVerified:!0}),console.log("Usuario existente de Google actualizado")):(await Ec(se(Y,"users",L.uid),{id:L.uid,email:L.email,name:null,role:"unverified",profileMedia:null,professionalInfo:null,stats:{aura:0,contributionCount:0,postCount:0,commentCount:0,forumCount:0,joinedForumsCount:0,totalImagesUploaded:0,totalStorageUsed:0},suspension:{isSuspended:!1,reason:null,startDate:null,endDate:null,suspendedBy:null},joinedForums:[],joinDate:new Date,lastLogin:new Date,isActive:!0,isDeleted:!1,deletedAt:null,emailVerified:!0,emailVerificationSentAt:new Date}),console.log("Nuevo usuario de Google creado en Firestore"))}catch(D){console.error("Error en login con Google:",D),p(A(D.code)),u(!1)}finally{u(!1)}},A=D=>{if(!D)return"Error al iniciar sesin. Intenta nuevamente.";switch(D){case"auth/invalid-email":return"El correo electrnico es invalido";case"auth/invalid-credential":return"El correo electrnico o contrasea no es valido.";case"auth/user-disabled":return"Esta cuenta ha sido deshabilitada.";case"auth/user-not-found":return"No existe una cuenta con este correo electrnico. Regstrate primero.";case"auth/wrong-password":return"La contrasea es incorrecta.";case"auth/too-many-requests":return"Demasiados intentos fallidos. Intenta ms tarde.";case"auth/popup-closed-by-user":return"El inicio de sesin con Google fue cancelado.";case"auth/network-request-failed":return"Error de conexin. Verifica tu internet.";case"auth/invalid-login-credentials":case"auth/invalid-credential":return"Correo o contrasea incorrectos. Verifica tus datos.";default:return`Error al iniciar sesin: ${D}. Intenta nuevamente.`}};return i.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-lg border border-gray-100",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900 text-center mb-6",children:"Iniciar Sesin"}),h&&i.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4 text-sm",children:h}),i.jsxs("form",{onSubmit:E,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Correo Electrnico"}),i.jsx("input",{type:"email",id:"email",name:"email",value:n.email,onChange:y,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"tu@correo.com"})]}),i.jsxs("div",{className:"relative",children:[i.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Contrasea"}),i.jsx("input",{type:g?"text":"password",id:"password",name:"password",value:n.password,onChange:y,required:!0,className:"w-full px-4 py-3 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:""}),i.jsx("button",{type:"button",onClick:v,className:"absolute right-3 top-9 p-1 text-gray-500 hover:text-gray-700 transition duration-200",children:g?i.jsx(P0,{className:"w-5 h-5"}):i.jsx(mh,{className:"w-5 h-5"})})]}),i.jsx("button",{type:"submit",disabled:l,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Iniciando sesin...":"Iniciar Sesin"})]}),i.jsxs("div",{className:"mt-6",children:[i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-0 flex items-center",children:i.jsx("div",{className:"w-full border-t border-gray-300"})}),i.jsx("div",{className:"relative flex justify-center text-sm",children:i.jsx("span",{className:"px-2 bg-white text-gray-500",children:"O contina con"})})]}),i.jsx("button",{onClick:S,disabled:l,className:"w-full mt-4 bg-white border border-gray-300 text-gray-700 py-3 px-4 rounded-lg font-medium hover:bg-gray-50 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all disabled:opacity-50 flex items-center justify-center",children:l?"Iniciando sesin...":"Iniciar con Google"})]}),i.jsxs("div",{className:"mt-6 text-center space-y-3",children:[i.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Olvidaste tu contrasea?"}),i.jsxs("div",{className:"text-sm text-gray-600",children:["No tienes cuenta?"," ",i.jsx("button",{onClick:s,className:"text-blue-600 hover:text-blue-700 font-medium",children:"Regstrate aqu"})]})]})]})}function UT({onSwitchToLogin:s}){const[e,n]=V.useState(""),[a,l]=V.useState(!1),[u,h]=V.useState(""),[p,g]=V.useState(""),x=async v=>{v.preventDefault(),l(!0),g(""),h("");try{await VN(Ne,e),h("Se ha enviado un enlace para restablecer tu contrasea a tu correo electrnico.")}catch(_){g(y(_.code))}finally{l(!1)}},y=v=>{switch(v){case"auth/user-not-found":return"No existe una cuenta con este correo electrnico.";case"auth/invalid-email":return"El correo electrnico no es vlido.";case"auth/too-many-requests":return"Demasiados intentos. Intenta ms tarde.";default:return"Error al enviar el correo de recuperacin. Intenta nuevamente."}};return i.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-lg border border-gray-100",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900 text-center mb-6",children:"Recuperar Contrasea"}),p&&i.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4 text-sm",children:p}),u&&i.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-4 text-sm",children:u}),i.jsxs("form",{onSubmit:x,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Correo Electrnico"}),i.jsx("input",{type:"email",id:"email",value:e,onChange:v=>n(v.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"tu@correo.com"})]}),i.jsx("button",{type:"submit",disabled:a,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Enviando...":"Enviar enlace de recuperacin"})]}),i.jsx("div",{className:"mt-6 text-center",children:i.jsx("button",{onClick:s,className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:" Volver al inicio de sesin"})})]})}const Y4="/TheHeartCloud2.0/assets/logoprincipal-jha9_fkW.png";function zT(){const[s,e]=V.useState("login"),n=()=>{switch(s){case"register":return i.jsx(PT,{onSwitchToLogin:()=>e("login")});case"forgot-password":return i.jsx(UT,{onSwitchToLogin:()=>e("login")});default:return i.jsx(LT,{onSwitchToRegister:()=>e("register"),onSwitchToForgotPassword:()=>e("forgot-password")})}};return i.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex flex-col lg:flex-row",children:[i.jsx("div",{className:"lg:w-1/2 p-8 lg:p-12 flex items-center justify-center",children:i.jsx(VT,{})}),i.jsx("div",{className:"lg:w-1/2 bg-white",children:i.jsx("div",{className:"min-h-screen flex items-center justify-center p-8",children:i.jsxs("div",{className:"w-full max-w-md",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:"w-50 h-50 flex items-center justify-center",children:i.jsx("img",{src:Y4,alt:"TheHeartCloud Logo",className:"w-28 h-28 object-contain rounded-xl"})})}),i.jsx("h1",{className:"text-4xl font-bold text-blue-700 mb-2",children:"TheHeartCloud"}),i.jsx("p",{className:"text-gray-600 text-lg",children:"Comunidad mdica especializada"})]}),n()]})})})]})}function K4(){return i.jsxs("div",{className:"flex items-center flex-shrink-0",children:[i.jsx("img",{src:Y4,alt:"TheHeartCloudLogo",className:"w-8 h-8 md:w-10 md:h-10 lg:w-12 lg:h-12 mr-2 lg:mr-3"}),i.jsx("h1",{className:"text-lg md:text-xl lg:text-2xl font-bold text-blue-600 whitespace-nowrap",children:"TheHeartCloud"})]})}function BT({onSearch:s}){const[e,n]=V.useState(""),a=l=>{l.preventDefault(),e.trim()&&s(e.trim(),"forums")};return i.jsx("div",{className:"hidden lg:flex flex-1 max-w-lg mx-4",children:i.jsxs("form",{onSubmit:a,className:"flex w-full",children:[i.jsx("input",{type:"text",value:e,onChange:l=>n(l.target.value),placeholder:"Buscar comunidades y usuarios...",className:"flex-1 px-4 py-2 rounded-l-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-r-lg hover:bg-blue-700 transition duration-200 flex items-center justify-center min-w-[45px]",children:i.jsx(Vc,{className:"w-4 h-4"})})]})})}const Br=()=>{const s=new Date;return s.setDate(s.getDate()+30),s},jn={smartCleanup:async s=>{try{console.log(` Limpieza inteligente para: ${s}`);const e=await jn.getAllUserNotifications(s);if(e.length===0)return{success:!0,expiredDeleted:0,oldDeleted:0};const n=new Date,a=e.filter(p=>{const g=p.expiresAt?.toDate();return g&&g<=n});let l=0;a.length>0&&(l=await jn.deleteNotificationsByIds(a.map(p=>p.id)));const u=e.length-l;let h=0;if(u>80){const g=e.filter(x=>!a.find(y=>y.id===x.id)).sort((x,y)=>y.createdAt?.seconds-x.createdAt?.seconds).slice(80);h=await jn.deleteNotificationsByIds(g.map(x=>x.id))}return console.log(` Resultado limpieza: ${l} expiradas, ${h} antiguas`),{success:!0,expiredDeleted:l,oldDeleted:h}}catch(e){return console.error(" Error en limpieza inteligente:",e),{success:!1,error:e.message}}},getAllUserNotifications:async s=>{try{const e=Me(Y,"notifications"),n=Dt(e,He("userId","==",s)),a=await gn(n),l=[];return a.forEach(u=>{l.push({id:u.id,...u.data()})}),l}catch(e){return console.error(" Error obteniendo notificaciones:",e),[]}},deleteNotificationsByIds:async s=>{if(s.length===0)return 0;try{const e=$n(Y);let n=0;return s.forEach(a=>{const l=doc(Y,"notifications",a);e.delete(l),n++}),await e.commit(),n}catch(e){return console.error(" Error eliminando por IDs:",e),0}},sendVerificationApproved:async(s,e,n)=>{try{await jn.smartCleanup(s),await _n(Me(Y,"notifications"),{userId:s,type:"verification_approved",title:"Verificacin Aprobada! ",message:`Felicidades ${e}, tu cuenta mdica ha sido verificada y ahora puedes publicar y comentar.`,isRead:!1,isActionable:!1,actionData:{triggeredByUsername:n},createdAt:new Date,expiresAt:Br()}),console.log(` Verificacin aprobada enviada por: ${n}`)}catch(a){console.error("Error en notificacin de aprobacin:",a)}},sendVerificationRejected:async(s,e,n,a)=>{try{await jn.smartCleanup(s),await _n(Me(Y,"notifications"),{userId:s,type:"verification_rejected",title:"Solicitud Rechazada ",message:`Tu solicitud de verificacin fue rechazada. Razn: ${n}`,isRead:!1,isActionable:!0,actionData:{triggeredByUsername:a,actionRequired:"resubmit_verification"},createdAt:new Date,expiresAt:Br()}),console.log(` Verificacin rechazada enviada por: ${a}`)}catch(l){console.error("Error en notificacin de rechazo:",l)}},sendSanctionNotification:async(s,e,n,a)=>{try{await jn.smartCleanup(s);const l=e==="Permanente"?"Suspensin Permanente ":`Suspensin Temporal - ${e} `,u=e==="Permanente"?`Tu cuenta ha sido suspendida permanentemente. Razn: ${n}`:`Tu cuenta ha sido suspendida por ${e}. Razn: ${n}`;await _n(Me(Y,"notifications"),{userId:s,type:"user_suspended",title:l,message:u,isRead:!1,isActionable:!1,actionData:{triggeredByUsername:a},createdAt:new Date,expiresAt:Br()}),console.log(`Sancin enviada por: ${a}`)}catch(l){console.error("Error en notificacin de sancin:",l)}},sendPostApproved:async(s,e,n)=>{try{await _n(Me(Y,"notifications"),{userId:s,type:"post_approved",title:"Publicacin Aprobada",message:`Tu publicacin en "${n}" ha sido aprobada y ahora es visible para todos.`,isRead:!1,isActionable:!1,actionData:{forumId:e,forumName:n},createdAt:new Date,expiresAt:Br()}),console.log(`Notificacin de post aprobado enviada a: ${s}`)}catch(a){console.error("Error en notificacin de post aprobado:",a)}},sendPostRejected:async(s,e,n,a)=>{try{await _n(Me(Y,"notifications"),{userId:s,type:"post_rejected",title:"Publicacin Rechazada",message:`Tu publicacin en "${n}" fue rechazada. Motivo: ${a}`,isRead:!1,isActionable:!0,actionData:{forumId:e,forumName:n,reason:a,actionRequired:"edit_and_resubmit"},createdAt:new Date,expiresAt:Br()}),console.log(`Notificacin de post rechazado enviada a: ${s}`)}catch(l){console.error("Error en notificacin de post rechazado:",l)}},sendModeratorAssigned:async(s,e)=>{try{await _n(Me(Y,"notifications"),{userId:s,type:"moderator_assigned",title:"Eres ahora moderador",message:`Has sido asignado como moderador en la comunidad "${e}". Ahora puedes gestionar publicaciones y miembros.`,isRead:!1,isActionable:!1,actionData:{forumName:e},createdAt:new Date,expiresAt:Br()}),console.log(`Notificacin de moderador asignado enviada a: ${s}`)}catch(n){console.error("Error en notificacin de moderador:",n)}},sendCommunityBan:async(s,e,n,a)=>{try{await _n(Me(Y,"notifications"),{userId:s,type:"community_ban",title:"Baneado de comunidad",message:`Has sido baneado de "${e}". Motivo: ${n} - Duracin: ${a}`,isRead:!1,isActionable:!1,actionData:{forumName:e,reason:n,duration:a},createdAt:new Date,expiresAt:Br()}),console.log(`Notificacin de ban de comunidad enviada a: ${s}`)}catch(l){console.error("Error en notificacin de ban:",l)}},sendMembershipApproved:async(s,e)=>{try{await _n(Me(Y,"notifications"),{userId:s,type:"membership_approved",title:"Solicitud aprobada",message:`Tu solicitud para unirte a "${e}" ha sido aprobada. Bienvenido!`,isRead:!1,isActionable:!1,actionData:{forumName:e},createdAt:new Date,expiresAt:Br()}),console.log(`Notificacin de membresa aprobada enviada a: ${s}`)}catch(n){console.error("Error en notificacin de membresa:",n)}},sendOwnershipTransferred:async(s,e)=>{try{await _n(Me(Y,"notifications"),{userId:s,type:"ownership_transferred",title:" Eres ahora dueo",message:`Has sido asignado como dueo de la comunidad "${e}". Ahora tienes control total.`,isRead:!1,isActionable:!1,actionData:{forumName:e},createdAt:new Date,expiresAt:Br()}),console.log(` Notificacin de transferencia enviada a: ${s}`)}catch(n){console.error("Error en notificacin de transferencia:",n)}}},FT=()=>{const[s,e]=V.useState([]),[n,a]=V.useState(0),[l,u]=V.useState(!0),[h,p]=V.useState(null);return V.useEffect(()=>{const y=Ne.currentUser;if(!y){u(!1);return}const v=async()=>{try{console.log(" Iniciando sistema de notificaciones..."),await jn.smartCleanup(y.uid)}catch(S){console.warn(" Limpieza inicial fall:",S)}finally{_(y.uid)}},_=S=>{try{const A=Dt(Me(Y,"notifications"),He("userId","==",S));return zs(A,L=>{const B=[];let k=0;L.forEach(q=>{const F={id:q.id,...q.data()};E(F)&&(B.push(F),F.isRead||k++)}),B.sort((q,F)=>{const R=q.createdAt?.seconds||0;return(F.createdAt?.seconds||0)-R});const $=B.slice(0,80);e($),a(k),u(!1),p(null)},L=>{console.error(" Error en listener:",L),p("Error al cargar notificaciones"),u(!1)})}catch(A){return console.error(" Error configurando query:",A),p("Error en configuracin"),u(!1),()=>{}}},E=S=>{if(!["verification_approved","verification_rejected","user_suspended"].includes(S.type))return!1;const D=S.expiresAt?.toDate();return!(D&&D<new Date)};v()},[]),{notifications:s,unreadCount:n,loading:l,error:h,markAsRead:async y=>{try{await tt(se(Y,"notifications",y),{isRead:!0,readAt:new Date}),e(v=>v.map(_=>_.id===y?{..._,isRead:!0}:_)),a(v=>Math.max(0,v-1))}catch(v){throw console.error(" Error marcando como leda:",v),v}},markAllAsRead:async()=>{try{const y=s.filter(_=>!_.isRead);if(y.length===0)return;const v=y.map(_=>tt(se(Y,"notifications",_.id),{isRead:!0,readAt:new Date}));await Promise.all(v),e(_=>_.map(E=>({...E,isRead:!0}))),a(0)}catch(y){throw console.error(" Error marcando todas como ledas:",y),y}}}};function qT({unreadCount:s,onClick:e,isOpen:n}){return i.jsxs("button",{onClick:e,className:"relative p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-full transition duration-200",children:[i.jsx(gT,{className:"w-6 h-6"}),s>0&&i.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium",children:s>9?"9+":s})]})}function HT({notification:s,onMarkAsRead:e}){return i.jsx("div",{className:`p-4 border-l-4 border-l-green-500 bg-white rounded-r-lg hover:bg-gray-50 transition duration-200 ${s.isRead?"":"bg-blue-50"}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:i.jsx(Hh,{className:"w-5 h-5 text-green-600"})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("h4",{className:"font-semibold text-gray-900",children:s.title}),!s.isRead&&i.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"})]}),i.jsx("p",{className:"text-gray-600 text-sm mb-2",children:s.message}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.createdAt?.seconds*1e3).toLocaleDateString()}),!s.isRead&&i.jsx("button",{onClick:()=>e(s.id),className:"text-green-600 hover:text-green-700 text-sm font-medium",children:"Marcar leda"})]})]})]})})}function GT({notification:s,onMarkAsRead:e}){const n=s.isActionable&&s.actionData?.actionRequired==="resubmit_verification";return i.jsx("div",{className:`p-4 border-l-4 border-l-red-500 bg-white rounded-r-lg hover:bg-gray-50 transition duration-200 ${s.isRead?"":"bg-blue-50"}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:i.jsx(an,{className:"w-5 h-5 text-red-600"})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("h4",{className:"font-semibold text-gray-900",children:s.title}),!s.isRead&&i.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"})]}),i.jsx("p",{className:"text-gray-600 text-sm mb-2",children:s.message}),n&&i.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-2 mt-2",children:i.jsx("p",{className:"text-amber-700 text-xs font-medium",children:" Puedes volver a enviar tu documentacin"})}),i.jsxs("div",{className:"flex items-center justify-between mt-2",children:[i.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.createdAt?.seconds*1e3).toLocaleDateString()}),!s.isRead&&i.jsx("button",{onClick:()=>e(s.id),className:"text-red-600 hover:text-red-700 text-sm font-medium",children:"Marcar leda"})]})]})]})})}function $T({notification:s,onMarkAsRead:e}){return i.jsx("div",{className:`p-4 border-l-4 border-l-red-600 bg-white rounded-r-lg hover:bg-gray-50 transition duration-200 ${s.isRead?"":"bg-blue-50"}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:i.jsx(mr,{className:"w-5 h-5 text-red-600"})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("h4",{className:"font-semibold text-gray-900",children:s.title}),!s.isRead&&i.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"})]}),i.jsx("p",{className:"text-gray-600 text-sm mb-2",children:s.message}),s.actionData?.triggeredByUsername&&i.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:["Moderador: ",s.actionData.triggeredByUsername]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.createdAt?.seconds*1e3).toLocaleDateString()}),!s.isRead&&i.jsx("button",{onClick:()=>e(s.id),className:"text-red-600 hover:text-red-700 text-sm font-medium",children:"Marcar leda"})]})]})]})})}function QT({notification:s,onMarkAsRead:e}){return i.jsx("div",{className:`p-4 border-l-4 border-l-green-500 bg-white rounded-r-lg hover:bg-gray-50 transition duration-200 ${s.isRead?"":"bg-blue-50"}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:i.jsx(Wr,{className:"w-5 h-5 text-green-600"})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("h4",{className:"font-semibold text-gray-900",children:s.title}),!s.isRead&&i.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"})]}),i.jsx("p",{className:"text-gray-600 text-sm mb-2",children:s.message}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.createdAt?.seconds*1e3).toLocaleDateString()}),!s.isRead&&i.jsx("button",{onClick:()=>e(s.id),className:"text-green-600 hover:text-green-700 text-sm font-medium",children:"Marcar leda"})]})]})]})})}function YT({notification:s,onMarkAsRead:e}){const n=s.isActionable&&s.actionData?.actionRequired==="edit_and_resubmit";return i.jsx("div",{className:`p-4 border-l-4 border-l-red-500 bg-white rounded-r-lg hover:bg-gray-50 transition duration-200 ${s.isRead?"":"bg-blue-50"}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:i.jsx($g,{className:"w-5 h-5 text-red-600"})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("h4",{className:"font-semibold text-gray-900",children:s.title}),!s.isRead&&i.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"})]}),i.jsx("p",{className:"text-gray-600 text-sm mb-2",children:s.message}),n&&i.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-2 mt-2",children:i.jsx("p",{className:"text-amber-700 text-xs font-medium",children:" Puedes editar y volver a enviar tu publicacin"})}),i.jsxs("div",{className:"flex items-center justify-between mt-2",children:[i.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.createdAt?.seconds*1e3).toLocaleDateString()}),!s.isRead&&i.jsx("button",{onClick:()=>e(s.id),className:"text-red-600 hover:text-red-700 text-sm font-medium",children:"Marcar leda"})]})]})]})})}function KT({notification:s,onMarkAsRead:e}){return i.jsx("div",{className:`p-4 border-l-4 border-l-blue-500 bg-white rounded-r-lg hover:bg-gray-50 transition duration-200 ${s.isRead?"":"bg-blue-50"}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:i.jsx(Qn,{className:"w-5 h-5 text-blue-600"})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("h4",{className:"font-semibold text-gray-900",children:s.title}),!s.isRead&&i.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"})]}),i.jsx("p",{className:"text-gray-600 text-sm mb-2",children:s.message}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.createdAt?.seconds*1e3).toLocaleDateString()}),!s.isRead&&i.jsx("button",{onClick:()=>e(s.id),className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Marcar leda"})]})]})]})})}function XT({notification:s,onMarkAsRead:e}){return i.jsx("div",{className:`p-4 border-l-4 border-l-red-600 bg-white rounded-r-lg hover:bg-gray-50 transition duration-200 ${s.isRead?"":"bg-blue-50"}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:i.jsx(mr,{className:"w-5 h-5 text-red-600"})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("h4",{className:"font-semibold text-gray-900",children:s.title}),!s.isRead&&i.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"})]}),i.jsx("p",{className:"text-gray-600 text-sm mb-2",children:s.message}),s.actionData?.reason&&i.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:[i.jsx("strong",{children:"Motivo:"})," ",s.actionData.reason]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.createdAt?.seconds*1e3).toLocaleDateString()}),!s.isRead&&i.jsx("button",{onClick:()=>e(s.id),className:"text-red-600 hover:text-red-700 text-sm font-medium",children:"Marcar leda"})]})]})]})})}function ZT({notification:s,onMarkAsRead:e}){return i.jsx("div",{className:`p-4 border-l-4 border-l-green-500 bg-white rounded-r-lg hover:bg-gray-50 transition duration-200 ${s.isRead?"":"bg-blue-50"}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:i.jsx(Hh,{className:"w-5 h-5 text-green-600"})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("h4",{className:"font-semibold text-gray-900",children:s.title}),!s.isRead&&i.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"})]}),i.jsx("p",{className:"text-gray-600 text-sm mb-2",children:s.message}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.createdAt?.seconds*1e3).toLocaleDateString()}),!s.isRead&&i.jsx("button",{onClick:()=>e(s.id),className:"text-green-600 hover:text-green-700 text-sm font-medium",children:"Marcar leda"})]})]})]})})}function JT({notification:s,onMarkAsRead:e}){return i.jsx("div",{className:`p-4 border-l-4 border-l-yellow-500 bg-white rounded-r-lg hover:bg-gray-50 transition duration-200 ${s.isRead?"":"bg-blue-50"}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center",children:i.jsx(Wc,{className:"w-5 h-5 text-yellow-600"})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("h4",{className:"font-semibold text-gray-900",children:s.title}),!s.isRead&&i.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"})]}),i.jsx("p",{className:"text-gray-600 text-sm mb-2",children:s.message}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.createdAt?.seconds*1e3).toLocaleDateString()}),!s.isRead&&i.jsx("button",{onClick:()=>e(s.id),className:"text-yellow-600 hover:text-yellow-700 text-sm font-medium",children:"Marcar leda"})]})]})]})})}function WT({notification:s,onMarkAsRead:e}){return(()=>{switch(s.type){case"verification_approved":return i.jsx(HT,{notification:s,onMarkAsRead:e});case"verification_rejected":return i.jsx(GT,{notification:s,onMarkAsRead:e});case"user_suspended":return i.jsx($T,{notification:s,onMarkAsRead:e});case"post_approved":return i.jsx(QT,{notification:s,onMarkAsRead:e});case"post_rejected":return i.jsx(YT,{notification:s,onMarkAsRead:e});case"moderator_assigned":return i.jsx(KT,{notification:s,onMarkAsRead:e});case"community_ban":return i.jsx(XT,{notification:s,onMarkAsRead:e});case"membership_approved":return i.jsx(ZT,{notification:s,onMarkAsRead:e});case"ownership_transferred":return i.jsx(JT,{notification:s,onMarkAsRead:e});default:return i.jsx("div",{className:"p-4 bg-white rounded-lg border border-gray-200",children:i.jsxs("p",{className:"text-gray-600",children:["Tipo de notificacin no reconocido: ",s.type]})})}})()}function e8({notifications:s,onMarkAsRead:e,onMarkAllAsRead:n,loading:a,hasMore:l,loadMore:u}){const[h,p]=V.useState("all"),g=V.useRef(),x=V.useCallback(_=>{a||(g.current&&g.current.disconnect(),g.current=new IntersectionObserver(E=>{E[0].isIntersecting&&l&&u()}),_&&g.current.observe(_))},[a,l,u]),y=s.filter(_=>h==="unread"?!_.isRead:!0),v=s.filter(_=>!_.isRead).length;return a&&s.length===0?i.jsx("div",{className:"w-96 max-h-96 bg-white rounded-xl shadow-lg border border-gray-200",children:i.jsx("div",{className:"animate-pulse space-y-4 p-4",children:[1,2,3].map(_=>i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),i.jsxs("div",{className:"flex-1 space-y-2",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]},_))})}):i.jsxs("div",{className:"w-96 max-h-96 bg-white rounded-xl shadow-lg border border-gray-200",children:[i.jsxs("div",{className:"p-4 border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:"Notificaciones"}),v>0&&i.jsxs("button",{onClick:n,className:"flex items-center gap-1 px-3 py-1 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition duration-200",children:[i.jsx(xT,{className:"w-4 h-4"}),"Marcar todas"]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:()=>p("all"),className:`px-3 py-1 text-sm rounded-lg transition duration-200 ${h==="all"?"bg-blue-100 text-blue-700":"text-gray-600 hover:text-gray-900"}`,children:["Todas (",s.length,")"]}),i.jsxs("button",{onClick:()=>p("unread"),className:`px-3 py-1 text-sm rounded-lg transition duration-200 ${h==="unread"?"bg-blue-100 text-blue-700":"text-gray-600 hover:text-gray-900"}`,children:["No ledas (",v,")"]})]})]}),i.jsx("div",{className:"overflow-y-auto max-h-80",children:y.length===0?i.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500",children:[i.jsx(mT,{className:"w-12 h-12 mb-3 text-gray-300"}),i.jsx("p",{className:"text-sm font-medium",children:h==="unread"?"No hay notificaciones no ledas":"No hay notificaciones"})]}):i.jsxs("div",{className:"divide-y divide-gray-100",children:[y.map((_,E)=>i.jsx("div",{className:"hover:bg-gray-50 transition duration-200",ref:E===y.length-1?x:null,children:i.jsx(WT,{notification:_,onMarkAsRead:e})},_.id)),l&&i.jsx("div",{className:"flex justify-center py-4",children:i.jsx(ut,{className:"w-5 h-5 text-blue-500 animate-spin"})})]})})]})}function ob(){const[s,e]=V.useState(!1),n=V.useRef(null),{notifications:a,unreadCount:l,loading:u,markAsRead:h,markAllAsRead:p}=FT();V.useEffect(()=>{const v=_=>{n.current&&!n.current.contains(_.target)&&e(!1)};return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]);const g=()=>{e(!s)},x=v=>{h(v)},y=()=>{p()};return i.jsxs("div",{className:"relative",ref:n,children:[i.jsx(qT,{unreadCount:l,onClick:g,isOpen:s}),s&&i.jsx("div",{className:"absolute right-0 top-12 z-50",children:i.jsx(e8,{notifications:a,onMarkAsRead:x,onMarkAllAsRead:y,loading:u})})]})}function X4({onClick:s}){return i.jsxs("button",{onClick:s,className:"flex items-center gap-3 w-full text-left bg-amber-50 hover:bg-amber-100 border border-amber-200 rounded-lg p-3 transition duration-200 group",children:[i.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-amber-500 rounded-full flex items-center justify-center",children:i.jsx(Hh,{className:"w-5 h-5 text-white"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-semibold text-amber-800 text-sm",children:"Verificar Cuenta"}),i.jsx("p",{className:"text-amber-600 text-xs",children:"Completa tu perfil mdico"})]}),i.jsx(an,{className:"w-4 h-4 text-amber-500 group-hover:scale-110 transition-transform"})]})}function Z4({cancelDelete:s,deleteLoading:e,deleteAccount:n}){return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:i.jsxs("div",{className:"bg-white rounded-2xl p-6 max-w-md w-full mx-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:i.jsx(an,{className:"w-6 h-6 text-red-600"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Eliminar Cuenta"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Esta accin no se puede deshacer"})]})]}),i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[i.jsxs("p",{className:"text-sm text-red-700",children:[i.jsx("strong",{children:"Advertencia:"})," Al eliminar tu cuenta:"]}),i.jsxs("ul",{className:"text-sm text-red-600 mt-2 space-y-1",children:[i.jsx("li",{children:" Se perdern todos tus datos permanentemente"}),i.jsx("li",{children:" Tus publicaciones,comentarios y comunidades se mantendrn"}),i.jsx("li",{children:" No podrs recuperar tu cuenta"})]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:s,disabled:e,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition duration-200 disabled:opacity-50",children:"Cancelar"}),i.jsx("button",{onClick:n,disabled:e,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition duration-200 disabled:opacity-50 flex items-center justify-center gap-2",children:e?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Eliminando..."]}):"Eliminar Cuenta"})]})]})})}function t8({onProfileClick:s,onVerifyAccount:e}){const[n,a]=V.useState(null),[l,u]=V.useState(null),[h,p]=V.useState(!0),[g,x]=V.useState(!1),[y,v]=V.useState(!1),[_,E]=V.useState(!1),[S,A]=V.useState(!1);V.useEffect(()=>Bc(Ne,C=>{if(a(C),p(!1),C){const O=zs(se(Y,"users",C.uid),P=>{P.exists()&&u(P.data())});return()=>O()}else u(null)}),[]);const D=async()=>{v(!0);try{await Qb(Ne)}catch(j){console.error("Error al cerrar sesin:",j),v(!1)}},L=async()=>{if(n){E(!0);try{await zh(se(Y,"users",n.uid)),await J0(n)}catch(j){j.code==="auth/requires-recent-login"?alert("Para eliminar tu cuenta, necesitas haber iniciado sesin recientemente. Por favor, cierra sesin y vuelve a iniciar sesin, luego intenta eliminar tu cuenta nuevamente."):alert("Error al eliminar la cuenta: "+j.message),E(!1)}}},B=()=>{A(!0),x(!1)},k=()=>{A(!1)},$=l?.role==="unverified";if(h)return i.jsxs("div",{className:"hidden lg:flex items-center gap-4",children:[i.jsx(ob,{}),i.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full animate-pulse"})]});const q=n?.email?n.email[0].toUpperCase():"U",F=n?.displayName||n?.email||"Usuario",R=l?.photoURL;return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"hidden lg:flex items-center gap-4",children:[i.jsx(ob,{}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{onClick:()=>x(!g),className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 transition duration-200",children:[R?i.jsx("img",{src:R,alt:"Foto de perfil",className:"w-8 h-8 rounded-full object-cover border-2 border-blue-100"}):i.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:i.jsx("span",{className:"text-white text-sm font-semibold",children:q})}),i.jsxs("div",{className:"text-left",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:F}),i.jsx("p",{className:"text-xs text-gray-500",children:l?.role==="unverified"?"Sin verificar":l?.role==="doctor"?"Mdico":l?.role==="moderator"?"Moderador":l?.role==="admin"?"Admin":l?.role||"Usuario"})]}),i.jsx(O0,{className:`w-4 h-4 text-gray-500 transition-transform ${g?"rotate-180":""}`})]}),g&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>x(!1)}),i.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-xl shadow-lg border border-gray-200 py-2 z-50",children:[$&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"px-4 py-2",children:i.jsx(X4,{onClick:()=>{e&&e(),x(!1)}})}),i.jsx("div",{className:"border-t border-gray-200 my-1"})]}),!$&&i.jsxs("button",{onClick:()=>{s&&s(),x(!1)},className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 hover:bg-gray-50 transition duration-200",children:[i.jsx(yn,{className:"w-4 h-4 text-gray-400"}),i.jsx("span",{className:"font-medium",children:"Mi Perfil"})]}),i.jsx("div",{className:"border-t border-gray-200 my-1"}),i.jsxs("button",{onClick:D,disabled:y,className:"w-full flex items-center gap-3 px-4 py-3 text-left text-red-600 hover:bg-red-50 transition duration-200 disabled:opacity-50",children:[i.jsx(qh,{className:"w-4 h-4 text-red-500"}),i.jsx("span",{className:"font-medium",children:y?"Cerrando sesin...":"Cerrar Sesin"})]}),i.jsx("div",{className:"border-t border-gray-200 my-1"}),i.jsxs("button",{onClick:B,className:"w-full flex items-center gap-3 px-4 py-3 text-left text-red-600 hover:bg-red-50 transition duration-200",children:[i.jsx(ta,{className:"w-4 h-4 text-red-500"}),i.jsx("span",{className:"font-medium",children:"Eliminar Cuenta"})]})]})]})]})]}),S&&i.jsx(Z4,{cancelDelete:k,deleteLoading:_,deleteAccount:L})]})}function J4(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M346.5 240H272v-74.5c0-8.8-7.2-16-16-16s-16 7.2-16 16V240h-74.5c-8.8 0-16 6-16 16s7.5 16 16 16H240v74.5c0 9.5 7 16 16 16s16-7.2 16-16V272h74.5c8.8 0 16-7.2 16-16s-7.2-16-16-16z"},child:[]},{tag:"path",attr:{d:"M256 76c48.1 0 93.3 18.7 127.3 52.7S436 207.9 436 256s-18.7 93.3-52.7 127.3S304.1 436 256 436c-48.1 0-93.3-18.7-127.3-52.7S76 304.1 76 256s18.7-93.3 52.7-127.3S207.9 76 256 76m0-28C141.1 48 48 141.1 48 256s93.1 208 208 208 208-93.1 208-208S370.9 48 256 48z"},child:[]}]})(s)}function n8(s){return xe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M64 384h384v-42.666H64V384zm0-106.666h384v-42.667H64v42.667zM64 128v42.665h384V128H64z"},child:[]}]})(s)}function s8({onSearch:s}){const[e,n]=V.useState(!1),[a,l]=V.useState(""),u=p=>{p.preventDefault(),a.trim()&&(s(a.trim(),"temas"),n(!1),l(""))},h=()=>{n(!1),l("")};return i.jsxs("div",{className:"lg:hidden",children:[i.jsx("button",{onClick:()=>n(!e),className:"p-2 rounded-lg hover:bg-gray-100 transition duration-200","aria-label":"Buscar",children:e?i.jsx(At,{className:"w-5 h-5 text-gray-600"}):i.jsx(Vc,{className:"w-5 h-5 text-gray-600"})}),e&&i.jsxs("div",{className:"absolute top-full left-0 right-0 bg-white border-t border-gray-200 shadow-lg p-4 z-40 animate-slideDown",children:[i.jsxs("form",{onSubmit:u,className:"flex w-full max-w-2xl mx-auto",children:[i.jsx("input",{type:"text",value:a,onChange:p=>l(p.target.value),placeholder:"Qu ests buscando?",className:"flex-1 px-4 py-3 border border-gray-300 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",autoFocus:!0}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-3 rounded-r-lg hover:bg-blue-700 transition duration-200 flex items-center justify-center min-w-[50px]",children:i.jsx(Vc,{className:"w-4 h-4"})})]}),i.jsx("div",{className:"text-center mt-2",children:i.jsx("button",{onClick:h,className:"text-sm text-gray-500 hover:text-gray-700 transition duration-200",children:"Cerrar bsqueda"})})]})]})}function r8({onShowMenu:s,onSearch:e}){return i.jsxs("div",{className:"flex lg:hidden items-center gap-2",children:[i.jsx(s8,{onSearch:e}),i.jsx("button",{className:"text-gray-600 hover:text-blue-600 p-2 rounded-lg hover:bg-gray-100 transition duration-200",onClick:s,children:i.jsx(n8,{className:"w-6 h-6"})})]})}function a8({isOpen:s,onClose:e,onProfileClick:n,onVerifyAccount:a}){const[l,u]=V.useState(null),[h,p]=V.useState(null),[g,x]=V.useState(!0),[y,v]=V.useState(!1),[_,E]=V.useState(!1),[S,A]=V.useState(!1);V.useEffect(()=>Bc(Ne,U=>{if(u(U),x(!1),U){const M=zs(se(Y,"users",U.uid),ue=>{ue.exists()&&p(ue.data())});return()=>M()}else p(null)}),[]);const D=async()=>{if(l){E(!0);try{await zh(se(Y,"users",l.uid)),await J0(l)}catch(P){P.code==="auth/requires-recent-login"?alert("Para eliminar tu cuenta, necesitas haber iniciado sesin recientemente. Por favor, cierra sesin y vuelve a iniciar sesin, luego intenta eliminar tu cuenta nuevamente."):alert("Error al eliminar la cuenta: "+P.message),E(!1)}}},L=()=>{A(!0)},B=()=>{A(!1)},k=async()=>{v(!0);try{await Qb(Ne),e()}catch(P){console.error("Error al cerrar sesin:",P),v(!1)}},$=()=>{n(),e()},q=()=>{a&&a(),e()},F=h?.role==="unverified",R=l?.email?l.email[0].toUpperCase():"U",j=l?.displayName||l?.email||"Usuario",C=h?.role==="unverified"?"Sin verificar":h?.role==="doctor"?"Mdico":h?.role==="moderator"?"Moderador":h?.role==="admin"?"Admin":h?.role||"Usuario",O=h?.photoURL;return s?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:e}),i.jsx("div",{className:"absolute right-0 top-0 h-full w-80 bg-white shadow-xl",children:i.jsxs("div",{className:"p-4 h-full flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6 border-b pb-4",children:[i.jsx("h2",{className:"text-xl font-bold text-blue-600",children:"Men"}),i.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 p-2",children:i.jsx(At,{className:"w-6 h-6"})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto",children:i.jsxs("div",{className:"space-y-6",children:[g?i.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full animate-pulse"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 animate-pulse"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-16 animate-pulse"})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"h-10 bg-gray-200 rounded animate-pulse"}),i.jsx("div",{className:"h-10 bg-gray-200 rounded animate-pulse"})]})]}):i.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[O?i.jsx("img",{src:O,alt:"Foto de perfil",className:"w-12 h-12 rounded-full object-cover border-2 border-blue-100"}):i.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:i.jsx("span",{className:"text-white font-semibold",children:R})}),i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-blue-800",children:j}),i.jsx("p",{className:"text-blue-600 text-sm",children:C})]})]}),F&&i.jsx("div",{className:"mb-4",children:i.jsx(X4,{onClick:q})}),i.jsxs("div",{className:"space-y-2",children:[!F&&i.jsxs("button",{onClick:$,className:"flex items-center gap-3 w-full text-left hover:bg-blue-100 rounded-lg p-2 transition duration-200 text-blue-700",children:[i.jsx(yn,{className:"w-4 h-4"}),i.jsx("span",{className:"font-medium",children:"Mi Perfil"})]}),i.jsxs("button",{onClick:k,disabled:y,className:"flex items-center gap-3 w-full text-left hover:bg-red-50 rounded-lg p-2 transition duration-200 text-red-600 disabled:opacity-50",children:[i.jsx(qh,{className:"w-4 h-4"}),i.jsx("span",{className:"font-medium",children:y?"Cerrando sesin...":"Cerrar Sesin"})]}),i.jsxs("button",{onClick:L,className:"flex items-center gap-3 w-full text-left hover:bg-red-50 rounded-lg p-2 transition duration-200 text-red-600",children:[i.jsx(ta,{className:"w-4 h-4 text-red-500"}),i.jsx("span",{className:"font-medium",children:"Eliminar Cuenta"})]})]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[i.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"TheHeartCloud"}),i.jsx("p",{className:"text-gray-600 text-sm",children:"Plataforma mdica para profesionales de la salud."})]})]})}),i.jsx("div",{className:"border-t border-gray-200 pt-4",children:i.jsx("p",{className:"text-xs text-gray-500 text-center",children:"TheHeartCloud v1.0"})})]})})]}),S&&i.jsx(Z4,{cancelDelete:B,deleteLoading:_,deleteAccount:D})]}):null}const i8=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),o8=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,a)=>a?a.toUpperCase():n.toLowerCase()),lb=s=>{const e=o8(s);return e.charAt(0).toUpperCase()+e.slice(1)},W4=(...s)=>s.filter((e,n,a)=>!!e&&e.trim()!==""&&a.indexOf(e)===n).join(" ").trim(),l8=s=>{for(const e in s)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var c8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const u8=V.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:a,className:l="",children:u,iconNode:h,...p},g)=>V.createElement("svg",{ref:g,...c8,width:e,height:e,stroke:s,strokeWidth:a?Number(n)*24/Number(e):n,className:W4("lucide",l),...!u&&!l8(p)&&{"aria-hidden":"true"},...p},[...h.map(([x,y])=>V.createElement(x,y)),...Array.isArray(u)?u:[u]]));const d8=(s,e)=>{const n=V.forwardRef(({className:a,...l},u)=>V.createElement(u8,{ref:u,iconNode:e,className:W4(`lucide-${i8(lb(s))}`,`lucide-${s}`,a),...l}));return n.displayName=lb(s),n};const h8=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],f8=d8("menu",h8);function m8({onToggleSidebar:s,onProfileClick:e,onSearch:n,onVerifyAccount:a}){const[l,u]=V.useState(!1),h=()=>{a&&a()};return i.jsxs("header",{className:"bg-white shadow-sm sticky top-0 z-30",children:[i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex items-center justify-between py-3 md:py-4",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:s,className:"p-2 rounded-lg hover:bg-gray-100 transition duration-200 lg:hidden","aria-label":"Abrir men de navegacin",children:i.jsx(f8,{className:"w-6 h-6 text-gray-600"})}),i.jsx(K4,{})]}),i.jsx(BT,{onSearch:n}),i.jsx(t8,{onProfileClick:e,onVerifyAccount:h}),i.jsx("div",{className:"flex items-center gap-2 lg:hidden",children:i.jsx(r8,{onShowMenu:()=>u(!0),onSearch:n})})]})}),i.jsx(a8,{isOpen:l,onClose:()=>u(!1),onProfileClick:e,onVerifyAccount:h})]})}const ew=()=>{const[s,e]=V.useState([]),[n,a]=V.useState(!0),[l,u]=V.useState(null);return V.useEffect(()=>{const h=Dt(Me(Y,"forums"),He("isDeleted","==",!1),He("status","==","active"),el("memberCount","desc"),tl(10)),p=zs(h,g=>{try{const x=[];g.forEach(y=>{const v=y.data();x.push({id:y.id,...v,memberCount:v.memberCount||0,createdAt:v.createdAt?.toDate?.()||new Date})}),e(x),a(!1)}catch(x){console.error("Error cargando comunidades:",x),u("Error cargando comunidades"),a(!1)}},g=>{console.error("Error en conexin:",g),u("Error de conexin con la base de datos"),a(!1)});return()=>p()},[]),{forums:s,loading:n,error:l}},tw=()=>{const[s,e]=V.useState([]),[n,a]=V.useState(!0),[l,u]=V.useState(null);return V.useEffect(()=>{const h=Ne.currentUser;if(!h){e([]),a(!1);return}const p=Dt(Me(Y,"forums"),He("isDeleted","==",!1),He("status","==","active"));return zs(p,x=>{try{const y=[];x.forEach(v=>{const _={id:v.id,...v.data(),memberCount:v.data().memberCount||0,postCount:v.data().postCount||0};if(_.members&&_.members.includes(h.uid)){let E="member";_.ownerId===h.uid?E="owner":_.moderators&&_.moderators[h.uid]&&(E="moderator"),y.push({..._,userRole:E})}}),e(y),a(!1)}catch(y){console.error("Error cargando comunidades del usuario:",y),u("Error cargando tus comunidades"),a(!1)}},x=>{console.error("Error en conexin:",x),u("Error en conexin con base de datos"),a(!1)})},[]),{userForums:s,loading:n,error:l}},Qg=()=>{const s=Ne.currentUser,e=async(E,S)=>{try{const A=se(Y,"forums",E),D=await ve(A);if(!D.exists())return!1;const B=D.data().bannedUsers||[],k=B.find($=>$.userId===S&&$.isActive!==!1);if(!k)return!1;if(k.duration!=="permanent"){const $=k.bannedAt?.toDate?.()||new Date(k.bannedAt),F=Math.floor((new Date-$)/(1e3*60*60*24));let R=0;switch(k.duration){case"1d":R=1;break;case"7d":R=7;break;case"30d":R=30;break;default:R=0}if(F>=R)return await tt(A,{bannedUsers:B.filter(j=>j.userId!==S)}),!1}return!0}catch(A){return console.error("Error verificando baneo:",A),!1}},n=async(E,S,A=null)=>{try{const D=se(Y,"users",E),L={};switch(S){case"forum_created":L["stats.forumCount"]=ke(1),L["stats.joinedForumsCount"]=ke(1),A&&(L.joinedForums=Gr(A));break;case"forum_joined":L["stats.joinedForumsCount"]=ke(1),A&&(L.joinedForums=Gr(A));break;case"forum_left":L["stats.joinedForumsCount"]=ke(-1),A&&(L.joinedForums=lr(A));break}Object.keys(L).length>0&&(await tt(D,L),console.log(` Estadsticas actualizadas: ${S}`,L))}catch(D){throw console.error(" Error actualizando estadsticas:",D),D}};return{createForum:async E=>{try{if(!s)throw new Error("Debes iniciar sesin para crear una comunidad");const S=se(Me(Y,"forums")),A=S.id,D={id:A,name:E.name,description:E.description,rules:E.rules||` Respeto hacia todos los miembros
 Contenido mdico verificado
 No spam ni autopromocin
 Confidencialidad de pacientes
 Lenguaje profesional`,ownerId:s.uid,createdAt:bt(),membershipSettings:{requiresApproval:E.requiresApproval||!1},members:[s.uid],memberCount:1,pendingMembers:{},bannedUsers:[],status:"active",disabledAt:null,disabledBy:null,disabledReason:null,moderators:{[s.uid]:{addedAt:bt(),addedBy:s.uid}},postCount:0,lastPostAt:null,isDeleted:!1,deletedAt:null};return await Ec(S,D),await n(s.uid,"forum_created",A),{success:!0,forumId:A,forum:D}}catch(S){return console.error("Error creando comunidad:",S),{success:!1,error:S.message}}},joinForum:async E=>{try{if(!s)throw new Error("Debes iniciar sesin para unirte a una comunidad");if(await e(E,s.uid))throw new Error("No puedes unirte a esta comunidad porque has sido baneado");const A=se(Y,"forums",E),D=await ve(A);if(!D.exists())throw new Error("Comunidad no encontrada");const L=D.data();if(L.members&&L.members.includes(s.uid))throw new Error("Ya eres miembro de esta comunidad");if(L.pendingMembers&&L.pendingMembers[s.uid])throw new Error("Ya tienes una solicitud pendiente");const k=(await ve(se(Y,"users",s.uid))).data();return L.membershipSettings?.requiresApproval?(await tt(A,{[`pendingMembers.${s.uid}`]:{requestedAt:bt(),userEmail:k?.email||"Email no disponible",userName:k?.name?`${k.name.name||""} ${k.name.apellidopat||""} ${k.name.apellidomat||""}`.trim():"Usuario",userRole:k?.role||"unverified"}}),{success:!0,requiresApproval:!0,message:"Solicitud enviada. Espera la aprobacin de un moderador."}):(await tt(A,{members:Gr(s.uid),memberCount:ke(1)}),await n(s.uid,"forum_joined",E),{success:!0,requiresApproval:!1})}catch(S){return console.error("Error unindose a comunidad:",S),{success:!1,error:S.message}}},leaveForum:async E=>{try{if(!s)throw new Error("Debes iniciar sesin");const S=se(Y,"forums",E),A=await ve(S);if(!A.exists())throw new Error("Comunidad no encontrada");const D=A.data();if(!D.members||!D.members.includes(s.uid))throw new Error("No eres miembro de esta comunidad");if(D.ownerId===s.uid)throw new Error("El dueo no puede abandonar la comunidad");return await tt(S,{members:lr(s.uid),memberCount:ke(-1)}),await n(s.uid,"forum_left",E),{success:!0}}catch(S){return console.error("Error abandonando comunidad:",S),{success:!1,error:S.message}}},addModerator:async(E,S)=>{try{if(!s)throw new Error("Debes iniciar sesin");const A=se(Y,"forums",E),D=await ve(A);if(!D.exists())throw new Error("Comunidad no encontrada");const L=D.data();if(L.ownerId!==s.uid)throw new Error("Solo el dueo puede agregar moderadores");if(!L.members||!L.members.includes(S))throw new Error("El usuario debe ser miembro de la comunidad");return await tt(A,{[`moderators.${S}`]:{addedAt:bt(),addedBy:s.uid}}),{success:!0}}catch(A){return console.error("Error agregando moderador:",A),{success:!1,error:A.message}}},removeModerator:async(E,S)=>{try{if(!s)throw new Error("Debes iniciar sesin");const A=se(Y,"forums",E),D=await ve(A);if(!D.exists())throw new Error("Comunidad no encontrada");if(D.data().ownerId!==s.uid)throw new Error("Solo el dueo puede remover moderadores");return await tt(A,{[`moderators.${S}`]:Hn()}),{success:!0}}catch(A){return console.error("Error removiendo moderador:",A),{success:!1,error:A.message}}},checkUserMembership:async E=>{try{if(!s)return{isMember:!1,role:null};const S=se(Y,"forums",E),A=await ve(S);if(!A.exists())return{isMember:!1,role:null};const D=A.data(),L=D.members?.includes(s.uid)||!1;let B="member";return D.ownerId===s.uid?B="owner":D.moderators&&D.moderators[s.uid]&&(B="moderator"),{isMember:L,role:B}}catch(S){return console.error("Error verificando membresa:",S),{isMember:!1,role:null}}},getForumData:async E=>{try{const S=se(Y,"forums",E),A=await ve(S);if(!A.exists())throw new Error("Comunidad no encontrada");const D=A.data();return{success:!0,data:{id:A.id,...D,memberCount:D.memberCount||0,postCount:D.postCount||0,bannedUsers:D.bannedUsers||[],rules:D.rules||` Respeto hacia todos los miembros
 Contenido mdico verificado
 No spam ni autopromocin
 Confidencialidad de pacientes
 Lenguaje profesional`}}}catch(S){return console.error("Error obteniendo datos de comunidad:",S),{success:!1,error:S.message}}},approveMember:async(E,S)=>{try{if(!s)throw new Error("Debes iniciar sesin");const A=se(Y,"forums",E),D=await ve(A);if(!D.exists())throw new Error("Comunidad no encontrada");const L=D.data(),B=L.ownerId===s.uid,k=L.moderators&&L.moderators[s.uid];if(!B&&!k)throw new Error("Solo dueos y moderadores pueden aprobar miembros");if(await e(E,S))throw new Error("No puedes aprobar este usuario porque est baneado de la comunidad");if(!L.pendingMembers||!L.pendingMembers[S])throw new Error("No hay solicitud pendiente para este usuario");const q=$n(Y);return q.update(A,{members:Gr(S),memberCount:ke(1)}),q.update(A,{[`pendingMembers.${S}`]:Hn()}),await q.commit(),await n(S,"forum_joined",E),{success:!0}}catch(A){return console.error("Error aprobando miembro:",A),{success:!1,error:A.message}}},rejectMember:async(E,S)=>{try{if(!s)throw new Error("Debes iniciar sesin");const A=se(Y,"forums",E),D=await ve(A);if(!D.exists())throw new Error("Comunidad no encontrada");const L=D.data(),B=L.ownerId===s.uid,k=L.moderators&&L.moderators[s.uid];if(!B&&!k)throw new Error("Solo dueos y moderadores pueden rechazar miembros");return await tt(A,{[`pendingMembers.${S}`]:Hn()}),{success:!0}}catch(A){return console.error("Error rechazando miembro:",A),{success:!1,error:A.message}}},updateMembershipSettings:async(E,S)=>{try{if(!s)throw new Error("Debes iniciar sesin");const A=se(Y,"forums",E),D=await ve(A);if(!D.exists())throw new Error("Comunidad no encontrada");if(D.data().ownerId!==s.uid)throw new Error("Solo el dueo puede cambiar la configuracin de membresa");return await tt(A,{"membershipSettings.requiresApproval":S}),{success:!0}}catch(A){return console.error("Error actualizando configuracin:",A),{success:!1,error:A.message}}},isUserBannedFromForum:e}};function nw({isOpen:s,onClose:e,onForumCreated:n}){const[a,l]=V.useState({name:"",description:"",rules:` Respeto hacia todos los miembros
 Contenido mdico verificado
 No spam ni autopromocin
 Confidencialidad de pacientes
 Lenguaje profesional`,requiresApproval:!1}),[u,h]=V.useState(!1),[p,g]=V.useState(""),{createForum:x}=Qg(),y=_=>{const{name:E,value:S,type:A,checked:D}=_.target;l(L=>({...L,[E]:A==="checkbox"?D:S})),g("")},v=async _=>{if(_.preventDefault(),!a.name.trim()||!a.description.trim()){g("El nombre y descripcin son obligatorios");return}if(a.name.length<3){g("El nombre debe tener al menos 3 caracteres");return}if(a.description.length<10){g("La descripcin debe tener al menos 10 caracteres");return}h(!0),g("");try{const E=await x(a);E.success?(n&&n(E.forum),e(),l({name:"",description:"",rules:` Respeto hacia todos los miembros
 Contenido mdico verificado
 No spam ni autopromocin
 Confidencialidad de pacientes
 Lenguaje profesional`,requiresApproval:!1})):g(E.error)}catch(E){console.error("Error creando comunidad:",E),g("Error al crear la comunidad. Intenta nuevamente.")}finally{h(!1)}};return s?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden",onClick:_=>_.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Crear Nueva Comunidad"}),i.jsx("button",{onClick:e,disabled:u,className:"p-2 hover:bg-gray-100 rounded-lg transition duration-200 disabled:opacity-50",children:i.jsx(At,{className:"w-5 h-5 text-gray-500"})})]}),i.jsxs("form",{onSubmit:v,className:"flex flex-col h-[calc(90vh-80px)]",children:[i.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[p&&i.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:i.jsx("p",{className:"text-red-700 text-sm",children:p})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre de la Comunidad *"}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name,onChange:y,disabled:u,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 disabled:opacity-50",placeholder:"Ej: Cardiologa Avanzada, Diabetes Tipo 1...",maxLength:50,required:!0}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[a.name.length,"/50 caracteres"]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Descripcin *"}),i.jsx("textarea",{id:"description",name:"description",value:a.description,onChange:y,disabled:u,rows:4,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 resize-none disabled:opacity-50",placeholder:"Describe el propsito, enfoque y temas que se discutirn en esta comunidad...",maxLength:500,required:!0}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[a.description.length,"/500 caracteres"]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Configuracin de Membresa"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("label",{className:`flex items-start p-4 border rounded-lg cursor-pointer transition duration-200 ${a.requiresApproval?"border-gray-300 hover:bg-gray-50":"border-blue-500 bg-blue-50 ring-2 ring-blue-500 ring-opacity-50"}`,children:[i.jsx("div",{className:"flex items-center h-5 mt-0.5",children:i.jsx("input",{type:"radio",name:"requiresApproval",checked:!a.requiresApproval,onChange:()=>l(_=>({..._,requiresApproval:!1})),disabled:u,className:"text-blue-600 focus:ring-blue-500"})}),i.jsxs("div",{className:"ml-3 flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx(RT,{className:"w-4 h-4 text-green-600"}),i.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Entrada Libre"})]}),i.jsx("p",{className:"text-xs text-gray-600",children:"Los usuarios pueden unirse directamente sin necesidad de aprobacin."})]})]}),i.jsxs("label",{className:`flex items-start p-4 border rounded-lg cursor-pointer transition duration-200 ${a.requiresApproval?"border-blue-500 bg-blue-50 ring-2 ring-blue-500 ring-opacity-50":"border-gray-300 hover:bg-gray-50"}`,children:[i.jsx("div",{className:"flex items-center h-5 mt-0.5",children:i.jsx("input",{type:"radio",name:"requiresApproval",checked:a.requiresApproval,onChange:()=>l(_=>({..._,requiresApproval:!0})),disabled:u,className:"text-blue-600 focus:ring-blue-500"})}),i.jsxs("div",{className:"ml-3 flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx(gh,{className:"w-4 h-4 text-orange-600"}),i.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Requiere Aprobacin"})]}),i.jsx("p",{className:"text-xs text-gray-600",children:"Los usuarios solicitan unirse y necesitan aprobacin de un moderador."})]})]})]}),i.jsx("p",{className:"text-xs text-gray-500 mt-2",children:a.requiresApproval?"Los usuarios enviarn solicitudes que debers aprobar manualmente.":"Cualquier usuario verificado podr unirse automticamente."})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{htmlFor:"rules",className:"block text-sm font-medium text-gray-700 mb-2",children:"Reglas de la Comunidad"}),i.jsx("textarea",{id:"rules",name:"rules",value:a.rules,onChange:y,disabled:u,rows:6,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 resize-none disabled:opacity-50",placeholder:"Establece las reglas bsicas para los miembros de tu comunidad...",maxLength:1e3}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[a.rules.length,"/1000 caracteres. Las reglas ayudan a mantener un ambiente profesional."]})]}),i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(Gg,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Informacin importante"}),i.jsxs("ul",{className:"text-xs text-blue-700 space-y-1",children:[i.jsx("li",{children:" Sers el dueo y primer moderador de la comunidad"}),i.jsx("li",{children:" Puedes agregar ms moderadores despus"}),i.jsx("li",{children:" Eres responsable del contenido en tu comunidad"}),i.jsx("li",{children:" Las comunidades deben seguir las normas de TheHeartCloud"}),i.jsxs("li",{children:[" ",a.requiresApproval?"Aprobars manualmente las solicitudes de membresa":"Los usuarios podrn unirse libremente"]})]})]})]})})]}),i.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Tu comunidad ser pblica y visible para todos los usuarios."}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{type:"button",onClick:e,disabled:u,className:"px-6 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition duration-200 font-medium disabled:opacity-50",children:"Cancelar"}),i.jsx("button",{type:"submit",disabled:u,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition duration-200 font-medium flex items-center gap-2 disabled:opacity-50",children:u?i.jsxs(i.Fragment,{children:[i.jsx(ut,{className:"w-4 h-4 animate-spin"}),"Creando..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Tt,{className:"w-4 h-4"}),"Crear Comunidad"]})})]})]})})]})]})}):null}function g8({onInicioClick:s,onThemeClick:e,userData:n,onVerificationClick:a}){const[l,u]=V.useState(!0),[h,p]=V.useState(!1),[g,x]=V.useState(!1),{forums:y,loading:v}=ew(),{userForums:_,loading:E}=tw(),S=n?.role||"unverified",A=S==="doctor"||S==="moderator"||S==="admin",D=S==="doctor"||S==="moderator"||S==="admin",L=S==="admin",B=()=>{x(!0)},k=q=>{e&&e({id:q.id,name:q.name,description:q.description,createdAt:q.createdAt,memberCount:q.memberCount||0,ownerId:q.ownerId})},$=q=>{switch(q){case"owner":return i.jsx(Wc,{className:"w-3 h-3 text-yellow-500"});case"moderator":return i.jsx(Qn,{className:"w-3 h-3 text-blue-500"});default:return i.jsx(yn,{className:"w-3 h-3 text-gray-500"})}};return i.jsxs(i.Fragment,{children:[i.jsx("aside",{className:"hidden lg:block w-64 bg-white shadow-lg h-[calc(100vh-80px)] sticky top-20 overflow-y-auto",children:i.jsxs("nav",{className:"p-4",children:[i.jsx("button",{onClick:s,className:"flex items-center gap-3 p-3 rounded-lg hover:bg-blue-50 text-gray-700 hover:text-blue-600 transition duration-200 mb-2 w-full text-left",children:i.jsx("span",{className:"font-medium",children:"Inicio"})}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("button",{onClick:()=>u(!l),className:"flex items-center justify-between w-full p-3 rounded-lg hover:bg-blue-50 text-gray-700 hover:text-blue-600 transition duration-200",children:[i.jsx("span",{className:"font-medium",children:"Comunidades Relevantes"}),l?i.jsx(hh,{className:"w-4 h-4"}):i.jsx(fh,{className:"w-4 h-4"})]}),l&&i.jsx("div",{className:"mt-2 ml-4 space-y-1 max-h-64 overflow-y-auto",children:v?i.jsx("div",{className:"space-y-2",children:[...Array(5)].map((q,F)=>i.jsxs("div",{className:"animate-pulse flex items-center gap-3 p-2",children:[i.jsx("div",{className:"w-4 h-4 bg-gray-200 rounded-full"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded flex-1"})]},F))}):y.length===0?i.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:[i.jsx("p",{className:"text-sm text-gray-500 text-center",children:"No hay comunidades creadas an"}),A&&i.jsx("p",{className:"text-xs text-gray-400 text-center mt-1",children:"S el primero en crear una comunidad"})]}):y.map(q=>i.jsxs("button",{onClick:()=>k(q),className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 text-gray-600 hover:text-gray-900 transition duration-200 group w-full text-left",title:q.description,children:[i.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[i.jsx(Tt,{className:"w-3 h-3 text-green-500"}),i.jsx("span",{className:"text-sm flex-1 truncate",children:q.name})]}),i.jsx("div",{className:"opacity-70 group-hover:opacity-100 transition-opacity",children:i.jsx("span",{className:"text-xs text-gray-500",children:q.memberCount||0})})]},q.id))})]}),A&&i.jsx("div",{className:"mb-4",children:i.jsxs("button",{onClick:B,className:"flex items-center gap-3 p-3 rounded-lg hover:bg-green-50 text-gray-700 hover:text-green-600 transition duration-200 w-full text-left",children:[i.jsx(J4,{className:"w-5 h-5"}),i.jsx("span",{className:"font-medium",children:"Crear Comunidad"})]})}),D&&i.jsxs("div",{className:"mb-4",children:[i.jsxs("button",{onClick:()=>p(!h),className:"flex items-center justify-between w-full p-3 rounded-lg hover:bg-purple-50 text-gray-700 hover:text-purple-600 transition duration-200",children:[i.jsx("span",{className:"font-medium",children:"Mis Comunidades"}),h?i.jsx(hh,{className:"w-4 h-4"}):i.jsx(fh,{className:"w-4 h-4"})]}),h&&i.jsx("div",{className:"mt-2 ml-4 space-y-1 max-h-64 overflow-y-auto",children:E?i.jsx("div",{className:"space-y-2",children:[...Array(3)].map((q,F)=>i.jsxs("div",{className:"animate-pulse flex items-center gap-3 p-2",children:[i.jsx("div",{className:"w-4 h-4 bg-gray-200 rounded-full"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded flex-1"})]},F))}):_.length===0?i.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:[i.jsx("p",{className:"text-sm text-gray-500 text-center",children:"No ests unido a ninguna comunidad"}),i.jsx("p",{className:"text-xs text-gray-400 text-center mt-1",children:"nete a comunidades para verlas aqu"})]}):_.map(q=>i.jsxs("button",{onClick:()=>k(q),className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 text-gray-600 hover:text-gray-900 transition duration-200 group w-full text-left",title:`${q.name} - ${q.userRole==="owner"?"Dueo":q.userRole==="moderator"?"Moderador":"Miembro"}`,children:[i.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[i.jsx(Tt,{className:"w-3 h-3 text-green-500"}),i.jsx("span",{className:"text-sm flex-1 truncate",children:q.name})]}),i.jsx("div",{className:"flex items-center gap-1 opacity-70 group-hover:opacity-100 transition-opacity",children:$(q.userRole)})]},q.id))})]}),(S==="moderator"||S==="admin")&&i.jsx("div",{className:"mb-4",children:i.jsx("button",{className:"flex items-center gap-3 p-3 rounded-lg hover:bg-orange-50 text-gray-700 hover:text-orange-600 transition duration-200 w-full text-left",children:i.jsx("span",{className:"font-medium",children:"Revisar Reportes"})})}),L&&i.jsx("div",{className:"mb-4",children:i.jsx("button",{onClick:a,className:"flex items-center gap-3 p-3 rounded-lg hover:bg-purple-50 text-gray-700 hover:text-purple-600 transition duration-200 w-full text-left",children:i.jsx("span",{className:"font-medium",children:"Revisar Solicitudes de Verificacin"})})}),i.jsx("div",{className:"border-t border-gray-200 my-4"}),i.jsx("div",{className:"mb-4",children:i.jsx("a",{href:"/terminos-y-condiciones",className:"flex items-center gap-3 p-3 rounded-lg hover:bg-gray-100 text-gray-600 hover:text-gray-800 transition duration-200",children:i.jsx("span",{className:"text-sm font-medium",children:"Trminos y Condiciones"})})})]})}),i.jsx(nw,{isOpen:g,onClose:()=>x(!1)})]})}function p8({isOpen:s,onClose:e,onInicioClick:n,onThemeClick:a,userData:l,onVerificationClick:u}){const[h,p]=V.useState(!0),[g,x]=V.useState(!1),[y,v]=V.useState(!1),{forums:_,loading:E}=ew(),{userForums:S,loading:A}=tw(),D=l?.role||"unverified",L=D==="doctor"||D==="moderator"||D==="admin",B=D==="doctor"||D==="moderator"||D==="admin",k=D==="admin",$=()=>{v(!0)},q=()=>{n(),e()},F=j=>{a&&a({id:j.id,name:j.name,description:j.description,createdAt:j.createdAt,memberCount:j.memberCount||0,ownerId:j.ownerId}),e()},R=j=>{switch(j){case"owner":return i.jsx(Wc,{className:"w-3 h-3 text-yellow-500"});case"moderator":return i.jsx(Qn,{className:"w-3 h-3 text-blue-500"});default:return i.jsx(yn,{className:"w-3 h-3 text-gray-500"})}};return s?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-50",onClick:e}),i.jsxs("div",{className:"lg:hidden fixed inset-y-0 left-0 z-50 w-80 bg-white shadow-xl",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-white",children:[i.jsx(K4,{}),i.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg transition duration-200",children:i.jsx(At,{className:"w-6 h-6 text-gray-600"})})]}),i.jsx("div",{className:"h-full overflow-y-auto pb-20",children:i.jsxs("nav",{className:"p-4",children:[i.jsx("button",{onClick:q,className:"flex items-center gap-3 p-3 rounded-lg hover:bg-blue-50 text-gray-700 hover:text-blue-600 transition duration-200 mb-2 w-full text-left",children:i.jsx("span",{className:"font-medium",children:"Inicio"})}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("button",{onClick:()=>p(!h),className:"flex items-center justify-between w-full p-3 rounded-lg hover:bg-blue-50 text-gray-700 hover:text-blue-600 transition duration-200",children:[i.jsx("span",{className:"font-medium",children:"Comunidades Relevantes"}),h?i.jsx(hh,{className:"w-4 h-4"}):i.jsx(fh,{className:"w-4 h-4"})]}),h&&i.jsx("div",{className:"mt-2 ml-4 space-y-1 max-h-64 overflow-y-auto",children:E?i.jsx("div",{className:"space-y-2",children:[...Array(5)].map((j,C)=>i.jsxs("div",{className:"animate-pulse flex items-center gap-3 p-2",children:[i.jsx("div",{className:"w-4 h-4 bg-gray-200 rounded-full"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded flex-1"})]},C))}):_.length===0?i.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:[i.jsx("p",{className:"text-sm text-gray-500 text-center",children:"No hay comunidades creadas an"}),L&&i.jsx("p",{className:"text-xs text-gray-400 text-center mt-1",children:"S el primero en crear una comunidad"})]}):_.map(j=>i.jsxs("button",{onClick:()=>F(j),className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 text-gray-600 hover:text-gray-900 transition duration-200 group w-full text-left",title:j.description,children:[i.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[i.jsx(Tt,{className:"w-3 h-3 text-green-500"}),i.jsx("span",{className:"text-sm flex-1 truncate",children:j.name})]}),i.jsx("div",{className:"opacity-70 group-hover:opacity-100 transition-opacity",children:i.jsx("span",{className:"text-xs text-gray-500",children:j.memberCount||0})})]},j.id))})]}),L&&i.jsx("div",{className:"mb-4",children:i.jsxs("button",{onClick:$,className:"flex items-center gap-3 p-3 rounded-lg hover:bg-green-50 text-gray-700 hover:text-green-600 transition duration-200 w-full text-left",children:[i.jsx(J4,{className:"w-5 h-5"}),i.jsx("span",{className:"font-medium",children:"Crear Comunidad"})]})}),B&&i.jsxs("div",{className:"mb-4",children:[i.jsxs("button",{onClick:()=>x(!g),className:"flex items-center justify-between w-full p-3 rounded-lg hover:bg-purple-50 text-gray-700 hover:text-purple-600 transition duration-200",children:[i.jsx("span",{className:"font-medium",children:"Mis Comunidades"}),g?i.jsx(hh,{className:"w-4 h-4"}):i.jsx(fh,{className:"w-4 h-4"})]}),g&&i.jsx("div",{className:"mt-2 ml-4 space-y-1 max-h-64 overflow-y-auto",children:A?i.jsx("div",{className:"space-y-2",children:[...Array(3)].map((j,C)=>i.jsxs("div",{className:"animate-pulse flex items-center gap-3 p-2",children:[i.jsx("div",{className:"w-4 h-4 bg-gray-200 rounded-full"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded flex-1"})]},C))}):S.length===0?i.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:[i.jsx("p",{className:"text-sm text-gray-500 text-center",children:"No ests unido a ninguna comunidad"}),i.jsx("p",{className:"text-xs text-gray-400 text-center mt-1",children:"nete a comunidades para verlas aqu"})]}):S.map(j=>i.jsxs("button",{onClick:()=>F(j),className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 text-gray-600 hover:text-gray-900 transition duration-200 group w-full text-left",title:`${j.name} - ${j.userRole==="owner"?"Dueo":j.userRole==="moderator"?"Moderador":"Miembro"}`,children:[i.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[i.jsx(Tt,{className:"w-3 h-3 text-green-500"}),i.jsx("span",{className:"text-sm flex-1 truncate",children:j.name})]}),i.jsx("div",{className:"flex items-center gap-1 opacity-70 group-hover:opacity-100 transition-opacity",children:R(j.userRole)})]},j.id))})]}),(D==="moderator"||D==="admin")&&i.jsx("div",{className:"mb-4",children:i.jsx("button",{className:"flex items-center gap-3 p-3 rounded-lg hover:bg-orange-50 text-gray-700 hover:text-orange-600 transition duration-200 w-full text-left",children:i.jsx("span",{className:"font-medium",children:"Revisar Reportes"})})}),k&&i.jsx("div",{className:"mb-4",children:i.jsx("button",{onClick:()=>{u(),e()},className:"flex items-center gap-3 p-3 rounded-lg hover:bg-purple-50 text-gray-700 hover:text-purple-600 transition duration-200 w-full text-left",children:i.jsx("span",{className:"font-medium",children:"Revisar Solicitudes de Verificacin"})})}),i.jsx("div",{className:"border-t border-gray-200 my-4"}),i.jsx("div",{className:"mb-4",children:i.jsx("a",{href:"/terminos-y-condiciones",onClick:e,className:"flex items-center gap-3 p-3 rounded-lg hover:bg-gray-100 text-gray-600 hover:text-gray-800 transition duration-200",children:i.jsx("span",{className:"text-sm font-medium",children:"Trminos y Condiciones"})})})]})})]}),i.jsx(nw,{isOpen:y,onClose:()=>v(!1)})]}):null}function x8(){return i.jsx("main",{className:"flex-1 min-h-screen bg-gray-50 p-4 lg:p-6",children:i.jsx("div",{className:"max-w-4xl mx-auto",children:i.jsx("div",{className:"mt-8 text-center",children:i.jsx("p",{className:"text-gray-500",children:"Ms posts cargarn aqu..."})})})})}const y8=(s=null)=>{const[e,n]=V.useState(null),[a,l]=V.useState([]),[u,h]=V.useState([]),[p,g]=V.useState([]),[x,y]=V.useState(!0),[v,_]=V.useState(null),E=s||(Ne.currentUser?Ne.currentUser.uid:null);V.useEffect(()=>{if(!E){y(!1);return}S()},[E]);const S=async()=>{try{y(!0),_(null),console.log(" Cargando perfil para usuario:",E);const L=await ve(se(Y,"users",E));if(!L.exists())throw new Error("Usuario no encontrado");const B=L.data();console.log(" Datos del usuario:",B);const k=Dt(Me(Y,"posts"),He("authorId","==",E),el("createdAt","desc")),$=await gn(k);console.log(" Publicaciones encontradas:",$.docs.length);const q=[];for(const M of $.docs){const ue=M.data();console.log(" Publicacin:",ue);let we="General";if(ue.forumId)try{const K=await ve(se(Y,"forums",ue.forumId));K.exists()&&(we=K.data().name||"Foro")}catch(K){console.error("Error cargando foro:",K)}q.push({id:M.id,...ue,tema:we,fecha:ue.createdAt,likes:ue.likes||[],titulo:ue.title,contenido:ue.content,stats:ue.stats||{commentCount:0,likeCount:0}})}const F=Dt(Me(Y,"comments"),He("authorId","==",E),el("createdAt","desc")),R=await gn(F);console.log(" Comentarios encontrados:",R.docs.length);const j=[];for(const M of R.docs){const ue=M.data();console.log(" Comentario:",ue);let we="Publicacin no disponible",K="Usuario",ce="General";if(ue.postId)try{const ge=await ve(se(Y,"posts",ue.postId));if(ge.exists()){const Ee=ge.data();if(we=Ee.title||"Sin ttulo",Ee.authorId){const Le=await ve(se(Y,"users",Ee.authorId));if(Le.exists()){const H=Le.data();K=H.name?`${H.name.name||""} ${H.name.apellidopat||""}`.trim():"Usuario"}}if(Ee.forumId){const Le=await ve(se(Y,"forums",Ee.forumId));Le.exists()&&(ce=Le.data().name||"Foro")}}}catch(ge){console.error("Error cargando datos del post:",ge)}j.push({id:M.id,...ue,publicacionTitulo:we,usuarioPost:K,tema:ce,fecha:ue.createdAt,usuarioComentarista:B.name?`${B.name.name||""} ${B.name.apellidopat||""}`.trim():"Usuario",rolComentarista:B.professionalInfo?.specialty||"Mdico",contenido:ue.content})}const C=[],O=B.joinedForums||[];console.log(" Foros unidos:",O);for(const M of O)try{const ue=await ve(se(Y,"forums",M));if(ue.exists()){const we=ue.data(),K=q.filter(ge=>ge.forumId===M),ce=j.filter(ge=>{const Ee=q.find(Le=>Le.id===ge.postId);return Ee&&Ee.forumId===M});C.push({id:M,nombre:we.name,description:we.description,fechaUnion:B.joinDate,publicaciones:K.length,comentarios:ce.length,memberCount:we.memberCount||0,lastActivity:we.lastPostAt||we.createdAt})}}catch(ue){console.error(`Error cargando foro ${M}:`,ue)}const P=A(B,q,j,C);console.log(" Estadsticas calculadas:",P);const U={nombreCompleto:B.name?`${B.name.name||""} ${B.name.apellidopat||""} ${B.name.apellidomat||""}`.trim():"Usuario",especialidad:B.professionalInfo?.specialty||"Mdico",fotoPerfil:B.photoURL||null,fechaRegistro:B.joinDate,role:B.role,verificationStatus:B.professionalInfo?.verificationStatus,professionalInfo:B.professionalInfo,estadisticas:P,publicaciones:q,comentarios:j,temasParticipacion:C};console.log(" Datos formateados:",U),n(U),l(q),h(j),g(C)}catch(L){console.error(" Error cargando perfil:",L),_(L.message)}finally{y(!1)}},A=(L,B,k,$)=>{const q=L.joinDate?.toDate?.()||new Date,F=Math.max(1,Math.floor((new Date-q)/(1e3*60*60*24)));return{aura:L.stats?.aura||0,interacciones:(L.stats?.postCount||0)+(L.stats?.commentCount||0),diasPlataforma:F,temasParticipacion:$.length,publicaciones:L.stats?.postCount||B.length,comentarios:L.stats?.commentCount||k.length}};return{userData:e,userPosts:a,userComments:u,userForums:p,loading:x,error:v,refreshProfile:()=>{S()}}},ph={cloudName:void 0,uploadPreset:void 0},b8=()=>{const[s,e]=V.useState(!1),[n,a]=V.useState(null),l=async p=>{const g=new FormData;g.append("file",p),g.append("upload_preset","profile");try{const x=await fetch(`https://api.cloudinary.com/v1_1/${ph.cloudName}/auto/upload`,{method:"POST",body:g});if(!x.ok)throw new Error("Error al subir la imagen a Cloudinary");return(await x.json()).secure_url}catch(x){throw console.error("Error subiendo a Cloudinary:",x),new Error("No se pudo subir la imagen")}};return{uploadProfilePhoto:async p=>{if(!Ne.currentUser)return a("Usuario no autenticado"),null;try{if(e(!0),a(null),!p.type.startsWith("image/"))throw new Error("Solo se permiten archivos de imagen (JPG, PNG, WEBP)");if(p.size>5*1024*1024)throw new Error("La imagen no debe superar los 5MB");const g=Ne.currentUser.uid,x=await l(p);return await tt(se(Y,"users",g),{photoURL:x,lastUpdated:new Date}),x}catch(g){return console.error("Error subiendo foto de perfil:",g),a(g.message),null}finally{e(!1)}},deleteProfilePhoto:async()=>{if(Ne.currentUser)try{e(!0),await tt(se(Y,"users",Ne.currentUser.uid),{photoURL:null,lastUpdated:new Date})}catch(p){console.error("Error eliminando foto de perfil:",p),a(p.message)}finally{e(!1)}},uploading:s,error:n,clearError:()=>a(null)}};function v8({currentPhoto:s,onPhotoUpdate:e,isOwnProfile:n=!0}){const[a,l]=V.useState(s),[u,h]=V.useState(!1),p=V.useRef(null),{uploadProfilePhoto:g,deleteProfilePhoto:x,uploading:y,error:v,clearError:_}=b8();if(!n)return i.jsx("div",{className:"flex-shrink-0",children:s?i.jsx("img",{src:s,alt:"Foto de perfil",className:"w-24 h-24 rounded-full object-cover border-4 border-blue-100"}):i.jsx(qd,{className:"w-24 h-24 text-gray-400"})});const E=async B=>{const k=B.target.files[0];if(!k)return;_();const $=new FileReader;$.onload=F=>{l(F.target.result)},$.readAsDataURL(k);const q=await g(k);q&&e&&e(q),B.target.value=""},S=async()=>{_(),await x(),l(null),e&&e(null),h(!1)},A=()=>{p.current?.click()},D=()=>{_(),h(!0)},L=()=>{_(),h(!1)};return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"relative group flex-shrink-0",children:[a?i.jsx("img",{src:a,alt:"Foto de perfil",className:"w-24 h-24 rounded-full object-cover border-4 border-blue-100 cursor-pointer transition duration-200 group-hover:brightness-90",onClick:D}):i.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-100 flex items-center justify-center cursor-pointer border-4 border-blue-100 transition duration-200 group-hover:bg-gray-200",onClick:D,children:i.jsx(qd,{className:"w-16 h-16 text-gray-400"})}),n&&i.jsx("button",{onClick:D,className:"absolute -bottom-2 -right-2 bg-blue-600 text-white p-2 rounded-full shadow-lg hover:bg-blue-700 transition duration-200 group-hover:scale-110 border-2 border-white",title:"Cambiar foto de perfil",type:"button",children:i.jsx(rb,{className:"w-3 h-3"})})]}),u&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-2xl p-6 max-w-md w-full mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Foto de perfil"}),i.jsx("button",{onClick:L,className:"p-2 hover:bg-gray-100 rounded-lg transition duration-200",disabled:y,children:i.jsx(At,{className:"w-5 h-5 text-gray-500"})})]}),v&&i.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:v}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"flex justify-center mb-6",children:a?i.jsx("img",{src:a,alt:"Preview",className:"w-32 h-32 rounded-full object-cover border-4 border-blue-100"}):i.jsx("div",{className:"w-32 h-32 rounded-full bg-gray-200 flex items-center justify-center",children:i.jsx(qd,{className:"w-20 h-20 text-gray-400"})})}),i.jsxs("div",{className:"flex flex-col gap-3",children:[i.jsx("button",{onClick:A,disabled:y,className:"flex items-center justify-center gap-2 bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:y?i.jsxs(i.Fragment,{children:[i.jsx(ut,{className:"w-4 h-4 animate-spin"}),"Subiendo..."]}):i.jsxs(i.Fragment,{children:[i.jsx(rb,{className:"w-4 h-4"}),a?"Cambiar foto":"Subir foto"]})}),i.jsx("input",{ref:p,type:"file",accept:"image/*",onChange:E,className:"hidden",disabled:y}),a&&i.jsxs("button",{onClick:S,disabled:y,className:"flex items-center justify-center gap-2 bg-red-600 text-white py-3 px-4 rounded-lg hover:bg-red-700 transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx(At,{className:"w-4 h-4"}),"Eliminar foto"]}),i.jsx("button",{onClick:L,disabled:y,className:"py-3 px-4 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition duration-200 disabled:opacity-50",children:"Cancelar"})]}),i.jsx("div",{className:"mt-4 text-xs text-gray-500",children:"Formatos soportados: JPG, PNG, WEBP. Mximo 5MB."})]})]})})]})}function w8({userData:s,onShowStats:e,onPhotoUpdate:n,isOwnProfile:a=!0,onReportProfile:l}){const u=g=>{if(!g)return"Fecha no disponible";try{return g.toDate?g.toDate().toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):new Date(g).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})}catch{return"Fecha invlida"}},h=()=>{const g=s.verificationStatus||s.professionalInfo?.verificationStatus||(s.role==="doctor"?"verified":"unverified");switch(console.log(" Estado de verificacin:",g,s),g){case"verified":return i.jsxs("span",{className:"inline-flex items-center gap-1 bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full border border-green-200",children:[i.jsx(Wr,{className:"w-3 h-3"}),"Doctor Verificado"]});case"pending":return i.jsxs("span",{className:"inline-flex items-center gap-1 bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full border border-yellow-200",children:[i.jsx(si,{className:"w-3 h-3"}),"En verificacin"]});case"rejected":return i.jsxs("span",{className:"inline-flex items-center gap-1 bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full border border-red-200",children:[i.jsx($g,{className:"w-3 h-3"}),"Verificacin rechazada"]});default:return s.role==="doctor"?i.jsxs("span",{className:"inline-flex items-center gap-1 bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full border border-green-200",children:[i.jsx(pT,{className:"w-3 h-3"}),"Doctor"]}):i.jsxs("span",{className:"inline-flex items-center gap-1 bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded-full border border-gray-200",children:[i.jsx(qd,{className:"w-3 h-3"}),"Usuario"]})}},p=()=>{const g=s.role,x={doctor:"bg-blue-100 text-blue-800 border-blue-200",moderator:"bg-purple-100 text-purple-800 border-purple-200",admin:"bg-red-100 text-red-800 border-red-200",unverified:"bg-gray-100 text-gray-800 border-gray-200"},y={doctor:"Doctor",moderator:"Moderador",admin:"Administrador",unverified:"No Verificado"};return i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${x[g]||"bg-gray-100 text-gray-800"}`,children:y[g]||"Usuario"})};return i.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:i.jsxs("div",{className:"flex items-start gap-4 sm:gap-6",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx(v8,{currentPhoto:s.fotoPerfil,onPhotoUpdate:n,isOwnProfile:a})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[i.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900 truncate",children:s.nombreCompleto}),h(),p(),!a&&i.jsxs("button",{onClick:l,className:"inline-flex items-center gap-1 bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded-full border border-orange-200 hover:bg-orange-200 transition duration-200",title:"Reportar este perfil",children:[i.jsx(eu,{className:"w-3 h-3"}),"Reportar"]})]}),i.jsx("p",{className:"text-base sm:text-lg text-blue-600 font-semibold mb-3 sm:mb-4",children:s.especialidad}),i.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-500",children:[i.jsxs("p",{children:["Miembro desde ",u(s.fechaRegistro)]}),s.professionalInfo?.university&&i.jsx("span",{className:"bg-gray-100 px-2 py-1 rounded text-xs",children:s.professionalInfo.university}),s.professionalInfo?.titulationYear&&i.jsxs("span",{className:"bg-gray-100 px-2 py-1 rounded text-xs",children:["Graduado ",s.professionalInfo.titulationYear]})]}),i.jsxs("div",{className:"flex flex-wrap gap-4 mt-3 pt-3 border-t border-gray-200",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-lg font-bold text-gray-900",children:s.estadisticas?.publicaciones||0}),i.jsx("div",{className:"text-xs text-gray-500",children:"Publicaciones"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-lg font-bold text-gray-900",children:s.estadisticas?.comentarios||0}),i.jsx("div",{className:"text-xs text-gray-500",children:"Comentarios"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-lg font-bold text-gray-900",children:s.estadisticas?.temasParticipacion||0}),i.jsx("div",{className:"text-xs text-gray-500",children:"Comunidades"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-lg font-bold text-gray-900",children:s.estadisticas?.aura||0}),i.jsx("div",{className:"text-xs text-gray-500",children:"Aura"})]})]})]}),i.jsx("button",{onClick:e,className:"lg:hidden flex-shrink-0 p-2 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200 transition duration-200",title:"Ver estadsticas completas",children:i.jsx(Fh,{className:"w-5 h-5"})})]})})}function _8({activeTab:s,setActiveTab:e}){const n=[{id:"publicaciones",label:"Publicaciones",icon:i.jsx(_T,{className:"w-4 h-4"})},{id:"comentarios",label:"Comentarios",icon:i.jsx(xr,{className:"w-4 h-4"})},{id:"temas",label:"Comunidades",icon:i.jsx(Tt,{className:"w-4 h-4"})}];return i.jsx("nav",{className:"flex border-b border-gray-200 overflow-x-auto",children:n.map(a=>i.jsxs("button",{onClick:()=>e(a.id),className:`flex-1 min-w-0 px-4 sm:px-6 py-3 sm:py-4 text-xs sm:text-sm font-medium border-b-2 transition duration-200 whitespace-nowrap flex items-center justify-center gap-2 ${s===a.id?"border-blue-500 text-blue-600 bg-blue-50":"border-transparent text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[a.icon,i.jsx("span",{className:"hidden sm:inline",children:a.label}),i.jsx("span",{className:"sm:hidden",children:a.label.split(" ")[0]})]},a.id))})}const $h=()=>{const s=Ne.currentUser,e=async y=>{if(!s)throw new Error("Debes iniciar sesin");const v=se(Y,"posts",y),_=await ve(v);if(!_.exists())throw new Error("Publicacin no encontrada");const E=_.data(),A=(await ve(se(Y,"users",s.uid))).data(),D=E.authorId===s.uid,L=["moderator","admin"].includes(A?.role),B=await n(E.forumId);if(!D&&!L&&!B)throw new Error("No tienes permisos para modificar esta publicacin");return{postData:E,userData:A,isAuthor:D,isModeratorOrAdmin:L,isForumModerator:B}},n=async y=>{try{const v=se(Y,"forums",y),_=await ve(v);if(!_.exists())return!1;const E=_.data();return E.moderators&&E.moderators[s.uid]}catch{return!1}},a=async y=>{try{if(!s)throw new Error("Debes iniciar sesin para publicar");const _=(await ve(se(Y,"users",s.uid))).data();if(!["doctor","moderator","admin"].includes(_?.role))throw new Error("Solo usuarios verificados pueden publicar");const E={title:y.title,content:y.content,authorId:s.uid,forumId:y.forumId,createdAt:bt(),updatedAt:null,likes:[],dislikes:[],images:y.images||[],stats:{commentCount:0,viewCount:0},status:y.status||"active"},S=await _n(Me(Y,"posts"),E);return E.status==="active"&&await tt(se(Y,"forums",y.forumId),{postCount:ke(1),lastPostAt:bt()}),await tt(se(Y,"users",s.uid),{"stats.postCount":ke(1),"stats.contributionCount":ke(1)}),{success:!0,postId:S.id}}catch(v){return console.error("Error creando post:",v),{success:!1,error:v.message}}},l=async(y,v)=>{try{const{postData:_}=await e(y),E=se(Y,"posts",y);return await tt(E,{...v,updatedAt:bt()}),{success:!0}}catch(_){return console.error("Error editando post:",_),{success:!1,error:_.message}}},u=async y=>{try{const v=Dt(Me(Y,"comments"),He("postId","==",y)),_=await gn(v),E=$n(Y);return _.forEach(S=>{E.delete(S.ref)}),await E.commit(),console.log(` Eliminados ${_.size} comentarios del post ${y}`),{success:!0,deletedComments:_.size}}catch(v){return console.error("Error eliminando comentarios del post:",v),{success:!1,error:v.message}}},h=async y=>{try{const v=Dt(Me(Y,"comments"),He("postId","==",y)),_=await gn(v),E=new Map;_.forEach(A=>{const L=A.data().authorId;L&&E.set(L,(E.get(L)||0)+1)});const S=$n(Y);for(const[A,D]of E){const L=se(Y,"users",A);S.update(L,{"stats.commentCount":ke(-D),"stats.contributionCount":ke(-D)})}return await S.commit(),console.log(` Actualizadas estadsticas de ${E.size} autores`),{success:!0,updatedAuthors:E.size}}catch(v){return console.error("Error actualizando estadsticas de autores:",v),{success:!1,error:v.message}}},p=async(y,v="user_deleted",_=!1)=>{try{const{postData:E,isAuthor:S,isModeratorOrAdmin:A,isForumModerator:D}=await e(y),L=_||!S&&(A||D);console.log(" Eliminando comentarios del post...");const k=(await u(y)).deletedComments||0;let $=0;k>0&&(console.log(` ${k} comentarios eliminados, actualizando estadsticas...`),$=(await h(y)).updatedAuthors||0);const q=$n(Y);if(L){const R=se(Me(Y,"deleted_posts"),y);q.set(R,{...E,id:y,deletedAt:bt(),deletedBy:s.uid,deleteReason:v,deleteType:"moderator_deletion",originalForumId:E.forumId,authorId:E.authorId,moderatorAction:!0,statsAtDeletion:{likes:E.likes?.length||0,dislikes:E.dislikes?.length||0,comments:E.stats?.commentCount||0,views:E.stats?.viewCount||0},reportedToGlobal:!1})}const F=se(Y,"posts",y);if(q.delete(F),E.status==="active"){const R=se(Y,"forums",E.forumId);q.update(R,{postCount:ke(-1)})}if(S){const R=se(Y,"users",s.uid);q.update(R,{"stats.postCount":ke(-1),"stats.contributionCount":ke(-1)})}return await q.commit(),console.log(" Post eliminado correctamente"),L&&await x(E.authorId,v,"post_deleted_by_moderator",y),{success:!0,deletionType:L?"moderator":"user",savedForAudit:L,deletedComments:k,updatedAuthors:$}}catch(E){return console.error("Error eliminando post:",E),{success:!1,error:E.message}}},g=async(y,v)=>{try{if(!s)throw new Error("Debes iniciar sesin");const _=se(Y,"posts",y),E=await ve(_);if(!E.exists())throw new Error("Publicacin no encontrada");const S=E.data(),A=S.authorId;let D=0;const L=S.likes||[],B=S.dislikes||[],k=L.includes(s.uid),$=B.includes(s.uid);v==="like"?k?D=-1:$?D=2:D=1:v==="dislike"?$?D=1:k?D=-2:D=-1:v==="remove"&&(k?D=-1:$&&(D=1));const q=$n(Y);if(v==="like"?q.update(_,{likes:Gr(s.uid),dislikes:lr(s.uid)}):v==="dislike"?q.update(_,{dislikes:Gr(s.uid),likes:lr(s.uid)}):v==="remove"&&q.update(_,{likes:lr(s.uid),dislikes:lr(s.uid)}),D!==0&&A!==s.uid){const F=se(Y,"users",A);q.update(F,{"stats.aura":ke(D)})}return await q.commit(),{success:!0,auraChange:D}}catch(_){return console.error("Error reaccionando al post:",_),{success:!1,error:_.message}}},x=async(y,v,_,E=null)=>{try{await _n(Me(Y,"global_moderation_reports"),{userId:y,reason:v,moderatorId:s.uid,actionType:_,postId:E,reportedAt:bt(),status:"pending_review",communityContext:!0,requiresAction:!0})}catch(S){console.error("Error reporting to global moderation:",S)}};return{createPost:a,editPost:l,deletePost:p,reactToPost:g}};function N8({images:s}){const[e,n]=V.useState(null);return!s||s.length===0?null:i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"grid grid-cols-1 gap-3",children:s.map((a,l)=>i.jsxs("div",{className:"relative group",children:[i.jsx("img",{src:a.url,alt:`Imagen ${l+1} del post`,className:"w-full max-h-96 object-contain rounded-lg border border-gray-200 cursor-pointer",onClick:()=>n(a)}),i.jsx("button",{onClick:()=>n(a),className:"absolute top-2 right-2 bg-black bg-opacity-50 text-white p-2 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:i.jsx(vT,{className:"w-3 h-3"})})]},l))}),e&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",onClick:()=>n(null),children:i.jsxs("div",{className:"relative max-w-4xl max-h-full",children:[i.jsx("img",{src:e.url,alt:"Imagen expandida",className:"max-w-full max-h-full object-contain"}),i.jsx("button",{onClick:()=>n(null),className:"absolute top-4 right-4 bg-white text-gray-800 p-2 rounded-full hover:bg-gray-200 transition duration-200",children:i.jsx(At,{className:"w-5 h-5"})})]})})]})}const sw=()=>{const[s,e]=V.useState(!1),[n,a]=V.useState(null);return{uploadImage:async u=>{e(!0),a(null);try{if(!u)throw new Error("No se seleccion ningn archivo");const h=2*1024*1024,p=["image/jpeg","image/png","image/gif","image/webp"];if(u.size>h)throw new Error("La imagen debe ser menor a 2MB");if(!p.includes(u.type))throw new Error("Solo se permiten imgenes JPEG, PNG, GIF o WebP");const g=new FormData;g.append("file",u),g.append("upload_preset","publicaciones");const x=await fetch(`https://api.cloudinary.com/v1_1/${ph.cloudName}/image/upload`,{method:"POST",body:g});if(!x.ok)throw new Error("Error subiendo imagen");const y=await x.json();return{success:!0,image:{url:y.secure_url,thumbnailUrl:y.secure_url,storagePath:y.public_id,filename:u.name,size:u.size,dimensions:{width:y.width,height:y.height},uploadedAt:new Date}}}catch(h){return console.error("Error subiendo imagen:",h),a(h.message),{success:!1,error:h.message}}finally{e(!1)}},uploading:s,error:n}};function E8({isOpen:s,onClose:e,post:n,onPostUpdated:a}){const[l,u]=V.useState({title:"",content:""}),[h,p]=V.useState([]),[g,x]=V.useState(!1),[y,v]=V.useState(""),{editPost:_}=$h(),{uploadImage:E,uploading:S}=sw();V.useEffect(()=>{n&&(u({title:n.title||"",content:n.content||""}),p(n.images||[]))},[n]);const A=k=>{const{name:$,value:q}=k.target;u(F=>({...F,[$]:q})),v("")},D=async k=>{const $=Array.from(k.target.files);if(h.length+$.length>1){v("Mximo 1 imagen");return}for(const q of $){const F=await E(q);F.success?p(R=>[...R,F.image]):v(F.error)}},L=k=>{p($=>$.filter((q,F)=>F!==k))},B=async k=>{if(k.preventDefault(),!l.title.trim()||!l.content.trim()){v("El ttulo y contenido son obligatorios");return}if(l.content.length<10){v("El contenido debe tener al menos 10 caracteres");return}x(!0),v("");try{const $=await _(n.id,{title:l.title,content:l.content,images:h});$.success?(a&&a(),e()):v($.error)}catch{v("Error al actualizar la publicacin")}finally{x(!1)}};return!s||!n?null:i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden",onClick:k=>k.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Editar Publicacin"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Actualiza tu contenido"})]}),i.jsx("button",{onClick:e,disabled:g,className:"p-2 hover:bg-gray-100 rounded-lg transition duration-200 disabled:opacity-50",children:i.jsx(At,{className:"w-5 h-5 text-gray-500"})})]}),i.jsxs("form",{onSubmit:B,className:"flex flex-col h-[calc(90vh-80px)]",children:[i.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[y&&i.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:i.jsx("p",{className:"text-red-700 text-sm",children:y})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-2",children:"Ttulo *"}),i.jsx("input",{type:"text",id:"title",name:"title",value:l.title,onChange:A,disabled:g,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 disabled:opacity-50",placeholder:"Escribe un ttulo claro y descriptivo...",maxLength:200,required:!0}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[l.title.length,"/200 caracteres"]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-2",children:"Contenido *"}),i.jsx("textarea",{id:"content",name:"content",value:l.content,onChange:A,disabled:g,rows:8,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 resize-none disabled:opacity-50",placeholder:"Comparte tu conocimiento, experiencia, pregunta o caso clnico...",maxLength:1e4,required:!0}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[l.content.length,"/10000 caracteres (mnimo 10)"]})]}),h.length>0&&i.jsxs("div",{className:"mb-6",children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Imgenes (",h.length,"/1)"]}),i.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:h.map((k,$)=>i.jsxs("div",{className:"relative group",children:[i.jsx("img",{src:k.url,alt:`Imagen ${$+1}`,className:"w-full h-24 object-cover rounded-lg border border-gray-200"}),i.jsx("button",{type:"button",onClick:()=>L($),disabled:g,className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50",children:""})]},$))})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:h.length===0?"Agregar imagen (opcional)":"Reemplazar imagen"}),i.jsx("div",{className:"flex gap-3",children:i.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition duration-200 cursor-pointer disabled:opacity-50",children:[i.jsx(G4,{className:"w-4 h-4 text-gray-600"}),i.jsx("span",{className:"text-sm",children:h.length===0?"Subir imagen":"Cambiar imagen"}),i.jsx("input",{type:"file",accept:"image/*",onChange:D,disabled:g||S,className:"hidden"})]})}),i.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Mximo 1 imagen. Formatos: JPEG, PNG, WebP. Tamao mximo: 2MB."})]})]}),i.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Los cambios se aplicarn inmediatamente."}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{type:"button",onClick:e,disabled:g,className:"px-6 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition duration-200 font-medium disabled:opacity-50",children:"Cancelar"}),i.jsxs("button",{type:"submit",disabled:g||S,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition duration-200 font-medium flex items-center gap-2 disabled:opacity-50",children:[(g||S)&&i.jsx(ut,{className:"w-4 h-4 animate-spin"}),g?"Guardando...":S?"Subiendo...":"Guardar Cambios"]})]})]})})]})]})})}function j8({isOpen:s,onClose:e,post:n,onPostDeleted:a,isModeratorAction:l=!1}){const[u,h]=V.useState(""),[p,g]=V.useState(!1),[x,y]=V.useState(""),{deletePost:v}=$h();Ne.currentUser;const _=async A=>{if(A.preventDefault(),l&&!u.trim()){y("Como moderador, debes proporcionar un motivo para la eliminacin");return}if(l&&u.length<10){y("El motivo debe tener al menos 10 caracteres para acciones de moderacin");return}g(!0),y("");try{let D;l?D=await v(n.id,u,!0):D=await v(n.id,"user_deleted",!1),D.success?(a&&a(D.deletionType),e(),h(""),alert(l?" Publicacin eliminada y guardada para auditora de moderacin.":" Publicacin eliminada permanentemente.")):y(D.error)}catch{y("Error al eliminar la publicacin")}finally{g(!1)}};if(s?document.body.style.overflow="hidden":document.body.style.overflow="unset",!s||!n)return null;const E=()=>l?"Eliminar Publicacin (Moderacin)":"Eliminar Publicacin",S=()=>l?"Esta accin se registrar para auditora del sistema":"Ests seguro de que quieres eliminar esta publicacin?";return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md my-8",onClick:A=>A.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white z-10 rounded-t-2xl",children:[i.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[i.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 ${l?"bg-red-100":"bg-orange-100"}`,children:l?i.jsx(Qn,{className:"w-5 h-5 text-red-600"}):i.jsx(an,{className:"w-5 h-5 text-orange-600"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 truncate",children:E()}),i.jsx("p",{className:"text-sm text-gray-500 truncate",children:S()})]})]}),i.jsx("button",{onClick:e,disabled:p,className:"p-2 hover:bg-gray-100 rounded-lg transition duration-200 disabled:opacity-50 flex-shrink-0 ml-2",children:i.jsx(At,{className:"w-5 h-5 text-gray-500"})})]}),i.jsx("div",{className:"max-h-[calc(80vh-120px)] overflow-y-auto",children:i.jsxs("form",{onSubmit:_,className:"p-6",children:[x&&i.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:i.jsx("p",{className:"text-red-700 text-sm",children:x})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Publicacin a eliminar:"}),i.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:[i.jsx("p",{className:"font-semibold text-gray-900 text-sm mb-1 break-words",children:n.title}),i.jsxs("p",{className:"text-xs text-gray-600 line-clamp-2 break-words",children:[n.content?.substring(0,150),"..."]})]})]}),l&&i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-700 mb-2",children:"Motivo de la eliminacin *"}),i.jsx("textarea",{id:"reason",value:u,onChange:A=>h(A.target.value),disabled:p,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition duration-200 disabled:opacity-50 resize-none",placeholder:"Explica detalladamente por qu eliminas esta publicacin. Este motivo ser revisado por la moderacin global.",required:!0}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[u.length," caracteres (mnimo 10)"]})]}),i.jsx("div",{className:`border rounded-lg p-4 mb-6 ${l?"bg-red-50 border-red-200":"bg-orange-50 border-orange-200"}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(an,{className:`w-5 h-5 mt-0.5 flex-shrink-0 ${l?"text-red-600":"text-orange-600"}`}),i.jsxs("div",{children:[i.jsx("h4",{className:`text-sm font-medium mb-1 ${l?"text-red-800":"text-orange-800"}`,children:l?"Accin de moderacin":"Esta accin es permanente"}),i.jsx("ul",{className:`text-xs space-y-1 ${l?"text-red-700":"text-orange-700"}`,children:l?i.jsxs(i.Fragment,{children:[i.jsx("li",{children:" La publicacin se guardar en registros de moderacin"}),i.jsx("li",{children:" El autor ser notificado sobre la eliminacin"}),i.jsx("li",{children:" El motivo ser revisado por moderacin global"}),i.jsx("li",{children:" Puede conllevar sanciones para el autor"}),i.jsx("li",{children:"  Esta accin queda registrada en el sistema"})]}):i.jsxs(i.Fragment,{children:[i.jsx("li",{children:" La publicacin ser eliminada permanentemente"}),i.jsx("li",{children:" No podrs recuperar esta publicacin"}),i.jsx("li",{children:" Los comentarios y reacciones tambin se eliminarn"}),i.jsx("li",{children:" Esta accin no se puede deshacer"})]})})]})]})})]})}),i.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50 sticky bottom-0 rounded-b-2xl",children:i.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[i.jsx("button",{type:"button",onClick:e,disabled:p,className:"px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition duration-200 font-medium disabled:opacity-50 order-2 sm:order-1",children:"Cancelar"}),i.jsxs("button",{type:"submit",onClick:_,disabled:p||l&&u.length<10,className:`px-6 py-3 rounded-lg transition duration-200 font-medium flex items-center justify-center gap-2 disabled:opacity-50 order-1 sm:order-2 ${l?"bg-red-600 text-white hover:bg-red-700":"bg-orange-600 text-white hover:bg-orange-700"}`,children:[p&&i.jsx(ut,{className:"w-4 h-4 animate-spin"}),i.jsx(ta,{className:"w-4 h-4"}),l?"Eliminar como Moderador":"Eliminar Publicacin"]})]})})]})})}const S8={async createReport(s){try{const n={...Object.fromEntries(Object.entries(s).filter(([l,u])=>u!=null)),status:"pending",assignedModerator:null,resolution:null,resolvedAt:null,resolvedBy:null,createdAt:bt(),updatedAt:bt()};return console.log(" Guardando reporte:",n),{success:!0,id:(await _n(Me(Y,"reports"),n)).id}}catch(e){return console.error("Error creando reporte:",e),{success:!1,error:e.message}}}},T8=()=>{const[s,e]=V.useState(!1),[n,a]=V.useState(null);return{createReport:async u=>{e(!0),a(null);try{const h=await S8.createReport(u);return h.success?{success:!0,id:h.id}:(a(h.error),{success:!1,error:h.error})}catch(h){return a(h.message),{success:!1,error:h.message}}finally{e(!1)}},loading:s,error:n}};function Qh({isOpen:s,onClose:e,reportType:n,targetId:a,targetName:l}){const[u,h]=V.useState({reason:"",description:"",urgency:"medium"}),[p,g]=V.useState(null),[x,y]=V.useState(null),[v,_]=V.useState(""),{createReport:E,loading:S}=T8();V.useEffect(()=>{const j=async()=>{const O=Ne.currentUser;if(O)try{const P=await ve(se(Y,"users",O.uid));P.exists()&&g(P.data())}catch(P){console.error("Error cargando datos del usuario:",P)}},C=async()=>{if(a)try{let O,P;switch(n){case"profile":P="users";break;case"post":P="posts";break;case"comment":P="comments";break;case"forum":P="forums";break;default:return}O=await ve(se(Y,P,a)),O.exists()?(console.log(` Datos del target (${n}):`,O.data()),y(O.data())):console.warn(` No se encontr el target ${a} en ${P}`)}catch(O){console.error("Error cargando datos del target:",O)}};s&&(j(),C())},[s,a,n]);const A={forum:["Contenido inapropiado","Spam o autopromocin","Comunidad duplicada","Informacin mdica falsa","Comportamiento abusivo","Violacin de normas","Otro"],post:["Contenido inapropiado","Informacin mdica falsa","Spam","Derechos de autor","Acoso o bullying","Contenido ofensivo","Otro"],comment:["Comentario ofensivo","Spam","Acoso","Informacin falsa","Fuera de contexto","Otro"],user:["Comportamiento abusivo","Spam o autopromocin excesiva","Suplantacin de identidad","Perfil falso o informacin fraudulenta","Acoso o intimidacin","Contenido inapropiado en el perfil","Usuario no verificado ejerciendo como mdico","Compartir informacin mdica peligrosa","Otro"],profile:["Informacin profesional falsa","Suplantacin de identidad mdica","Foto de perfil inapropiada","Comportamiento abusivo en mensajes","Spam o autopromocin excesiva","Acoso a otros usuarios","Compartir informacin mdica peligrosa","Usuario no verificado ejerciendo como mdico","Credenciales falsas o alteradas","Otro"]},D=[{value:"low",label:"Baja",color:"text-green-600",description:"Problema menor"},{value:"medium",label:"Media",color:"text-yellow-600",description:"Necesita revisin"},{value:"high",label:"Alta",color:"text-orange-600",description:"Requiere atencin pronto"},{value:"critical",label:"Crtica",color:"text-red-600",description:"Necesita accin inmediata"}],L=()=>{switch(n){case"forum":return`Reportar Comunidad: ${l}`;case"post":return`Reportar Publicacin: ${l}`;case"comment":return"Reportar Comentario";case"user":return`Reportar Usuario: ${l}`;case"profile":return`Reportar Perfil: ${l}`;default:return"Reportar Contenido"}},B=()=>{switch(n){case"forum":return"Reportar problemas con esta comunidad";case"post":return"Reportar problemas con esta publicacin";case"comment":return"Reportar problemas con este comentario";case"user":return"Reportar problemas con este usuario";case"profile":return"Reportar problemas con este perfil de usuario";default:return"Reportar contenido inapropiado"}},k=()=>{switch(n){case"profile":return i.jsx(yn,{className:"w-5 h-5 text-red-600"});default:return i.jsx(an,{className:"w-5 h-5 text-red-600"})}},$=()=>{switch(n){case"profile":return"Describe detalladamente el problema con este perfil. Incluye informacin especfica sobre: credenciales falsas, comportamiento inapropiado, informacin mdica fraudulenta, etc.";case"user":return"Describe detalladamente el problema con este usuario. Incluye ejemplos especficos de comportamiento inapropiado.";case"forum":return"Describe detalladamente el problema con esta comunidad.";case"post":return"Describe detalladamente el problema con esta publicacin.";case"comment":return"Describe detalladamente el problema con este comentario.";default:return"Proporciona todos los detalles relevantes sobre el problema."}},q=j=>{const{name:C,value:O}=j.target;h(P=>({...P,[C]:O})),_("")},F=async()=>{if(!x)return{authorId:null,authorName:null};switch(n){case"post":if(x.authorId)try{const j=await ve(se(Y,"users",x.authorId));if(j.exists()){const C=j.data(),O=C.name?`${C.name.name||""} ${C.name.apellidopat||""} ${C.name.apellidomat||""}`.trim():C.email||"Usuario";return{authorId:x.authorId,authorName:O,forumId:x.forumId,forumName:x.forumName||"Foro desconocido"}}}catch(j){console.error("Error obteniendo datos del autor:",j)}return{authorId:x.authorId,authorName:"Autor desconocido",forumId:x.forumId,forumName:x.forumName||"Foro desconocido"};case"comment":if(x.authorId)try{const j=await ve(se(Y,"users",x.authorId));if(j.exists()){const C=j.data(),O=C.name?`${C.name.name||""} ${C.name.apellidopat||""} ${C.name.apellidomat||""}`.trim():C.email||"Usuario";return{authorId:x.authorId,authorName:O,postId:x.postId,postTitle:x.postTitle||"Post desconocido"}}}catch(j){console.error("Error obteniendo datos del autor:",j)}return{authorId:x.authorId,authorName:"Autor desconocido",postId:x.postId,postTitle:x.postTitle||"Post desconocido"};case"user":case"profile":return{authorId:a,authorName:x.name?`${x.name.name||""} ${x.name.apellidopat||""} ${x.name.apellidomat||""}`.trim():x.email||"Usuario"};case"forum":return{authorId:x.ownerId||null,authorName:x.ownerName||null};default:return{authorId:null,authorName:null}}},R=async j=>{if(j.preventDefault(),!u.reason||!u.description.trim()){_("Por favor selecciona un motivo y proporciona una descripcin");return}if(u.description.length<10){_("La descripcin debe tener al menos 10 caracteres");return}const C=Ne.currentUser;if(!C){_("Debes iniciar sesin para reportar contenido");return}const{authorId:O,authorName:P,forumId:U,forumName:M,postId:ue,postTitle:we}=F(),K={type:n,targetId:a,targetName:l,reporterId:C.uid,reporterName:p?.name?`${p.name.name||""} ${p.name.apellidopat||""} ${p.name.apellidomat||""}`.trim():C.email||"Usuario",reporterEmail:C.email,reason:u.reason,description:u.description.trim(),urgency:u.urgency,...O&&{targetAuthorId:O},...P&&{targetAuthorName:P},...U&&{forumId:U},...M&&{forumName:M},...ue&&{postId:ue},...we&&{postTitle:we}};console.log(" Enviando reporte:",K);const ce=await E(K);ce.success?(alert("Reporte enviado exitosamente! Los moderadores revisarn tu reporte pronto."),e(),h({reason:"",description:"",urgency:"medium"})):_(ce.error||"Error al enviar el reporte")};return V.useEffect(()=>(s?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[s]),s?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md my-8",onClick:j=>j.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white z-10 rounded-t-2xl",children:[i.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[i.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 ${n==="profile"?"bg-purple-100":"bg-red-100"}`,children:k()}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 truncate",children:L()}),i.jsx("p",{className:"text-sm text-gray-500 truncate",children:B()})]})]}),i.jsx("button",{onClick:e,disabled:S,className:"p-2 hover:bg-gray-100 rounded-lg transition duration-200 disabled:opacity-50 flex-shrink-0 ml-2",children:i.jsx(At,{className:"w-5 h-5 text-gray-500"})})]}),i.jsx("div",{className:"max-h-[calc(80vh-120px)] overflow-y-auto",children:i.jsxs("form",{onSubmit:R,className:"p-6",children:[v&&i.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:i.jsx("p",{className:"text-red-700 text-sm",children:v})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-700 mb-2",children:"Motivo del reporte *"}),i.jsxs("select",{id:"reason",name:"reason",value:u.reason,onChange:q,disabled:S,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 disabled:opacity-50",required:!0,children:[i.jsx("option",{value:"",children:"Selecciona un motivo"}),A[n]?.map((j,C)=>i.jsx("option",{value:j,children:j},C))]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Nivel de urgencia"}),i.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:D.map(j=>i.jsxs("label",{className:`flex flex-col p-3 border rounded-lg cursor-pointer transition duration-200 min-h-[60px] ${u.urgency===j.value?"border-blue-500 bg-blue-50 ring-2 ring-blue-500 ring-opacity-50":"border-gray-300 hover:bg-gray-50"}`,children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("input",{type:"radio",name:"urgency",value:j.value,checked:u.urgency===j.value,onChange:q,disabled:S,className:"text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:`text-sm font-medium ${j.color}`,children:j.label})]}),i.jsx("div",{className:"text-xs text-gray-500",children:j.description})]},j.value))})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Descripcin detallada *"}),i.jsx("textarea",{id:"description",name:"description",value:u.description,onChange:q,disabled:S,rows:5,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 resize-none disabled:opacity-50",placeholder:$(),required:!0}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[u.description.length," caracteres (mnimo 10)"]})]}),i.jsxs("div",{className:"border rounded-lg p-4 mb-6 bg-blue-50 border-blue-200",children:[i.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Informacin importante"}),i.jsxs("ul",{className:"text-xs text-blue-700 space-y-1",children:[i.jsx("li",{children:" Los reportes son annimos para otros usuarios"}),i.jsx("li",{children:" Los moderadores revisarn tu reporte en 24-48 horas"}),i.jsx("li",{children:" Usa este sistema solo para contenido que viole las normas"}),i.jsx("li",{children:" Los reportes falsos pueden resultar en sanciones"}),n==="profile"&&i.jsx("li",{children:" Los perfiles mdicos reportados sern investigados exhaustivamente"})]})]})]})}),i.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50 sticky bottom-0 rounded-b-2xl",children:i.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[i.jsx("button",{type:"button",onClick:e,disabled:S,className:"px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition duration-200 font-medium disabled:opacity-50 order-2 sm:order-1",children:"Cancelar"}),i.jsxs("button",{type:"submit",onClick:R,disabled:S,className:"px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition duration-200 font-medium flex items-center justify-center gap-2 disabled:opacity-50 order-1 sm:order-2",children:[S&&i.jsx(ut,{className:"w-4 h-4 animate-spin"}),S?"Enviando...":"Enviar Reporte"]})]})})]})}):null}function Yg({post:s,onCommentClick:e,onPostUpdated:n,onPostDeleted:a,onDeleteContent:l,onBanUser:u,onShowUserProfile:h,userRole:p,userMembership:g,requiresPostApproval:x,forumData:y}){const[v,_]=V.useState(!1),[E,S]=V.useState(null),[A,D]=V.useState(null),[L,B]=V.useState(null),[k,$]=V.useState(!1),[q,F]=V.useState(!1),[R,j]=V.useState(!1),[C,O]=V.useState(s.likes||[]),[P,U]=V.useState(s.dislikes||[]),{reactToPost:M}=$h(),ue=Ne.currentUser;V.useEffect(()=>{const nt=async()=>{if(ue)try{const it=await ve(se(Y,"users",ue.uid));it.exists()&&B(it.data())}catch(it){console.error("Error cargando userData:",it)}},Tn=async()=>{if(s.authorId)try{const it=await ve(se(Y,"users",s.authorId));it.exists()&&D(it.data())}catch(it){console.error("Error cargando datos del autor:",it)}};nt(),Tn()},[ue,s.authorId]),V.useEffect(()=>{O(s.likes||[]),U(s.dislikes||[])},[s.likes,s.dislikes]),V.useEffect(()=>{ue&&(C.includes(ue.uid)?S("like"):P.includes(ue.uid)?S("dislike"):S(null))},[ue,C,P]);const we=async nt=>{if(!ue)return;const Tn=E,it=[...C],Qe=[...P];let qe=[...C],Ct=[...P];nt==="like"?Tn==="like"?(qe=qe.filter(Te=>Te!==ue.uid),S(null)):(qe=[...qe.filter(Te=>Te!==ue.uid),ue.uid],Ct=Ct.filter(Te=>Te!==ue.uid),S("like")):nt==="dislike"?Tn==="dislike"?(Ct=Ct.filter(Te=>Te!==ue.uid),S(null)):(Ct=[...Ct.filter(Te=>Te!==ue.uid),ue.uid],qe=qe.filter(Te=>Te!==ue.uid),S("dislike")):nt==="remove"&&(qe=qe.filter(Te=>Te!==ue.uid),Ct=Ct.filter(Te=>Te!==ue.uid),S(null)),O(qe),U(Ct);const Es=await M(s.id,nt);Es.success||(O(it),U(Qe),S(Tn),console.error("Error en reaccin:",Es.error))};V.useEffect(()=>{ue&&console.log(" DEBUG PostCard Permissions:",{userUid:ue.uid,postAuthorId:s.authorId,userMembership:g,userDataRole:L?.role,isAuthor:ue.uid===s.authorId,isModerator:["owner","moderator"].includes(g?.role),isGlobalModerator:["moderator","admin"].includes(L?.role),canModerate:["owner","moderator"].includes(g?.role)||["moderator","admin"].includes(L?.role)})},[ue,s.authorId,g,L]);const K=ue&&ue.uid===s.authorId,ce=ue&&["owner","moderator"].includes(g?.role),ge=ue&&["moderator","admin"].includes(L?.role),Ee=ce||ge,Le=K||Ee,H=ue&&!K&&!Ee,ae=()=>{h&&A&&h({id:s.authorId,...A})},he=()=>{$(!0),_(!1)},me=()=>{F(!0),_(!1)},Ae=()=>{F(!0),_(!1)},Ie=()=>{A&&u&&u({id:s.authorId,...A}),_(!1)},Fe=()=>{j(!0),_(!1)},wt=()=>{n&&n(),$(!1)},at=()=>{a&&a(),F(!1)},on=nt=>{if(!nt)return"";try{return nt.toDate?nt.toDate().toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):new Date(nt).toLocaleDateString("es-ES")}catch{return"Fecha invlida"}},Yn=()=>{if(!A)return"Usuario";const{name:nt}=A;return nt&&(nt.name||nt.apellidopat||nt.apellidomat)?`${nt.name||""} ${nt.apellidopat||""} ${nt.apellidomat||""}`.trim():A.email||"Usuario"},Kn=()=>A&&A.professionalInfo?.specialty||null,os=()=>A&&A.photoURL||null,In=s.status==="pending"?{label:"Pendiente de aprobacin",color:"bg-yellow-100 text-yellow-800",icon:si}:s.status==="rejected"?{label:"Rechazado",color:"bg-red-100 text-red-800",icon:$g}:s.validatedAt?{label:"Verificado",color:"bg-green-100 text-green-800",icon:Wr}:null;return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-4",children:[i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsx("div",{className:"flex items-center gap-3",children:i.jsxs("button",{onClick:ae,className:"flex items-center gap-3 hover:bg-gray-50 rounded-lg p-1 transition duration-200 group",children:[os()?i.jsx("img",{src:os(),alt:`Foto de ${Yn()}`,className:"w-10 h-10 rounded-full object-cover border-2 border-blue-100 group-hover:border-blue-300 transition duration-200"}):i.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center group-hover:from-blue-600 group-hover:to-purple-700 transition duration-200",children:i.jsx(yn,{className:"w-5 h-5 text-white"})}),i.jsxs("div",{className:"text-left",children:[i.jsx("h3",{className:"font-semibold text-gray-900 group-hover:text-blue-600 transition duration-200",children:Yn()}),Kn()&&i.jsx("p",{className:"text-sm text-gray-600",children:Kn()}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[i.jsx(Qi,{className:"w-3 h-3"}),i.jsx("span",{children:on(s.createdAt)}),s.updatedAt&&i.jsxs(i.Fragment,{children:[i.jsx("span",{children:""}),i.jsx("span",{className:"text-gray-400",children:"Editado"})]})]})]})]})}),i.jsxs("div",{className:"flex items-center gap-2",children:[In&&i.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full ${In.color}`,children:[i.jsx(In.icon,{className:"w-3 h-3"}),In.label]}),(Le||H)&&i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:()=>_(!v),className:"p-2 hover:bg-gray-100 rounded-lg transition duration-200",children:i.jsx(H4,{className:"w-4 h-4 text-gray-500"})}),v&&i.jsxs("div",{className:"absolute right-0 top-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-10 min-w-[160px]",children:[K&&s.status!=="rejected"&&i.jsxs("button",{onClick:he,className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[i.jsx(ea,{className:"w-3 h-3"}),"Editar"]}),K&&i.jsxs("button",{onClick:me,className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[i.jsx(ta,{className:"w-3 h-3"}),"Eliminar"]}),H&&i.jsxs("button",{onClick:Fe,className:"w-full text-left px-4 py-2 text-sm text-orange-600 hover:bg-orange-50 flex items-center gap-2",children:[i.jsx(eu,{className:"w-3 h-3"}),"Reportar"]}),Ee&&!K&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"border-t border-gray-200 my-1"}),i.jsx("div",{className:"px-3 py-1 text-xs font-medium text-gray-500 bg-gray-50",children:"Moderacin"}),i.jsxs("button",{onClick:Ae,className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[i.jsx(ta,{className:"w-3 h-3"}),"Eliminar como moderador"]}),i.jsxs("button",{onClick:Ie,className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[i.jsx(mr,{className:"w-3 h-3"}),"Banear autor"]})]})]})]})]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-3 break-words",children:s.title}),i.jsx("div",{className:"text-gray-700 whitespace-pre-line break-words leading-relaxed",children:s.content}),s.status==="rejected"&&s.rejectionReason&&i.jsxs("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:[i.jsx("p",{className:"text-sm font-medium text-red-800 mb-1",children:"Motivo de rechazo:"}),i.jsx("p",{className:"text-sm text-red-700",children:s.rejectionReason})]})]}),s.images&&s.images.length>0&&i.jsx("div",{className:"mb-4",children:i.jsx(N8,{images:s.images})}),i.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-100",children:[i.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(xr,{className:"w-4 h-4"}),i.jsxs("span",{children:[s.stats?.commentCount||0," comentarios"]})]})}),(s.status==="active"||Ee)&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:()=>we(E==="like"?"remove":"like"),disabled:s.status!=="active",className:`flex items-center gap-2 px-3 py-2 rounded-lg transition duration-200 ${E==="like"?"bg-red-50 text-red-600 border border-red-200":"text-gray-600 hover:bg-gray-100 border border-transparent"} ${s.status!=="active"?"opacity-50 cursor-not-allowed":""}`,children:[E==="like"?i.jsx(tu,{className:"w-4 h-4"}):i.jsx(Q4,{className:"w-4 h-4"}),i.jsx("span",{className:"text-sm font-medium",children:C.length})]}),i.jsxs("button",{onClick:()=>we(E==="dislike"?"remove":"dislike"),disabled:s.status!=="active",className:`flex items-center gap-2 px-3 py-2 rounded-lg transition duration-200 ${E==="dislike"?"bg-blue-50 text-blue-600 border border-blue-200":"text-gray-600 hover:bg-gray-100 border border-transparent"} ${s.status!=="active"?"opacity-50 cursor-not-allowed":""}`,children:[E==="dislike"?i.jsx(CT,{className:"w-4 h-4"}):i.jsx(kT,{className:"w-4 h-4"}),i.jsx("span",{className:"text-sm font-medium",children:P.length})]}),i.jsxs("button",{onClick:()=>{e&&e(s)},disabled:s.status!=="active",className:`flex items-center gap-2 px-3 py-2 rounded-lg transition duration-200 ${s.status==="active"?"text-gray-600 hover:bg-gray-100 border border-transparent hover:border-gray-200":"opacity-50 cursor-not-allowed"}`,children:[i.jsx(xr,{className:"w-4 h-4"}),i.jsxs("span",{className:"text-sm",children:["Comentar (",s.stats?.commentCount||0,")"]})]})]})]})]}),i.jsx(E8,{isOpen:k,onClose:()=>$(!1),post:s,onPostUpdated:wt}),i.jsx(j8,{isOpen:q,onClose:()=>F(!1),post:s,onPostDeleted:at,isModeratorAction:Ee&&!K}),i.jsx(Qh,{isOpen:R,onClose:()=>j(!1),reportType:"post",targetId:s.id,targetName:s.title})]})}function A8({publicaciones:s,onCommentClick:e}){const n=l=>({id:l.id,title:l.title||l.titulo,content:l.content||l.contenido,authorId:l.authorId,authorName:l.authorName||"T",authorRole:l.authorRole,forumId:l.forumId,forumName:l.tema,createdAt:l.fecha||l.createdAt,likes:l.likes||[],stats:l.stats||{commentCount:l.commentCount||0,likeCount:l.likeCount||0,viewCount:l.viewCount||0},images:l.images||[],status:l.status||"active"}),a=l=>{e&&e(l)};return i.jsxs("div",{className:"space-y-4",children:[s.map(l=>i.jsx(Yg,{post:n(l),showForumInfo:!0,showActions:!0,isProfileView:!0,onCommentClick:()=>a(n(l))},l.id)),s.length===0&&i.jsxs("div",{className:"text-center py-16 bg-white rounded-xl border border-gray-200",children:[i.jsx("div",{className:"text-gray-300 mb-4",children:i.jsx("svg",{className:"w-20 h-20 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),i.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"An no has creado publicaciones"}),i.jsx("p",{className:"text-gray-600 max-w-md mx-auto text-lg",children:"Cuando crees publicaciones en las comunidades, aparecern aqu."})]})]})}function C8({comentarios:s}){const e=n=>{if(!n)return"Fecha no disponible";try{return n.toDate?n.toDate().toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):new Date(n).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Fecha invlida"}};return i.jsx("div",{className:"space-y-4",children:s.map(n=>i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 sm:p-6 hover:shadow-md transition duration-200",children:[i.jsxs("div",{className:"mb-3 pb-3 border-b border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-1",children:[i.jsx(xr,{className:"w-3 h-3 text-blue-500"}),i.jsx("span",{className:"font-medium",children:"Coment en:"})]}),i.jsxs("h4",{className:"text-base font-semibold text-gray-900",children:['"',n.publicacionTitulo,'"']}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[i.jsx(yn,{className:"w-3 h-3"}),i.jsxs("span",{children:["Publicacin de ",n.usuarioPost]})]})]}),i.jsx("div",{className:"mb-4",children:i.jsx("p",{className:"text-gray-700 text-sm sm:text-base leading-relaxed bg-gray-50 rounded-lg p-3 border border-gray-200",children:n.content||n.contenido})}),i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 text-sm text-gray-500",children:[i.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Qi,{className:"w-4 h-4 text-green-500"}),i.jsx("span",{children:e(n.fecha)})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(tu,{className:"w-4 h-4 text-red-500"}),i.jsx("span",{children:n.likes?.length||n.stats?.likeCount||0})]}),n.status==="pending"&&i.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"En revisin"}),n.status==="rejected"&&i.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Rechazado"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs bg-blue-50 px-2 py-1 rounded-full",children:[i.jsx(yn,{className:"w-3 h-3 text-blue-600"}),i.jsx("span",{className:"text-blue-700 font-medium",children:n.usuarioComentarista}),n.rolComentarista&&i.jsxs("span",{className:"text-blue-600",children:[" ",n.rolComentarista]})]})]}),n.replies&&n.replies.length>0&&i.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:i.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[i.jsx(xr,{className:"w-3 h-3"}),i.jsxs("span",{children:[n.replies.length," respuesta(s)"]})]})})]},n.id))})}function R8({temas:s,onTopicClick:e}){const n=l=>{if(!l)return"Fecha no disponible";try{return l.toDate?l.toDate().toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):new Date(l).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})}catch{return"Fecha invlida"}},a=l=>{e&&e(l)};return i.jsx("div",{className:"space-y-4",children:s.map(l=>i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 sm:p-6 hover:shadow-md transition duration-200 cursor-pointer group",onClick:()=>a(l),children:[i.jsxs("div",{className:"flex items-start justify-between mb-4",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-gray-900 mb-2 group-hover:text-blue-600 transition duration-200",children:l.nombre}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 mb-3",children:[i.jsx(Qi,{className:"w-4 h-4 text-green-500"}),i.jsxs("span",{children:["Se uni el ",n(l.fechaUnion)]})]})]}),i.jsx(B4,{className:"w-5 h-5 text-gray-400 group-hover:text-blue-500 transition duration-200 flex-shrink-0 mt-1"})]}),i.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600",children:[i.jsxs("div",{className:"flex items-center gap-2 bg-blue-50 px-3 py-2 rounded-lg",children:[i.jsx(ea,{className:"w-4 h-4 text-blue-600"}),i.jsx("span",{className:"font-medium text-blue-700",children:l.publicaciones}),i.jsx("span",{className:"text-blue-600",children:"publicaciones"})]}),i.jsxs("div",{className:"flex items-center gap-2 bg-green-50 px-3 py-2 rounded-lg",children:[i.jsx(xr,{className:"w-4 h-4 text-green-600"}),i.jsx("span",{className:"font-medium text-green-700",children:l.comentarios}),i.jsx("span",{className:"text-green-600",children:"comentarios"})]}),l.memberCount&&i.jsxs("div",{className:"flex items-center gap-2 bg-purple-50 px-3 py-2 rounded-lg",children:[i.jsx(Tt,{className:"w-4 h-4 text-purple-600"}),i.jsx("span",{className:"font-medium text-purple-700",children:l.memberCount}),i.jsx("span",{className:"text-purple-600",children:"miembros"})]})]}),l.description&&i.jsx("p",{className:"mt-3 text-gray-600 text-sm leading-relaxed",children:l.description}),l.lastActivity&&i.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:i.jsx("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:i.jsxs("span",{children:["ltima actividad: ",n(l.lastActivity)]})})})]},l.id))})}function rw({message:s="Cargando..."}){return i.jsxs("div",{className:"flex flex-col items-center justify-center p-8",children:[i.jsx(ut,{className:"w-8 h-8 text-blue-500 animate-spin mb-4"}),i.jsx("p",{className:"text-gray-600 text-sm",children:s})]})}function Dd({type:s="default",message:e}){const n=()=>{switch(s){case"publicaciones":return i.jsx(ET,{className:"w-12 h-12"});case"comentarios":return i.jsx(xr,{className:"w-12 h-12"});case"temas":return i.jsx(Tt,{className:"w-12 h-12"});default:return i.jsx(Vc,{className:"w-12 h-12"})}},a=()=>{switch(s){case"publicaciones":return"An no has creado ninguna publicacin";case"comentarios":return"An no has realizado ningn comentario";case"temas":return"An no te has unido a ninguna comunidad";default:return e||"No hay datos para mostrar"}},l=()=>{switch(s){case"publicaciones":return"Comienza compartiendo tus conocimientos con la comunidad";case"comentarios":return"Participa en las discusiones de otros profesionales";case"temas":return"Explora comunidades de tu especialidad y nete";default:return""}};return i.jsxs("div",{className:"text-center py-12 px-4",children:[i.jsx("div",{className:"text-gray-300 mb-4 flex justify-center",children:n()}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:a()}),l()&&i.jsx("p",{className:"text-gray-500 text-sm max-w-md mx-auto",children:l()})]})}function D8({activeTab:s,userData:e,onTopicClick:n,onCommentClick:a}){if(!e)return i.jsx("div",{className:"p-6",children:i.jsx(rw,{message:`Cargando ${s}...`})});const u=()=>{switch(s){case"publicaciones":return e.publicaciones&&e.publicaciones.length>0?i.jsx(A8,{publicaciones:e.publicaciones,onCommentClick:a}):i.jsx(Dd,{type:"publicaciones"});case"comentarios":return e.comentarios&&e.comentarios.length>0?i.jsx(C8,{comentarios:e.comentarios}):i.jsx(Dd,{type:"comentarios"});case"temas":return e.temasParticipacion&&e.temasParticipacion.length>0?i.jsx(R8,{temas:e.temasParticipacion,onTopicClick:n}):i.jsx(Dd,{type:"temas"});default:return i.jsx(Dd,{})}};return i.jsx("div",{className:"p-4 sm:p-6",children:u()})}function Ha({icon:s,title:e,value:n,description:a,color:l="bg-gray-50",borderColor:u="border-gray-200",size:h="medium"}){const p={small:"p-3",medium:"p-4",large:"p-5"},g={small:"text-lg",medium:"text-xl",large:"text-2xl"};return i.jsxs("div",{className:`${l} border ${u} rounded-lg ${p[h]} transition duration-200 hover:shadow-sm`,children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s,i.jsx("span",{className:"font-semibold text-gray-900 text-sm",children:e})]}),i.jsx("div",{className:`font-bold text-gray-900 ${g[h]} mb-1`,children:n.toLocaleString()}),a&&i.jsx("div",{className:"text-xs text-gray-600",children:a})]})}function I8({estadisticas:s}){const n=(a=>a>=1e3?{level:"Experto",color:"text-purple-600",bg:"bg-purple-50"}:a>=500?{level:"Avanzado",color:"text-blue-600",bg:"bg-blue-50"}:a>=100?{level:"Intermedio",color:"text-green-600",bg:"bg-green-50"}:{level:"Principiante",color:"text-gray-600",bg:"bg-gray-50"})(s.aura);return i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[i.jsx(Fh,{className:"text-blue-600"}),"Estadsticas"]}),i.jsxs("div",{className:`${n.bg} border ${n.color.replace("text","border")} rounded-lg p-4 mb-6 text-center`,children:[i.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[i.jsx(Hg,{className:`w-5 h-5 ${n.color}`}),i.jsxs("span",{className:`font-semibold ${n.color}`,children:["Nivel ",n.level]})]}),i.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s.aura}),i.jsx("div",{className:"text-sm text-gray-600",children:"Puntos de Aura"})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx(Ha,{icon:i.jsx(tu,{className:"w-5 h-5 text-red-500"}),title:"Aura",value:s.aura,description:"Reputacin en la plataforma",color:"bg-red-50",borderColor:"border-red-200"}),i.jsx(Ha,{icon:i.jsx(xr,{className:"w-5 h-5 text-blue-500"}),title:"Interacciones",value:s.interacciones,description:"Publicaciones + comentarios",color:"bg-blue-50",borderColor:"border-blue-200"}),i.jsx(Ha,{icon:i.jsx(Bh,{className:"w-5 h-5 text-green-500"}),title:"Das en Plataforma",value:s.diasPlataforma,description:"Tiempo como miembro",color:"bg-green-50",borderColor:"border-green-200"}),i.jsx(Ha,{icon:i.jsx(Tt,{className:"w-5 h-5 text-purple-500"}),title:"Comunidades Activas",value:s.temasParticipacion,description:"Comunidades donde participas",color:"bg-purple-50",borderColor:"border-purple-200"}),i.jsx("div",{className:"pt-4 border-t border-gray-200",children:i.jsxs("div",{className:"grid grid-cols-2 gap-3 text-center",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-lg font-bold text-gray-900",children:s.publicaciones||0}),i.jsx("div",{className:"text-xs text-gray-500",children:"Publicaciones"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-lg font-bold text-gray-900",children:s.comentarios||0}),i.jsx("div",{className:"text-xs text-gray-500",children:"Comentarios"})]})]})})]})]})}function M8({isOpen:s,onClose:e,estadisticas:n}){if(!s)return null;const l=(u=>u>=1e3?{level:"Experto",color:"text-purple-600",bg:"bg-purple-50"}:u>=500?{level:"Avanzado",color:"text-blue-600",bg:"bg-blue-50"}:u>=100?{level:"Intermedio",color:"text-green-600",bg:"bg-green-50"}:{level:"Principiante",color:"text-gray-600",bg:"bg-gray-50"})(n.aura);return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-end sm:items-center justify-center p-0 sm:p-4",onClick:e,children:i.jsxs("div",{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",onClick:u=>u.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white rounded-t-2xl",children:[i.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[i.jsx(Fh,{className:"text-blue-600"}),"Estadsticas Detalladas"]}),i.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg transition duration-200",children:i.jsx(At,{className:"w-5 h-5 text-gray-500"})})]}),i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:`${l.bg} border ${l.color.replace("text","border")} rounded-lg p-4 mb-6 text-center`,children:[i.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[i.jsx(Hg,{className:`w-6 h-6 ${l.color}`}),i.jsxs("span",{className:`font-semibold text-lg ${l.color}`,children:["Nivel ",l.level]})]}),i.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-1",children:n.aura}),i.jsx("div",{className:"text-sm text-gray-600",children:"Puntos de Aura Total"})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx(Ha,{icon:i.jsx(tu,{className:"w-6 h-6 text-red-500"}),title:"Aura",value:n.aura,description:"Tu reputacin en la comunidad mdica",color:"bg-red-50",borderColor:"border-red-200",size:"large"}),i.jsx(Ha,{icon:i.jsx(xr,{className:"w-6 h-6 text-blue-500"}),title:"Interacciones Totales",value:n.interacciones,description:"Suma de publicaciones y comentarios",color:"bg-blue-50",borderColor:"border-blue-200",size:"large"}),i.jsx(Ha,{icon:i.jsx(Bh,{className:"w-6 h-6 text-green-500"}),title:"Das en Plataforma",value:n.diasPlataforma,description:"Tiempo como miembro activo",color:"bg-green-50",borderColor:"border-green-200",size:"large"}),i.jsx(Ha,{icon:i.jsx(Tt,{className:"w-6 h-6 text-purple-500"}),title:"Comunidades Activas",value:n.temasParticipacion,description:"Comunidades donde participas",color:"bg-purple-50",borderColor:"border-purple-200",size:"large"})]}),i.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[i.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Desglose de Actividad"}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[i.jsx("div",{className:"text-lg font-bold text-gray-900",children:n.publicaciones||0}),i.jsx("div",{className:"text-gray-600",children:"Publicaciones"})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[i.jsx("div",{className:"text-lg font-bold text-gray-900",children:n.comentarios||0}),i.jsx("div",{className:"text-gray-600",children:"Comentarios"})]})]})]})]})]})})}function Id({message:s,onRetry:e,showHomeButton:n=!1,showProfileButton:a=!1,type:l="error",onHomeClick:u,onProfileClick:h}){const p=()=>{switch(l){case"warning":return i.jsx(an,{className:"w-8 h-8 text-yellow-600"});case"info":return i.jsx(yn,{className:"w-8 h-8 text-blue-600"});default:return i.jsx(an,{className:"w-8 h-8 text-red-600"})}},g=()=>{switch(l){case"warning":return"bg-yellow-50 border-yellow-200";case"info":return"bg-blue-50 border-blue-200";default:return"bg-red-50 border-red-200"}},x=()=>{switch(l){case"warning":return"text-yellow-800";case"info":return"text-blue-800";default:return"text-red-800"}},y=()=>{u&&u()},v=()=>{h&&h()};return i.jsx("div",{className:`rounded-lg shadow-sm border p-6 max-w-md mx-auto ${g()}`,children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-4",children:p()}),i.jsx("h3",{className:`text-lg font-semibold mb-2 ${x()}`,children:l==="warning"?"Advertencia":l==="info"?"Informacin":"Error"}),i.jsx("p",{className:`mb-4 text-sm ${x().replace("800","700")}`,children:s}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center",children:[e&&i.jsxs("button",{onClick:e,className:`inline-flex items-center gap-2 px-4 py-2 rounded-lg transition duration-200 text-sm font-medium ${l==="warning"?"bg-yellow-600 text-white hover:bg-yellow-700":l==="info"?"bg-blue-600 text-white hover:bg-blue-700":"bg-red-600 text-white hover:bg-red-700"}`,children:[i.jsx(AT,{className:"w-4 h-4"}),"Reintentar"]}),n&&i.jsxs("button",{onClick:y,className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition duration-200 text-sm font-medium",children:[i.jsx(TT,{className:"w-4 h-4"}),"Ir al Inicio"]}),a&&i.jsxs("button",{onClick:v,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition duration-200 text-sm font-medium",children:[i.jsx(yn,{className:"w-4 h-4"}),"Mi Perfil"]})]}),l==="error"&&i.jsx("div",{className:"mt-4 p-3 bg-gray-100 rounded-lg",children:i.jsx("p",{className:"text-xs text-gray-600",children:"Si el problema persiste, contacta con soporte tcnico."})})]})})}function k8({onShowForum:s,onShowMain:e,onShowPost:n,userId:a=null}){const[l,u]=V.useState("publicaciones"),[h,p]=V.useState(!1),[g,x]=V.useState(!1),{userData:y,loading:v,error:_,refreshProfile:E}=y8(a),S=!a||a===Ne.currentUser?.uid,A=k=>{s&&k.id&&s({id:k.id,name:k.nombre,description:k.description})},D=()=>{x(!0)},L=k=>{console.log(" Click en comentar post:",k),n?n(k):(console.log("Navegando al post:",k.id),k.forumId&&s&&s({id:k.forumId}))},B=()=>{e&&e()};return!Ne.currentUser&&S?i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsx(Id,{type:"info",message:"Debes iniciar sesin para ver tu perfil",showHomeButton:!0,onHomeClick:B})}):!Ne.currentUser&&!S?i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsx(Id,{type:"info",message:"Debes iniciar sesin para ver perfiles de otros usuarios",showHomeButton:!0,onHomeClick:B})}):v?i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsx(rw,{message:"Cargando perfil..."})}):_?i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsx(Id,{message:_,onRetry:E,showHomeButton:!0,onHomeClick:B})}):y?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"min-h-screen bg-gray-50 py-4 sm:py-8",children:[i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 sm:gap-8",children:[i.jsxs("main",{className:"lg:w-3/4",children:[i.jsx(w8,{userData:y,onShowStats:()=>p(!0),isOwnProfile:S,onReportProfile:D}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 mb-6",children:[i.jsx(_8,{activeTab:l,setActiveTab:u}),i.jsx(D8,{activeTab:l,userData:y,onTopicClick:A,onCommentClick:L})]})]}),i.jsx("aside",{className:"hidden lg:block lg:w-1/4",children:i.jsx("div",{className:"sticky top-24",children:i.jsx(I8,{estadisticas:y.estadisticas})})})]})}),i.jsx(M8,{isOpen:h,onClose:()=>p(!1),estadisticas:y.estadisticas})]}),i.jsx(Qh,{isOpen:g,onClose:()=>x(!1),reportType:"profile",targetId:a||y.id,targetName:y.nombreCompleto||"Usuario"})]}):i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsx(Id,{type:"info",message:"No se pudo cargar la informacin del perfil",showHomeButton:!0,onHomeClick:B,onRetry:E})})}const V8=s=>{const[e,n]=V.useState({forums:[],users:[]}),[a,l]=V.useState(!1),[u,h]=V.useState(null);return V.useEffect(()=>{const p=async()=>{if(!s.trim()){n({forums:[],users:[]});return}l(!0),h(null);try{const[v,_]=await Promise.all([g(s),x(s)]);n({forums:v,users:_})}catch(v){console.error("Error en bsqueda:",v),h("Error al realizar la bsqueda")}finally{l(!1)}},g=async v=>{try{const _=Dt(Me(Y,"forums"),He("isDeleted","==",!1),He("status","==","active"),tl(100));return(await gn(_)).docs.map(D=>({id:D.id,type:"forum",...D.data()})).filter(D=>{const L=v.toLowerCase(),B=D.name?.toLowerCase()||"",k=D.description?.toLowerCase()||"";return B.includes(L)||k.includes(L)}).sort((D,L)=>{const B=D.name?.toLowerCase()||"",k=L.name?.toLowerCase()||"",$=v.toLowerCase(),q=B.startsWith($),F=k.startsWith($);return q&&!F?-1:!q&&F?1:(L.memberCount||0)-(D.memberCount||0)})}catch(_){return console.error("Error buscando forums:",_),[]}},x=async v=>{try{const _=Dt(Me(Y,"users"),He("isDeleted","==",!1),He("isActive","==",!0),tl(50));return(await gn(_)).docs.map(A=>{const D=A.data(),L=`${D.name?.name||""} ${D.name?.apellidopat||""} ${D.name?.apellidomat||""}`.trim();return{id:A.id,type:"user",...D,fullName:L,photoURL:D.photoURL||null,role:D.role||"unverified",professionalInfo:D.professionalInfo||{},stats:D.stats||{}}}).filter(A=>{const D=v.toLowerCase(),L=A.fullName?.toLowerCase()||"",B=A.professionalInfo?.specialty?.toLowerCase()||"";return L.includes(D)||B.includes(D)})}catch(_){return console.error("Error buscando usuarios:",_),[]}},y=setTimeout(p,400);return()=>clearTimeout(y)},[s]),{results:e,loading:a,error:u}};function O8({forums:s,searchQuery:e,onForumClick:n}){if(s.length===0)return i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"text-gray-400 mb-4",children:i.jsx(Tt,{className:"w-16 h-16 mx-auto"})}),i.jsxs("p",{className:"text-gray-500 text-lg mb-2",children:['No se encontraron comunidades relacionadas con "',e,'"']}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Intenta con otros trminos o crea una nueva comunidad"})]});const a=l=>{if(!l)return"Fecha no disponible";try{return l.toDate?l.toDate().toLocaleDateString("es-ES"):new Date(l).toLocaleDateString("es-ES")}catch{return"Fecha invlida"}};return i.jsx("div",{className:"space-y-4",children:s.map(l=>i.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200 hover:border-blue-300 transition duration-200 cursor-pointer group",onClick:()=>n(l),children:i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:i.jsx(Tt,{className:"w-4 h-4 text-green-600"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"font-semibold text-lg text-gray-900 break-words",children:l.name}),i.jsx("p",{className:"text-gray-600 text-sm break-words",children:l.description})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-4 text-xs text-gray-500 mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Tt,{className:"w-3 h-3"}),i.jsxs("span",{children:[l.memberCount||0," miembros"]})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ea,{className:"w-3 h-3"}),i.jsxs("span",{children:[l.postCount||0," publicaciones"]})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Qi,{className:"w-3 h-3"}),i.jsxs("span",{children:["Creado el ",a(l.createdAt)]})]})]})]}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-200 text-sm opacity-0 group-hover:opacity-100",children:"Ver Comunidad"})]})},l.id))})}function P8({users:s,searchQuery:e,onUserClick:n}){if(s.length===0)return i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"text-gray-400 mb-4",children:i.jsx(yn,{className:"w-16 h-16 mx-auto"})}),i.jsxs("p",{className:"text-gray-500 text-lg mb-2",children:['No se encontraron usuarios relacionados con "',e,'"']}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Intenta con otros trminos de bsqueda"})]});const a=u=>{const h="text-xs font-medium px-2 py-1 rounded-full";switch(u){case"doctor":return i.jsx("span",{className:`${h} bg-green-100 text-green-800`,children:"Doctor"});case"admin":return i.jsx("span",{className:`${h} bg-purple-100 text-purple-800`,children:"Administrador"});case"moderator":return i.jsx("span",{className:`${h} bg-blue-100 text-blue-800`,children:"Moderador"});default:return i.jsx("span",{className:`${h} bg-gray-100 text-gray-800`,children:"No Verificado"})}},l=u=>{n&&n(u)};return i.jsx("div",{className:"space-y-4",children:s.map(u=>i.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200 hover:border-blue-300 hover:shadow-md transition duration-200 cursor-pointer group",onClick:()=>l(u),children:i.jsxs("div",{className:"flex items-center space-x-4",children:[u.photoURL?i.jsx("img",{src:u.photoURL,alt:u.fullName,className:"w-12 h-12 rounded-full object-cover border-2 border-blue-100"}):i.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:u.fullName?.split(" ").map(h=>h[0]).join("").slice(0,2)||"US"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[i.jsx("h3",{className:"font-semibold text-gray-900 break-words group-hover:text-blue-600 transition duration-200",children:u.fullName||"Usuario"}),a(u.role)]}),u.professionalInfo?.specialty&&i.jsx("p",{className:"text-gray-600 text-sm mb-2 break-words",children:u.professionalInfo.specialty}),i.jsxs("div",{className:"flex flex-wrap gap-4 text-xs text-gray-500",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Hg,{className:"w-3 h-3 text-yellow-500"}),i.jsxs("span",{children:["Aura: ",u.stats?.aura||0]})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(xr,{className:"w-3 h-3 text-blue-500"}),i.jsxs("span",{children:["Contribuciones: ",u.stats?.contributionCount||0]})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(yn,{className:"w-3 h-3 text-green-500"}),i.jsxs("span",{children:["Comunidades: ",u.stats?.joinedForumsCount||0]})]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-gray-400 text-sm hidden group-hover:block transition duration-200",children:"Ver perfil"}),i.jsx(B4,{className:"w-4 h-4 text-gray-400 group-hover:text-blue-600 transition duration-200"})]})]})},u.id))})}function L8({searchQuery:s,searchType:e="forums",onThemeClick:n,onUserClick:a,onShowUserProfile:l}){const[u,h]=V.useState(e),{results:p,loading:g,error:x}=V8(s),y=A=>{h(A)},v=A=>{n&&n(A)},_=A=>{l&&(A&&A.id?l(A):console.error("El objeto usuario no tiene ID:",A))},E=u==="forums"?p.forums:p.users,S=E.length;return i.jsx("div",{className:"min-h-screen bg-gray-50 py-6",children:i.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[i.jsxs("div",{className:"mb-6",children:[i.jsxs("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:['Resultados de bsqueda: "',s,'"']}),i.jsx("p",{className:"text-gray-600",children:g?"Buscando...":u==="forums"?`Encontramos ${S} comunidades relacionadas`:`Encontramos ${S} usuarios relacionados`})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-6",children:[i.jsxs("div",{className:"flex border-b border-gray-200",children:[i.jsxs("button",{onClick:()=>y("forums"),className:`flex-1 py-4 px-6 text-center font-medium transition duration-200 ${u==="forums"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:["Comunidades (",g?"...":p.forums.length,")"]}),i.jsxs("button",{onClick:()=>y("users"),className:`flex-1 py-4 px-6 text-center font-medium transition duration-200 ${u==="users"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:["Usuarios (",g?"...":p.users.length,")"]})]}),i.jsxs("div",{className:"p-6",children:[x&&i.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:i.jsx("p",{className:"text-red-700 text-sm",children:x})}),g?i.jsx("div",{className:"flex justify-center py-8",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):u==="forums"?i.jsx(O8,{forums:E,searchQuery:s,onForumClick:v}):i.jsx(P8,{users:E,searchQuery:s,onUserClick:_})]})]})]})})}function U8(s){return xe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M3 2h2v20H3zm16 0H6v20h13c1.103 0 2-.897 2-2V4c0-1.103-.897-2-2-2zm-1 10H9v-2h9v2zm0-4H9V6h9v2z"},child:[]}]})(s)}const aw=()=>{const[s,e]=V.useState(!1),[n,a]=V.useState(null);return{updateForumSettings:async(h,p)=>{e(!0),a(null);try{const g=se(Y,"forums",h);return await tt(g,{...p,updatedAt:new Date}),{success:!0}}catch(g){return a(g.message),{success:!1,error:g.message}}finally{e(!1)}},leaveForumAsOwner:async h=>{e(!0);try{const p=se(Y,"forums",h),g=await ve(p);if(!g.exists())throw new Error("Comunidad no encontrada");const x=g.data(),y=x.moderators||{},v=Object.keys(y),_=Object.entries(y).filter(([k,$])=>k!==Ne.currentUser.uid);if(_.length===0)throw new Error("No puedes abandonar la comunidad sin asignar un nuevo dueo. Agrega moderadores primero.");let E=null,S=new Date;for(const[k,$]of _){const q=$.addedAt?.toDate?.()||new Date($.addedAt);q<S&&(S=q,E=k)}if(!E)throw new Error("No se pudo encontrar un moderador para transferir la propiedad");console.log(" TRANSFIRIENDO PROPIEDAD:"),console.log(" - Dueo actual:",Ne.currentUser.uid),console.log(" - Moderadores disponibles:",_.map(k=>k[0])),console.log(" - Nuevo dueo seleccionado:",E);const A=$n(Y);A.update(p,{ownerId:E,[`moderators.${Ne.currentUser.uid}`]:Hn(),members:lr(Ne.currentUser.uid),memberCount:ke(-1)}),await A.commit(),console.log(" Batch commit exitoso");const L=(await ve(p)).data();console.log(" Datos del foro despus:",L),await jn.sendOwnershipTransferred(E,x.name);const B=se(Y,"users",Ne.currentUser.uid);return await tt(B,{"stats.joinedForumsCount":ke(-1),joinedForums:lr(h)}),{success:!0,newOwnerId:E,previousOwnerId:Ne.currentUser.uid}}catch(p){return console.error(" Error en leaveForumAsOwner:",p),a(p.message),{success:!1,error:p.message}}finally{e(!1)}},loading:s,error:n}},iw=()=>{const[s,e]=V.useState(!1),n=async(p,g,x)=>{e(!0);try{const y=se(Y,"posts",p);await tt(y,{status:"active",validatedAt:bt(),validatedBy:Ne.currentUser.uid});const _=(await ve(y)).data();return await jn.sendPostApproved(_.authorId,g,x),{success:!0}}catch(y){return{success:!1,error:y.message}}finally{e(!1)}},a=async(p,g,x,y)=>{e(!0);try{const v=se(Y,"posts",p),_=await ve(v);if(!_.exists())throw new Error("Publicacin no encontrada");const E=_.data(),S=E.authorId,A=$n(Y),D=se(Me(Y,"deleted_posts"),p);if(A.set(D,{...E,id:p,deletedAt:bt(),deletedBy:Ne.currentUser.uid,deleteReason:y,deleteType:"moderator_rejection",originalForumId:g,authorId:S,moderatorAction:!0,rejectionReason:y,statsAtDeletion:{likes:E.likes?.length||0,dislikes:E.dislikes?.length||0,comments:E.stats?.commentCount||0,views:E.stats?.viewCount||0},reportedToGlobal:!0}),A.delete(v),E.status==="active"){const L=se(Y,"forums",g);A.update(L,{postCount:ke(-1)})}if(S){const L=se(Y,"users",S);A.update(L,{"stats.postCount":ke(-1),"stats.contributionCount":ke(-1)})}return await A.commit(),await jn.sendPostRejected(S,g,x,y),await h(S,y,"post_rejected",p),{success:!0}}catch(v){return console.error("Error rechazando post:",v),{success:!1,error:v.message}}finally{e(!1)}},l=async(p,g,x,y=!1)=>{e(!0);try{const v=se(Y,"posts",p),_=await ve(v);if(!_.exists())throw new Error("Publicacin no encontrada");const E=_.data(),S=$n(Y);if(y){const D=se(Me(Y,"deleted_posts"),p);S.set(D,{...E,id:p,deletedAt:bt(),deletedBy:Ne.currentUser.uid,deleteReason:g,deleteType:"moderator_deletion",originalForumId:x,authorId:E.authorId,moderatorAction:!0,statsAtDeletion:{likes:E.likes?.length||0,dislikes:E.dislikes?.length||0,comments:E.stats?.commentCount||0,views:E.stats?.viewCount||0},reportedToGlobal:!0})}S.delete(v);const A=se(Y,"forums",x);if(S.update(A,{postCount:ke(-1)}),E.authorId){const D=se(Y,"users",E.authorId);S.update(D,{"stats.postCount":ke(-1),"stats.contributionCount":ke(-1)})}return await S.commit(),y&&await h(E.authorId,g,"post_deleted_by_moderator",p),{success:!0,savedForAudit:y}}catch(v){return{success:!1,error:v.message}}finally{e(!1)}},u=async p=>{try{const g=Dt(Me(Y,"posts"),He("forumId","==",p),He("status","==","pending"));return(await gn(g)).docs.map(y=>({id:y.id,...y.data()}))}catch(g){return console.error("Error getting pending posts:",g),[]}},h=async(p,g,x,y=null)=>{try{await _n(Me(Y,"global_moderation_reports"),{userId:p,reason:g,moderatorId:Ne.currentUser.uid,actionType:x,postId:y,reportedAt:bt(),status:"pending_review",communityContext:!0,requiresAction:!0,severity:x.includes("rejected")?"medium":"high"})}catch(v){console.error("Error reporting to global moderation:",v)}};return{validatePost:n,rejectPost:a,deletePost:l,getPendingPosts:u,loading:s}},ow=()=>{const[s,e]=V.useState(!1),n=async(h,p,g,x="permanent")=>{e(!0);try{const y=se(Y,"forums",h),_=(await ve(y)).data(),S=(await ve(se(Y,"users",p))).data(),A={userId:p,bannedAt:new Date,bannedBy:Ne.currentUser.uid,reason:g,duration:x,isActive:!0,userEmail:S?.email||"Email no disponible",userName:S?.name?`${S.name.name||""} ${S.name.apellidopat||""} ${S.name.apellidomat||""}`.trim():"Usuario",userRole:S?.role||"unverified",forumId:h,forumName:_.name};return await tt(y,{bannedUsers:Gr(A)}),_.members&&_.members.includes(p)&&await tt(y,{members:lr(p),memberCount:_.memberCount>0?_.memberCount-1:0}),_.moderators&&_.moderators[p]&&await tt(y,{[`moderators.${p}`]:Hn()}),_.pendingMembers&&_.pendingMembers[p]&&await tt(y,{[`pendingMembers.${p}`]:Hn()}),await jn.sendCommunityBan(p,_.name,g,x),await a(p,g,"community_ban",h,_.name),{success:!0,banData:A}}catch(y){return console.error("Error baneando usuario:",y),{success:!1,error:y.message}}finally{e(!1)}},a=async(h,p,g,x=null,y=null)=>{try{await _n(Me(Y,"global_moderation_reports"),{userId:h,reason:p,moderatorId:Ne.currentUser.uid,actionType:g,forumId:x,forumName:y,reportedAt:bt(),status:"pending_review",communityContext:!0,requiresAction:!0,severity:"high"})}catch(v){console.error("Error reporting to global moderation:",v)}};return{banUser:n,isUserBanned:async(h,p)=>{try{const g=se(Y,"forums",h);return((await ve(g)).data().bannedUsers||[]).some(_=>_.userId===p&&_.isActive!==!1)}catch(g){return console.error("Error checking ban status:",g),!1}},getUserBanHistory:async h=>{try{const p=se(Y,"users",h),g=await ve(p);return g.exists()?g.data().banHistory||[]:[]}catch(p){return console.error("Error getting user ban history:",p),[]}},loading:s}},z8=s=>{const[e,n]=V.useState([]),[a,l]=V.useState(!0),[u,h]=V.useState(null);return V.useEffect(()=>{if(!s)return;(async()=>{try{l(!0);const g=se(Y,"forums",s),x=await ve(g);if(!x.exists())throw new Error("Comunidad no encontrada");const y=x.data(),v=y.members||[],_=y.moderators||{},E=y.ownerId,S=[];for(const A of v)try{const D=await ve(se(Y,"users",A));if(D.exists()){const L=D.data();let B="member";A===E?B="owner":_[A]&&(B="moderator"),S.push({id:A,...L,role:B,joinedAt:y.members[A]?.joinedAt||y.createdAt})}}catch(D){console.error(`Error loading user ${A}:`,D)}n(S),h(null)}catch(g){h(g.message)}finally{l(!1)}})()},[s]),{members:e,loading:a,error:u}},B8=(s,e=20)=>{const[n,a]=V.useState([]),[l,u]=V.useState(!0),[h,p]=V.useState(null);return V.useEffect(()=>{if(!s){a([]),u(!1);return}const g=Ne.currentUser,x=async()=>{if(!g)return!1;try{const _=se(Y,"forums",s),E=await ve(_);if(E.exists()){const S=E.data(),A=S.ownerId===g.uid,D=S.moderators&&S.moderators[g.uid];return A||D}}catch(_){console.error("Error verificando permisos:",_)}return!1},y=async()=>{try{const _=await x();let E;return _?E=Dt(Me(Y,"posts"),He("forumId","==",s),He("status","in",["active","pending"]),el("createdAt","desc"),tl(e)):E=Dt(Me(Y,"posts"),He("forumId","==",s),He("status","==","active"),el("createdAt","desc"),tl(e)),zs(E,A=>{try{const D=A.docs.map(L=>({id:L.id,...L.data(),likes:L.data().likes||[],dislikes:L.data().dislikes||[],images:L.data().images||[],status:L.data().status||"active",stats:{commentCount:L.data().stats?.commentCount||0,viewCount:L.data().stats?.viewCount||0}}));a(D),u(!1)}catch(D){console.error("Error cargando posts:",D),p("Error cargando publicaciones"),u(!1)}},A=>{console.error("Error en conexin de posts:",A),p("Error de conexin"),u(!1)})}catch(_){return console.error("Error configurando listener:",_),p("Error de configuracin"),u(!1),()=>{}}};let v=()=>{};return y().then(_=>{_&&(v=_)}),()=>{v()}},[s,e]),{posts:n,loading:l,error:h}};function F8({isOpen:s,onClose:e,forumId:n}){const[a,l]=V.useState([]),[u,h]=V.useState([]),[p,g]=V.useState(!1),[x,y]=V.useState(""),[v,_]=V.useState(""),E=Ne.currentUser;V.useEffect(()=>{s&&n&&S()},[s,n]),V.useEffect(()=>{if(x.trim()==="")h(a);else{const k=a.filter($=>$.userEmail?.toLowerCase().includes(x.toLowerCase())||$.userName?.toLowerCase().includes(x.toLowerCase()));h(k)}},[x,a]);const S=async()=>{try{g(!0),_("");const k=se(Y,"forums",n),$=await ve(k);if(!$.exists()){_("Comunidad no encontrada");return}const q=$.data(),F=[];if(q.members&&Array.isArray(q.members))for(const R of q.members)try{const j=await ve(se(Y,"users",R)),C=j.exists()?j.data():null;let O="member";q.ownerId===R?O="owner":q.moderators&&q.moderators[R]&&(O="moderator"),F.push({userId:R,userEmail:C?.email||"Email no disponible",userName:C?.name?`${C.name.name||""} ${C.name.apellidopat||""} ${C.name.apellidomat||""}`.trim():"Usuario",userRole:C?.role||"unverified",role:O,joinedAt:q.members[R]?.joinedAt||new Date})}catch(j){console.error(`Error cargando usuario ${R}:`,j),F.push({userId:R,userEmail:"Error al cargar",userName:"Usuario",userRole:"unknown",role:"member",joinedAt:new Date})}l(F),h(F)}catch(k){console.error("Error cargando miembros:",k),_("Error cargando los miembros de la comunidad")}finally{g(!1)}},A=async k=>{try{g(!0),_("");const $=se(Y,"forums",n);await tt($,{[`moderators.${k}`]:{addedAt:new Date,addedBy:E.uid}}),await S()}catch($){console.error("Error agregando moderador:",$),_("Error agregando moderador: "+$.message)}finally{g(!1)}},D=async k=>{try{g(!0),_("");const $=se(Y,"forums",n);await tt($,{[`moderators.${k}`]:Hn()}),await S()}catch($){console.error("Error removiendo moderador:",$),_("Error removiendo moderador: "+$.message)}finally{g(!1)}},L=(k,$)=>{const q="text-xs font-medium px-2 py-1 rounded-full";if(k==="owner")return i.jsxs("span",{className:`${q} bg-yellow-100 text-yellow-800 flex items-center gap-1`,children:[i.jsx(Wc,{className:"w-3 h-3"}),"Dueo"]});if(k==="moderator")return i.jsxs("span",{className:`${q} bg-blue-100 text-blue-800 flex items-center gap-1`,children:[i.jsx(Qn,{className:"w-3 h-3"}),"Moderador"]});const F={doctor:"bg-green-100 text-green-800",admin:"bg-purple-100 text-purple-800",moderator:"bg-blue-100 text-blue-800",unverified:"bg-gray-100 text-gray-800"},R={doctor:"Doctor",admin:"Admin",moderator:"Moderador",unverified:"No Verificado"};return i.jsxs("span",{className:`${q} ${F[$]||"bg-gray-100 text-gray-800"}`,children:[i.jsx(yn,{className:"w-3 h-3"}),R[$]||"Usuario"]})},B=k=>{if(!k)return"Fecha no disponible";try{return k.toDate?k.toDate().toLocaleDateString("es-ES"):new Date(k).toLocaleDateString("es-ES")}catch{return"Fecha invlida"}};return s?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-4xl max-h-[80vh] overflow-hidden",onClick:k=>k.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Gestionar Moderadores"}),i.jsx("button",{onClick:e,disabled:p,className:"p-2 hover:bg-gray-100 rounded-lg transition duration-200 disabled:opacity-50",children:i.jsx(At,{className:"w-5 h-5 text-gray-500"})})]}),i.jsxs("div",{className:"p-6",children:[v&&i.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:i.jsx("p",{className:"text-red-700 text-sm",children:v})}),i.jsx("div",{className:"mb-6",children:i.jsxs("div",{className:"relative",children:[i.jsx(Vc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"text",placeholder:"Buscar miembros por nombre o email...",value:x,onChange:k=>y(k.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),i.jsx("div",{className:"max-h-96 overflow-y-auto",children:p&&a.length===0?i.jsx("div",{className:"flex justify-center py-8",children:i.jsx(ut,{className:"w-8 h-8 text-blue-500 animate-spin"})}):u.length===0?i.jsx("div",{className:"text-center py-8 text-gray-500",children:i.jsx("p",{children:"No se encontraron miembros"})}):i.jsx("div",{className:"space-y-3",children:u.map(k=>i.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2 flex-wrap",children:[i.jsx("p",{className:"font-medium text-gray-900 truncate",children:k.userName}),L(k.role,k.userRole)]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600",children:[i.jsx("p",{className:"truncate",children:k.userEmail}),i.jsx("span",{children:""}),i.jsxs("p",{children:["Se uni: ",B(k.joinedAt)]})]})]}),i.jsxs("div",{className:"flex gap-2 ml-4",children:[k.role==="member"&&k.userRole==="doctor"&&i.jsxs("button",{onClick:()=>A(k.userId),disabled:p,className:"p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition duration-200 disabled:opacity-50 flex items-center gap-1 text-sm",title:"Hacer moderador",children:[i.jsx(Gh,{className:"w-4 h-4"}),i.jsx("span",{children:"Hacer Moderador"})]}),k.role==="moderator"&&i.jsxs("button",{onClick:()=>D(k.userId),disabled:p,className:"p-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition duration-200 disabled:opacity-50 flex items-center gap-1 text-sm",title:"Remover como moderador",children:[i.jsx(IT,{className:"w-4 h-4"}),i.jsx("span",{children:"Remover Moderador"})]}),k.role==="owner"&&i.jsx("span",{className:"px-3 py-2 text-sm text-gray-500 italic",children:"Dueo de la comunidad"}),k.role==="member"&&k.userRole!=="doctor"&&i.jsx("span",{className:"px-3 py-2 text-sm text-gray-500 italic",children:"Solo doctores pueden ser moderadores"})]})]},k.userId))})})]}),i.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:[i.jsxs("p",{children:["Total de miembros: ",a.length]}),i.jsxs("p",{children:["Moderadores: ",a.filter(k=>k.role==="moderator").length]}),i.jsxs("p",{children:["Doctores: ",a.filter(k=>k.userRole==="doctor").length]})]}),i.jsx("button",{onClick:e,className:"px-6 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition duration-200 font-medium",children:"Cerrar"})]})})]})}):null}function lw({isOpen:s,onClose:e,forumId:n,forumName:a,requiresPostApproval:l,canPostWithoutApproval:u}){const[h,p]=V.useState({title:"",content:""}),[g,x]=V.useState([]),[y,v]=V.useState(!1),[_,E]=V.useState(""),{createPost:S}=$h(),{uploadImage:A,uploading:D}=sw(),L=q=>{const{name:F,value:R}=q.target;p(j=>({...j,[F]:R})),E("")},B=async q=>{const F=Array.from(q.target.files);if(g.length+F.length>1){E("Mximo 1 imagen");return}for(const R of F){const j=await A(R);j.success&&x(C=>[...C,j.image])}},k=q=>{x(F=>F.filter((R,j)=>j!==q))},$=async q=>{if(q.preventDefault(),!h.title.trim()||!h.content.trim()){E("El ttulo y contenido son obligatorios");return}if(h.content.length<10){E("El contenido debe tener al menos 10 caracteres");return}v(!0),E("");try{const R=await S({...h,forumId:n,images:g,status:l&&!u?"pending":"active"});R.success?(e(),p({title:"",content:""}),x([]),alert(l&&!u?" Tu publicacin ha sido enviada y est pendiente de aprobacin por un moderador.":" Publicacin creada exitosamente.")):E(R.error)}catch{E("Error al crear la publicacin")}finally{v(!1)}};return s?document.body.style.overflow="hidden":document.body.style.overflow="unset",s?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl my-8",onClick:q=>q.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white z-10 rounded-t-2xl",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900 truncate",children:"Crear Publicacin"}),i.jsxs("p",{className:"text-sm text-gray-600 mt-1 truncate",children:["En ",a]}),l&&!u&&i.jsxs("div",{className:"flex items-center gap-2 mt-2 text-amber-600 text-sm",children:[i.jsx(Qn,{className:"w-4 h-4"}),i.jsx("span",{children:"Tu publicacin requerir aprobacin de un moderador"})]})]}),i.jsx("button",{onClick:e,disabled:y,className:"p-2 hover:bg-gray-100 rounded-lg transition duration-200 disabled:opacity-50 flex-shrink-0 ml-2",children:i.jsx(At,{className:"w-5 h-5 text-gray-500"})})]}),i.jsxs("form",{onSubmit:$,className:"flex flex-col max-h-[calc(100vh-100px)]",children:[i.jsx("div",{className:"flex-1 overflow-y-auto",children:i.jsxs("div",{className:"p-6",children:[_&&i.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:i.jsx("p",{className:"text-red-700 text-sm",children:_})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-2",children:"Ttulo *"}),i.jsx("input",{type:"text",id:"title",name:"title",value:h.title,onChange:L,disabled:y,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 disabled:opacity-50",placeholder:"Escribe un ttulo claro y descriptivo...",maxLength:200,required:!0}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[h.title.length,"/200 caracteres"]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-2",children:"Contenido *"}),i.jsx("textarea",{id:"content",name:"content",value:h.content,onChange:L,disabled:y,rows:8,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 resize-none disabled:opacity-50",placeholder:"Comparte tu conocimiento, experiencia, pregunta o caso clnico...",maxLength:1e4,required:!0}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[h.content.length,"/10000 caracteres (mnimo 10)"]})]}),g.length>0&&i.jsxs("div",{className:"mb-6",children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Imgenes (",g.length,"/1)"]}),i.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:g.map((q,F)=>i.jsxs("div",{className:"relative group",children:[i.jsx("img",{src:q.url,alt:`Imagen ${F+1}`,className:"w-full h-24 object-cover rounded-lg border border-gray-200"}),i.jsx("button",{type:"button",onClick:()=>k(F),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:""})]},F))})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Agregar imgenes (opcional)"}),i.jsx("div",{className:"flex gap-3",children:i.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition duration-200 cursor-pointer disabled:opacity-50",children:[i.jsx(G4,{className:"w-4 h-4 text-gray-600"}),i.jsx("span",{className:"text-sm",children:"Subir imagen"}),i.jsx("input",{type:"file",accept:"image/*",onChange:B,disabled:y||D||g.length>=1,className:"hidden"})]})}),i.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Mximo 1 imgen. Formatos: JPEG, PNG, WebP. Tamao mximo: 2MB por imagen."})]}),l&&!u&&i.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(Qn,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium text-amber-800 mb-1",children:"Publicacin pendiente de aprobacin"}),i.jsx("p",{className:"text-xs text-amber-700",children:"Tu publicacin ser revisada por un moderador antes de ser visible para la comunidad. Recibirs una notificacin cuando sea aprobada."})]})]})})]})}),i.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50 sticky bottom-0 rounded-b-2xl",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("p",{className:"text-sm text-gray-500",children:l&&!u?"Tu publicacin ser revisada antes de ser visible":"Tu publicacin ser visible para todos los miembros de la comunidad"}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{type:"button",onClick:e,disabled:y,className:"px-6 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition duration-200 font-medium disabled:opacity-50",children:"Cancelar"}),i.jsxs("button",{type:"submit",disabled:y||D,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition duration-200 font-medium flex items-center gap-2 disabled:opacity-50",children:[(y||D)&&i.jsx(ut,{className:"w-4 h-4 animate-spin"}),y?"Publicando...":D?"Subiendo...":l&&!u?"Enviar para Aprobacin":"Publicar"]})]})]})})]})]})}):null}function q8({isOpen:s,onClose:e,forum:n,onSettingsUpdated:a}){const[l,u]=V.useState({description:"",membershipSettings:{requiresApproval:!1},requiresPostApproval:!1}),{updateForumSettings:h,loading:p,error:g}=aw();V.useEffect(()=>{n&&u({description:n.description||"",membershipSettings:{requiresApproval:n.membershipSettings?.requiresApproval||!1},requiresPostApproval:n.requiresPostApproval||!1})},[n]);const x=async y=>{y.preventDefault(),(await h(n.id,l)).success&&(a&&a(),e())};return V.useEffect(()=>(s?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[s]),s?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md my-8",onClick:y=>y.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white z-10 rounded-t-2xl",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Configuracin de Comunidad"}),i.jsx("button",{onClick:e,disabled:p,className:"p-2 hover:bg-gray-100 rounded-lg transition duration-200 disabled:opacity-50",children:i.jsx(At,{className:"w-5 h-5 text-gray-500"})})]}),i.jsx("div",{className:"max-h-[calc(80vh-120px)] overflow-y-auto",children:i.jsxs("form",{onSubmit:x,className:"p-6",children:[g&&i.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:i.jsx("p",{className:"text-red-700 text-sm",children:g})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descripcin de la comunidad"}),i.jsx("textarea",{value:l.description,onChange:y=>u(v=>({...v,description:y.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200",maxLength:500,placeholder:"Describe el propsito y temas de esta comunidad..."}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[l.description.length,"/500 caracteres"]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Configuracin de Membresa"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("label",{className:`flex items-start gap-3 p-4 border-2 rounded-lg cursor-pointer transition duration-200 ${l.membershipSettings.requiresApproval?"border-gray-300 hover:bg-gray-50":"border-blue-500 bg-blue-50"}`,children:[i.jsx("input",{type:"radio",name:"membershipType",checked:!l.membershipSettings.requiresApproval,onChange:()=>u(y=>({...y,membershipSettings:{requiresApproval:!1}})),className:"text-blue-600 focus:ring-blue-500 mt-1"}),i.jsx(jT,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:"Entrada Libre"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Cualquier usuario puede unirse directamente sin necesidad de aprobacin"})]})]}),i.jsxs("label",{className:`flex items-start gap-3 p-4 border-2 rounded-lg cursor-pointer transition duration-200 ${l.membershipSettings.requiresApproval?"border-blue-500 bg-blue-50":"border-gray-300 hover:bg-gray-50"}`,children:[i.jsx("input",{type:"radio",name:"membershipType",checked:l.membershipSettings.requiresApproval,onChange:()=>u(y=>({...y,membershipSettings:{requiresApproval:!0}})),className:"text-blue-600 focus:ring-blue-500 mt-1"}),i.jsx(gh,{className:"w-5 h-5 text-orange-600 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:"Requiere Aprobacin"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Los usuarios solicitan unirse y necesitan aprobacin de un moderador"})]})]})]})]}),i.jsx("div",{className:"mb-6",children:i.jsxs("label",{className:`flex items-start gap-3 p-4 border-2 rounded-lg cursor-pointer transition duration-200 ${l.requiresPostApproval?"border-blue-500 bg-blue-50":"border-gray-300 hover:bg-gray-50"}`,children:[i.jsx("input",{type:"checkbox",checked:l.requiresPostApproval,onChange:y=>u(v=>({...v,requiresPostApproval:y.target.checked})),className:"text-blue-600 focus:ring-blue-500 rounded mt-1"}),i.jsx(Qn,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:"Validacin de publicaciones"}),i.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Los posts de miembros regulares requieren aprobacin de moderadores.",i.jsx("br",{}),i.jsx("span",{className:"text-blue-600 font-medium",children:"Moderadores y dueos pueden publicar sin validacin."})]})]})]})}),i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(Gg,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Configuracin de moderacin"}),i.jsxs("ul",{className:"text-xs text-blue-700 space-y-1",children:[i.jsx("li",{children:" Los cambios se aplican inmediatamente"}),i.jsx("li",{children:" La validacin de posts ayuda a mantener la calidad del contenido"}),i.jsx("li",{children:" Las comunidades con aprobacin son ideales para grupos especializados"}),i.jsx("li",{children:" Siempre puedes cambiar esta configuracin despus"})]})]})]})})]})}),i.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50 sticky bottom-0 rounded-b-2xl",children:i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{type:"button",onClick:e,disabled:p,className:"flex-1 px-4 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition duration-200 font-medium disabled:opacity-50",children:"Cancelar"}),i.jsxs("button",{type:"submit",onClick:x,disabled:p,className:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition duration-200 font-medium flex items-center justify-center gap-2 disabled:opacity-50",children:[p&&i.jsx(ut,{className:"w-4 h-4 animate-spin"}),"Guardar Cambios"]})]})})]})}):null}function H8({isOpen:s,onClose:e,forumId:n,forumName:a,onPostsValidated:l}){const[u,h]=V.useState([]),[p,g]=V.useState(!0),[x,y]=V.useState({}),[v,_]=V.useState(""),[E,S]=V.useState(null),{getPendingPosts:A,validatePost:D,rejectPost:L}=iw();V.useEffect(()=>{s&&n&&B()},[s,n]);const B=async()=>{g(!0);const F=await A(n),R=await Promise.all(F.map(async j=>{try{const C=await ve(se(Y,"users",j.authorId)),O=C.exists()?C.data():null;return{...j,authorName:O?.name?`${O.name.name||""} ${O.name.apellidopat||""} ${O.name.apellidomat||""}`.trim():"Usuario",authorSpecialty:O?.professionalInfo?.specialty||null}}catch{return{...j,authorName:"Usuario",authorSpecialty:null}}}));h(R),g(!1)},k=async F=>{y(j=>({...j,[F]:"validating"}));const R=await D(F,n,a);R.success?(h(j=>j.filter(C=>C.id!==F)),l&&l()):alert(`Error al validar: ${R.error}`),y(j=>({...j,[F]:null}))},$=async F=>{if(!v.trim()){alert("Por favor proporciona un motivo para el rechazo");return}y(j=>({...j,[F]:"rejecting"}));const R=await L(F,n,a,v);R.success?(h(j=>j.filter(C=>C.id!==F)),_(""),S(null),l&&l()):alert(`Error al rechazar: ${R.error}`),y(j=>({...j,[F]:null}))},q=F=>{if(!F)return"";try{return F.toDate?F.toDate().toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):new Date(F).toLocaleDateString("es-ES")}catch{return"Fecha invlida"}};return V.useEffect(()=>(s?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[s]),s?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 flex-shrink-0",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900 truncate",children:"Validar Publicaciones"}),i.jsxs("p",{className:"text-sm text-gray-600 mt-1 truncate",children:["Revisa y aprueba publicaciones pendientes en ",a,u.length>0&&` - ${u.length} pendiente(s)`]})]}),i.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg transition duration-200 flex-shrink-0 ml-4",children:i.jsx(At,{className:"w-5 h-5 text-gray-500"})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:p?i.jsx("div",{className:"flex justify-center items-center py-12",children:i.jsx(ut,{className:"w-8 h-8 text-blue-500 animate-spin"})}):u.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx(mh,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No hay publicaciones pendientes"}),i.jsx("p",{className:"text-gray-600",children:"Todas las publicaciones han sido revisadas."})]}):i.jsx("div",{className:"space-y-6",children:u.map(F=>i.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 bg-gray-50",children:[i.jsxs("div",{className:"flex items-start justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx(yn,{className:"w-5 h-5 text-blue-600"})}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:F.authorName}),F.authorSpecialty&&i.jsx("p",{className:"text-sm text-gray-600 truncate",children:F.authorSpecialty}),i.jsx("p",{className:"text-xs text-gray-500 truncate",children:q(F.createdAt)})]})]}),i.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 text-sm font-medium rounded-full flex-shrink-0 ml-3",children:"Pendiente"})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("h4",{className:"font-bold text-lg text-gray-900 mb-2 break-words",children:F.title}),i.jsx("div",{className:"text-gray-700 whitespace-pre-line bg-white p-4 rounded-lg border max-h-60 overflow-y-auto",children:F.content})]}),i.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[i.jsxs("button",{onClick:()=>k(F.id),disabled:x[F.id],className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition duration-200 flex items-center justify-center gap-2 font-medium disabled:opacity-50 min-h-[42px]",children:[x[F.id]==="validating"?i.jsx(ut,{className:"w-4 h-4 animate-spin"}):i.jsx(F4,{className:"w-4 h-4"}),"Aprobar"]}),i.jsxs("button",{onClick:()=>S(F.id),disabled:x[F.id],className:"flex-1 bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700 transition duration-200 flex items-center justify-center gap-2 font-medium disabled:opacity-50 min-h-[42px]",children:[i.jsx(At,{className:"w-4 h-4"}),"Rechazar"]})]}),E===F.id&&i.jsxs("div",{className:"mt-4 p-4 bg-white border border-red-200 rounded-lg",children:[i.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:"Motivo del rechazo"}),i.jsx("textarea",{value:v,onChange:R=>_(R.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 resize-none",placeholder:"Explica por qu rechazas esta publicacin...",maxLength:500}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[v.length,"/500 caracteres"]}),i.jsxs("div",{className:"flex gap-3 mt-3",children:[i.jsx("button",{onClick:()=>{S(null),_("")},className:"flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 font-medium",children:"Cancelar"}),i.jsxs("button",{onClick:()=>$(F.id),disabled:!v.trim()||x[F.id],className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-medium flex items-center justify-center gap-2 disabled:opacity-50 min-h-[42px]",children:[x[F.id]==="rejecting"&&i.jsx(ut,{className:"w-4 h-4 animate-spin"}),"Confirmar Rechazo"]})]})]})]},F.id))})}),i.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50 flex-shrink-0",children:i.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-600",children:[i.jsx("span",{className:"truncate",children:u.length===0?"No hay publicaciones pendientes":`${u.length} publicacin(es) pendiente(s)`}),i.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 font-medium whitespace-nowrap",children:"Cerrar"})]})})]})}):null}function cw({isOpen:s,onClose:e,user:n,forumId:a,forumName:l,onUserBanned:u}){const[h,p]=V.useState({reason:"",duration:"7d"}),[g,x]=V.useState(!1),[y,v]=V.useState(""),{banUser:_}=ow(),E=[{value:"1d",label:"1 da",description:"Suspensin temporal"},{value:"7d",label:"7 das",description:"Suspensin por una semana"},{value:"30d",label:"30 das",description:"Suspensin por un mes"},{value:"permanent",label:"Permanente",description:"Baneo definitivo"}],S=async D=>{if(D.preventDefault(),!h.reason.trim()){v("Por favor proporciona un motivo para el baneo");return}if(h.reason.length<10){v("El motivo debe tener al menos 10 caracteres");return}x(!0),v("");try{const L=await _(a,n.id,h.reason,h.duration);L.success?(u&&u(),e(),p({reason:"",duration:"7d"})):v(L.error)}catch{v("Error al banear al usuario")}finally{x(!1)}};if(s?document.body.style.overflow="hidden":document.body.style.overflow="unset",!s||!n)return null;const A=()=>n.name&&(n.name.name||n.name.apellidopat||n.name.apellidomat)?`${n.name.name||""} ${n.name.apellidopat||""} ${n.name.apellidomat||""}`.trim():n.email||"Usuario";return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md my-8",onClick:D=>D.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white z-10 rounded-t-2xl",children:[i.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[i.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx(mr,{className:"w-5 h-5 text-red-600"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 truncate",children:"Banear Usuario"}),i.jsxs("p",{className:"text-sm text-gray-500 truncate",children:["De ",l]})]})]}),i.jsx("button",{onClick:e,disabled:g,className:"p-2 hover:bg-gray-100 rounded-lg transition duration-200 disabled:opacity-50 flex-shrink-0 ml-2",children:i.jsx(At,{className:"w-5 h-5 text-gray-500"})})]}),i.jsx("div",{className:"max-h-[calc(80vh-120px)] overflow-y-auto",children:i.jsxs("form",{onSubmit:S,className:"p-6",children:[y&&i.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:i.jsx("p",{className:"text-red-700 text-sm",children:y})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Usuario a banear:"}),i.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx(yn,{className:"w-5 h-5 text-blue-600"})}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("p",{className:"font-semibold text-gray-900 break-words",children:A()}),i.jsx("p",{className:"text-sm text-gray-600 truncate",children:n.email}),n.role&&i.jsx("span",{className:"inline-block mt-1 px-2 py-1 bg-gray-200 text-gray-700 text-xs rounded-full",children:n.role})]})]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Duracin del baneo"}),i.jsx("div",{className:"grid grid-cols-2 gap-2",children:E.map(D=>i.jsxs("label",{className:`flex flex-col p-3 border rounded-lg cursor-pointer transition duration-200 min-h-[60px] ${h.duration===D.value?"border-red-500 bg-red-50 ring-2 ring-red-500 ring-opacity-50":"border-gray-300 hover:bg-gray-50"}`,children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("input",{type:"radio",name:"duration",value:D.value,checked:h.duration===D.value,onChange:L=>p(B=>({...B,duration:L.target.value})),className:"text-red-600 focus:ring-red-500"}),i.jsx("span",{className:"text-sm font-medium text-gray-900",children:D.label})]}),i.jsx("div",{className:"text-xs text-gray-500",children:D.description})]},D.value))})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-700 mb-2",children:"Motivo del baneo *"}),i.jsx("textarea",{id:"reason",value:h.reason,onChange:D=>p(L=>({...L,reason:D.target.value})),disabled:g,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition duration-200 disabled:opacity-50 resize-none",placeholder:"Explica detalladamente por qu ests baneando a este usuario...",required:!0}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[h.reason.length," caracteres (mnimo 10)"]})]}),i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(mr,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium text-red-800 mb-1",children:"Consecuencias del baneo"}),i.jsxs("ul",{className:"text-xs text-red-700 space-y-1",children:[i.jsx("li",{children:" El usuario ser removido de la comunidad"}),i.jsx("li",{children:" No podr volver a unirse a esta comunidad"}),i.jsx("li",{children:" Se notificar al usuario sobre el baneo"}),i.jsx("li",{children:" El motivo ser revisado por moderacin global"}),h.duration==="permanent"&&i.jsx("li",{children:"  Este baneo es permanente e irreversible"})]})]})]})})]})}),i.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50 sticky bottom-0 rounded-b-2xl",children:i.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[i.jsx("button",{type:"button",onClick:e,disabled:g,className:"px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition duration-200 font-medium disabled:opacity-50 order-2 sm:order-1",children:"Cancelar"}),i.jsxs("button",{type:"submit",onClick:S,disabled:g||h.reason.length<10,className:"px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition duration-200 font-medium flex items-center justify-center gap-2 disabled:opacity-50 order-1 sm:order-2",children:[g&&i.jsx(ut,{className:"w-4 h-4 animate-spin"}),i.jsx(mr,{className:"w-4 h-4"}),"Banear Usuario"]})]})})]})})}function G8({isOpen:s,onClose:e,actions:n}){if(!s)return null;const a=u=>({createPost:i.jsx(ea,{className:"w-5 h-5"}),manageModerators:i.jsx(Qn,{className:"w-5 h-5"}),settings:i.jsx(q4,{className:"w-5 h-5"}),report:i.jsx(eu,{className:"w-5 h-5"}),manageMembers:i.jsx(Tt,{className:"w-5 h-5"}),validatePosts:i.jsx(Wr,{className:"w-5 h-5"}),banUser:i.jsx(mr,{className:"w-5 h-5"}),leave:i.jsx(qh,{className:"w-5 h-5"}),join:i.jsx(Gh,{className:"w-5 h-5"})})[u]||i.jsx(ea,{className:"w-5 h-5"}),l=u=>{const h={primary:"border-blue-500 bg-blue-50 text-blue-700 hover:bg-blue-100",secondary:"border-gray-500 bg-gray-50 text-gray-700 hover:bg-gray-100",danger:"border-red-500 bg-red-50 text-red-700 hover:bg-red-100",success:"border-green-500 bg-green-50 text-green-700 hover:bg-green-100",warning:"border-orange-500 bg-orange-50 text-orange-700 hover:bg-orange-100"};return h[u]||h.secondary};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 lg:hidden flex items-end",children:i.jsxs("div",{className:"w-full bg-white rounded-t-2xl shadow-xl max-h-[80vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 sticky top-0 bg-white",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Acciones"}),i.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg transition duration-200",children:i.jsx(At,{className:"w-5 h-5 text-gray-500"})})]}),i.jsx("div",{className:"grid grid-cols-2 gap-3 p-4",children:n.map((u,h)=>i.jsxs("button",{onClick:()=>{u.onClick(),e()},disabled:u.disabled,className:`p-4 rounded-xl border-2 flex flex-col items-center justify-center gap-3 transition duration-200 min-h-[100px] disabled:opacity-50 disabled:cursor-not-allowed ${l(u.type)}`,children:[a(u.icon),i.jsx("span",{className:"text-sm font-medium text-center leading-tight",children:u.label})]},h))}),i.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:i.jsx("button",{onClick:e,className:"w-full py-3 bg-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-400 transition duration-200",children:"Cerrar"})})]})})}function $8({isOpen:s,onClose:e,forumId:n}){const[a,l]=V.useState([]),[u,h]=V.useState(!0),[p,g]=V.useState({}),[x,y]=V.useState(""),{approveMember:v,rejectMember:_,getForumData:E}=Qg();V.useEffect(()=>{s&&n&&S()},[s,n]);const S=async()=>{try{h(!0),y("");const k=await E(n);if(!k.success){y(k.error);return}const $=k.data,q=[];$.pendingMembers&&Object.entries($.pendingMembers).forEach(([F,R])=>{q.push({userId:F,...R})}),q.sort((F,R)=>{const j=F.requestedAt?.toDate?.()||new Date(F.requestedAt);return(R.requestedAt?.toDate?.()||new Date(R.requestedAt))-j}),l(q)}catch(k){console.error("Error cargando solicitudes:",k),y("Error cargando las solicitudes pendientes")}finally{h(!1)}},A=async k=>{try{g(q=>({...q,[k]:"approving"})),y("");const $=await v(n,k);$.success?l(q=>q.filter(F=>F.userId!==k)):y($.error)}catch{y("Error aprobando la solicitud")}finally{g($=>({...$,[k]:null}))}},D=async k=>{try{g(q=>({...q,[k]:"rejecting"})),y("");const $=await _(n,k);$.success?l(q=>q.filter(F=>F.userId!==k)):y($.error)}catch{y("Error rechazando la solicitud")}finally{g($=>({...$,[k]:null}))}},L=k=>{if(!k)return"Fecha no disponible";try{return k.toDate?k.toDate().toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):new Date(k).toLocaleDateString("es-ES")}catch{return"Fecha invlida"}},B=k=>{const $="text-xs font-medium px-2 py-1 rounded-full",q={doctor:"bg-green-100 text-green-800",admin:"bg-purple-100 text-purple-800",moderator:"bg-blue-100 text-blue-800",unverified:"bg-gray-100 text-gray-800"},F={doctor:"Doctor",admin:"Admin",moderator:"Moderador",unverified:"No Verificado"};return i.jsx("span",{className:`${$} ${q[k]||"bg-gray-100 text-gray-800"}`,children:F[k]||"Usuario"})};return s?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-4xl max-h-[80vh] overflow-hidden",onClick:k=>k.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:i.jsx(Tt,{className:"w-5 h-5 text-orange-600"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Gestionar Solicitudes"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Aprobar o rechazar solicitudes de membresa"})]})]}),i.jsx("button",{onClick:e,disabled:u,className:"p-2 hover:bg-gray-100 rounded-lg transition duration-200 disabled:opacity-50",children:i.jsx(At,{className:"w-5 h-5 text-gray-500"})})]}),i.jsxs("div",{className:"p-6",children:[x&&i.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:i.jsx("p",{className:"text-red-700 text-sm",children:x})}),i.jsx("div",{className:"mb-6",children:i.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(si,{className:"w-4 h-4 text-orange-500"}),i.jsxs("span",{children:[a.length," solicitudes pendientes"]})]})})}),i.jsx("div",{className:"max-h-96 overflow-y-auto",children:u?i.jsx("div",{className:"flex justify-center py-8",children:i.jsx(ut,{className:"w-8 h-8 text-blue-500 animate-spin"})}):a.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"text-gray-400 mb-4",children:i.jsx(Tt,{className:"w-16 h-16 mx-auto"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No hay solicitudes pendientes"}),i.jsx("p",{className:"text-gray-600",children:"Todas las solicitudes han sido procesadas."})]}):i.jsx("div",{className:"space-y-4",children:a.map(k=>i.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2 flex-wrap",children:[i.jsx("p",{className:"font-medium text-gray-900 truncate",children:k.userName}),B(k.userRole)]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600",children:[i.jsx("p",{className:"truncate",children:k.userEmail}),i.jsx("span",{children:""}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(si,{className:"w-3 h-3 text-orange-500"}),i.jsxs("span",{children:["Solicit: ",L(k.requestedAt)]})]})]})]}),i.jsxs("div",{className:"flex gap-2 ml-4 flex-shrink-0",children:[i.jsxs("button",{onClick:()=>A(k.userId),disabled:p[k.userId],className:"p-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition duration-200 disabled:opacity-50 flex items-center gap-1 text-sm",title:"Aprobar solicitud",children:[p[k.userId]==="approving"?i.jsx(ut,{className:"w-4 h-4 animate-spin"}):i.jsx(Hh,{className:"w-4 h-4"}),i.jsx("span",{children:"Aprobar"})]}),i.jsxs("button",{onClick:()=>D(k.userId),disabled:p[k.userId],className:"p-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition duration-200 disabled:opacity-50 flex items-center gap-1 text-sm",title:"Rechazar solicitud",children:[p[k.userId]==="rejecting"?i.jsx(ut,{className:"w-4 h-4 animate-spin"}):i.jsx(MT,{className:"w-4 h-4"}),i.jsx("span",{children:"Rechazar"})]})]})]},k.userId))})})]}),i.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("div",{className:"text-sm text-gray-600",children:i.jsxs("p",{children:["Total de solicitudes: ",a.length]})}),i.jsx("button",{onClick:e,className:"px-6 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition duration-200 font-medium",children:"Cerrar"})]})})]})}):null}function Q8({forumDetails:s,userMembership:e,onBack:n}){const a=u=>{switch(u){case"owner":return i.jsxs("span",{className:"inline-flex items-center gap-1 bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full",children:[i.jsx(Wc,{className:"w-3 h-3"}),"Dueo"]});case"moderator":return i.jsxs("span",{className:"inline-flex items-center gap-1 bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:[i.jsx(Qn,{className:"w-3 h-3"}),"Moderador"]});default:return null}},l=u=>{if(!u)return"Fecha no disponible";try{return u.toDate?u.toDate().toLocaleDateString("es-ES"):new Date(u).toLocaleDateString("es-ES")}catch{return"Fecha invlida"}};return i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4 mb-4",children:[i.jsxs("div",{className:"flex items-start gap-4 flex-1 min-w-0",children:[i.jsx("div",{className:"p-3 rounded-full bg-green-100 flex-shrink-0",children:i.jsx(Tt,{className:"w-6 h-6 text-green-600"})}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2 break-words overflow-hidden",children:s.name}),i.jsx("p",{className:"text-gray-600 text-base sm:text-lg break-words whitespace-normal line-clamp-3 sm:line-clamp-none",children:s.description})]})]}),i.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition duration-200 flex-shrink-0 self-start sm:self-center",children:[i.jsx(qg,{className:"w-4 h-4"}),i.jsx("span",{className:"whitespace-nowrap",children:"Volver"})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-4 sm:gap-6 text-sm text-gray-500 border-t border-gray-200 pt-4",children:[i.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[i.jsx(Qi,{className:"w-4 h-4"}),i.jsxs("span",{className:"whitespace-nowrap",children:["Creado el ",l(s.createdAt)]})]}),i.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[i.jsx(Tt,{className:"w-4 h-4"}),i.jsxs("span",{className:"whitespace-nowrap",children:[(s.memberCount||0).toLocaleString()," miembros"]})]}),i.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[i.jsx(ea,{className:"w-4 h-4"}),i.jsxs("span",{className:"whitespace-nowrap",children:[s.postCount||0," publicaciones"]})]}),e.role&&i.jsx("div",{className:"flex items-center gap-2 flex-shrink-0",children:a(e.role)}),s.requiresPostApproval&&i.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[i.jsx(Wr,{className:"w-4 h-4 text-blue-500"}),i.jsx("span",{className:"whitespace-nowrap",children:"Validacin de posts activa"})]})]})]})}function Y8({requiresApproval:s,hasPendingRequest:e,actionLoading:n,onJoinLeave:a}){return e?i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6 text-center",children:[i.jsx("div",{className:"text-gray-400 mb-4",children:i.jsx(Tt,{className:"w-12 h-12 mx-auto"})}),i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Solicitud Enviada"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"Tu solicitud para unirte a esta comunidad est en revisin. Un moderador la aprobar pronto."}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 inline-flex items-center gap-2",children:[i.jsx(si,{className:"w-4 h-4 text-blue-600"}),i.jsx("span",{className:"text-blue-700 text-sm",children:"Esperando aprobacin"})]})]}):i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6 text-center",children:[i.jsx("div",{className:"text-gray-400 mb-4",children:i.jsx(Tt,{className:"w-12 h-12 mx-auto"})}),i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:s?"Solicitar Unirse a la Comunidad":"Unirse a la Comunidad"}),i.jsx("p",{className:"text-gray-600 mb-4",children:s?"Enva una solicitud para unirte a esta comunidad. Un moderador la revisar pronto.":"nete para poder interactuar y publicar contenido."}),i.jsxs("button",{onClick:a,disabled:n,className:"bg-green-600 text-white py-2 px-6 rounded-lg hover:bg-green-700 transition duration-200 font-medium flex items-center gap-2 mx-auto disabled:opacity-50",children:[n?i.jsx(ut,{className:"w-4 h-4 animate-spin"}):i.jsx(Gh,{className:"w-4 h-4"}),n?"Procesando...":s?"Solicitar Unirse":"Unirse a la Comunidad"]})]})}function K8({canPost:s,canPostWithoutApproval:e,isVerified:n,canReport:a,isOwner:l,isModerator:u,requiresApproval:h,requiresPostApproval:p,pendingRequestsCount:g,pendingPostsCount:x,userMembership:y,actionLoading:v,hasPendingRequest:_,forumDetails:E,isUserBanned:S,onCreatePost:A,onJoinLeave:D,onLeaveAsOwner:L,onReport:B,onManageModerators:k,onManageMembers:$,onSettings:q,onValidatePosts:F}){const R=j=>{if(!j)return"Fecha no disponible";try{return j.toDate?j.toDate().toLocaleDateString("es-ES"):new Date(j).toLocaleDateString("es-ES")}catch{return"Fecha invlida"}};return i.jsxs("div",{className:"sticky top-24 space-y-4",children:[i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[i.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Acciones"}),i.jsxs("div",{className:"space-y-3",children:[S&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-2",children:[i.jsxs("div",{className:"flex items-center gap-2 text-red-800 mb-2",children:[i.jsx(mr,{className:"w-4 h-4"}),i.jsx("span",{className:"font-semibold",children:"Has sido baneado de esta comunidad"})]}),i.jsx("p",{className:"text-sm text-red-700",children:"No puedes unirte, publicar ni interactuar en esta comunidad."})]}),s&&!S&&i.jsxs("button",{onClick:A,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition duration-200 flex items-center justify-center gap-2 font-medium",children:[i.jsx(ea,{className:"w-4 h-4"}),"Crear Publicacin",p&&!e&&i.jsx("span",{className:"text-xs bg-blue-800 px-2 py-1 rounded-full",children:"Requiere aprobacin"})]}),(l||u)&&p&&i.jsxs("button",{onClick:F,className:"w-full bg-orange-600 text-white py-3 px-4 rounded-lg hover:bg-orange-700 transition duration-200 flex items-center justify-center gap-2 font-medium",children:[i.jsx(Wr,{className:"w-4 h-4"}),"Validar Publicaciones",x>0&&i.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full w-6 h-6 flex items-center justify-center",children:x})]}),n&&!y.isMember&&!S&&(_?i.jsxs("div",{className:"w-full bg-blue-50 border border-blue-200 text-blue-700 py-3 px-4 rounded-lg flex items-center justify-center gap-2 font-medium",children:[i.jsx(si,{className:"w-4 h-4"}),"Solicitud Enviada"]}):i.jsxs("button",{onClick:D,disabled:v,className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 transition duration-200 flex items-center justify-center gap-2 font-medium disabled:opacity-50",children:[v?i.jsx(ut,{className:"w-4 h-4 animate-spin"}):i.jsx(Gh,{className:"w-4 h-4"}),v?"Procesando...":h?"Solicitar Unirse":"Unirse a la Comunidad"]})),y.isMember&&!S&&i.jsxs("button",{onClick:l?L:D,disabled:v,className:"w-full bg-red-100 text-red-700 py-3 px-4 rounded-lg hover:bg-red-200 transition duration-200 flex items-center justify-center gap-2 font-medium disabled:opacity-50",children:[i.jsx(qh,{className:"w-4 h-4"}),v?"Procesando...":l?"Transferir y Salir":"Abandonar Comunidad"]}),a&&!S&&i.jsxs("button",{onClick:B,className:"w-full bg-gray-100 text-gray-700 py-3 px-4 rounded-lg hover:bg-gray-200 transition duration-200 flex items-center justify-center gap-2 font-medium",children:[i.jsx(eu,{className:"w-4 h-4"}),"Reportar Comunidad"]}),l&&!S&&i.jsxs("button",{onClick:k,className:"w-full bg-purple-600 text-white py-3 px-4 rounded-lg hover:bg-purple-700 transition duration-200 flex items-center justify-center gap-2 font-medium",children:[i.jsx(Qn,{className:"w-4 h-4"}),"Gestionar Moderadores"]}),l&&!S&&i.jsxs("button",{onClick:q,className:"w-full bg-gray-600 text-white py-3 px-4 rounded-lg hover:bg-gray-700 transition duration-200 flex items-center justify-center gap-2 font-medium",children:[i.jsx(q4,{className:"w-4 h-4"}),"Configuracin"]}),(l||u)&&h&&!S&&i.jsxs("button",{onClick:$,className:"w-full bg-orange-600 text-white py-3 px-4 rounded-lg hover:bg-orange-700 transition duration-200 flex items-center justify-center gap-2 font-medium",children:[i.jsx(Tt,{className:"w-4 h-4"}),"Gestionar Solicitudes",g>0&&i.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full w-6 h-6 flex items-center justify-center",children:g})]}),(l||u)&&!S&&i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[i.jsxs("div",{className:"flex items-center gap-2 text-blue-800 mb-1",children:[i.jsx(Gg,{className:"w-4 h-4"}),i.jsx("span",{className:"text-sm font-medium",children:"Eres moderador"})]}),i.jsxs("p",{className:"text-xs text-blue-700",children:["Tienes acceso a herramientas de moderacin avanzadas.",p&&" Puedes publicar sin validacin."]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[i.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Sobre esta comunidad"}),i.jsxs("div",{className:"space-y-3 text-sm text-gray-600 mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Qi,{className:"w-4 h-4 text-gray-400"}),i.jsxs("span",{children:["Creado el ",R(E.createdAt)]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Tt,{className:"w-4 h-4 text-gray-400"}),i.jsxs("span",{children:[(E.memberCount||0).toLocaleString()," miembros"]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ea,{className:"w-4 h-4 text-gray-400"}),i.jsxs("span",{children:[E.postCount||0," publicaciones"]})]}),h&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(gh,{className:"w-4 h-4 text-orange-400"}),i.jsx("span",{children:"Requiere aprobacin para unirse"})]}),p&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Wr,{className:"w-4 h-4 text-blue-400"}),i.jsx("span",{children:"Validacin de posts activa"})]}),E.isPublic===!1&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(gh,{className:"w-4 h-4 text-red-400"}),i.jsx("span",{children:"Comunidad privada"})]}),S&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(mr,{className:"w-4 h-4 text-red-400"}),i.jsx("span",{className:"text-red-600 font-medium",children:"Ests baneado de esta comunidad"})]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Reglas de la comunidad"}),i.jsx("div",{className:"text-sm text-gray-600 bg-gray-50 rounded-lg p-3 border border-gray-200 break-words whitespace-pre-line",children:E.rules?i.jsx("div",{className:"break-words whitespace-pre-line",children:E.rules}):i.jsxs("p",{className:"text-gray-500 italic",children:[" Respeto hacia todos los miembros",i.jsx("br",{})," Contenido mdico verificado",i.jsx("br",{})," No spam ni autopromocin",i.jsx("br",{})," Confidencialidad de pacientes",i.jsx("br",{})," Lenguaje profesional"]})})]})]})]})}function X8({posts:s,loading:e,error:n,forumId:a,forumName:l,userRole:u,userMembership:h,requiresPostApproval:p,onPostUpdate:g,onDeleteContent:x,onBanUser:y,onCommentClick:v,onShowUserProfile:_,forumData:E}){const[S,A]=V.useState(!1),D=["doctor","moderator","admin"].includes(u);if(e)return i.jsx("div",{className:"flex justify-center py-12",children:i.jsxs("div",{className:"text-center",children:[i.jsx(ut,{className:"w-8 h-8 text-blue-500 animate-spin mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"Cargando publicaciones..."})]})});if(n)return i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"text-red-500 mb-4",children:i.jsx(an,{className:"w-12 h-12 mx-auto"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Error al cargar publicaciones"}),i.jsx("p",{className:"text-gray-600",children:n})]});if(s.length===0)return i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"text-gray-400 mb-4",children:i.jsx(an,{className:"w-16 h-16 mx-auto"})}),i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:D?"No hay publicaciones an":"No hay publicaciones en esta comunidad"}),i.jsx("p",{className:"text-gray-600 mb-6",children:D?"S el primero en compartir contenido en esta comunidad":"Los miembros de esta comunidad an no han publicado contenido"})]});const L=()=>{g&&g()},B=()=>{g&&g()};return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"space-y-4",children:s.map(k=>i.jsx(Yg,{post:k,onCommentClick:v,onPostUpdated:L,onPostDeleted:B,onDeleteContent:x,onBanUser:y,onShowUserProfile:_,userRole:u,userMembership:h,requiresPostApproval:p,forumData:E},k.id))}),D&&i.jsx(lw,{isOpen:S,onClose:()=>A(!1),forumId:a,forumName:l,requiresPostApproval:p,canPostWithoutApproval:h?.role==="owner"||h?.role==="moderator"})]})}function Z8({forumData:s,onBack:e,onShowPost:n,onShowUserProfile:a}){const[l,u]=V.useState({isMember:!1,role:null}),[h,p]=V.useState(null),[g,x]=V.useState(!0),[y,v]=V.useState(!1),[_,E]=V.useState(!1),[S,A]=V.useState(s),[D,L]=V.useState(0),[B,k]=V.useState(!1),[$,q]=V.useState(!1),[F,R]=V.useState(!1),[j,C]=V.useState(!1),[O,P]=V.useState(!1),[U,M]=V.useState(!1),[ue,we]=V.useState(!1),[K,ce]=V.useState(!1),[ge,Ee]=V.useState(!1),[Le,H]=V.useState(!1),[ae,he]=V.useState(null),[me,Ae]=V.useState(null),{joinForum:Ie,leaveForum:Fe,checkUserMembership:wt,getForumData:at,isUserBannedFromForum:on}=Qg(),{leaveForumAsOwner:Yn}=aw(),{getPendingPosts:Kn}=iw(),[os,ln]=V.useState(null);ow(),z8(S.id);const{posts:In,loading:nt,error:Tn}=B8(S.id),it=Ne.currentUser,Qe=l.role==="owner",qe=l.role==="moderator",Ct=l.isMember&&(h?.role==="doctor"||h?.role==="moderator"||h?.role==="admin")&&!B,Es=(Qe||qe)&&!B,Te=!!it&&l.role==="member"&&!B,Pt=h?.role!=="unverified",bn=S.membershipSettings?.requiresApproval,ls=S.requiresPostApproval,yr=S.pendingMembers?Object.keys(S.pendingMembers).length:0;V.useEffect(()=>{it&&ul()},[it]),V.useEffect(()=>{s.id&&br()},[s.id]),V.useEffect(()=>{S.id&&(Qe||qe)&&ls&&(async()=>await oa())()},[S.id,Qe,qe,ls]);const js=async()=>{if(it&&S.id)try{const pe=await on(S.id,it.uid);k(pe),console.log(" Estado de baneo:",pe)}catch(pe){console.error("Error verificando baneo:",pe),k(!1)}},ul=async()=>{try{const pe=await ve(se(Y,"users",it.uid));pe.exists()&&p(pe.data())}catch(pe){console.error("Error cargando userData:",pe)}},br=async()=>{x(!0);try{const pe=await at(s.id);pe.success&&(A(pe.data),it&&pe.data.pendingMembers&&pe.data.pendingMembers[it.uid]?E(!0):E(!1));const Vn=await wt(s.id);u(Vn),await js()}catch(pe){console.error("Error cargando detalles del foro:",pe)}finally{x(!1)}},oa=async()=>{const pe=await Kn(S.id);L(pe.length)},vr=async()=>{if(!it){alert("Debes iniciar sesin para unirte a comunidades");return}if(B){alert("No puedes unirte a esta comunidad porque has sido baneado");return}v(!0);try{if(l.isMember){const pe=await Fe(s.id);pe.success?(u({isMember:!1,role:null}),await Bs()):alert(pe.error)}else{const pe=await Ie(s.id);pe.success?pe.requiresApproval?(alert(" "+pe.message),E(!0),await Bs()):(u({isMember:!0,role:"member"}),await Bs()):alert(pe.error)}}catch{alert("Error al procesar la accin")}finally{v(!1)}},Mn=async()=>{if(!window.confirm("Ests seguro de que quieres abandonar la comunidad? Se transferir la propiedad al moderador ms antiguo."))return;console.log(" Iniciando proceso de transferencia...");const pe=await Yn(S.id);pe.success?(console.log(" Transferencia exitosa:"),console.log(" - Nuevo dueo:",pe.newOwnerId),console.log(" - Dueo anterior:",pe.previousOwnerId),alert("Has abandonado la comunidad. La propiedad ha sido transferida."),await br(),e()):(console.error("Error en transferencia:",pe.error),alert(pe.error))},Jt=(pe,Vn)=>{he({...pe,contentType:Vn}),ce(!0)},kn=pe=>{Ae(pe),Ee(!0)},Rt=pe=>{console.log(" Mostrar perfil de usuario desde ForumView:",pe),a&&a(pe)},Yi=async()=>{await br(),await js()},Bs=async()=>{const pe=await at(s.id);pe.success&&A(pe.data)},Ki=()=>{oa()},cs=[...Ct?[{label:"Crear Publicacin",icon:"createPost",type:"primary",onClick:()=>R(!0)}]:[],...(Qe||qe)&&ls?[{label:`Validar Publicaciones${D>0?` (${D})`:""}`,icon:"validatePosts",type:"warning",onClick:()=>we(!0)}]:[],...Qe&&!B?[{label:"Gestionar Moderadores",icon:"manageModerators",type:"primary",onClick:()=>q(!0)}]:[],...Qe&&!B?[{label:"Configuracin",icon:"settings",type:"secondary",onClick:()=>M(!0)}]:[],...(Qe||qe)&&bn&&!B?[{label:`Gestionar Solicitudes${yr>0?` (${yr})`:""}`,icon:"manageMembers",type:"warning",onClick:()=>P(!0)}]:[],...Te?[{label:"Reportar Comunidad",icon:"report",type:"secondary",onClick:()=>C(!0)}]:[],...Pt&&!l.isMember&&!B?[{label:_?"Solicitud Enviada":bn?"Solicitar Unirse":"Unirse",icon:"join",type:"success",onClick:vr,disabled:_||y}]:[],...l.isMember&&!B?[{label:Qe?"Transferir y Salir":"Abandonar Comunidad",icon:"leave",type:"danger",onClick:Qe?Mn:vr,disabled:y}]:[]].filter(pe=>pe!==null);if(g)return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx(ut,{className:"w-8 h-8 text-blue-500 animate-spin mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"Cargando comunidad..."})]})});const wr=pe=>{n&&n(pe)};return i.jsxs("div",{className:"min-h-screen bg-gray-50 py-6",children:[i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[i.jsxs("main",{className:"lg:w-3/4",children:[i.jsx(Q8,{forumDetails:S,userMembership:l,onBack:e}),!l.isMember&&Pt&&!B&&i.jsx(Y8,{requiresApproval:bn,hasPendingRequest:_,actionLoading:y,onJoinLeave:vr}),i.jsx(X8,{posts:In,loading:nt,error:Tn,forumId:S.id,forumName:S.name,userRole:h?.role,userMembership:l,requiresPostApproval:ls,onPostUpdate:Ki,onDeleteContent:Jt,onBanUser:kn,onCommentClick:wr,onShowUserProfile:Rt,forumData:s})]}),i.jsx("aside",{className:"lg:w-1/4",children:i.jsx(K8,{canPost:Ct,canPostWithoutApproval:Es,isVerified:Pt,canReport:Te,isOwner:Qe,isModerator:qe,requiresApproval:bn,requiresPostApproval:ls,pendingRequestsCount:yr,pendingPostsCount:D,userMembership:l,actionLoading:y,hasPendingRequest:_,forumDetails:S,isUserBanned:B,onCreatePost:()=>R(!0),onJoinLeave:vr,onLeaveAsOwner:Mn,onReport:()=>C(!0),onManageModerators:()=>q(!0),onManageMembers:()=>P(!0),onSettings:()=>M(!0),onValidatePosts:()=>we(!0)})})]})}),i.jsx(F8,{isOpen:$,onClose:()=>q(!1),forumId:S.id}),i.jsx(lw,{isOpen:F,onClose:()=>R(!1),forumId:S.id,forumName:S.name,requiresPostApproval:ls,canPostWithoutApproval:Es}),i.jsx(Qh,{isOpen:j,onClose:()=>C(!1),reportType:"forum",targetId:S.id,targetName:S.name}),i.jsx($8,{isOpen:O,onClose:()=>P(!1),forumId:S.id}),i.jsx(q8,{isOpen:U,onClose:()=>M(!1),forum:S,userRole:l.role,onSettingsUpdated:br}),i.jsx(H8,{isOpen:ue,onClose:()=>we(!1),forumId:S.id,forumName:S.name,onPostsValidated:oa}),i.jsx(cw,{isOpen:ge,onClose:()=>Ee(!1),user:me,forumId:S.id,forumName:S.name,onUserBanned:Yi}),i.jsx(G8,{isOpen:Le,onClose:()=>H(!1),actions:cs}),i.jsx("div",{className:"lg:hidden fixed bottom-6 right-6 z-40",children:i.jsx("button",{onClick:()=>H(!0),className:"w-14 h-14 bg-blue-600 text-white rounded-full shadow-lg hover:bg-blue-700 transition duration-200 flex items-center justify-center",children:i.jsx(U8,{className:"w-6 h-6"})})})]})}function J8({onBack:s}){const[e,n]=V.useState({apellidoPaterno:"",apellidoMaterno:"",nombre:"",especialidad:"",cedula:"",paisCedula:"",universidad:"",anioTitulacion:"",documentoCedula:null}),[a,l]=V.useState(!1),[u,h]=V.useState(""),[p,g]=V.useState(""),[x,y]=V.useState(""),[v,_]=V.useState(!0),[E,S]=V.useState({});V.useEffect(()=>{(async()=>{const F=Ne.currentUser;if(F)try{const R=await ve(se(Y,"users",F.uid));if(R.exists()){const C=R.data().professionalInfo?.verificationStatus;y(C||""),(C==="pending"||C==="verified")&&_(!1)}}catch(R){console.error("Error al verificar estado:",R)}})()},[]);const A=q=>{if(!v)return;const{name:F,value:R,files:j}=q.target,C=L(F,R);S(O=>({...O,[F]:C})),n(F==="documentoCedula"?O=>({...O,documentoCedula:j[0]}):O=>({...O,[F]:R}))},D=async q=>{try{if(!q)throw new Error("No se proporcion ningn archivo");if(!["image/jpeg","image/png","image/jpg"].includes(q.type))throw new Error("Tipo de archivo no permitido. Use JPEG o PNG");const R=2*1024*1024;if(q.size>R)throw new Error("La imagen no puede pesar ms de 2MB");const j=new FormData;j.append("file",q),j.append("upload_preset",ph.uploadPreset);const C=await fetch(`https://api.cloudinary.com/v1_1/${ph.cloudName}/auto/upload`,{method:"POST",body:j});if(!C.ok){const P=await C.text();throw new Error(`Cloudinary error ${C.status}: ${P}`)}const O=await C.json();if(!O.secure_url)throw new Error("Cloudinary no devolvi una URL segura");return console.log("Archivo subido exitosamente:",O.secure_url),O.secure_url}catch(F){throw console.error("Error completo en uploadToCloudinary:",F),F.message.includes("Failed to fetch")?new Error("Error de conexin. Verifica tu internet e intenta nuevamente."):F.message.includes("413")?new Error("El archivo es demasiado grande. Mximo 2MB"):F.message.includes("400")?new Error("Error en la configuracin de Cloudinary. Contacta al administrador."):new Error(`Error al subir el documento: ${F.message}`)}},L=(q,F)=>{switch(q){case"apellidoPaterno":case"apellidoMaterno":case"nombre":if(!/^[A-Za-z\s]{2,30}$/.test(F))return"Solo letras, 2-30 caracteres";break;case"especialidad":case"universidad":case"paisCedula":if(!/^[A-Za-z0-9\s\-\.,]{3,50}$/.test(F))return"Solo letras, nmeros y espacios, 3-50 caracteres";break;case"cedula":if(!/^[A-Za-z0-9]{5,20}$/.test(F))return"Solo nmeros y letras, 5-20 caracteres";break;case"anioTitulacion":const R=parseInt(F),j=new Date().getFullYear();if(R<1950||R>j)return`Ao debe estar entre 1950 y ${j}`;break;default:return null}return null},B=async q=>{if(q.preventDefault(),!v){h("Ya tienes una solicitud de verificacin en proceso.");return}l(!0),h(""),g("");try{const F={};if(Object.keys(e).forEach(O=>{if(O!=="documentoCedula"){const P=L(O,e[O]);P&&(F[O]=P)}}),Object.keys(F).length>0)throw S(F),new Error("Por favor corrige los errores en el formulario");const R=Ne.currentUser;if(!R)throw new Error("No hay usuario autenticado");if(!e.documentoCedula)throw new Error("Debes subir una imagen de tu cdula profesional");const j=await D(e.documentoCedula),C={name:{apellidopat:e.apellidoPaterno,apellidomat:e.apellidoMaterno,name:e.nombre},professionalInfo:{specialty:e.especialidad,licenseNumber:e.cedula,licenseCountry:e.paisCedula,university:e.universidad,titulationYear:parseInt(e.anioTitulacion),licenseDocument:j,verificationStatus:"pending",verifiedAt:null,verifiedBy:null}};await tt(se(Y,"users",R.uid),C),_(!1),y("pending"),g("Solicitud de verificacin enviada! Un moderador revisar tu documentacin."),setTimeout(()=>{s&&s()},3e3)}catch(F){console.error("Error completo en verificacin:",F);let R="Error al enviar la solicitud de verificacin";F.message.includes("Cloudinary")||F.message.includes("subir")?R=F.message:F.message.includes("Firebase")&&(R="Error de conexin con la base de datos. Intenta nuevamente."),h(R)}finally{l(!1)}},k=new Date().getFullYear(),$=()=>{switch(x){case"pending":return i.jsxs("div",{className:"bg-amber-50 border border-amber-200 text-amber-700 px-4 py-3 rounded-lg mb-6",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(si,{className:"w-4 h-4"}),i.jsx("span",{className:"font-medium",children:"Solicitud en revisin"})]}),i.jsx("p",{className:"text-sm mt-1",children:"Tu solicitud de verificacin est siendo revisada por nuestro equipo. Te notificaremos cuando sea procesada."})]});case"verified":return i.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Wr,{className:"w-4 h-4"}),i.jsx("span",{className:"font-medium",children:"Cuenta verificada"})]}),i.jsx("p",{className:"text-sm mt-1",children:"Felicidades! Tu cuenta mdica ha sido verificada exitosamente."})]});case"rejected":return i.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Wr,{className:"w-4 h-4"}),i.jsx("span",{className:"font-medium",children:"Solicitud rechazada"})]}),i.jsx("p",{className:"text-sm mt-1",children:"Tu solicitud fue rechazada. Por favor contacta al administrador para ms informacin."})]});default:return null}};return i.jsx("div",{className:"min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"max-w-2xl mx-auto",children:[i.jsxs("div",{className:"mb-8",children:[i.jsxs("button",{onClick:s,className:"flex items-center gap-2 text-blue-600 hover:text-blue-700 mb-4 transition duration-200",children:[i.jsx(qg,{className:"w-4 h-4"}),i.jsx("span",{children:"Volver al inicio"})]}),i.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Verificacin de Cuenta Mdica"}),i.jsx("p",{className:"text-gray-600",children:"Completa tu informacin profesional para verificar tu cuenta"})]}),$(),u&&i.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:u}),p&&i.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6",children:p}),v?i.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:i.jsxs("form",{onSubmit:B,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[i.jsx(L0,{className:"text-blue-600"}),"Informacin Personal"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Apellido Paterno *"}),i.jsx("input",{type:"text",name:"apellidoPaterno",value:e.apellidoPaterno,onChange:A,required:!0,className:`w-full px-3 py-2 border rounded-lg focus:ring-2  focus:ring-blue-500 focus:border-blue-500 transition duration-200 ${E.apellidoPaterno?"border-red-500":"border-gray-300"}`,placeholder:"Paterno"}),E.apellidoPaterno&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.apellidoPaterno})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Apellido Materno *"}),i.jsx("input",{type:"text",name:"apellidoMaterno",value:e.apellidoMaterno,onChange:A,required:!0,className:`w-full px-3 py-2 border rounded-lg focus:ring-2  focus:ring-blue-500 focus:border-blue-500 transition duration-200 ${E.apellidoMaterno?"border-red-500":"border-gray-300"}`,placeholder:"Materno"}),E.apellidoMaterno&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.apellidoMaterno})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre(s) *"}),i.jsx("input",{type:"text",name:"nombre",value:e.nombre,onChange:A,required:!0,className:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 ${E.nombre?"border-red-500":"border-gray-300"}`,placeholder:"Nombre completo"}),E.nombre&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.nombre})]})]})]}),i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[i.jsx(U0,{className:"text-blue-600"}),"Informacin Profesional"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Especialidad *"}),i.jsx("input",{type:"text",name:"especialidad",value:e.especialidad,onChange:A,required:!0,className:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 ${E.especialidad?"border-red-500":"border-gray-300"}`,placeholder:"Ej: Cardiologa, Pediatra, etc."}),E.especialidad&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.especialidad})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nmero de Cdula *"}),i.jsx("input",{type:"text",name:"cedula",value:e.cedula,onChange:A,required:!0,className:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 ${E.cedula?"border-red-500":"border-gray-300"}`,placeholder:"Nmero de cdula profesional"}),E.cedula&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.cedula})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pas de la Cdula *"}),i.jsx("input",{type:"text",name:"paisCedula",value:e.paisCedula,onChange:A,required:!0,className:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 ${E.paisCedula?"border-red-500":"border-gray-300"}`,placeholder:"Pas donde fue expedida"}),E.paisCedula&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.paisCedula})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Universidad *"}),i.jsx("input",{type:"text",name:"universidad",value:e.universidad,onChange:A,required:!0,className:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 ${E.universidad?"border-red-500":"border-gray-300"}`,placeholder:"Universidad de titulacin"}),E.universidad&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.universidad})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:[i.jsx(Bh,{className:"text-blue-600"}),"Ao de Titulacin *"]}),i.jsx("input",{type:"number",name:"anioTitulacion",value:e.anioTitulacion,onChange:A,required:!0,min:"1950",max:k,className:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 ${E.anioTitulacion?"border-red-500":"border-gray-300"}`,placeholder:"Ej: 2020"}),E.anioTitulacion&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.anioTitulacion}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ao en que obtuviste tu ttulo profesional"})]})]})]}),i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[i.jsx(ib,{className:"text-blue-600"}),"Documento de Verificacin"]}),i.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition duration-200",children:[i.jsx("input",{type:"file",id:"documentoCedula",name:"documentoCedula",onChange:A,accept:"image/*",required:!0,className:"hidden"}),i.jsxs("label",{htmlFor:"documentoCedula",className:"cursor-pointer block",children:[i.jsx(ib,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),i.jsx("p",{className:"text-sm font-medium text-gray-700",children:e.documentoCedula?`Archivo seleccionado: ${e.documentoCedula.name}`:"Sube tu cdula profesional"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"PNG, JPG(Mx. 2MB)"})]})]})]}),i.jsx("div",{className:"pt-4",children:i.jsx("button",{type:"submit",disabled:a||!v,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:a?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Enviando solicitud..."]}):"Enviar Solicitud de Verificacin"})})]})}):i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 text-center",children:[i.jsx(si,{className:"w-16 h-16 text-amber-500 mx-auto mb-4"}),i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Solicitud en Proceso"}),i.jsx("p",{className:"text-gray-600 mb-4",children:x==="pending"?"Tu solicitud de verificacin est siendo revisada por nuestro equipo.":"Ya has completado el proceso de verificacin."}),i.jsx("button",{onClick:s,className:"bg-blue-600 text-white py-2 px-6 rounded-lg font-medium hover:bg-blue-700 transition duration-200",children:"Volver al Inicio"})]}),i.jsxs("div",{className:"mt-6 bg-blue-50 rounded-lg p-4 border border-blue-200",children:[i.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Informacin importante"}),i.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[i.jsx("li",{children:" Tu informacin ser revisada por nuestro equipo"}),i.jsx("li",{children:" Recibirs una notificacin cuando tu cuenta sea verificada"}),i.jsx("li",{children:" Solo puedes enviar una solicitud de verificacin a la vez"})]})]})]})})}const W8=()=>{const[s,e]=V.useState([]),[n,a]=V.useState(!0),[l,u]=V.useState("");return V.useEffect(()=>{const h=Me(Y,"users");return zs(h,g=>{const x=[];g.forEach(y=>{const v=y.data();v.professionalInfo?.verificationStatus==="pending"&&x.push({id:y.id,...v})}),x.sort((y,v)=>{const _=y.joinDate?.seconds||0,E=v.joinDate?.seconds||0;return _-E}),e(x),a(!1)},g=>{console.error("Error fetching requests:",g),u("Error al cargar las solicitudes"),a(!1)})},[]),{requests:s,loading:n,error:l}};function eA({request:s,onUpdate:e,currentAdmin:n}){const[a,l]=V.useState(""),[u,h]=V.useState(!1),[p,g]=V.useState(""),x=async()=>{l("accepting");try{const v=se(Y,"users",s.id);await tt(v,{role:"doctor","professionalInfo.verificationStatus":"verified","professionalInfo.verifiedAt":new Date,"professionalInfo.verifiedBy":n?.email,stats:{aura:0,contributionCount:0,postCount:0,commentCount:0,forumCount:0,joinedForumsCount:0,totalImagesUploaded:0,totalStorageUsed:0},suspension:{isSuspended:!1,reason:null,startDate:null,endDate:null,suspendedBy:null},joinedForums:[],isActive:!0,isDeleted:!1,deletedAt:null});const _=`${s.name?.name} ${s.name?.apellidopat}`;await jn.sendVerificationApproved(s.id,_,n?.email),e(s.id,"accepted"),console.log(`Usuario ${s.id} verificado por: ${n?.email}`)}catch(v){console.error("Error al aceptar solicitud:",v)}finally{l("")}},y=async()=>{if(!p.trim()){alert("Por favor proporciona una razn para el rechazo");return}l("rejecting");try{const v=se(Y,"users",s.id);await tt(v,{"professionalInfo.verificationStatus":"rejected","professionalInfo.verifiedAt":new Date,"professionalInfo.verifiedBy":n?.email,"professionalInfo.rejectionReason":p,name:Hn(),"professionalInfo.specialty":Hn(),"professionalInfo.licenseNumber":Hn(),"professionalInfo.licenseCountry":Hn(),"professionalInfo.university":Hn(),"professionalInfo.titulationYear":Hn(),"professionalInfo.licenseDocument":Hn()});const _=`${s.name?.name} ${s.name?.apellidopat}`;await jn.sendVerificationRejected(s.id,_,p,n?.email),e(s.id,"rejected"),console.log(`Solicitud ${s.id} rechazada por: ${n?.email}`),h(!1),g("")}catch(v){console.error("Error al rechazar solicitud:",v)}finally{l("")}};return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:x,disabled:a,className:"flex items-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition duration-200 disabled:opacity-50 text-sm",children:[a==="accepting"?i.jsx(ut,{className:"w-4 h-4 animate-spin"}):i.jsx(F4,{className:"w-4 h-4"}),"Aceptar"]}),i.jsxs("button",{onClick:()=>h(!0),disabled:a,className:"flex items-center gap-2 px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition duration-200 disabled:opacity-50 text-sm",children:[a==="rejecting"?i.jsx(ut,{className:"w-4 h-4 animate-spin"}):i.jsx(At,{className:"w-4 h-4"}),"Rechazar"]})]}),u&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Razn del Rechazo"}),i.jsx("textarea",{value:p,onChange:v=>g(v.target.value),placeholder:"Explica por qu se rechaza la solicitud...",className:"w-full h-32 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"}),i.jsxs("div",{className:"flex gap-3 mt-4",children:[i.jsx("button",{onClick:()=>{h(!1),g("")},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition duration-200",children:"Cancelar"}),i.jsx("button",{onClick:y,disabled:a==="rejecting"||!p.trim(),className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition duration-200 disabled:opacity-50",children:a==="rejecting"?"Rechazando...":"Confirmar Rechazo"})]})]})})]})}function tA({request:s,onUpdate:e,currentAdmin:n}){const{name:a,email:l,professionalInfo:u,joinDate:h}=s,p=x=>x?new Date(x.seconds*1e3).toLocaleDateString():"N/A",g=()=>{u?.licenseDocument&&window.open(u.licenseDocument,"_blank")};return i.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 hover:shadow-md transition duration-200",children:[i.jsxs("div",{className:"flex items-start justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:i.jsx(yn,{className:"w-6 h-6 text-white"})}),i.jsxs("div",{children:[i.jsxs("h3",{className:"font-semibold text-gray-900 text-lg",children:[a?.name," ",a?.apellidopat," ",a?.apellidomat]}),i.jsx("p",{className:"text-gray-600 text-sm",children:l}),i.jsxs("p",{className:"text-xs text-gray-500",children:["Se uni: ",p(h)]})]})]}),i.jsx(eA,{request:s,onUpdate:e,currentAdmin:n})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(L0,{className:"w-5 h-5 text-blue-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Cdula"}),i.jsx("p",{className:"text-gray-900",children:u?.licenseNumber})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(U0,{className:"w-5 h-5 text-green-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Especialidad"}),i.jsx("p",{className:"text-gray-900",children:u?.specialty})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(U0,{className:"w-5 h-5 text-purple-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Universidad"}),i.jsx("p",{className:"text-gray-900",children:u?.university})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Bh,{className:"w-5 h-5 text-orange-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Ao Titulacin"}),i.jsx("p",{className:"text-gray-900",children:u?.titulationYear})]})]})]}),u?.licenseDocument&&i.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(L0,{className:"w-5 h-5 text-gray-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Documento de Cdula"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Haz clic para ver el documento"})]})]}),i.jsxs("button",{onClick:g,className:"flex items-center gap-2 px-3 py-2 text-blue-600 hover:bg-blue-50 rounded-lg transition duration-200",children:[i.jsx(wT,{className:"w-4 h-4"}),i.jsx("span",{className:"text-sm",children:"Ver"})]})]})]})}function nA(){const{requests:s,loading:e,error:n}=W8(),[a,l]=V.useState(""),[u,h]=V.useState(null),[p,g]=V.useState(!0);V.useEffect(()=>Bc(Ne,v=>{h(v?{uid:v.uid,email:v.email,displayName:v.displayName}:null),g(!1)}),[]);const x=(y,v)=>{u&&console.log(`Usuario ${y} ${v} por: ${u.email}`)};return p?i.jsx("div",{className:"min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8",children:i.jsx("div",{className:"max-w-7xl mx-auto",children:i.jsxs("div",{className:"animate-pulse",children:[i.jsx("div",{className:"h-8 bg-gray-200 rounded w-64 mb-6"}),i.jsx("div",{className:"grid gap-6",children:[1,2,3].map(y=>i.jsx("div",{className:"h-32 bg-gray-200 rounded-xl"},y))})]})})}):u?e?i.jsx("div",{className:"min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8",children:i.jsx("div",{className:"max-w-7xl mx-auto",children:i.jsxs("div",{className:"animate-pulse",children:[i.jsx("div",{className:"h-8 bg-gray-200 rounded w-64 mb-6"}),i.jsx("div",{className:"grid gap-6",children:[1,2,3].map(y=>i.jsx("div",{className:"h-32 bg-gray-200 rounded-xl"},y))})]})})}):n?i.jsx("div",{className:"min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8",children:i.jsx("div",{className:"max-w-7xl mx-auto",children:i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(an,{className:"w-6 h-6 text-red-600"}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-red-800",children:"Error"}),i.jsx("p",{className:"text-red-700",children:n})]})]})})})}):i.jsx("div",{className:"min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"mb-8",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:i.jsx(Tt,{className:"w-6 h-6 text-white"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Solicitudes de Verificacin"}),i.jsx("p",{className:"text-gray-600",children:"Revisa y gestiona las solicitudes de verificacin de mdicos"}),i.jsxs("p",{className:"text-sm text-gray-500",children:["Conectado como: ",u.email]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Solicitudes"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.length})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pendientes"}),i.jsx("p",{className:"text-2xl font-bold text-amber-600",children:s.length})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Administrador"}),i.jsx("p",{className:"text-sm font-bold text-gray-900 truncate",children:u.email})]})]})]}),i.jsx("div",{className:"space-y-6",children:s.length===0?i.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-12 text-center",children:[i.jsx(Tt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No hay solicitudes pendientes"}),i.jsx("p",{className:"text-gray-600",children:"Todas las solicitudes han sido procesadas"})]}):s.map(y=>i.jsx(tA,{request:y,onUpdate:x,currentAdmin:u},y.id))})]})}):i.jsx("div",{className:"min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8",children:i.jsx("div",{className:"max-w-7xl mx-auto",children:i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(an,{className:"w-6 h-6 text-red-600"}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-red-800",children:"Acceso Denegado"}),i.jsx("p",{className:"text-red-700",children:"Debes iniciar sesin para acceder a esta pgina."})]})]})})})})}const sA=(s,e=50)=>{const[n,a]=V.useState([]),[l,u]=V.useState(!0),[h,p]=V.useState(null);return V.useEffect(()=>{if(!s){a([]),u(!1);return}const g=Dt(Me(Y,"comments"),He("postId","==",s),He("isDeleted","==",!1),el("createdAt","asc"),tl(e)),x=zs(g,y=>{try{const v=y.docs.map(_=>({id:_.id,..._.data(),likes:_.data().likes||[],likeCount:_.data().likeCount||0,parentCommentId:_.data().parentCommentId||null,editHistory:_.data().editHistory||[],isDeleted:_.data().isDeleted||!1}));a(v),u(!1)}catch(v){console.error("Error cargando comentarios:",v),p("Error cargando comentarios"),u(!1)}},y=>{console.error("Error en conexin de comentarios:",y),p("Error de conexin"),u(!1)});return()=>x()},[s,e]),{comments:n,loading:l,error:h}},Yh=()=>{const s=Ne.currentUser,e=async g=>{if(!s)throw new Error("Debes iniciar sesin");const x=se(Y,"comments",g),y=await ve(x);if(!y.exists())throw new Error("Comentario no encontrado");const v=y.data(),E=(await ve(se(Y,"users",s.uid))).data(),S=v.authorId===s.uid,A=["moderator","admin"].includes(E?.role);let D=!1;if(v.postId){const L=await ve(se(Y,"posts",v.postId));if(L.exists()){const B=L.data(),k=await ve(se(Y,"forums",B.forumId));if(k.exists()){const $=k.data();D=$.moderators&&$.moderators[s.uid]}}}if(!S&&!A&&!D)throw new Error("No tienes permisos para modificar este comentario");return{commentData:v,userData:E,isAuthor:S,isModeratorOrAdmin:A,isForumModerator:D}},n=async g=>{try{if(!s)throw new Error("Debes iniciar sesin para comentar");const y=(await ve(se(Y,"users",s.uid))).data();if(!["doctor","moderator","admin"].includes(y?.role))throw new Error("Solo usuarios verificados pueden comentar");const v={content:g.content,authorId:s.uid,postId:g.postId,parentCommentId:g.parentCommentId||null,likes:[],likeCount:0,isDeleted:!1,createdAt:bt(),updatedAt:null,editHistory:[]},_=await _n(Me(Y,"comments"),v);return await tt(se(Y,"posts",g.postId),{"stats.commentCount":ke(1)}),await tt(se(Y,"users",s.uid),{"stats.commentCount":ke(1),"stats.contributionCount":ke(1)}),{success:!0,commentId:_.id}}catch(x){return console.error("Error creando comentario:",x),{success:!1,error:x.message}}},a=async(g,x)=>{try{const{commentData:y,isAuthor:v}=await e(g);if(!v)throw new Error("Solo el autor puede editar el comentario");const _=se(Y,"comments",g),E=$n(Y),S={previousContent:y.content,editedAt:bt(),editedBy:s.uid};return E.update(_,{content:x,updatedAt:bt(),editHistory:Gr(S)}),await E.commit(),{success:!0}}catch(y){return console.error("Error editando comentario:",y),{success:!1,error:y.message}}},l=async(g,x=!1)=>{try{const{commentData:y}=await e(g);return await h(g,x)}catch(y){return console.error("Error eliminando comentario:",y),{success:!1,error:y.message}}},u=async g=>{try{if(!s)throw new Error("Debes iniciar sesin");const x=se(Y,"comments",g),y=await ve(x);if(!y.exists())throw new Error("Comentario no encontrado");const v=y.data(),_=v.authorId,S=(v.likes||[]).includes(s.uid),A=$n(Y);return S?(A.update(x,{likes:lr(s.uid),likeCount:ke(-1)}),_!==s.uid&&A.update(se(Y,"users",_),{"stats.aura":ke(-1)})):(A.update(x,{likes:Gr(s.uid),likeCount:ke(1)}),_!==s.uid&&A.update(se(Y,"users",_),{"stats.aura":ke(1)})),await A.commit(),{success:!0,liked:!S}}catch(x){return console.error("Error en like del comentario:",x),{success:!1,error:x.message}}},h=async(g,x=!1)=>{try{const{commentData:y,isAuthor:v,isModeratorOrAdmin:_,isForumModerator:E}=await e(g),S=$n(Y);let A=0;const D=async(L,B)=>{const k=Dt(Me(Y,"comments"),He("parentCommentId","==",L),He("isDeleted","==",!1)),q=(await gn(k)).docs;let F=0;for(const C of q)F+=await D(C.id,B);const R=se(Y,"comments",L),j=await ve(R);if(j.exists()){const C=j.data();x||!v&&(_||E)?B.update(R,{isDeleted:!0,deletedAt:bt(),deletedBy:s.uid,moderatorDelete:!0,deletedContent:C.content}):B.update(R,{isDeleted:!0,deletedAt:bt(),deletedContent:C.content});const O=C.authorId;O===s.uid?B.update(se(Y,"users",O),{"stats.commentCount":ke(-1),"stats.contributionCount":ke(-1)}):x&&B.update(se(Y,"users",O),{"stats.commentCount":ke(-1),"stats.contributionCount":ke(-1),"stats.warnings":ke(1)})}return 1+F};return A=await D(g,S),S.update(se(Y,"posts",y.postId),{"stats.commentCount":ke(-A)}),await S.commit(),{success:!0,deletionType:v?"user":"moderator",deletedCount:A}}catch(y){return console.error("Error eliminando comentario con respuestas:",y),{success:!1,error:y.message}}},p=async g=>{try{const x=Dt(Me(Y,"comments"),He("parentCommentId","==",g),He("isDeleted","==",!1)),y=await gn(x);let v=y.size;for(const _ of y.docs)v+=await p(_.id);return v}catch(x){return console.error("Error contando respuestas:",x),0}};return{createComment:n,editComment:a,deleteComment:l,deleteCommentWithReplies:h,countCommentReplies:p,likeComment:u}},rA=s=>{const[e,n]=V.useState([]),[a,l]=V.useState(0),[u,h]=V.useState(!1),[p,g]=V.useState(!0),x=Ne.currentUser;return V.useEffect(()=>{if(!s){n([]),l(0),h(!1),g(!1);return}const y=se(Y,"comments",s),v=zs(y,_=>{if(_.exists()){const E=_.data(),S=E.likes||[],A=E.likeCount||0;n(S),l(A),h(x?S.includes(x.uid):!1)}g(!1)});return()=>v()},[s,x]),{likes:e,likeCount:a,userLiked:u,loading:p}};function aA({isOpen:s,onClose:e,comment:n,onCommentUpdated:a}){const[l,u]=V.useState(""),[h,p]=V.useState(!1),[g,x]=V.useState(""),[y,v]=V.useState(!1),{editComment:_}=Yh();V.useEffect(()=>{n&&u(n.content||"")},[n]);const E=async A=>{if(A.preventDefault(),!l.trim()){x("El contenido del comentario es obligatorio");return}if(l.length<2){x("El comentario debe tener al menos 2 caracteres");return}if(l.length>1e3){x("El comentario no puede tener ms de 1000 caracteres");return}if(l===n.content){x("No hay cambios para guardar");return}p(!0),x("");try{const D=await _(n.id,l.trim());D.success?(a&&a(),e()):x(D.error)}catch{x("Error al actualizar el comentario")}finally{p(!1)}},S=A=>{if(!A)return"";try{return A.toDate?A.toDate().toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):new Date(A).toLocaleDateString("es-ES")}catch{return"Fecha invlida"}};return s?document.body.style.overflow="hidden":document.body.style.overflow="unset",!s||!n?null:i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl my-8",onClick:A=>A.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white z-10 rounded-t-2xl",children:[i.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx(DT,{className:"w-5 h-5 text-blue-600"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 truncate",children:"Editar Comentario"}),i.jsx("p",{className:"text-sm text-gray-500 truncate",children:"Actualiza tu comentario"})]})]}),i.jsx("button",{onClick:e,disabled:h,className:"p-2 hover:bg-gray-100 rounded-lg transition duration-200 disabled:opacity-50 flex-shrink-0 ml-2",children:i.jsx(At,{className:"w-5 h-5 text-gray-500"})})]}),i.jsxs("form",{onSubmit:E,className:"flex flex-col max-h-[calc(100vh-100px)]",children:[i.jsx("div",{className:"flex-1 overflow-y-auto",children:i.jsxs("div",{className:"p-6",children:[g&&i.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:i.jsx("p",{className:"text-red-700 text-sm",children:g})}),n.editHistory&&n.editHistory.length>0&&i.jsx("div",{className:"mb-4",children:i.jsxs("button",{type:"button",onClick:()=>v(!y),className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition duration-200",children:[i.jsx(ST,{className:"w-4 h-4"}),i.jsxs("span",{children:["Ver historial de ediciones (",n.editHistory.length,")"]})]})}),y&&n.editHistory&&n.editHistory.length>0&&i.jsxs("div",{className:"mb-6 bg-gray-50 border border-gray-200 rounded-lg p-4",children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Historial de Ediciones"}),i.jsx("div",{className:"space-y-3 max-h-40 overflow-y-auto",children:n.editHistory.map((A,D)=>i.jsxs("div",{className:"text-sm border-l-2 border-blue-500 pl-3",children:[i.jsxs("div",{className:"text-gray-500 mb-1",children:["Editado el ",S(A.editedAt)]}),i.jsx("div",{className:"text-gray-700 bg-white p-2 rounded border",children:A.previousContent})]},D))})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-2",children:"Comentario *"}),i.jsx("textarea",{id:"content",value:l,onChange:A=>u(A.target.value),disabled:h,rows:6,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 resize-none disabled:opacity-50",placeholder:"Escribe tu comentario aqu...",maxLength:1e3,required:!0}),i.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[i.jsxs("span",{children:["Soporte para ",i.jsx("strong",{children:"**negritas**"})," y ",i.jsx("em",{children:"*cursivas*"})]}),i.jsxs("span",{children:[l.length,"/1000"]})]})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Informacin importante"}),i.jsxs("ul",{className:"text-xs text-blue-700 space-y-1",children:[i.jsx("li",{children:" Esta edicin quedar registrada en el historial"}),i.jsx("li",{children:" Los cambios sern visibles inmediatamente"}),i.jsx("li",{children:" No puedes editar comentarios de otros usuarios"}),i.jsx("li",{children:" Mantn un lenguaje profesional y respetuoso"})]})]})]})}),i.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50 sticky bottom-0 rounded-b-2xl",children:i.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[i.jsx("button",{type:"button",onClick:e,disabled:h,className:"px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition duration-200 font-medium disabled:opacity-50 order-2 sm:order-1",children:"Cancelar"}),i.jsxs("button",{type:"submit",disabled:h||l.length<2||l===n.content,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition duration-200 font-medium flex items-center justify-center gap-2 disabled:opacity-50 order-1 sm:order-2",children:[h&&i.jsx(ut,{className:"w-4 h-4 animate-spin"}),"Guardar Cambios"]})]})})]})]})})}function iA({isOpen:s,onClose:e,comment:n,onCommentDeleted:a,isModeratorAction:l=!1}){const[u,h]=V.useState(!1),[p,g]=V.useState(""),{deleteComment:x}=Yh(),y=async E=>{E.preventDefault(),h(!0),g("");try{const S=await x(n.id,l);S.success?(a&&a(S.deletionType),e(),alert(l?" Comentario eliminado por moderacin.":" Comentario eliminado.")):g(S.error)}catch{g("Error al eliminar el comentario")}finally{h(!1)}};if(s?document.body.style.overflow="hidden":document.body.style.overflow="unset",!s||!n)return null;const v=()=>l?"Eliminar Comentario (Moderacin)":"Eliminar Comentario",_=()=>l?"Esta accin se registrar para auditora del sistema":"Ests seguro de que quieres eliminar este comentario?";return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md my-8",onClick:E=>E.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white z-10 rounded-t-2xl",children:[i.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[i.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 ${l?"bg-red-100":"bg-orange-100"}`,children:l?i.jsx(Qn,{className:"w-5 h-5 text-red-600"}):i.jsx(an,{className:"w-5 h-5 text-orange-600"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 truncate",children:v()}),i.jsx("p",{className:"text-sm text-gray-500 truncate",children:_()})]})]}),i.jsx("button",{onClick:e,disabled:u,className:"p-2 hover:bg-gray-100 rounded-lg transition duration-200 disabled:opacity-50 flex-shrink-0 ml-2",children:i.jsx(At,{className:"w-5 h-5 text-gray-500"})})]}),i.jsx("div",{className:"max-h-[calc(80vh-120px)] overflow-y-auto",children:i.jsxs("form",{onSubmit:y,className:"p-6",children:[p&&i.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:i.jsx("p",{className:"text-red-700 text-sm",children:p})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Comentario a eliminar:"}),i.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:[i.jsx("div",{className:"text-sm text-gray-700 line-clamp-3 break-words",children:n.content}),i.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Creado el: ",n.createdAt?.toDate?.().toLocaleDateString("es-ES")||"Fecha no disponible"]})]})]}),i.jsx("div",{className:`border rounded-lg p-4 mb-6 ${l?"bg-red-50 border-red-200":"bg-orange-50 border-orange-200"}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(an,{className:`w-5 h-5 mt-0.5 flex-shrink-0 ${l?"text-red-600":"text-orange-600"}`}),i.jsxs("div",{children:[i.jsx("h4",{className:`text-sm font-medium mb-1 ${l?"text-red-800":"text-orange-800"}`,children:l?"Accin de moderacin":"Eliminacin permanente"}),i.jsx("ul",{className:`text-xs space-y-1 ${l?"text-red-700":"text-orange-700"}`,children:l?i.jsxs(i.Fragment,{children:[i.jsx("li",{children:" El comentario se marcar como eliminado por moderacin"}),i.jsx("li",{children:" El autor ser notificado sobre la eliminacin"}),i.jsx("li",{children:" La accin quedar registrada en el sistema"}),i.jsx("li",{children:" Puede conllevar sanciones para el autor"})]}):i.jsxs(i.Fragment,{children:[i.jsx("li",{children:" El comentario ser eliminado permanentemente"}),i.jsx("li",{children:" No podrs recuperar este comentario"}),i.jsx("li",{children:" Las respuestas a este comentario tambin se eliminarn"}),i.jsx("li",{children:" Esta accin no se puede deshacer"})]})})]})]})})]})}),i.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50 sticky bottom-0 rounded-b-2xl",children:i.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[i.jsx("button",{type:"button",onClick:e,disabled:u,className:"px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition duration-200 font-medium disabled:opacity-50 order-2 sm:order-1",children:"Cancelar"}),i.jsxs("button",{type:"submit",onClick:y,disabled:u,className:`px-6 py-3 rounded-lg transition duration-200 font-medium flex items-center justify-center gap-2 disabled:opacity-50 order-1 sm:order-2 ${l?"bg-red-600 text-white hover:bg-red-700":"bg-orange-600 text-white hover:bg-orange-700"}`,children:[u&&i.jsx(ut,{className:"w-4 h-4 animate-spin"}),i.jsx(ta,{className:"w-4 h-4"}),l?"Eliminar como Moderador":"Eliminar Comentario"]})]})})]})})}function uw({isOpen:s,onClose:e,postId:n,postTitle:a,parentCommentId:l=null,onCommentCreated:u}){const[h,p]=V.useState(""),[g,x]=V.useState(!1),[y,v]=V.useState(""),{createComment:_}=Yh(),E=async A=>{if(A.preventDefault(),!h.trim()){v("El contenido del comentario es obligatorio");return}if(h.length<2){v("El comentario debe tener al menos 2 caracteres");return}if(h.length>1e3){v("El comentario no puede tener ms de 1000 caracteres");return}x(!0),v("");try{const D=await _({content:h.trim(),postId:n,parentCommentId:l});D.success?(u&&u(),e(),p("")):v(D.error)}catch{v("Error al crear el comentario")}finally{x(!1)}};if(s?document.body.style.overflow="hidden":document.body.style.overflow="unset",!s)return null;const S=()=>l?"Responder Comentario":`Comentar en: ${a}`;return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md my-8",onClick:A=>A.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white z-10 rounded-t-2xl",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 truncate",children:S()}),i.jsx("p",{className:"text-sm text-gray-500 mt-1 truncate",children:l?"Responde a este comentario":"Comparte tu opinin o conocimiento"})]}),i.jsx("button",{onClick:e,disabled:g,className:"p-2 hover:bg-gray-100 rounded-lg transition duration-200 disabled:opacity-50 flex-shrink-0 ml-2",children:i.jsx(At,{className:"w-5 h-5 text-gray-500"})})]}),i.jsxs("form",{onSubmit:E,className:"flex flex-col max-h-[calc(100vh-100px)]",children:[i.jsx("div",{className:"flex-1 overflow-y-auto",children:i.jsxs("div",{className:"p-6",children:[y&&i.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:i.jsx("p",{className:"text-red-700 text-sm",children:y})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-2",children:"Tu comentario *"}),i.jsx("textarea",{id:"content",value:h,onChange:A=>p(A.target.value),disabled:g,rows:6,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 resize-none disabled:opacity-50",placeholder:"Escribe tu comentario aqu",maxLength:1e3,required:!0}),i.jsx("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:i.jsxs("span",{children:[h.length,"/1000"]})})]})]})}),i.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50 sticky bottom-0 rounded-b-2xl",children:i.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[i.jsx("button",{type:"button",onClick:e,disabled:g,className:"px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition duration-200 font-medium disabled:opacity-50 order-2 sm:order-1",children:"Cancelar"}),i.jsxs("button",{type:"submit",disabled:g||h.length<2,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition duration-200 font-medium flex items-center justify-center gap-2 disabled:opacity-50 order-1 sm:order-2",children:[g&&i.jsx(ut,{className:"w-4 h-4 animate-spin"}),l?"Responder":"Publicar Comentario"]})]})})]})]})})}const oA=()=>{const[s,e]=V.useState(!1),n=async(x,y,v)=>{e(!0);try{const _=se(Y,"comments",x);await tt(_,{status:"active",validatedAt:bt(),validatedBy:Ne.currentUser.uid});const S=(await ve(_)).data();return await jn.sendCommentApproved(S.authorId,y,v),{success:!0}}catch(_){return{success:!1,error:_.message}}finally{e(!1)}},a=async(x,y,v,_)=>{e(!0);try{const E=se(Y,"comments",x),S=await ve(E);if(!S.exists())throw new Error("Comentario no encontrado");const A=S.data(),D=A.authorId,L=A.postId,B=$n(Y),k=se(Me(Y,"deleted_comments"),x);if(B.set(k,{...A,id:x,deletedAt:bt(),deletedBy:Ne.currentUser.uid,deleteReason:_,deleteType:"moderator_rejection",originalPostId:L,originalForumId:y,authorId:D,moderatorAction:!0,rejectionReason:_,statsAtDeletion:{likes:A.likes?.length||0,likeCount:A.likeCount||0},reportedToGlobal:!0}),B.update(E,{isDeleted:!0,deletedAt:bt(),deletedBy:Ne.currentUser.uid,moderatorDelete:!0,deletionReason:_}),L){const $=se(Y,"posts",L);B.update($,{"stats.commentCount":ke(-1)})}if(D){const $=se(Y,"users",D);B.update($,{"stats.commentCount":ke(-1),"stats.contributionCount":ke(-1),"stats.warnings":ke(1)})}return await B.commit(),await jn.sendCommentRejected(D,y,v,_),await g(D,_,"comment_rejected",x),{success:!0}}catch(E){return console.error("Error rechazando comentario:",E),{success:!1,error:E.message}}finally{e(!1)}},l=async(x,y,v,_=!1,E=!0)=>{e(!0);try{const S=se(Y,"comments",x),A=await ve(S);if(!A.exists())throw new Error("Comentario no encontrado");const D=A.data(),L=D.authorId,B=D.postId,k=$n(Y),$=async(q,F)=>{const R=Dt(Me(Y,"comments"),He("parentCommentId","==",q),He("isDeleted","==",!1)),j=await gn(R);for(const P of j.docs)await $(P.id,F);const C=se(Y,"comments",q),O=await ve(C);if(O.exists()){const P=O.data(),U=P.authorId;if(_){const M=se(Me(Y,"deleted_comments"),q);F.set(M,{...P,id:q,deletedAt:bt(),deletedBy:Ne.currentUser.uid,deleteReason:y,deleteType:"moderator_deletion",originalPostId:B,originalForumId:v,authorId:U,moderatorAction:!0,statsAtDeletion:{likes:P.likes?.length||0,likeCount:P.likeCount||0},reportedToGlobal:!0})}if(F.update(C,{isDeleted:!0,deletedAt:bt(),deletedBy:Ne.currentUser.uid,moderatorDelete:_,deletionReason:y}),U){const M=se(Y,"users",U);F.update(M,{"stats.commentCount":ke(-1),"stats.contributionCount":ke(-1),..._&&{"stats.warnings":ke(1)}})}}};if(await $(x,k),B){const q=1+await p(x),F=se(Y,"posts",B);k.update(F,{"stats.commentCount":ke(-q)})}return await k.commit(),_&&(await jn.sendCommentDeletedByModerator(L,v,y),await g(L,y,"comment_deleted_by_moderator",x)),{success:!0,savedForAudit:_,deletedCount:1+await p(x)}}catch(S){return{success:!1,error:S.message}}finally{e(!1)}},u=async x=>{try{const y=Dt(Me(Y,"posts"),He("forumId","==",x)),_=(await gn(y)).docs.map(A=>A.id);if(_.length===0)return[];const E=Dt(Me(Y,"comments"),He("postId","in",_),He("status","==","pending"));return(await gn(E)).docs.map(A=>({id:A.id,...A.data()}))}catch(y){return console.error("Error getting pending comments:",y),[]}},h=async x=>{try{const y=Dt(Me(Y,"posts"),He("forumId","==",x)),_=(await gn(y)).docs.map(A=>A.id);if(_.length===0)return[];const E=Dt(Me(Y,"comments"),He("postId","in",_),He("reportCount",">",0));return(await gn(E)).docs.map(A=>({id:A.id,...A.data()}))}catch(y){return console.error("Error getting reported comments:",y),[]}},p=async x=>{try{const y=Dt(Me(Y,"comments"),He("parentCommentId","==",x),He("isDeleted","==",!1)),v=await gn(y);let _=v.size;for(const E of v.docs)_+=await p(E.id);return _}catch(y){return console.error("Error contando respuestas:",y),0}},g=async(x,y,v,_=null)=>{try{await _n(Me(Y,"global_moderation_reports"),{userId:x,reason:y,moderatorId:Ne.currentUser.uid,actionType:v,commentId:_,reportedAt:bt(),status:"pending_review",communityContext:!0,requiresAction:!0,severity:v.includes("rejected")?"medium":"high"})}catch(E){console.error("Error reporting to global moderation:",E)}};return{validateComment:n,rejectComment:a,deleteComment:l,getPendingComments:u,getReportedComments:h,loading:s}};function lA({isOpen:s,onClose:e,comment:n,forumData:a,onCommentModerated:l}){const[u,h]=V.useState(!1),[p,g]=V.useState(""),[x,y]=V.useState(""),[v,_]=V.useState(!0),{deleteComment:E}=oA(),S=async A=>{if(A.preventDefault(),!x.trim()){g("Debes proporcionar una razn para la eliminacin");return}h(!0),g("");try{const D=await E(n.id,x.trim(),a.id,!0,v);D.success?(l&&l(D.deletedCount),e(),D.deletedCount>1?alert(` Comentario eliminado junto con ${D.deletedCount-1} respuesta(s) por moderacin.`):alert(" Comentario eliminado por moderacin.")):g(D.error)}catch{g("Error al eliminar el comentario")}finally{h(!1)}};return!s||!n?null:i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md my-8",onClick:A=>A.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white z-10 rounded-t-2xl",children:[i.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[i.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx(Qn,{className:"w-5 h-5 text-red-600"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 truncate",children:"Eliminar Comentario (Moderacin)"}),i.jsx("p",{className:"text-sm text-gray-500 truncate",children:"Esta accin se registrar para auditora"})]})]}),i.jsx("button",{onClick:e,disabled:u,className:"p-2 hover:bg-gray-100 rounded-lg transition duration-200 disabled:opacity-50 flex-shrink-0 ml-2",children:i.jsx(At,{className:"w-5 h-5 text-gray-500"})})]}),i.jsx("div",{className:"max-h-[calc(80vh-120px)] overflow-y-auto",children:i.jsxs("form",{onSubmit:S,className:"p-6",children:[p&&i.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:i.jsx("p",{className:"text-red-700 text-sm",children:p})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Comentario a eliminar:"}),i.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:[i.jsx("div",{className:"text-sm text-gray-700 line-clamp-3 break-words",children:n.content}),i.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Creado el: ",n.createdAt?.toDate?.().toLocaleDateString("es-ES")||"Fecha no disponible"]})]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-700 mb-2",children:"Razn de eliminacin *"}),i.jsx("textarea",{id:"reason",value:x,onChange:A=>y(A.target.value),disabled:u,rows:3,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 transition duration-200 resize-none disabled:opacity-50",placeholder:"Explica por qu este comentario debe ser eliminado...",required:!0})]}),i.jsx("div",{className:"mb-6",children:i.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:v,onChange:A=>_(A.target.checked),disabled:u,className:"w-4 h-4 text-red-600 border-gray-300 rounded focus:ring-red-500"}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Eliminar tambin las respuestas"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Si est marcado, todas las respuestas a este comentario tambin sern eliminadas"})]})]})}),i.jsx("div",{className:"border border-red-200 bg-red-50 rounded-lg p-4 mb-6",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(an,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium text-red-800 mb-1",children:"Accin de moderacin"}),i.jsxs("ul",{className:"text-xs text-red-700 space-y-1",children:[i.jsx("li",{children:" El comentario se marcar como eliminado por moderacin"}),i.jsx("li",{children:" El autor ser notificado sobre la eliminacin"}),i.jsx("li",{children:" La accin quedar registrada en el sistema de auditora"}),i.jsx("li",{children:" Puede conllevar sanciones para el autor"}),i.jsx("li",{children:" Se reportar a moderacin global"})]})]})]})})]})}),i.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50 sticky bottom-0 rounded-b-2xl",children:i.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[i.jsx("button",{type:"button",onClick:e,disabled:u,className:"px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition duration-200 font-medium disabled:opacity-50 order-2 sm:order-1",children:"Cancelar"}),i.jsxs("button",{type:"submit",onClick:S,disabled:u||!x.trim(),className:"px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition duration-200 font-medium flex items-center justify-center gap-2 disabled:opacity-50 order-1 sm:order-2",children:[u&&i.jsx(ut,{className:"w-4 h-4 animate-spin"}),i.jsx(ta,{className:"w-4 h-4"}),"Eliminar como Moderador"]})]})})]})})}function cA({comment:s,postId:e,userData:n,onCommentCreated:a,isReply:l=!1,forumData:u,onShowUserProfile:h}){const[p,g]=V.useState(!1),[x,y]=V.useState(!1),[v,_]=V.useState(!1),[E,S]=V.useState(!1),[A,D]=V.useState(!1),[L,B]=V.useState(!1),[k,$]=V.useState(null),[q,F]=V.useState(null),[R,j]=V.useState(!1),[C,O]=V.useState(!1),{likeComment:P}=Yh(),{likeCount:U,userLiked:M,loading:ue}=rA(s.id),we=Ne.currentUser;V.useEffect(()=>{K(),ce()},[s.authorId,u]);const K=async()=>{try{const Te=await ve(se(Y,"users",s.authorId));Te.exists()&&$(Te.data())}catch(Te){console.error("Error cargando datos del autor:",Te)}},ce=async()=>{if(u)F(u);else if(e)try{const Te=await ve(se(Y,"posts",e));if(Te.exists()){const Pt=Te.data(),bn=await ve(se(Y,"forums",Pt.forumId));bn.exists()&&F({id:bn.id,...bn.data()})}}catch(Te){console.error("Error cargando datos del foro:",Te)}},ge=()=>{h&&k&&h({id:s.authorId,...k})},Ee=async()=>{if(!we)return;j(!0);const Te=await P(s.id);j(!1),Te.success||console.error("Error en like:",Te.error)},Le=()=>{y(!0),g(!1)},H=()=>{_(!0),g(!1)},ae=()=>{S(!0),g(!1)},he=()=>{k&&(D(!0),g(!1))},me=()=>{B(!0),g(!1)},Ae=()=>{y(!1)},Ie=()=>{_(!1)},Fe=()=>{O(!0),g(!1)},wt=()=>{S(!1),a&&a()},at=()=>{D(!1)},on=we&&we.uid===s.authorId,Yn=n&&["moderator","admin"].includes(n?.role),Kn=q&&q.moderators&&q.moderators[we?.uid],os=q&&q.ownerId===we?.uid,ln=Yn||Kn||os,In=n&&["doctor","moderator","admin"].includes(n?.role),nt=we&&!on&&!ln,Tn=we&&(on||ln||nt),it=()=>{if(!k)return"Usuario";const{name:Te}=k;return Te&&(Te.name||Te.apellidopat||Te.apellidomat)?`${Te.name||""} ${Te.apellidopat||""} ${Te.apellidomat||""}`.trim():k.email||"Usuario"},Qe=()=>k&&k.professionalInfo?.specialty||null,qe=()=>k&&k.photoURL||null,Ct=Te=>{if(!Te)return"";try{return Te.toDate?Te.toDate().toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):new Date(Te).toLocaleDateString("es-ES")}catch{return"Fecha invlida"}},Es=Te=>Te?Te.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>"):"";return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:`bg-white rounded-lg border border-gray-200 p-4 ${l?"bg-gray-50":""}`,children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsx("div",{className:"flex items-center gap-3",children:i.jsxs("button",{onClick:ge,className:"flex items-center gap-3 hover:bg-gray-50 rounded-lg p-1 transition duration-200 group",children:[qe()?i.jsx("img",{src:qe(),alt:`Foto de ${it()}`,className:"w-8 h-8 rounded-full object-cover border-2 border-blue-100 group-hover:border-blue-300 transition duration-200 flex-shrink-0"}):i.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center group-hover:from-blue-600 group-hover:to-purple-700 transition duration-200 flex-shrink-0",children:i.jsx(yn,{className:"w-4 h-4 text-white"})}),i.jsxs("div",{className:"text-left",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("h3",{className:"font-semibold text-gray-900 text-sm group-hover:text-blue-600 transition duration-200",children:it()}),Qe()&&i.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:Qe()})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[i.jsx(Qi,{className:"w-3 h-3"}),i.jsx("span",{children:Ct(s.createdAt)}),s.updatedAt&&i.jsxs(i.Fragment,{children:[i.jsx("span",{children:""}),i.jsx("span",{className:"text-gray-400",children:"Editado"})]})]})]})]})}),Tn&&i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:()=>g(!p),className:"p-1 hover:bg-gray-100 rounded transition duration-200",children:i.jsx(H4,{className:"w-4 h-4 text-gray-500"})}),p&&i.jsxs("div",{className:"absolute right-0 top-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-10 min-w-[160px]",children:[on&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:Le,className:"w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[i.jsx(ea,{className:"w-3 h-3"}),"Editar"]}),i.jsxs("button",{onClick:H,className:"w-full text-left px-3 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[i.jsx(ta,{className:"w-3 h-3"}),"Eliminar"]})]}),nt&&i.jsxs("button",{onClick:me,className:"w-full text-left px-3 py-2 text-sm text-orange-600 hover:bg-orange-50 flex items-center gap-2",children:[i.jsx(eu,{className:"w-3 h-3"}),"Reportar"]}),ln&&!on&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"border-t border-gray-200 my-1"}),i.jsx("div",{className:"px-3 py-1 text-xs font-medium text-gray-500 bg-gray-50",children:"Moderacin"}),i.jsxs("button",{onClick:Fe,className:"w-full text-left px-3 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[i.jsx(ta,{className:"w-3 h-3"}),"Eliminar Comentario"]}),i.jsxs("button",{onClick:he,className:"w-full text-left px-3 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[i.jsx(mr,{className:"w-3 h-3"}),"Banear Usuario"]})]})]})]})]}),i.jsx("div",{className:"mb-4",children:i.jsx("div",{className:"text-gray-700 whitespace-pre-line break-words leading-relaxed text-sm",dangerouslySetInnerHTML:{__html:Es(s.content)}})}),i.jsxs("div",{className:"flex items-center gap-4 pt-3 border-t border-gray-100",children:[i.jsxs("button",{onClick:Ee,disabled:!we||R||ue,className:`flex items-center gap-2 px-2 py-1 rounded transition duration-200 text-sm ${M?"text-red-600 hover:text-red-700":"text-gray-600 hover:text-gray-700"} ${!we||R?"opacity-50 cursor-not-allowed":""}`,children:[R?i.jsx(ut,{className:"w-3 h-3 animate-spin"}):M?i.jsx(tu,{className:"w-3 h-3"}):i.jsx(Q4,{className:"w-3 h-3"}),i.jsx("span",{className:"font-medium",children:U})]}),In&&i.jsxs("button",{onClick:ae,className:"flex items-center gap-2 px-2 py-1 rounded text-gray-600 hover:text-gray-700 hover:bg-gray-100 transition duration-200 text-sm",children:[i.jsx($4,{className:"w-3 h-3"}),i.jsx("span",{children:"Responder"})]})]})]}),i.jsx(aA,{isOpen:x,onClose:()=>y(!1),comment:s,onCommentUpdated:Ae}),i.jsx(iA,{isOpen:v,onClose:()=>_(!1),comment:s,onCommentDeleted:Ie,isModeratorAction:ln&&!on}),i.jsx(uw,{isOpen:E,onClose:()=>S(!1),postId:e,postTitle:"Responder comentario",parentCommentId:s.id,onCommentCreated:wt}),q&&i.jsx(cw,{isOpen:A,onClose:()=>D(!1),user:k?{id:s.authorId,...k}:null,forumId:q.id,forumName:q.name,onUserBanned:at}),i.jsx(Qh,{isOpen:L,onClose:()=>B(!1),reportType:"comment",targetId:s.id,targetName:`Comentario de ${it()}`}),i.jsx(lA,{isOpen:C,onClose:()=>O(!1),comment:s,forumData:q,onCommentModerated:Te=>{O(!1),a&&a()}})]})}function uA({comments:s,loading:e,error:n,postId:a,userData:l,onCommentCreated:u,onShowUserProfile:h,forumData:p}){const[g,x]=V.useState(new Set),[y,v]=V.useState(new Set),E=(B=>{const k=new Map,$=[];return B.forEach(q=>{k.set(q.id,{...q,replies:[],replyCount:0,depth:0})}),B.forEach(q=>{const F=k.get(q.id);if(q.parentCommentId){const R=k.get(q.parentCommentId);R&&(R.replies.push(F),R.replyCount=(R.replyCount||0)+1,F.depth=R.depth+1)}else $.push(F)}),$})(s),S=B=>{x(k=>{const $=new Set(k);return $.has(B)?($.delete(B),A(B,$)):$.add(B),$})},A=(B,k)=>{const $=E.find(q=>q.id===B)||E.flatMap(q=>q.replies).find(q=>q.id===B);$&&$.replies&&$.replies.forEach(q=>{k.delete(q.id),A(q.id,k)})},D=B=>{v(k=>{const $=new Set(k);return $.has(B)?$.delete(B):$.add(B),$})};if(e)return i.jsx("div",{className:"flex justify-center py-8",children:i.jsxs("div",{className:"text-center",children:[i.jsx(ut,{className:"w-8 h-8 text-blue-500 animate-spin mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"Cargando comentarios..."})]})});if(n)return i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"text-red-500 mb-4",children:i.jsx(an,{className:"w-12 h-12 mx-auto"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Error al cargar comentarios"}),i.jsx("p",{className:"text-gray-600",children:n})]});if(E.length===0)return i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"text-gray-400 mb-4",children:i.jsx(yT,{className:"w-16 h-16 mx-auto"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No hay comentarios an"}),i.jsx("p",{className:"text-gray-600",children:"S el primero en comentar esta publicacin"})]});const L=(B,k=0,$=!0)=>{const q=B.replies&&B.replies.length>0,F=g.has(B.id),R=y.has(B.id);if(k>0&&!$)return null;const O=Math.min(k,4)*1.5,P=R?B.replies:B.replies.slice(0,2),U=B.replies.length>2&&!R;return i.jsxs("div",{className:`${k>0?`ml-${O*4} border-l-2 border-gray-200 pl-4`:""}`,children:[i.jsx(cA,{comment:B,postId:a,userData:l,onCommentCreated:u,onShowUserProfile:h,isReply:k>0,forumData:p}),q&&i.jsx("div",{className:"mt-3 ml-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("button",{onClick:()=>S(B.id),className:"flex items-center gap-2 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 px-3 py-1 rounded-lg transition duration-200",children:[F?i.jsx(O0,{className:"w-3 h-3"}):i.jsx(ab,{className:"w-3 h-3"}),i.jsxs("span",{children:[F?"Ocultar":"Ver"," ",B.replyCount," respuesta",B.replyCount!==1?"s":""]})]}),k>0&&i.jsxs("span",{className:"text-xs text-gray-400 flex items-center gap-1",children:[i.jsx($4,{className:"w-3 h-3 rotate-180"}),"Hilo anidado"]})]})}),q&&F&&i.jsxs("div",{className:"mt-4 space-y-4",children:[P.map(M=>L(M,k+1,F)),U&&i.jsx("div",{className:`ml-${(O+1)*4}`,children:i.jsxs("button",{onClick:()=>D(B.id),className:"flex items-center gap-2 text-sm text-blue-600 hover:text-blue-700 hover:bg-blue-50 px-3 py-2 rounded-lg transition duration-200",children:[i.jsx(O0,{className:"w-3 h-3"}),i.jsxs("span",{children:["Ver ",B.replies.length-2," respuestas ms"]})]})}),R&&B.replies.length>2&&i.jsx("div",{className:`ml-${(O+1)*4}`,children:i.jsxs("button",{onClick:()=>D(B.id),className:"flex items-center gap-2 text-sm text-gray-600 hover:text-gray-700 hover:bg-gray-100 px-3 py-2 rounded-lg transition duration-200",children:[i.jsx(ab,{className:"w-3 h-3"}),i.jsx("span",{children:"Mostrar menos"})]})})]})]},B.id)};return i.jsx("div",{className:"space-y-6",children:E.map(B=>L(B))})}const dA=s=>{const[e,n]=V.useState(null),[a,l]=V.useState(!0),[u,h]=V.useState(null);return V.useEffect(()=>{if(!s){n(null),l(!1);return}const p=se(Y,"posts",s),g=zs(p,x=>{if(x.exists()){const y={id:x.id,...x.data(),likes:x.data().likes||[],dislikes:x.data().dislikes||[],images:x.data().images||[],stats:{commentCount:x.data().stats?.commentCount||0,viewCount:x.data().stats?.viewCount||0}};n(y)}else n(null);l(!1)},x=>{console.error("Error cargando post:",x),h("Error cargando publicacin"),l(!1)});return()=>g()},[s]),{post:e,loading:a,error:u}};function hA({post:s,onBack:e,onShowUserProfile:n}){const{post:a,loading:l,error:u}=dA(s?.id),[h,p]=V.useState(null),[g,x]=V.useState(null),[y,v]=V.useState(null),[_,E]=V.useState(!1),{comments:S,loading:A,error:D}=sA(s?.id),L=Ne.currentUser;V.useEffect(()=>{k()},[L]),V.useEffect(()=>{a&&(B(),$())},[a]);const B=async()=>{if(a?.authorId)try{const C=await ve(se(Y,"users",a.authorId));C.exists()&&p(C.data())}catch(C){console.error("Error cargando datos del autor:",C)}},k=async()=>{if(L)try{const C=await ve(se(Y,"users",L.uid));C.exists()&&x(C.data())}catch(C){console.error("Error cargando userData:",C)}},$=async()=>{try{if(a?.forumId){const C=await ve(se(Y,"forums",a.forumId));C.exists()&&v({id:C.id,...C.data()})}}catch(C){console.error("Error cargando datos del foro:",C)}},q=()=>{E(!1)},F=()=>{},R=()=>{e&&e()};if(l)return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx(ut,{className:"w-8 h-8 text-blue-500 animate-spin mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"Cargando publicacin..."})]})});if(u)return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx(an,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Error al cargar la publicacin"}),i.jsx("p",{className:"text-gray-600 mb-4",children:u}),i.jsx("button",{onClick:e,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-200",children:"Volver"})]})});if(!a)return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx(an,{className:"w-12 h-12 text-yellow-500 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Publicacin no encontrada"}),i.jsx("button",{onClick:e,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-200",children:"Volver al inicio"})]})});const j=g&&["doctor","moderator","admin"].includes(g?.role);return i.jsxs("div",{className:"min-h-screen bg-gray-50 py-6",children:[i.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[i.jsx("div",{className:"mb-6",children:i.jsxs("button",{onClick:e,className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 px-4 py-2 rounded-lg transition duration-200",children:[i.jsx(qg,{className:"w-4 h-4"}),i.jsx("span",{children:"Volver"})]})}),i.jsx("div",{className:"mb-8",children:i.jsx(Yg,{post:a,onCommentClick:()=>{},onPostUpdated:F,onPostDeleted:R,onShowUserProfile:n,userRole:g?.role,userMembership:{},requiresPostApproval:!1,showCommentsButton:!1})}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Comentarios (",S.length,")"]}),j&&i.jsx("button",{onClick:()=>E(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-200 font-medium",children:"Nuevo Comentario"})]}),!j&&L&&i.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Solo usuarios verificados pueden comentar"}),!L&&i.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Inicia sesin para comentar"})]}),i.jsx("div",{className:"p-6",children:i.jsx(uA,{comments:S,loading:A,error:D,postId:a.id,userData:g,onCommentCreated:q,onShowUserProfile:n,forumData:y})})]})]}),i.jsx(uw,{isOpen:_,onClose:()=>E(!1),postId:a.id,postTitle:a.title,onCommentCreated:q})]})}function fA(){const[s,e]=V.useState(!1),[n,a]=V.useState("main"),[l,u]=V.useState("main"),[h,p]=V.useState({query:"",type:"forums"}),[g,x]=V.useState(null),[y,v]=V.useState(null),[_,E]=V.useState(null),[S,A]=V.useState(null),[D,L]=V.useState(null),[B,k]=V.useState(null);V.useEffect(()=>Bc(Ne,ce=>{if(E(ce),ce){const ge=zs(se(Y,"users",ce.uid),Ee=>{Ee.exists()&&A(Ee.data())});return()=>ge()}else A(null)}),[]);const $=K=>{u(n),a(K)},q=()=>{k(null),$("profile")},F=()=>{$("main")},R=(K,ce="forums")=>{p({query:K,type:ce}),$("search")},j=K=>{x(K),$("forum")},C=K=>{v(K),$("post")},O=()=>{a(l)},P=()=>{a(l)},U=()=>{$("verify")},M=()=>{$("verificationRequests")},ue=K=>{console.log(" Mostrar perfil de usuario:",K),K&&K.id?(k(K.id),$("profile")):console.error(" No se pudo obtener el ID del usuario")},we=()=>{B&&B!==_?.uid?(a("search"),k(null)):F()};return i.jsxs("div",{className:"min-h-screen bg-gray-50",children:[i.jsx(m8,{onToggleSidebar:()=>e(!0),onProfileClick:q,onSearch:R,onVerifyAccount:U}),i.jsxs("div",{className:"flex",children:[i.jsx(g8,{onInicioClick:F,onThemeClick:j,userData:S,onVerificationClick:M}),i.jsx(p8,{isOpen:s,onClose:()=>e(!1),onInicioClick:()=>{F(),e(!1)},onThemeClick:j,userData:S,onVerificationClick:M}),i.jsx("div",{className:"flex-1 min-w-0 flex justify-center",children:i.jsxs("div",{className:"w-full max-w-7xl",children:[n==="main"&&i.jsx(x8,{}),n==="profile"&&i.jsx(k8,{userId:B,onShowForum:j,onShowMain:we,onShowPost:C}),n==="search"&&i.jsx(L8,{searchQuery:h.query,searchType:h.type,onThemeClick:j,onShowUserProfile:ue}),n==="forum"&&i.jsx(Z8,{forumData:g,onBack:O,onShowPost:C,onShowUserProfile:ue}),n==="post"&&i.jsx(hA,{post:y,onBack:P,onShowUserProfile:ue}),n==="verify"&&i.jsx(J8,{onBack:F}),n==="verificationRequests"&&i.jsx(nA,{})]})})]})]})}function mA(){const[s,e]=V.useState(null),[n,a]=V.useState(!0);return V.useEffect(()=>Bc(Ne,u=>{u?u.emailVerified?e(u):(Ne.signOut(),e(null)):e(null),a(!1)}),[]),n?i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"Cargando..."})]})}):s?i.jsx(fA,{}):i.jsx(zT,{})}function gA(){return i.jsx("div",{className:"App",children:i.jsx(mA,{})})}Z_.createRoot(document.getElementById("root")).render(i.jsx(Ga.StrictMode,{children:i.jsx(gA,{})}));
